
__label__testing Refactoring log utils  * Moved log functions from rally/common/utils.py #L137-L234 to rally/common/log.y * Moved test tunctions form test/unit/common/test_utils.py to test/unit/common/test_log.py  
__label__objective Refactoring log utils  * Moved log functions from rally/common/utils.py #L137-L234 to rally/common/log.y * Moved test tunctions form test/unit/common/test_utils.py to test/unit/common/test_log.py  
__label__testing (WIP) Refactor for better connection testing  * Assign configured fake connections to test class dynamically  * Generalize event queue handling in tests  * Pass upstream_root to fake gerrit explicitly  * Don't pass fake_gerrit to FakeURLOpener  
__label__objective (WIP) Refactor for better connection testing  * Assign configured fake connections to test class dynamically  * Generalize event queue handling in tests  * Pass upstream_root to fake gerrit explicitly  * Don't pass fake_gerrit to FakeURLOpener  
__label__testing Refactor project instance test  Refactoring the test_launch_instance_post test as suggested in review for bug 1260436. There are four distinct other users of test_launch_instance_post apart from the test itself.  Creating a new method _test_launch_instance_post and ensuring test_launch_instance_post now invokes this method with the default and only required parameters. Other tests also incoke the new method with parameters specific to them.  Closes bug: #1403948  
__label__objective Refactor project instance test  Refactoring the test_launch_instance_post test as suggested in review for bug 1260436. There are four distinct other users of test_launch_instance_post apart from the test itself.  Creating a new method _test_launch_instance_post and ensuring test_launch_instance_post now invokes this method with the default and only required parameters. Other tests also incoke the new method with parameters specific to them.  Closes bug: #1403948  
__label__testing refactoring nova ha system tests to use neutron network manager  *Changed nova-network-manager to neutron-tun on next test cases:  - Add and re-add cinder / compute + cinder to HA cluster  - Add compute node to cluster in HA mode with flat nova-network  - Check HA mode on scalability  - Backup/restore master node with cluster in ha mode  - Optimize code by change repetable code to functions  * Move neutron_tun cases to new file * Move neutron_public_network cases to new file  
__label__objective refactoring nova ha system tests to use neutron network manager  *Changed nova-network-manager to neutron-tun on next test cases:  - Add and re-add cinder / compute + cinder to HA cluster  - Add compute node to cluster in HA mode with flat nova-network  - Check HA mode on scalability  - Backup/restore master node with cluster in ha mode  - Optimize code by change repetable code to functions  * Move neutron_tun cases to new file * Move neutron_public_network cases to new file  
__label__quality refactoring nova ha system tests to use neutron network manager  *Changed nova-network-manager to neutron-tun on next test cases:  - Add and re-add cinder / compute + cinder to HA cluster  - Add compute node to cluster in HA mode with flat nova-network  - Check HA mode on scalability  - Backup/restore master node with cluster in ha mode  - Optimize code by change repetable code to functions  * Move neutron_tun cases to new file * Move neutron_public_network cases to new file  
__label__testing Refactoring test on test_api  Addition of function get_request_object_data() to remove the repeating lines in many methods. The refactoring is partially done because it affects more than 500 lines of code (mostly deletion of code lines). There are still other aspects remaining to refactor it more.  This bug is an action item to track the review comment for  https://review.openstack.org/#/c/64079/4 raised by Steve Kowalik.  
__label__objective Refactoring test on test_api  Addition of function get_request_object_data() to remove the repeating lines in many methods. The refactoring is partially done because it affects more than 500 lines of code (mostly deletion of code lines). There are still other aspects remaining to refactor it more.  This bug is an action item to track the review comment for  https://review.openstack.org/#/c/64079/4 raised by Steve Kowalik.  
__label__objective Refactoring test on test_api  Addition of function get_request_object_data() to remove the repeating lines in many methods. The refactoring is partially done because it affects more than 500 lines of code (mostly deletion of code lines). There are still other aspects remaining to refactor it more.  This bug is an action item to track the review comment for  https://review.openstack.org/#/c/64079/4 raised by Steve Kowalik.  
__label__quality Refactoring test on test_api  Addition of function get_request_object_data() to remove the repeating lines in many methods. The refactoring is partially done because it affects more than 500 lines of code (mostly deletion of code lines). There are still other aspects remaining to refactor it more.  This bug is an action item to track the review comment for  https://review.openstack.org/#/c/64079/4 raised by Steve Kowalik.  
__label__testing Targets test refactoring  The unit tests for iser inherit from the tgtAdm, it means that any time run tests for iser, tgtAdm tests run too. This chache add TargetFixture to tests, it allows to decouple tests and delete duplicated code.  Other changes:  -  deleted  __init__ in test's classes; __init__ may work as a replacement for setUp, but  setUp should be used instead because it is part of the protocol for writing tests. It also has a counterpart, tearDown, which __init__ does no;  - replaced stubs to mock.  
__label__quality Targets test refactoring  The unit tests for iser inherit from the tgtAdm, it means that any time run tests for iser, tgtAdm tests run too. This chache add TargetFixture to tests, it allows to decouple tests and delete duplicated code.  Other changes:  -  deleted  __init__ in test's classes; __init__ may work as a replacement for setUp, but  setUp should be used instead because it is part of the protocol for writing tests. It also has a counterpart, tearDown, which __init__ does no;  - replaced stubs to mock.  
__label__objective Targets test refactoring  The unit tests for iser inherit from the tgtAdm, it means that any time run tests for iser, tgtAdm tests run too. This chache add TargetFixture to tests, it allows to decouple tests and delete duplicated code.  Other changes:  -  deleted  __init__ in test's classes; __init__ may work as a replacement for setUp, but  setUp should be used instead because it is part of the protocol for writing tests. It also has a counterpart, tearDown, which __init__ does no;  - replaced stubs to mock.  
__label__testing refactored test in xenapi/test_vm_utils to pass wiith random PYTHOHASHSEED  added ordering before assertion Partial-Bug: #1348818  
__label__objective refactored test in xenapi/test_vm_utils to pass wiith random PYTHOHASHSEED  added ordering before assertion Partial-Bug: #1348818  
__label__testing refactored test in test_cloud to pass with random PYTHONHASHSEED  sort lists in dictionaries before assertions Partial-Bug: #1348818  
__label__objective refactored test in test_cloud to pass with random PYTHONHASHSEED  sort lists in dictionaries before assertions Partial-Bug: #1348818  
__label__testing refactored test in test_trusted_filters to pass with random PYTHONHASHSEED  changed assertion of trusted_filter  mock _request method arguments  Partial-Bug: #1348818  
__label__objective refactored test in test_trusted_filters to pass with random PYTHONHASHSEED  changed assertion of trusted_filter  mock _request method arguments  Partial-Bug: #1348818  
__label__testing Refactor Fernet: drop timestamps and move payload version into payload  This is a squashed commit consisting of the following changes:  - https://review.openstack.org/#/c/161838/ - https://review.openstack.org/#/c/161855/ - https://review.openstack.org/#/c/161876/ - https://review.openstack.org/#/c/161774/ - https://review.openstack.org/#/c/161897/ - https://review.openstack.org/#/c/162031/  Net summary of changes:  - Remove token formatters dependency on 'token_data', the v3 token data   helper, and the trust_api. The calling module already has to interface   with all these modules and understand how token_data is composed, so   there's no reason for the token formatters create() method to work   with such complex data. This patch ensures that token formatters only   see primitive strings (of datetimes, audit IDs, and trust IDs) when   creating tokens, which they're free to encode however they wish.  - The handling of audit_ids is simplified (they're not mutated any more   than strictly necessary).  - This removes the expiration timestamp embedded in Fernet tokens in   favor of using key rotation to tune the lifespan of Fernet tokens.  - This removes the creation timestamp from the token's payload in favor   of extracting the token's creation timestamp from the Fernet token   format itself.  - This moves the payload version (part of the plaintext token prefix)   into the integrity verified portion of the token (the payload). This   also drops the 'F', which doesn't serve a purpose with Fernet tokens   as it does with token formats that can be validated offline (PKI,   PKIZ). This requires a bunch of refactoring to move the responsibility   of decrypting, unpacking, and disassembling the payload contents to   the caller (the Provider).  - Add a domain-scoped payload format, identical to that for   project-scoped tokens, just with a different version number. Better   functional tests revealed that tests intended to exercise   domain-scoped Fernet tokens, which didn't exist, should not have been   passing.  - Remove remaining functional tests from the unit test suite   (test_fernet_provider), and ensure that same coverage exists in the   actual functional test suite (test_v3_auth). Several of the unit tests   required heavy refactoring due to the refactoring required to support   the first item above, so it was easier just to dump those tests in   favor of better functional test coverage, which are agnostic to the   implementation details.  
__label__quality Refactor Fernet: drop timestamps and move payload version into payload  This is a squashed commit consisting of the following changes:  - https://review.openstack.org/#/c/161838/ - https://review.openstack.org/#/c/161855/ - https://review.openstack.org/#/c/161876/ - https://review.openstack.org/#/c/161774/ - https://review.openstack.org/#/c/161897/ - https://review.openstack.org/#/c/162031/  Net summary of changes:  - Remove token formatters dependency on 'token_data', the v3 token data   helper, and the trust_api. The calling module already has to interface   with all these modules and understand how token_data is composed, so   there's no reason for the token formatters create() method to work   with such complex data. This patch ensures that token formatters only   see primitive strings (of datetimes, audit IDs, and trust IDs) when   creating tokens, which they're free to encode however they wish.  - The handling of audit_ids is simplified (they're not mutated any more   than strictly necessary).  - This removes the expiration timestamp embedded in Fernet tokens in   favor of using key rotation to tune the lifespan of Fernet tokens.  - This removes the creation timestamp from the token's payload in favor   of extracting the token's creation timestamp from the Fernet token   format itself.  - This moves the payload version (part of the plaintext token prefix)   into the integrity verified portion of the token (the payload). This   also drops the 'F', which doesn't serve a purpose with Fernet tokens   as it does with token formats that can be validated offline (PKI,   PKIZ). This requires a bunch of refactoring to move the responsibility   of decrypting, unpacking, and disassembling the payload contents to   the caller (the Provider).  - Add a domain-scoped payload format, identical to that for   project-scoped tokens, just with a different version number. Better   functional tests revealed that tests intended to exercise   domain-scoped Fernet tokens, which didn't exist, should not have been   passing.  - Remove remaining functional tests from the unit test suite   (test_fernet_provider), and ensure that same coverage exists in the   actual functional test suite (test_v3_auth). Several of the unit tests   required heavy refactoring due to the refactoring required to support   the first item above, so it was easier just to dump those tests in   favor of better functional test coverage, which are agnostic to the   implementation details.  
__label__objective Refactor Fernet: drop timestamps and move payload version into payload  This is a squashed commit consisting of the following changes:  - https://review.openstack.org/#/c/161838/ - https://review.openstack.org/#/c/161855/ - https://review.openstack.org/#/c/161876/ - https://review.openstack.org/#/c/161774/ - https://review.openstack.org/#/c/161897/ - https://review.openstack.org/#/c/162031/  Net summary of changes:  - Remove token formatters dependency on 'token_data', the v3 token data   helper, and the trust_api. The calling module already has to interface   with all these modules and understand how token_data is composed, so   there's no reason for the token formatters create() method to work   with such complex data. This patch ensures that token formatters only   see primitive strings (of datetimes, audit IDs, and trust IDs) when   creating tokens, which they're free to encode however they wish.  - The handling of audit_ids is simplified (they're not mutated any more   than strictly necessary).  - This removes the expiration timestamp embedded in Fernet tokens in   favor of using key rotation to tune the lifespan of Fernet tokens.  - This removes the creation timestamp from the token's payload in favor   of extracting the token's creation timestamp from the Fernet token   format itself.  - This moves the payload version (part of the plaintext token prefix)   into the integrity verified portion of the token (the payload). This   also drops the 'F', which doesn't serve a purpose with Fernet tokens   as it does with token formats that can be validated offline (PKI,   PKIZ). This requires a bunch of refactoring to move the responsibility   of decrypting, unpacking, and disassembling the payload contents to   the caller (the Provider).  - Add a domain-scoped payload format, identical to that for   project-scoped tokens, just with a different version number. Better   functional tests revealed that tests intended to exercise   domain-scoped Fernet tokens, which didn't exist, should not have been   passing.  - Remove remaining functional tests from the unit test suite   (test_fernet_provider), and ensure that same coverage exists in the   actual functional test suite (test_v3_auth). Several of the unit tests   required heavy refactoring due to the refactoring required to support   the first item above, so it was easier just to dump those tests in   favor of better functional test coverage, which are agnostic to the   implementation details.  
__label__testing Refactoring the rest tests and their tooling  There will be a need for session and role information in these test as the code and tests get more complicated. I don't feel, at this point, there is a need for a new test case class for these tests.  Also, the utils in the api_tests directory is really confusing. So, rolled that into the base test class in helpers.py  
__label__objective Refactoring the rest tests and their tooling  There will be a need for session and role information in these test as the code and tests get more complicated. I don't feel, at this point, there is a need for a new test case class for these tests.  Also, the utils in the api_tests directory is really confusing. So, rolled that into the base test class in helpers.py  
__label__quality Refactoring the rest tests and their tooling  There will be a need for session and role information in these test as the code and tests get more complicated. I don't feel, at this point, there is a need for a new test case class for these tests.  Also, the utils in the api_tests directory is really confusing. So, rolled that into the base test class in helpers.py  
__label__testing Refactor RootHelperProcess with AsyncProcess  * move RootHelperProcess from functional test to common lib so we can re-use in another cases outside of functional test, i.e. sanity test * RootHelperProcess and AsyncProcess have similar functions so I merge all functions of RootHelperProcess to AsyncProcess. * add optional param wait_cmd_start (default to False) for AsyncProcess to wait for the command of the child process to start executing before it can return to main process (and wait for the result asynchronous)  
__label__objective Refactor RootHelperProcess with AsyncProcess  * move RootHelperProcess from functional test to common lib so we can re-use in another cases outside of functional test, i.e. sanity test * RootHelperProcess and AsyncProcess have similar functions so I merge all functions of RootHelperProcess to AsyncProcess. * add optional param wait_cmd_start (default to False) for AsyncProcess to wait for the command of the child process to start executing before it can return to main process (and wait for the result asynchronous)  
__label__quality Refactor RootHelperProcess with AsyncProcess  * move RootHelperProcess from functional test to common lib so we can re-use in another cases outside of functional test, i.e. sanity test * RootHelperProcess and AsyncProcess have similar functions so I merge all functions of RootHelperProcess to AsyncProcess. * add optional param wait_cmd_start (default to False) for AsyncProcess to wait for the command of the child process to start executing before it can return to main process (and wait for the result asynchronous)  
__label__objective Refactor RootHelperProcess with AsyncProcess  * move RootHelperProcess from functional test to common lib so we can re-use in another cases outside of functional test, i.e. sanity test * RootHelperProcess and AsyncProcess have similar functions so I merge all functions of RootHelperProcess to AsyncProcess. * add optional param wait_cmd_start (default to False) for AsyncProcess to wait for the command of the child process to start executing before it can return to main process (and wait for the result asynchronous)  
__label__testing WIP: Refactor unit test helpers to return objects  Make the return value from the port, network, and subnet creation methods in the unit tests return something with helper methods to manage the lifecycle of each item more concisely.  Refactors the tests in test_db_plugin to leverage these new objects.  
__label__objective WIP: Refactor unit test helpers to return objects  Make the return value from the port, network, and subnet creation methods in the unit tests return something with helper methods to manage the lifecycle of each item more concisely.  Refactors the tests in test_db_plugin to leverage these new objects.  
__label__testing Xenapi: refactor _find_vdi_refs and lookup_vm_vdis  The two functions look to be doing the same thing and we really don't need two implementations.  This change works to remove the lookup_vm_vdis implementation, but keep it's name.  Test cases are adjusted to handle passing dictionary instead or list.  
__label__objective Xenapi: refactor _find_vdi_refs and lookup_vm_vdis  The two functions look to be doing the same thing and we really don't need two implementations.  This change works to remove the lookup_vm_vdis implementation, but keep it's name.  Test cases are adjusted to handle passing dictionary instead or list.  
__label__testing Refactoring some libvirt tests to use mock  Test Case: nova.tests.virt.libvirt.test_driver.LibvirtConnTestCase  Tests: test_hard_reboot test_resume test_finish_migration_power_on test_finish_migration_power_off test_finish_revert_migration_after_crash test_finish_revert_migration_after_crash_before_backup test_finish_revert_migration_after_crash_delete_failed  Partial-Bug 1370590  
__label__testing Sample of refactoring test code for a retargetable client  The goal is to move the following out of tests into the client: 1. validation 2. serialize/deserialize 3. resource management using addCleanUp  The client will return an object as an attribute dict so members can be access with instance variable syntax.  This change allows an abstract definition of the client interface which will allow decoupling of "where the tests live" and "what client is used". Clients might be a tempest client, official client, or direct API calls to a project.  
__label__objective Sample of refactoring test code for a retargetable client  The goal is to move the following out of tests into the client: 1. validation 2. serialize/deserialize 3. resource management using addCleanUp  The client will return an object as an attribute dict so members can be access with instance variable syntax.  This change allows an abstract definition of the client interface which will allow decoupling of "where the tests live" and "what client is used". Clients might be a tempest client, official client, or direct API calls to a project.  
__label__quality Sample of refactoring test code for a retargetable client  The goal is to move the following out of tests into the client: 1. validation 2. serialize/deserialize 3. resource management using addCleanUp  The client will return an object as an attribute dict so members can be access with instance variable syntax.  This change allows an abstract definition of the client interface which will allow decoupling of "where the tests live" and "what client is used". Clients might be a tempest client, official client, or direct API calls to a project.  
__label__testing WIP: refactor glance tempest test  To make checking of data table against service data more reusable.  
__label__quality WIP: refactor glance tempest test  To make checking of data table against service data more reusable.  
__label__testing Refactor test cases of test_floating_ip_dnsto simple code  This is some preparation works to make sharing unittests between V2.1 and V2 easier.  
__label__objective Refactor test cases of test_floating_ip_dnsto simple code  This is some preparation works to make sharing unittests between V2.1 and V2 easier.  
__label__testing Refactor Schedule class  Instead of having a list of Schedule objects in every Meeting object, lets just keep the dictionary that we get from parsing the YAML file and store that in an attribute of the Meeting object. Added test for validating datetime, and mocked out the datetime module.  
__label__objective Refactor Schedule class  Instead of having a list of Schedule objects in every Meeting object, lets just keep the dictionary that we get from parsing the YAML file and store that in an attribute of the Meeting object. Added test for validating datetime, and mocked out the datetime module.  
__label__testing Refactoring Trove gates jobs  Reasons:  - All Trove gate jobs should be moved under job-groups    to allocation all possible future modifications aroung on trove.yaml  Changes:  - implementing two groups job groups:    - gate-trove-functional-dsvm-test-group -- covers non-heat and heat      test jobs templates for different datastores;    - gate-trove-buildimage-group -- covers image publishing jobs for datastores  
__label__objective Refactoring Trove gates jobs  Reasons:  - All Trove gate jobs should be moved under job-groups    to allocation all possible future modifications aroung on trove.yaml  Changes:  - implementing two groups job groups:    - gate-trove-functional-dsvm-test-group -- covers non-heat and heat      test jobs templates for different datastores;    - gate-trove-buildimage-group -- covers image publishing jobs for datastores  
__label__testing Refactoring test on test_api  Addition of function get_request_object_data() to remove the repeating lines in many methods.  recheck bug 1307344  This bug is an action item to track the review comment for https://review.openstack.org/#/c/64079/4 raised by Steve Kowalik.  
__label__quality Refactoring test on test_api  Addition of function get_request_object_data() to remove the repeating lines in many methods.  recheck bug 1307344  This bug is an action item to track the review comment for https://review.openstack.org/#/c/64079/4 raised by Steve Kowalik.  
__label__testing Refactoring test on test_api  Addition of function get_response_object_data() to remove the repeating lines in many methods.The code had some spaces which got automatically added.The spaces have been removed  recheck bug 1307344  This bug is an action item to track the review comment for https://review.openstack.org/#/c/64079/4 raised by Steve Kowalik.  
__label__quality Refactoring test on test_api  Addition of function get_response_object_data() to remove the repeating lines in many methods.The code had some spaces which got automatically added.The spaces have been removed  recheck bug 1307344  This bug is an action item to track the review comment for https://review.openstack.org/#/c/64079/4 raised by Steve Kowalik.  
__label__testing refactor out code duplication  pull out the duplication of setup that was in all the test functions and put it in setup instead.  
__label__quality refactor out code duplication  pull out the duplication of setup that was in all the test functions and put it in setup instead.  
__label__testing Refactor to use docker build-then-run logic.  Dockerfile should be built once, and run many times. This means that docker config should be passed in with ENV variables, following principles in 12 factors. Have refactored web interface to ALSO run tests using ENV, and added a kick.py script to run the docker w/o the web app.  Cherry pick of basic docker build-then-run logic.  
__label__objective Refactor to use docker build-then-run logic.  Dockerfile should be built once, and run many times. This means that docker config should be passed in with ENV variables, following principles in 12 factors. Have refactored web interface to ALSO run tests using ENV, and added a kick.py script to run the docker w/o the web app.  Cherry pick of basic docker build-then-run logic.  
__label__testing Implements: Refactor of YamlParser.parse method  I am proposing this change to allow the use case where the parse method can handle dynamically generated strings in addition to files.  The yaml.load() method can handle both strings and file handles. The current implementation of the YamlParser.parse method excludes strings. By removing the open() call in the the yaml.load method and moving it to the Buider.load_files method the YamlParser can support a broader set of use cases.  The test driver needed to be updated as well since it was loading files directly.  
__label__objective Implements: Refactor of YamlParser.parse method  I am proposing this change to allow the use case where the parse method can handle dynamically generated strings in addition to files.  The yaml.load() method can handle both strings and file handles. The current implementation of the YamlParser.parse method excludes strings. By removing the open() call in the the yaml.load method and moving it to the Buider.load_files method the YamlParser can support a broader set of use cases.  The test driver needed to be updated as well since it was loading files directly.  
__label__testing Refactor proxy configuration  Moved out proxy variables from roles into zuul.d/projects.yaml instead. This way it can be controlled from a centralized place.  Also added the proxy variable for local test scripts in to config_template.yaml.  
__label__objective Refactor proxy configuration  Moved out proxy variables from roles into zuul.d/projects.yaml instead. This way it can be controlled from a centralized place.  Also added the proxy variable for local test scripts in to config_template.yaml.  
__label__quality Refactor proxy configuration  Moved out proxy variables from roles into zuul.d/projects.yaml instead. This way it can be controlled from a centralized place.  Also added the proxy variable for local test scripts in to config_template.yaml.  
__label__testing Refactor code to apply openstacksdk changes  Since some changes appears on openstacksdk this project facing some unit test errors:  - openstack sdk profile remove - openstack sdk execptions changes  This commit try to follow these changes  
__label__objective Refactor code to apply openstacksdk changes  Since some changes appears on openstacksdk this project facing some unit test errors:  - openstack sdk profile remove - openstack sdk execptions changes  This commit try to follow these changes  
__label__integration Refactor tox-tmpl.ini  - drop unneeded '*-nosa' test envs; - move common sql deps to [testenv] section - instead of python-specific axes for SQLAlchemy, introduce new   axis -- mysql -- which defines which MySQL driver should be used   for testing.  
__label__objective Refactor tox-tmpl.ini  - drop unneeded '*-nosa' test envs; - move common sql deps to [testenv] section - instead of python-specific axes for SQLAlchemy, introduce new   axis -- mysql -- which defines which MySQL driver should be used   for testing.  
__label__testing Refactors network scenario test to support more network tests  1. Adds a base network scenario test class. 2. Makes the network scenario basic test inherit from base class. 3. Moves the network scenario tests to network package.  
__label__objective Refactors network scenario test to support more network tests  1. Adds a base network scenario test class. 2. Makes the network scenario basic test inherit from base class. 3. Moves the network scenario tests to network package.  
__label__testing Refactor FloatingIPCheckTracker in basic network scenario test  Move floating IP check to base class manager.NetworkScenarioTest. Do the floating IP check as soon as the floating IP created to server.  
__label__objective Refactor FloatingIPCheckTracker in basic network scenario test  Move floating IP check to base class manager.NetworkScenarioTest. Do the floating IP check as soon as the floating IP created to server.  
__label__testing Refactored access to RequestContext.  RequestContext is passed all over the internal api and it's only used in few places in oslo code and some ironic drivers. I've refactored access to context to make it directly available using: ironic.common.context.get_current_context() function This allows us to remove context parameter from everywhere.  Review process suggestions: 1) ironic/common/context.py - This file provides basic functionality and you need to check it to get the main idea 2) ironic/api/hooks.py - This is a entry point that publishes context for all public API requests 3) ironic/conductor/manager.py - Entry point that publishes context for internal tasks run by scheduler 4) Review all other files. In most files we just remove context from parameters. In test files we fix mock assertions and setUp to publish context manually  
__label__objective Refactored access to RequestContext.  RequestContext is passed all over the internal api and it's only used in few places in oslo code and some ironic drivers. I've refactored access to context to make it directly available using: ironic.common.context.get_current_context() function This allows us to remove context parameter from everywhere.  Review process suggestions: 1) ironic/common/context.py - This file provides basic functionality and you need to check it to get the main idea 2) ironic/api/hooks.py - This is a entry point that publishes context for all public API requests 3) ironic/conductor/manager.py - Entry point that publishes context for internal tasks run by scheduler 4) Review all other files. In most files we just remove context from parameters. In test files we fix mock assertions and setUp to publish context manually  
__label__testing Refactors network test in scenario to support advanced network test  1. Adds VM connectivity check test between VMs in the same subnet. 2. Adds VM connectivity check test after VM resized.  
__label__objective Refactors network test in scenario to support advanced network test  1. Adds VM connectivity check test between VMs in the same subnet. 2. Adds VM connectivity check test after VM resized.  
__label__testing Refactoring api and Archiver  test commit  
__label__integration Refactoring api and Archiver  test commit  
__label__testing Refactor test_agent_scheduler  Unit test for l3 agent scheduler and dhcp agent scheduler should be seperated because:  - they are two different extensions, logically, they should be separated - currently nvp doesn't support both of them, future plugin may not   support both of them too (at least in the development process, it can   happen)  Closes-Bug: #1220005 
__label__objective Refactor test_agent_scheduler  Unit test for l3 agent scheduler and dhcp agent scheduler should be seperated because:  - they are two different extensions, logically, they should be separated - currently nvp doesn't support both of them, future plugin may not   support both of them too (at least in the development process, it can   happen)  Closes-Bug: #1220005 
__label__testing Refactor test_network_info  * Refactor test helper so it's easier to add a new variant to be tested * Change tests order so it's easier to see all possible combos  
__label__quality Refactor test_network_info  * Refactor test helper so it's easier to add a new variant to be tested * Change tests order so it's easier to see all possible combos  
__label__testing Refactor image download  Refactor and test nova/virt/images.py, so that we can reuse the code with the xenapi driver.  Related to blueprint xenapi-supported-image-import-export  
__label__quality Refactor image download  Refactor and test nova/virt/images.py, so that we can reuse the code with the xenapi driver.  Related to blueprint xenapi-supported-image-import-export  
__label__objective Refactor image download  Refactor and test nova/virt/images.py, so that we can reuse the code with the xenapi driver.  Related to blueprint xenapi-supported-image-import-export  
__label__testing Refactor system tests, update for metadata endpnt  Rationale:  This patchset aims to make it far easier to add new system tests in the future, and also includes support for running tests in parallel, if a test runner supports that feature.  Some major additions include:  - Auth once per test suite:     * Facilitated by new TestHTTPClient - Automatic tearDown - Automatic setUp - Perfect clean-up by using context managers for messages, claims, and   queues - Some restructuring of QueueTests: QueueCreate, QueueMeta, QueueList - Updates to queue tests to handle metadata endpoint  One new dependency is added: yurl (see: pypy - yurl). Used to simplify URL location parsing for messages.  Also removed were various print statements and exception-handling.  One minor fix:  import configparser handled in a py3k friendly way  
__label__quality Refactor system tests, update for metadata endpnt  Rationale:  This patchset aims to make it far easier to add new system tests in the future, and also includes support for running tests in parallel, if a test runner supports that feature.  Some major additions include:  - Auth once per test suite:     * Facilitated by new TestHTTPClient - Automatic tearDown - Automatic setUp - Perfect clean-up by using context managers for messages, claims, and   queues - Some restructuring of QueueTests: QueueCreate, QueueMeta, QueueList - Updates to queue tests to handle metadata endpoint  One new dependency is added: yurl (see: pypy - yurl). Used to simplify URL location parsing for messages.  Also removed were various print statements and exception-handling.  One minor fix:  import configparser handled in a py3k friendly way  
__label__objective Refactor system tests, update for metadata endpnt  Rationale:  This patchset aims to make it far easier to add new system tests in the future, and also includes support for running tests in parallel, if a test runner supports that feature.  Some major additions include:  - Auth once per test suite:     * Facilitated by new TestHTTPClient - Automatic tearDown - Automatic setUp - Perfect clean-up by using context managers for messages, claims, and   queues - Some restructuring of QueueTests: QueueCreate, QueueMeta, QueueList - Updates to queue tests to handle metadata endpoint  One new dependency is added: yurl (see: pypy - yurl). Used to simplify URL location parsing for messages.  Also removed were various print statements and exception-handling.  One minor fix:  import configparser handled in a py3k friendly way  
__label__objective Refactor system tests, update for metadata endpnt  Rationale:  This patchset aims to make it far easier to add new system tests in the future, and also includes support for running tests in parallel, if a test runner supports that feature.  Some major additions include:  - Auth once per test suite:     * Facilitated by new TestHTTPClient - Automatic tearDown - Automatic setUp - Perfect clean-up by using context managers for messages, claims, and   queues - Some restructuring of QueueTests: QueueCreate, QueueMeta, QueueList - Updates to queue tests to handle metadata endpoint  One new dependency is added: yurl (see: pypy - yurl). Used to simplify URL location parsing for messages.  Also removed were various print statements and exception-handling.  One minor fix:  import configparser handled in a py3k friendly way  
__label__testing Refactor db api tests.  This test file was nearly 6,000 lines long. This change just splits it out into a series of smaller files by test type. No functional changes.  
__label__integration Refactor db api tests.  This test file was nearly 6,000 lines long. This change just splits it out into a series of smaller files by test type. No functional changes.  
__label__quality Refactor db api tests.  This test file was nearly 6,000 lines long. This change just splits it out into a series of smaller files by test type. No functional changes.  
__label__objective Refactor db api tests.  This test file was nearly 6,000 lines long. This change just splits it out into a series of smaller files by test type. No functional changes.  
__label__testing Alternate refactor of info caching  This is just a reimplementation of the work David Hadas is doing at:  https://review.openstack.org/#/c/30481/  This rework was mainly just so I could get my head around what the state of things were, what state we were trying to get them in, and what was required to get it there. I felt some things were not quite right with David's work, but I was at a loss to explain why. Hopefully this will help when I re-review his work.  I'm mainly posting this up so other reviewers of David's work might get a better view into things from a different perspective and consider some of the ideas here as alternatives.  This is an area to tread lightly. The starting state of things is a mess and the ending state should be cleaner, even if not "perfect".  Now, I do like this approach better (of course, I wrote it :P) but let me state why:  * No all-in-one functions. I know this is what David wanted, but I   disagree. I find the all-in-ones harder to read and easier to make   mistakes with when in use elsewhere. Having them separate doesn't   prevent making an all-in-one that calls the separate functions for   convenience, but honestly, is a quick "if container:   container_func() else: account_func()" that much harder to type or   read?  * No "magic" HEADs that happen to set the cache values and, if they   don't, blow things up. If I implement a stand-in proxy app, I   wouldn't expect to have to feed a cache when implementing my HEAD   functionality. With this approach, the caching stays in the caching   functions and they fail gracefully.  * Account autocreation happens only within controllers/account.py   Everyone else just indicates they're asking for account information   in order to perform a pending write and the account is autocreated   if configured to so.  I used comments liberally in this patch set to help a reviewer understand what changed and why. A final patch set would be needed to clear out these comments as they're mostly just noise after the fact, though it should probably be a separate review/merge so that the history isn't completely lost.  I was especially careful to alter the existing tests as little as possible and to comment liberally again when I had to change things. If this were to truly be a candidate for merging, new tests for the new functions and functionality would need to be added.  One last note: We need to fix our test paths! Wow, talk about a lot of screwy paths. All over the place we use paths like '/a/c' when we should have used '/v1/a/c'. The tests happened to pass all this time because so much relied on controller.account_name and .container_name and not PATH_INFO. But we really need to fix these paths at some point.  
__label__objective Alternate refactor of info caching  This is just a reimplementation of the work David Hadas is doing at:  https://review.openstack.org/#/c/30481/  This rework was mainly just so I could get my head around what the state of things were, what state we were trying to get them in, and what was required to get it there. I felt some things were not quite right with David's work, but I was at a loss to explain why. Hopefully this will help when I re-review his work.  I'm mainly posting this up so other reviewers of David's work might get a better view into things from a different perspective and consider some of the ideas here as alternatives.  This is an area to tread lightly. The starting state of things is a mess and the ending state should be cleaner, even if not "perfect".  Now, I do like this approach better (of course, I wrote it :P) but let me state why:  * No all-in-one functions. I know this is what David wanted, but I   disagree. I find the all-in-ones harder to read and easier to make   mistakes with when in use elsewhere. Having them separate doesn't   prevent making an all-in-one that calls the separate functions for   convenience, but honestly, is a quick "if container:   container_func() else: account_func()" that much harder to type or   read?  * No "magic" HEADs that happen to set the cache values and, if they   don't, blow things up. If I implement a stand-in proxy app, I   wouldn't expect to have to feed a cache when implementing my HEAD   functionality. With this approach, the caching stays in the caching   functions and they fail gracefully.  * Account autocreation happens only within controllers/account.py   Everyone else just indicates they're asking for account information   in order to perform a pending write and the account is autocreated   if configured to so.  I used comments liberally in this patch set to help a reviewer understand what changed and why. A final patch set would be needed to clear out these comments as they're mostly just noise after the fact, though it should probably be a separate review/merge so that the history isn't completely lost.  I was especially careful to alter the existing tests as little as possible and to comment liberally again when I had to change things. If this were to truly be a candidate for merging, new tests for the new functions and functionality would need to be added.  One last note: We need to fix our test paths! Wow, talk about a lot of screwy paths. All over the place we use paths like '/a/c' when we should have used '/v1/a/c'. The tests happened to pass all this time because so much relied on controller.account_name and .container_name and not PATH_INFO. But we really need to fix these paths at some point.  
__label__quality Alternate refactor of info caching  This is just a reimplementation of the work David Hadas is doing at:  https://review.openstack.org/#/c/30481/  This rework was mainly just so I could get my head around what the state of things were, what state we were trying to get them in, and what was required to get it there. I felt some things were not quite right with David's work, but I was at a loss to explain why. Hopefully this will help when I re-review his work.  I'm mainly posting this up so other reviewers of David's work might get a better view into things from a different perspective and consider some of the ideas here as alternatives.  This is an area to tread lightly. The starting state of things is a mess and the ending state should be cleaner, even if not "perfect".  Now, I do like this approach better (of course, I wrote it :P) but let me state why:  * No all-in-one functions. I know this is what David wanted, but I   disagree. I find the all-in-ones harder to read and easier to make   mistakes with when in use elsewhere. Having them separate doesn't   prevent making an all-in-one that calls the separate functions for   convenience, but honestly, is a quick "if container:   container_func() else: account_func()" that much harder to type or   read?  * No "magic" HEADs that happen to set the cache values and, if they   don't, blow things up. If I implement a stand-in proxy app, I   wouldn't expect to have to feed a cache when implementing my HEAD   functionality. With this approach, the caching stays in the caching   functions and they fail gracefully.  * Account autocreation happens only within controllers/account.py   Everyone else just indicates they're asking for account information   in order to perform a pending write and the account is autocreated   if configured to so.  I used comments liberally in this patch set to help a reviewer understand what changed and why. A final patch set would be needed to clear out these comments as they're mostly just noise after the fact, though it should probably be a separate review/merge so that the history isn't completely lost.  I was especially careful to alter the existing tests as little as possible and to comment liberally again when I had to change things. If this were to truly be a candidate for merging, new tests for the new functions and functionality would need to be added.  One last note: We need to fix our test paths! Wow, talk about a lot of screwy paths. All over the place we use paths like '/a/c' when we should have used '/v1/a/c'. The tests happened to pass all this time because so much relied on controller.account_name and .container_name and not PATH_INFO. But we really need to fix these paths at some point.  
__label__testing Refactoring the quantum basic test case by using python "with" statement.  The implementation creates the basic network scenario, so the following test cases can execute relative testing against it.  There are more quantum test cases will be pushed to community based on the same solution.  
__label__objective Refactoring the quantum basic test case by using python "with" statement.  The implementation creates the basic network scenario, so the following test cases can execute relative testing against it.  There are more quantum test cases will be pushed to community based on the same solution.  
__label__testing Refactoring of base test case classes  * Splits out the "manager" class into its own file (at least   for now to keep the code change size down initially) * Adds base manager classes for Fuzz and Default clients * Adds base test case class and a derived base SmokeTest class * Adds smoke test for basic server operations in compute * Adds non-smoke test for advanced server operations in compute  
__label__objective Refactoring of base test case classes  * Splits out the "manager" class into its own file (at least   for now to keep the code change size down initially) * Adds base manager classes for Fuzz and Default clients * Adds base test case class and a derived base SmokeTest class * Adds smoke test for basic server operations in compute * Adds non-smoke test for advanced server operations in compute  
__label__testing Started refactor of server actions tests  * Broke down basic smoke action tests into classes * Prepped fixtures drive data for the generic tests * TODO: next patch will break the singe test method   into each test class into distinct test methods  
__label__objective Started refactor of server actions tests  * Broke down basic smoke action tests into classes * Prepped fixtures drive data for the generic tests * TODO: next patch will break the singe test method   into each test class into distinct test methods  
__label__testing Refactor list servers negative test and fix remaining gate bugs  test_list_servers_negative had so many issues with it, it's hard to list them here... but at least the following has been fixed:  * No longer will the test flatly delete all instances the tenant   and alt tenant have during every test method run (!!) * Fixtures -- 2 active and 1 deleted server -- are created in the   class' setUpClass() method instead of having test methods   constantly re-launch instances -- this reduces the test time   down about 3 minutes * Removed all non-negative tests * Removed all tests that were skipped due to bugs that have been   marked Invalid by upstream since they were checking for errors   that should not be errors * Skip the XML create_service() test for Identity Admin tests   because of the upstream Keystone bug 1061738  
__label__objective Refactor list servers negative test and fix remaining gate bugs  test_list_servers_negative had so many issues with it, it's hard to list them here... but at least the following has been fixed:  * No longer will the test flatly delete all instances the tenant   and alt tenant have during every test method run (!!) * Fixtures -- 2 active and 1 deleted server -- are created in the   class' setUpClass() method instead of having test methods   constantly re-launch instances -- this reduces the test time   down about 3 minutes * Removed all non-negative tests * Removed all tests that were skipped due to bugs that have been   marked Invalid by upstream since they were checking for errors   that should not be errors * Skip the XML create_service() test for Identity Admin tests   because of the upstream Keystone bug 1061738  
__label__testing Refactoring of base test case classes  * Splits out the "manager" class into its own file (at least   for now to keep the code change size down initially) * Adds base manager classes for Fuzz and Default clients * Adds base test case class and a derived base SmokeTest class * Adds smoke test for basic server operations in compute * Adds non-smoke test for advanced server operations in compute  
__label__objective Refactoring of base test case classes  * Splits out the "manager" class into its own file (at least   for now to keep the code change size down initially) * Adds base manager classes for Fuzz and Default clients * Adds base test case class and a derived base SmokeTest class * Adds smoke test for basic server operations in compute * Adds non-smoke test for advanced server operations in compute  
__label__testing Refactoring/cleanup of some view builders.  I have re-worked the "addresses", "flavors", "images", and "servers" view builders to share logic which was previously duplicated across many ViewBuilder classes. Also, I have re-worked the ViewBuilder class in general to persist longer (meaning that a new ViewBuilder is not created for every request but rather a single ViewBuilder is created and deals with each request as needed.)  During the re-factor I found an issue with test_servers.py where links were not containing the project_id like they should. This was fixed and tests were updated.  Overall we had good test coverage so not many tests had to be updated during the refactor.  (Patch Set 2) Updated _set_request and _get_request to be a request property               and a set_request method which can be overridden. (Patch Set 3) Fixed tests that I broke with the last update. (Patch Set 4) Changed "id in network.keys()" to "id in network" (Patch Set 5) Feedback changes from bcwaldon: Moved Controller to wsgi.py               instead of common.py. Left ViewBuilder in common.py because               wsgi.py can't import common (circular dep) and ViewBuilder               needs common logic.                Updated _resource_name to _collection_name.                Updated the name of Controller._view_builder to               Controller._view_builder_class and made it default to None.                Removed prepare wrapper: request is passed around a lot more now               which removes the need for the decorator but clutters the code               a bit.                Created test which utilizes 'floating' ips and made sure the               logic which was in the old addresses builder was transfered.  
__label__objective Refactoring/cleanup of some view builders.  I have re-worked the "addresses", "flavors", "images", and "servers" view builders to share logic which was previously duplicated across many ViewBuilder classes. Also, I have re-worked the ViewBuilder class in general to persist longer (meaning that a new ViewBuilder is not created for every request but rather a single ViewBuilder is created and deals with each request as needed.)  During the re-factor I found an issue with test_servers.py where links were not containing the project_id like they should. This was fixed and tests were updated.  Overall we had good test coverage so not many tests had to be updated during the refactor.  (Patch Set 2) Updated _set_request and _get_request to be a request property               and a set_request method which can be overridden. (Patch Set 3) Fixed tests that I broke with the last update. (Patch Set 4) Changed "id in network.keys()" to "id in network" (Patch Set 5) Feedback changes from bcwaldon: Moved Controller to wsgi.py               instead of common.py. Left ViewBuilder in common.py because               wsgi.py can't import common (circular dep) and ViewBuilder               needs common logic.                Updated _resource_name to _collection_name.                Updated the name of Controller._view_builder to               Controller._view_builder_class and made it default to None.                Removed prepare wrapper: request is passed around a lot more now               which removes the need for the decorator but clutters the code               a bit.                Created test which utilizes 'floating' ips and made sure the               logic which was in the old addresses builder was transfered.  
__label__quality Refactoring/cleanup of some view builders.  I have re-worked the "addresses", "flavors", "images", and "servers" view builders to share logic which was previously duplicated across many ViewBuilder classes. Also, I have re-worked the ViewBuilder class in general to persist longer (meaning that a new ViewBuilder is not created for every request but rather a single ViewBuilder is created and deals with each request as needed.)  During the re-factor I found an issue with test_servers.py where links were not containing the project_id like they should. This was fixed and tests were updated.  Overall we had good test coverage so not many tests had to be updated during the refactor.  (Patch Set 2) Updated _set_request and _get_request to be a request property               and a set_request method which can be overridden. (Patch Set 3) Fixed tests that I broke with the last update. (Patch Set 4) Changed "id in network.keys()" to "id in network" (Patch Set 5) Feedback changes from bcwaldon: Moved Controller to wsgi.py               instead of common.py. Left ViewBuilder in common.py because               wsgi.py can't import common (circular dep) and ViewBuilder               needs common logic.                Updated _resource_name to _collection_name.                Updated the name of Controller._view_builder to               Controller._view_builder_class and made it default to None.                Removed prepare wrapper: request is passed around a lot more now               which removes the need for the decorator but clutters the code               a bit.                Created test which utilizes 'floating' ips and made sure the               logic which was in the old addresses builder was transfered.  
__label__testing [WIP] Refactor API unit tests to be more extensible  The pv and partition unit tests have been refactored to have a common base.  Mixins have been added to allow more test permutations.  New unit tests based on the common base class and mixins have been added to provide testing of:  - ntp  
__label__objective [WIP] Refactor API unit tests to be more extensible  The pv and partition unit tests have been refactored to have a common base.  Mixins have been added to allow more test permutations.  New unit tests based on the common base class and mixins have been added to provide testing of:  - ntp  
__label__testing [WIP] Remove code from Selenium Test Refactor  This change would further refactor the Selenium Tests in order to move boilerplate code to separate file.  
__label__objective [WIP] Remove code from Selenium Test Refactor  This change would further refactor the Selenium Tests in order to move boilerplate code to separate file.  
__label__testing Refactor Shipyard to use new Action class  This patch set implements the new action class for Shipyard, to improve how Shipyard handles actions internally. This is a refactor, and surface level Shipyard functionality should remain unchanged. The goal of this refactor is to eliminate repeated code, increase testing code coverage, and help simplify future Shipyard features.  "action" code should now have 100% unit test code coverage shipyard_airflow unit test coverage pre-refactor: 74% (1263 missing statements) post-refactor: 76% (1207 missing statements)  
__label__quality Refactor Shipyard to use new Action class  This patch set implements the new action class for Shipyard, to improve how Shipyard handles actions internally. This is a refactor, and surface level Shipyard functionality should remain unchanged. The goal of this refactor is to eliminate repeated code, increase testing code coverage, and help simplify future Shipyard features.  "action" code should now have 100% unit test code coverage shipyard_airflow unit test coverage pre-refactor: 74% (1263 missing statements) post-refactor: 76% (1207 missing statements)  
__label__objective Refactor Shipyard to use new Action class  This patch set implements the new action class for Shipyard, to improve how Shipyard handles actions internally. This is a refactor, and surface level Shipyard functionality should remain unchanged. The goal of this refactor is to eliminate repeated code, increase testing code coverage, and help simplify future Shipyard features.  "action" code should now have 100% unit test code coverage shipyard_airflow unit test coverage pre-refactor: 74% (1263 missing statements) post-refactor: 76% (1207 missing statements)  
__label__testing Refactor test_snapshot.py and test_transfer_request.py  This is a work-in-progress commit  This change aims to remove the blanket skip test on all volume v1 tests. First, I test changes to the problem classes behind this skip. After these succeed, I will then implement code necessary to determine volume endpoint version and ensure that if volume v1 is not present, only then skip the v1 tests, rather than always skipping as with current practice.  
__label__objective Refactor test_snapshot.py and test_transfer_request.py  This is a work-in-progress commit  This change aims to remove the blanket skip test on all volume v1 tests. First, I test changes to the problem classes behind this skip. After these succeed, I will then implement code necessary to determine volume endpoint version and ensure that if volume v1 is not present, only then skip the v1 tests, rather than always skipping as with current practice.  
__label__testing Refactor Shipyard's internal action functionality  This patchset refactors how "actions" are handled internally to Shipyard by creating an Action class, and refactoring the action_helper module. This accomplishes many things: - Increase testability and unit test code coverage - Eliminate repeated code across different action APIs - Better encapsulate actions (were dicts before) - Make future updates to action logic and functionality easier (main motivation for this work)  Actual Shipyard functionality should not be affected with this PS.  
__label__quality Refactor Shipyard's internal action functionality  This patchset refactors how "actions" are handled internally to Shipyard by creating an Action class, and refactoring the action_helper module. This accomplishes many things: - Increase testability and unit test code coverage - Eliminate repeated code across different action APIs - Better encapsulate actions (were dicts before) - Make future updates to action logic and functionality easier (main motivation for this work)  Actual Shipyard functionality should not be affected with this PS.  
__label__objective Refactor Shipyard's internal action functionality  This patchset refactors how "actions" are handled internally to Shipyard by creating an Action class, and refactoring the action_helper module. This accomplishes many things: - Increase testability and unit test code coverage - Eliminate repeated code across different action APIs - Better encapsulate actions (were dicts before) - Make future updates to action logic and functionality easier (main motivation for this work)  Actual Shipyard functionality should not be affected with this PS.  
__label__testing [WIP] Refactor security groups scenario test  TODO: describe it  
__label__testing [DNM] Test tq refactorings  Tests two set of release config removals inside tripleo-quickstart.  Depends-On: https://review.openstack.org/#/c/650921/ 
__label__objective [DNM] Test tq refactorings  Tests two set of release config removals inside tripleo-quickstart.  Depends-On: https://review.openstack.org/#/c/650921/ 
__label__testing [DNM] Test tq refactorings  Tests two set of release config removals inside tripleo-quickstart.  Depends-On: https://review.openstack.org/#/c/650921/ 
__label__objective [DNM] Test tq refactorings  Tests two set of release config removals inside tripleo-quickstart.  Depends-On: https://review.openstack.org/#/c/650921/ 
__label__testing [DNM] Test tq refactorings  Tests two set of release config removals inside tripleo-quickstart.  Depends-On: https://review.openstack.org/#/c/650921/ 
__label__objective [DNM] Test tq refactorings  Tests two set of release config removals inside tripleo-quickstart.  Depends-On: https://review.openstack.org/#/c/650921/ 
__label__testing WIP - LDAP test refactor  
__label__objective WIP - LDAP test refactor  
__label__testing Refactor test_namespace  This commit refactors and fixes some issues with test_namespace. In particular:  * Take care of namespace deletions after test is done. * Rewrite waiting code to use test_utils.call_until_true().  
__label__objective Refactor test_namespace  This commit refactors and fixes some issues with test_namespace. In particular:  * Take care of namespace deletions after test is done. * Rewrite waiting code to use test_utils.call_until_true().  
__label__testing Refactor tobiko package  - Remove dependencies:   - testscenarios   - testtools   - tempest  - Move pythonclient code to tobiko.openstack module - Parse tobiko.conf file instead of tempest.conf - Rename pre_ test method to create_ and add delete_ method   to test_floating_ip test case. - Move networking case to tobiko.tests.neutron package. - Wraps ping command - Refactor StackManager and separate user frontend to pythonclient backend. - Allow to add other backends (ansible, etc) for populating resources. - Prefix stack names after the python package of the test case.  
__label__quality Refactor tobiko package  - Remove dependencies:   - testscenarios   - testtools   - tempest  - Move pythonclient code to tobiko.openstack module - Parse tobiko.conf file instead of tempest.conf - Rename pre_ test method to create_ and add delete_ method   to test_floating_ip test case. - Move networking case to tobiko.tests.neutron package. - Wraps ping command - Refactor StackManager and separate user frontend to pythonclient backend. - Allow to add other backends (ansible, etc) for populating resources. - Prefix stack names after the python package of the test case.  
__label__objective Refactor tobiko package  - Remove dependencies:   - testscenarios   - testtools   - tempest  - Move pythonclient code to tobiko.openstack module - Parse tobiko.conf file instead of tempest.conf - Rename pre_ test method to create_ and add delete_ method   to test_floating_ip test case. - Move networking case to tobiko.tests.neutron package. - Wraps ping command - Refactor StackManager and separate user frontend to pythonclient backend. - Allow to add other backends (ansible, etc) for populating resources. - Prefix stack names after the python package of the test case.  
__label__testing Refactor create_server to smartly handle advanced images  Create new base class called BaseScenarioTest for provisioning resources in a way more similar to API base classs and allowing to allocate server at class scope (IE inside resource_setup method).  This new class could be the barebone for new methods rewritten from scrach without keeping backward compatibility with the old BaseTempestTestCase test case (for example for helping creating resources to login to created server).  Now create_server method returns only server details instead of Nova API client answer body.  Add create_ssh_client method to handle SSH connection distruction at the end of the test.  Make sure either server and SSH connection are created using advance image settings if required by just passing a simple method parameter (advanced_image=True) or setting the at test class level.  
__label__objective Refactor create_server to smartly handle advanced images  Create new base class called BaseScenarioTest for provisioning resources in a way more similar to API base classs and allowing to allocate server at class scope (IE inside resource_setup method).  This new class could be the barebone for new methods rewritten from scrach without keeping backward compatibility with the old BaseTempestTestCase test case (for example for helping creating resources to login to created server).  Now create_server method returns only server details instead of Nova API client answer body.  Add create_ssh_client method to handle SSH connection distruction at the end of the test.  Make sure either server and SSH connection are created using advance image settings if required by just passing a simple method parameter (advanced_image=True) or setting the at test class level.  
__label__testing DNM: test buildimage job refactor  Depends-On: https://review.openstack.org/571951 
__label__testing refactor: prepare test_list_users for pre-prov  This is part 1 of 2 commits that aim to move tests from only being executed with the dynamic creds credential provider.  Part 1 does some initial refactoring and Part 2 will move the tests and finish any other refactoring that's needed.  Notes on refactor:   * removing usage of non_domain_enabled_user so that I can run the     tests with os_primary's user except for tests that are not targeted     for pre-prov.   * removing alt_email as os_primary's user does not have the email     attribute.  Warning on test completeness:   * I realize some of these tests are intended to check for exclusion of     certain users in the user list which is now lost due to the removal     of the non_domain_enabled_user.  
__label__objective refactor: prepare test_list_users for pre-prov  This is part 1 of 2 commits that aim to move tests from only being executed with the dynamic creds credential provider.  Part 1 does some initial refactoring and Part 2 will move the tests and finish any other refactoring that's needed.  Notes on refactor:   * removing usage of non_domain_enabled_user so that I can run the     tests with os_primary's user except for tests that are not targeted     for pre-prov.   * removing alt_email as os_primary's user does not have the email     attribute.  Warning on test completeness:   * I realize some of these tests are intended to check for exclusion of     certain users in the user list which is now lost due to the removal     of the non_domain_enabled_user.  
__label__testing [DNM] To test sprint16 toci refactoring  Depends-On: I79d2b8b3a4bd1fbb46d80d82b9a946974c1cde8f 
__label__testing [DNM] To test various toci refactor  Depends-On: Iaf0ba7e06c809859f8ad60070285941ec436b5e9 
__label__testing [DNM] To test env_vars refactor  Depends-On: I96f0925a39ad37e0eb51de6900cf78dae2b5505b 
__label__testing [DNM] To test featurset_conf refactor  Depends-On: Ib1caf1261c6fd423a0bb4aa2be0f525bffd471bc 
__label__testing Refactor usage tests to properly test project personas  
__label__testing Refactor test 'test_boot_server_from_encrypted_volume_luks' to use cirros image  This test is uploaded, since there was a bug [1] while booting an instance from an encrypted volume created from a whole image.  [1] https://bugs.launchpad.net/nova/+bug/1465656  
__label__objective Refactor test 'test_boot_server_from_encrypted_volume_luks' to use cirros image  This test is uploaded, since there was a bug [1] while booting an instance from an encrypted volume created from a whole image.  [1] https://bugs.launchpad.net/nova/+bug/1465656  
__label__objective Refactor test 'test_boot_server_from_encrypted_volume_luks' to use cirros image  This test is uploaded, since there was a bug [1] while booting an instance from an encrypted volume created from a whole image.  [1] https://bugs.launchpad.net/nova/+bug/1465656  
__label__testing WIP: test seret refactor  
__label__integration Update UPPER_CONSTRAINTS_FILE for feature/policy-refactor  The new stable upper-constraints file is only available after the openstack/requirements repository is branched. This will happen around the RC1 timeframe.  Recheck and merge this change once the requirements repository has been branched.  The CI system will work with this patch before the requirements repository is branched because zuul configues the job to run with a local copy of the file and defaults to the master branch. However, accepting the patch will break the test configuration on developers' local systems, so please wait until after the requirements repository is branched to merge the patch.  
__label__objective Update UPPER_CONSTRAINTS_FILE for feature/policy-refactor  The new stable upper-constraints file is only available after the openstack/requirements repository is branched. This will happen around the RC1 timeframe.  Recheck and merge this change once the requirements repository has been branched.  The CI system will work with this patch before the requirements repository is branched because zuul configues the job to run with a local copy of the file and defaults to the master branch. However, accepting the patch will break the test configuration on developers' local systems, so please wait until after the requirements repository is branched to merge the patch.  
__label__quality [WIP] Refactor docs  Split docs into following parts: 1. Supported features 2. Installation(TODO) 3. Run as service container(TODO) 4. Run Fullstack test 5. Release Notes 6. Run nested-container(TODO) 7. Configuration(TODO) 8. Generating Documentation(TODO) 9. Others  
__label__objective [WIP] Refactor docs  Split docs into following parts: 1. Supported features 2. Installation(TODO) 3. Run as service container(TODO) 4. Run Fullstack test 5. Release Notes 6. Run nested-container(TODO) 7. Configuration(TODO) 8. Generating Documentation(TODO) 9. Others  
__label__objective Refactor check for 'latest' version  Refactor checking for the 'latest' version to remove code duplication.  Add a unit test which proves comments that if the "--os-baremetal-api-version" command line argument is not given then ReplaceLatestVersion is not called.  
__label__quality Refactor check for 'latest' version  Refactor checking for the 'latest' version to remove code duplication.  Add a unit test which proves comments that if the "--os-baremetal-api-version" command line argument is not given then ReplaceLatestVersion is not called.  
__label__testing sharding: Test and refactor for _misplaced_objects  
__label__testing Refactor IP configuration loading  Previously the set_used_ips function did all of the work to read the configuration and inventory data to determine how to mark IPs as used.  This changeset splits that work into separate functions, one for configuration and inventory, and uses their output to the set the used IPs.  The information was separated this way in preparation for using with an IPManager instance instead of the Queue.Queue and set objects in the future.  Also added were tests for the configuration and inventory parsing. The TestSetUsedIPS test was moved into the test_ips module for consistency.  
__label__quality Refactor IP configuration loading  Previously the set_used_ips function did all of the work to read the configuration and inventory data to determine how to mark IPs as used.  This changeset splits that work into separate functions, one for configuration and inventory, and uses their output to the set the used IPs.  The information was separated this way in preparation for using with an IPManager instance instead of the Queue.Queue and set objects in the future.  Also added were tests for the configuration and inventory parsing. The TestSetUsedIPS test was moved into the test_ips module for consistency.  
__label__objective Refactor IP configuration loading  Previously the set_used_ips function did all of the work to read the configuration and inventory data to determine how to mark IPs as used.  This changeset splits that work into separate functions, one for configuration and inventory, and uses their output to the set the used IPs.  The information was separated this way in preparation for using with an IPManager instance instead of the Queue.Queue and set objects in the future.  Also added were tests for the configuration and inventory parsing. The TestSetUsedIPS test was moved into the test_ips module for consistency.  
__label__testing Refactor bulk of data checking into mixin class  We have a set of testscenarios that match with test methods that validate input and output data. We also have a test class which describes each type of setup. Copy the scenarios and methods into a mixin class so that we can have one rather than two sets of those.  
__label__quality Refactor bulk of data checking into mixin class  We have a set of testscenarios that match with test methods that validate input and output data. We also have a test class which describes each type of setup. Copy the scenarios and methods into a mixin class so that we can have one rather than two sets of those.  
__label__objective Refactor bulk of data checking into mixin class  We have a set of testscenarios that match with test methods that validate input and output data. We also have a test class which describes each type of setup. Copy the scenarios and methods into a mixin class so that we can have one rather than two sets of those.  
__label__testing Refactor shutdown_ceph_for_all test. Add new power_outage_ceph_for_all test  + refactor existing shutdown_ceph_for_all test + add new power_outage_ceph_for_all test  Related blueprint run-fuel-qa-on-baremetal  
__label__objective Refactor shutdown_ceph_for_all test. Add new power_outage_ceph_for_all test  + refactor existing shutdown_ceph_for_all test + add new power_outage_ceph_for_all test  Related blueprint run-fuel-qa-on-baremetal  
__label__testing refactor tempest test code  1. extract base class from api to a higher directory, and move    most code to scenario directory because they indeed are scenario    based, see [1] 2. we have event RBAC now, so normal test should have await_event    as well, then admin test just need to promote credential and    connect to admin client 3. split nova and glance test code to individual file, so in future    we can add new code separately 4. object storage middleware should use base class as well  [1]: http://docs.openstack.org/developer/tempest/field_guide/index.html#scenario-field-guide  
__label__objective refactor tempest test code  1. extract base class from api to a higher directory, and move    most code to scenario directory because they indeed are scenario    based, see [1] 2. we have event RBAC now, so normal test should have await_event    as well, then admin test just need to promote credential and    connect to admin client 3. split nova and glance test code to individual file, so in future    we can add new code separately 4. object storage middleware should use base class as well  [1]: http://docs.openstack.org/developer/tempest/field_guide/index.html#scenario-field-guide  
__label__testing Refactor instance-exists comment and test  Refactored the instance-exists related notify_usage_exists method documentation, and the test_instance_usage_audit unit test in unit/compute/test_compute_mgr.py  
__label__quality Refactor instance-exists comment and test  Refactored the instance-exists related notify_usage_exists method documentation, and the test_instance_usage_audit unit test in unit/compute/test_compute_mgr.py  
__label__objective Refactor instance-exists comment and test  Refactored the instance-exists related notify_usage_exists method documentation, and the test_instance_usage_audit unit test in unit/compute/test_compute_mgr.py  
__label__testing libvirt: Refactor _create_image into storagepolicy  _create_image contains logic to:  * Iterate over all of an instance's disks * Create those disks  This is problematic for a few reasons. Firstly, finish_migration wants to iterate over all of an instance's disks but *not* create them, only check and resize them. It currently re-uses _create_image in a manner which relies on the 'all the things' behaviour of cache(), which is confusing and error-prone.  Secondly, rescue doesn't need to iterate over all disks. It gets round this by not passing in block_device_info, but this is confusing.  Lastly, there is a parallel implementation of this functionality in _create_images_and_backing using different data, which creates disks differently. We would like the functionality of _create_image to be re-usable in that context to avoid edge cases where the behaviours are different.  This change introduces the StoragePolicy object, which is a new canonical source for an instance's disks. It exposes the disk iteration of _create_iteration in its methods. Additionally, instead of returning an Image object it returns a DiskCreationProxy object. This object wraps the Image and adds an addition method, create(), taking no arguments. This means that the caller can iterate over disks in a manner consistent with _create_image without creating them if that isn't required. This change is required for finish_migration().  Note that the changes in test_driver are intentionally minimal. In fact, they are almost entirely mechanical due to the changed interface of _create_image() requiring a StoragePolicy object. The substantive changes are:  * tests which only tested _create_ephemeral, _create_swap, and   _is_supported_fs move to test_storagepolicy, which is where the   functions under test have moved. The tests are updated to use mock   in place of mox, but are otherwise identical.  * We now create config disk, kernel, and ramdisk as 'flat' instead of   'raw'. These are completely equivalent.  The lack of changes in test_driver means that we are continuing to test calls all the way down to imagebackend.Image.cache, which give us a degree of confidence that we haven't introduced regressions. With this more practical separation of logic, we can now incrementally make tests in test_driver more 'unity' by stopping at the storagepolicy boundary. Over time this should eliminate a significant number of tests in test_driver.  TODO: Add comprehensive tests for storagepolicy.  
__label__quality libvirt: Refactor _create_image into storagepolicy  _create_image contains logic to:  * Iterate over all of an instance's disks * Create those disks  This is problematic for a few reasons. Firstly, finish_migration wants to iterate over all of an instance's disks but *not* create them, only check and resize them. It currently re-uses _create_image in a manner which relies on the 'all the things' behaviour of cache(), which is confusing and error-prone.  Secondly, rescue doesn't need to iterate over all disks. It gets round this by not passing in block_device_info, but this is confusing.  Lastly, there is a parallel implementation of this functionality in _create_images_and_backing using different data, which creates disks differently. We would like the functionality of _create_image to be re-usable in that context to avoid edge cases where the behaviours are different.  This change introduces the StoragePolicy object, which is a new canonical source for an instance's disks. It exposes the disk iteration of _create_iteration in its methods. Additionally, instead of returning an Image object it returns a DiskCreationProxy object. This object wraps the Image and adds an addition method, create(), taking no arguments. This means that the caller can iterate over disks in a manner consistent with _create_image without creating them if that isn't required. This change is required for finish_migration().  Note that the changes in test_driver are intentionally minimal. In fact, they are almost entirely mechanical due to the changed interface of _create_image() requiring a StoragePolicy object. The substantive changes are:  * tests which only tested _create_ephemeral, _create_swap, and   _is_supported_fs move to test_storagepolicy, which is where the   functions under test have moved. The tests are updated to use mock   in place of mox, but are otherwise identical.  * We now create config disk, kernel, and ramdisk as 'flat' instead of   'raw'. These are completely equivalent.  The lack of changes in test_driver means that we are continuing to test calls all the way down to imagebackend.Image.cache, which give us a degree of confidence that we haven't introduced regressions. With this more practical separation of logic, we can now incrementally make tests in test_driver more 'unity' by stopping at the storagepolicy boundary. Over time this should eliminate a significant number of tests in test_driver.  TODO: Add comprehensive tests for storagepolicy.  
__label__objective libvirt: Refactor _create_image into storagepolicy  _create_image contains logic to:  * Iterate over all of an instance's disks * Create those disks  This is problematic for a few reasons. Firstly, finish_migration wants to iterate over all of an instance's disks but *not* create them, only check and resize them. It currently re-uses _create_image in a manner which relies on the 'all the things' behaviour of cache(), which is confusing and error-prone.  Secondly, rescue doesn't need to iterate over all disks. It gets round this by not passing in block_device_info, but this is confusing.  Lastly, there is a parallel implementation of this functionality in _create_images_and_backing using different data, which creates disks differently. We would like the functionality of _create_image to be re-usable in that context to avoid edge cases where the behaviours are different.  This change introduces the StoragePolicy object, which is a new canonical source for an instance's disks. It exposes the disk iteration of _create_iteration in its methods. Additionally, instead of returning an Image object it returns a DiskCreationProxy object. This object wraps the Image and adds an addition method, create(), taking no arguments. This means that the caller can iterate over disks in a manner consistent with _create_image without creating them if that isn't required. This change is required for finish_migration().  Note that the changes in test_driver are intentionally minimal. In fact, they are almost entirely mechanical due to the changed interface of _create_image() requiring a StoragePolicy object. The substantive changes are:  * tests which only tested _create_ephemeral, _create_swap, and   _is_supported_fs move to test_storagepolicy, which is where the   functions under test have moved. The tests are updated to use mock   in place of mox, but are otherwise identical.  * We now create config disk, kernel, and ramdisk as 'flat' instead of   'raw'. These are completely equivalent.  The lack of changes in test_driver means that we are continuing to test calls all the way down to imagebackend.Image.cache, which give us a degree of confidence that we haven't introduced regressions. With this more practical separation of logic, we can now incrementally make tests in test_driver more 'unity' by stopping at the storagepolicy boundary. Over time this should eliminate a significant number of tests in test_driver.  TODO: Add comprehensive tests for storagepolicy.  
__label__testing Roles RBAC test Refactor Keystone API v2 roles  - refactor the changes to rbac_utils so that the tests pass  Partially-Implements bp: initial-tests-identity  
__label__integration Roles RBAC test Refactor Keystone API v2 roles  - refactor the changes to rbac_utils so that the tests pass  Partially-Implements bp: initial-tests-identity  
__label__objective Roles RBAC test Refactor Keystone API v2 roles  - refactor the changes to rbac_utils so that the tests pass  Partially-Implements bp: initial-tests-identity  
__label__testing Refactor the case test_storwize_vdisk_copy_ops  Let the assertion explicitly test the 'vdiskcopyops' is not in the admin_metadata dictionary.  
__label__objective Refactor the case test_storwize_vdisk_copy_ops  Let the assertion explicitly test the 'vdiskcopyops' is not in the admin_metadata dictionary.  
__label__testing WIP: Initial unit test API refactor  The amount of lines changed made me want to commit this. Feedback is appreciated.  
__label__integration WIP: Initial unit test API refactor  The amount of lines changed made me want to commit this. Feedback is appreciated.  
__label__integration Refactor Base64 use and other changes for Python3  This is WIP until Oslo.Serialization 1.10 is added to global requirements.  It is an OpenStack goal to make the code base Python 2 and 3 compatible. This commit makes several changes to enable that and extends the py34 unit test environment to enforce it.  The following conventions were used: 1) oslo.serialization.base64 has base64 encode and decode routines that accept both bytes and strings as input, and can return bytes or strings as output.  They are very Python 2/3 friendly. 2) b'foo'.  The b'' string prefix has no affect in Python 2.  It is a signal to Python 3 that a string literal is a bytestring. b'' is the right choice for much of Barbican, since that the type expected and returned by many of our dependent libraries. 3) e.message for exceptions has been removed.  It is deprecated in py27 and removed from py3. 4) ''.encode('utf-8') generates bytes from a string for py3.  It returns the string for py2. 5) b''.decode('utf-8') generates a string from from bytes for py3.  It generates u'' for py2, which is not typically used in Barbican. 6) isinstance(obj, type) can be used to check for necessary conversions if needed. 7) // does integer division  
__label__objective Refactor Base64 use and other changes for Python3  This is WIP until Oslo.Serialization 1.10 is added to global requirements.  It is an OpenStack goal to make the code base Python 2 and 3 compatible. This commit makes several changes to enable that and extends the py34 unit test environment to enforce it.  The following conventions were used: 1) oslo.serialization.base64 has base64 encode and decode routines that accept both bytes and strings as input, and can return bytes or strings as output.  They are very Python 2/3 friendly. 2) b'foo'.  The b'' string prefix has no affect in Python 2.  It is a signal to Python 3 that a string literal is a bytestring. b'' is the right choice for much of Barbican, since that the type expected and returned by many of our dependent libraries. 3) e.message for exceptions has been removed.  It is deprecated in py27 and removed from py3. 4) ''.encode('utf-8') generates bytes from a string for py3.  It returns the string for py2. 5) b''.decode('utf-8') generates a string from from bytes for py3.  It generates u'' for py2, which is not typically used in Barbican. 6) isinstance(obj, type) can be used to check for necessary conversions if needed. 7) // does integer division  
__label__objective Refactor Base64 use and other changes for Python3  This is WIP until Oslo.Serialization 1.10 is added to global requirements.  It is an OpenStack goal to make the code base Python 2 and 3 compatible. This commit makes several changes to enable that and extends the py34 unit test environment to enforce it.  The following conventions were used: 1) oslo.serialization.base64 has base64 encode and decode routines that accept both bytes and strings as input, and can return bytes or strings as output.  They are very Python 2/3 friendly. 2) b'foo'.  The b'' string prefix has no affect in Python 2.  It is a signal to Python 3 that a string literal is a bytestring. b'' is the right choice for much of Barbican, since that the type expected and returned by many of our dependent libraries. 3) e.message for exceptions has been removed.  It is deprecated in py27 and removed from py3. 4) ''.encode('utf-8') generates bytes from a string for py3.  It returns the string for py2. 5) b''.decode('utf-8') generates a string from from bytes for py3.  It generates u'' for py2, which is not typically used in Barbican. 6) isinstance(obj, type) can be used to check for necessary conversions if needed. 7) // does integer division  
__label__testing Refactor test case for ml2 mech driver(network)  This patch makes the test case atomic and introduces ml2 test cases.  
__label__objective Refactor test case for ml2 mech driver(network)  This patch makes the test case atomic and introduces ml2 test cases.  
__label__testing [WIP] Refactor daemonset upgrade/rollout test according to last changes  
__label__testing Refactor test_dbaas.py  user is now a TestCase member. Refactored test_dbaas.py as per this change. Instead of using variables per the test functions, the TestCase class  is inherited and the user member is then usable in the tests.  Closes Bug:#1474100 
__label__objective Refactor test_dbaas.py  user is now a TestCase member. Refactored test_dbaas.py as per this change. Instead of using variables per the test functions, the TestCase class  is inherited and the user member is then usable in the tests.  Closes Bug:#1474100 
__label__quality Refactor test_dbaas.py  user is now a TestCase member. Refactored test_dbaas.py as per this change. Instead of using variables per the test functions, the TestCase class  is inherited and the user member is then usable in the tests.  Closes Bug:#1474100 
__label__testing Refactor test samples  Change organization of samples for tests so that it is more scalable and organized. Unfinished.  
__label__quality Refactor test samples  Change organization of samples for tests so that it is more scalable and organized. Unfinished.  
__label__objective Refactor test samples  Change organization of samples for tests so that it is more scalable and organized. Unfinished.  
__label__testing [Fullstack] Refactor SG tests  As firewall driver in fullstack tests can interfere between various tests, all tests were so far added to single test in the class.  It was hard e.g. to debug when exaclty specific issue happend. So now, as those tests are always run serially (at least in the gate) lets refactor it and make separate test cases for various scenarios.  
__label__quality [Fullstack] Refactor SG tests  As firewall driver in fullstack tests can interfere between various tests, all tests were so far added to single test in the class.  It was hard e.g. to debug when exaclty specific issue happend. So now, as those tests are always run serially (at least in the gate) lets refactor it and make separate test cases for various scenarios.  
__label__objective [Fullstack] Refactor SG tests  As firewall driver in fullstack tests can interfere between various tests, all tests were so far added to single test in the class.  It was hard e.g. to debug when exaclty specific issue happend. So now, as those tests are always run serially (at least in the gate) lets refactor it and make separate test cases for various scenarios.  
__label__testing xenapi: refactor check_can_live_migrate_destination  Refactoring check_can_live_migrate_destination so its very clear how the block_migrate parameter is used within the method. It turns out this is correct, but it this should make it easier to understand. The changes shouldn't affect the test coverage of this code.  
__label__integration xenapi: refactor check_can_live_migrate_destination  Refactoring check_can_live_migrate_destination so its very clear how the block_migrate parameter is used within the method. It turns out this is correct, but it this should make it easier to understand. The changes shouldn't affect the test coverage of this code.  
__label__objective xenapi: refactor check_can_live_migrate_destination  Refactoring check_can_live_migrate_destination so its very clear how the block_migrate parameter is used within the method. It turns out this is correct, but it this should make it easier to understand. The changes shouldn't affect the test coverage of this code.  
__label__quality xenapi: refactor check_can_live_migrate_destination  Refactoring check_can_live_migrate_destination so its very clear how the block_migrate parameter is used within the method. It turns out this is correct, but it this should make it easier to understand. The changes shouldn't affect the test coverage of this code.  
__label__testing unit test refactoring trivial changes  
__label__objective unit test refactoring trivial changes  
__label__testing Refactoring tempest test config options  Refactoring Neutron configuration options for tempest test config to be in neutron/conf/tests/tempest. This will allow centralization of all config options and provide an easy way to import.  
__label__quality Refactoring tempest test config options  Refactoring Neutron configuration options for tempest test config to be in neutron/conf/tests/tempest. This will allow centralization of all config options and provide an easy way to import.  
__label__objective Refactoring tempest test config options  Refactoring Neutron configuration options for tempest test config to be in neutron/conf/tests/tempest. This will allow centralization of all config options and provide an easy way to import.  
__label__testing Refactoring common test config opts  Refactoring Neutron configuration options for common test config to be in neutron/conf/tests/common. This will allow centralization of all config options and provide an easy way to import.  
__label__quality Refactoring common test config opts  Refactoring Neutron configuration options for common test config to be in neutron/conf/tests/common. This will allow centralization of all config options and provide an easy way to import.  
__label__objective Refactoring common test config opts  Refactoring Neutron configuration options for common test config to be in neutron/conf/tests/common. This will allow centralization of all config options and provide an easy way to import.  
__label__testing Refactoring functional test config opts  Refactoring Neutron configuration options for functional test config to be in neutron/conf/tests/functional/agent. This will allow centralization of all config options and provide an easy way to import.  
__label__quality Refactoring functional test config opts  Refactoring Neutron configuration options for functional test config to be in neutron/conf/tests/functional/agent. This will allow centralization of all config options and provide an easy way to import.  
__label__objective Refactoring functional test config opts  Refactoring Neutron configuration options for functional test config to be in neutron/conf/tests/functional/agent. This will allow centralization of all config options and provide an easy way to import.  
__label__testing [DO NOT MERGE] Refactoring unit test  Removing the core_plugin logic to test the dsvm gate failed on commit: 25e47504f4066bb3270483736bbf5774730073b9.  
__label__objective [DO NOT MERGE] Refactoring unit test  Removing the core_plugin logic to test the dsvm gate failed on commit: 25e47504f4066bb3270483736bbf5774730073b9.  
__label__testing Refactor locale tests and unicode issue  There is an issue if someone uses a non-english locale, that includes non US-ASCII chars. In that case appending a unicode argument to a string fails with an error.  This patch refactors the existing test, covering a few more different cases with english and non-english locales. The last test currently fails on master with an UnicodeDecodeError; this is fixed by the gettext decoding.  Closes-Bug: 1580678 
__label__objective Refactor locale tests and unicode issue  There is an issue if someone uses a non-english locale, that includes non US-ASCII chars. In that case appending a unicode argument to a string fails with an error.  This patch refactors the existing test, covering a few more different cases with english and non-english locales. The last test currently fails on master with an UnicodeDecodeError; this is fixed by the gettext decoding.  Closes-Bug: 1580678 
__label__objective Refactor locale tests and unicode issue  There is an issue if someone uses a non-english locale, that includes non US-ASCII chars. In that case appending a unicode argument to a string fails with an error.  This patch refactors the existing test, covering a few more different cases with english and non-english locales. The last test currently fails on master with an UnicodeDecodeError; this is fixed by the gettext decoding.  Closes-Bug: 1580678 
__label__testing VMware: Unit test refactoring  There are unit tests which test multiple cases and methods. This patch refactors the unit tests for the following methods in the vmdk module to fix this: * backup_volume * restore_backup * _restore_backing * _create_backing_from_stream_optimized_file  
__label__objective VMware: Unit test refactoring  There are unit tests which test multiple cases and methods. This patch refactors the unit tests for the following methods in the vmdk module to fix this: * backup_volume * restore_backup * _restore_backing * _create_backing_from_stream_optimized_file  
__label__testing Refactor test_cluster_deployment.js nightly test  * added common timeout 90sec for each test in the test suite   because each test performs long runnning cluster actions * added proper clean-up after each test to make tests independent * optimized test suit setup: all needed variables are populated here  
__label__objective Refactor test_cluster_deployment.js nightly test  * added common timeout 90sec for each test in the test suite   because each test performs long runnning cluster actions * added proper clean-up after each test to make tests independent * optimized test suit setup: all needed variables are populated here  
__label__integration Refactor forking in container sync run_forever  By refactoring the creation of pipes and forking of child processes into a helper method the test for run_forever can be greatly simplified.  Also relocate when self.report() is called to get uniform log events when one or more processes are used.  This patch also cleans up test_run_forever.  
__label__testing Refactor forking in container sync run_forever  By refactoring the creation of pipes and forking of child processes into a helper method the test for run_forever can be greatly simplified.  Also relocate when self.report() is called to get uniform log events when one or more processes are used.  This patch also cleans up test_run_forever.  
__label__objective Refactor forking in container sync run_forever  By refactoring the creation of pipes and forking of child processes into a helper method the test for run_forever can be greatly simplified.  Also relocate when self.report() is called to get uniform log events when one or more processes are used.  This patch also cleans up test_run_forever.  
__label__quality Refactor forking in container sync run_forever  By refactoring the creation of pipes and forking of child processes into a helper method the test for run_forever can be greatly simplified.  Also relocate when self.report() is called to get uniform log events when one or more processes are used.  This patch also cleans up test_run_forever.  
__label__integration Refactor Ironic job macro  Ironic is getting more and more jobs to test the different deployment scenarios we support, every time we add a new optional feature we add a new conditional to the existing macro to enable it for one job, and then we have to add a new variable to every job template that uses that macro.  This is getting unmanageable and messy, so this patch refactors out the configurations we've been controlling using conditionals into their own builders which can be pulled into a job-template only if required. It does this by writing the optional script parts into a file call ironic-extra-vars which is then sourced in the main ironic macro.  
__label__quality Refactor Ironic job macro  Ironic is getting more and more jobs to test the different deployment scenarios we support, every time we add a new optional feature we add a new conditional to the existing macro to enable it for one job, and then we have to add a new variable to every job template that uses that macro.  This is getting unmanageable and messy, so this patch refactors out the configurations we've been controlling using conditionals into their own builders which can be pulled into a job-template only if required. It does this by writing the optional script parts into a file call ironic-extra-vars which is then sourced in the main ironic macro.  
__label__objective Refactor Ironic job macro  Ironic is getting more and more jobs to test the different deployment scenarios we support, every time we add a new optional feature we add a new conditional to the existing macro to enable it for one job, and then we have to add a new variable to every job template that uses that macro.  This is getting unmanageable and messy, so this patch refactors out the configurations we've been controlling using conditionals into their own builders which can be pulled into a job-template only if required. It does this by writing the optional script parts into a file call ironic-extra-vars which is then sourced in the main ironic macro.  
__label__testing DNM, test refactor of release  
__label__testing Refactor locale tests and unicode issue  There is an issue if someone uses a non-english locale, that includes non US-ASCII chars. In that case appending a unicode argument to a string fails with an error.  This patch refactors the existing test, covering a few more different cases with english and non-english locales. The last test currently fails on master with an UnicodeDecodeError; this is fixed by the gettext decoding.  Closes-Bug: 1580678 
__label__objective Refactor locale tests and unicode issue  There is an issue if someone uses a non-english locale, that includes non US-ASCII chars. In that case appending a unicode argument to a string fails with an error.  This patch refactors the existing test, covering a few more different cases with english and non-english locales. The last test currently fails on master with an UnicodeDecodeError; this is fixed by the gettext decoding.  Closes-Bug: 1580678 
__label__objective Refactor locale tests and unicode issue  There is an issue if someone uses a non-english locale, that includes non US-ASCII chars. In that case appending a unicode argument to a string fails with an error.  This patch refactors the existing test, covering a few more different cases with english and non-english locales. The last test currently fails on master with an UnicodeDecodeError; this is fixed by the gettext decoding.  Closes-Bug: 1580678 
__label__testing libvirt: refactor config drive live migration test  The code in pre_live_migration() to check whether live migration with config drive is supported in various cases is complex enough and heavily enough commented that moving it to a separate function helps make the code more straightforward to follow.  Also, if we do this, we can create separate tests for the new function allowing us to test this logic in isolation rather than having to probe each condition in the context of a full call to pre_live_migration().  
__label__quality libvirt: refactor config drive live migration test  The code in pre_live_migration() to check whether live migration with config drive is supported in various cases is complex enough and heavily enough commented that moving it to a separate function helps make the code more straightforward to follow.  Also, if we do this, we can create separate tests for the new function allowing us to test this logic in isolation rather than having to probe each condition in the context of a full call to pre_live_migration().  
__label__objective libvirt: refactor config drive live migration test  The code in pre_live_migration() to check whether live migration with config drive is supported in various cases is complex enough and heavily enough commented that moving it to a separate function helps make the code more straightforward to follow.  Also, if we do this, we can create separate tests for the new function allowing us to test this logic in isolation rather than having to probe each condition in the context of a full call to pre_live_migration().  
__label__testing DNM: Commit to test neutron worker refactor  The previous neutron worker refactor broke networking-ovn before it was reverted. This patch set tests the updated refactor to ensure it doesn't break networking-ovn again.  
__label__objective DNM: Commit to test neutron worker refactor  The previous neutron worker refactor broke networking-ovn before it was reverted. This patch set tests the updated refactor to ensure it doesn't break networking-ovn again.  
__label__objective DNM: Commit to test neutron worker refactor  The previous neutron worker refactor broke networking-ovn before it was reverted. This patch set tests the updated refactor to ensure it doesn't break networking-ovn again.  
__label__objective refactored the test imports to comply with openstack convention  
__label__quality refactored the test imports to comply with openstack convention  
__label__testing Refactor test_attributes.py (part 1)  This patch refactored repeated test cases with a for loop  
__label__quality Refactor test_attributes.py (part 1)  This patch refactored repeated test cases with a for loop  
__label__objective Refactor test_attributes.py (part 1)  This patch refactored repeated test cases with a for loop  
__label__testing Refactor test fixtures  
__label__integration Refactoring of code:  1) new snapshot module with code vss, lvm and part of backup.py - create_snapshot and remove_snapshot  This module should contain all code related shadow, vss and any new snapshots.  2) new openstack module with code from osclient, restore and backup (BackupOS)  This module should contain code related to cinder/nova backups  3) new utils module with code from utils, win_utils, bandwidth, config, exec_cmd, validator, streaming  This module should containd code related to anything that cannot be extracted to its own module  4) new test modules - snapshot, utils, openstack and apiclient.  Test scheduler daemon is now located in scheduler module.  5) Backup.py is deleted and code placed to openstack.backup (BackupOS) and to job.BackupJob  
__label__objective Refactoring of code:  1) new snapshot module with code vss, lvm and part of backup.py - create_snapshot and remove_snapshot  This module should contain all code related shadow, vss and any new snapshots.  2) new openstack module with code from osclient, restore and backup (BackupOS)  This module should contain code related to cinder/nova backups  3) new utils module with code from utils, win_utils, bandwidth, config, exec_cmd, validator, streaming  This module should containd code related to anything that cannot be extracted to its own module  4) new test modules - snapshot, utils, openstack and apiclient.  Test scheduler daemon is now located in scheduler module.  5) Backup.py is deleted and code placed to openstack.backup (BackupOS) and to job.BackupJob  
__label__testing Refactor packaging module into functional modules  The packaging module has become large and complex module containing many different functional features. Long term support and maintenance is significantly impacted.  The packaging module has been refactored into the following:      common - utility functions imported by several modules     git - all the git related functions     requirements - all the requirements processing functions     package cmds (aligned to how setuptools and distribute are defined)         build_doc         egg_info         install         install_scripts         sdist         test  The dependencies and test cases have been updated to point to the new modules except for version. A separate refactoring of version will be handled in a different patch, at which point the packaging module can be deprecated and/or removed.  
__label__quality Refactor packaging module into functional modules  The packaging module has become large and complex module containing many different functional features. Long term support and maintenance is significantly impacted.  The packaging module has been refactored into the following:      common - utility functions imported by several modules     git - all the git related functions     requirements - all the requirements processing functions     package cmds (aligned to how setuptools and distribute are defined)         build_doc         egg_info         install         install_scripts         sdist         test  The dependencies and test cases have been updated to point to the new modules except for version. A separate refactoring of version will be handled in a different patch, at which point the packaging module can be deprecated and/or removed.  
__label__objective Refactor packaging module into functional modules  The packaging module has become large and complex module containing many different functional features. Long term support and maintenance is significantly impacted.  The packaging module has been refactored into the following:      common - utility functions imported by several modules     git - all the git related functions     requirements - all the requirements processing functions     package cmds (aligned to how setuptools and distribute are defined)         build_doc         egg_info         install         install_scripts         sdist         test  The dependencies and test cases have been updated to point to the new modules except for version. A separate refactoring of version will be handled in a different patch, at which point the packaging module can be deprecated and/or removed.  
__label__testing Refactor Hitachi Block Storage Driver (Fourth patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is last one.  The class relationship of my patches are following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  
__label__quality Refactor Hitachi Block Storage Driver (Fourth patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is last one.  The class relationship of my patches are following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  
__label__objective Refactor Hitachi Block Storage Driver (Fourth patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is last one.  The class relationship of my patches are following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  
__label__integration Refactor Hitachi Block Storage Driver (Fourth patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is last one.  The class relationship of my patches are following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  
__label__testing Refactor Hitachi Block Storage Driver (Third patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is 3rd one.  The class relationship of my patches are following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  
__label__quality Refactor Hitachi Block Storage Driver (Third patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is 3rd one.  The class relationship of my patches are following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  
__label__objective Refactor Hitachi Block Storage Driver (Third patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is 3rd one.  The class relationship of my patches are following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  
__label__integration Refactor Hitachi Block Storage Driver (Third patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is 3rd one.  The class relationship of my patches are following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  
__label__testing Refactor Hitachi Block Storage Driver (Second patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is 2nd one.  The class relationship of my patches are following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  
__label__quality Refactor Hitachi Block Storage Driver (Second patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is 2nd one.  The class relationship of my patches are following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  
__label__objective Refactor Hitachi Block Storage Driver (Second patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is 2nd one.  The class relationship of my patches are following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  
__label__integration Refactor Hitachi Block Storage Driver (Second patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is 2nd one.  The class relationship of my patches are following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  
__label__testing Refactor Hitachi Block Storage Driver (First patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is 1st one.  The class relationship of my patches is following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  DocImpact Implements: blueprint refactoring-hbsd-driver  
__label__quality Refactor Hitachi Block Storage Driver (First patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is 1st one.  The class relationship of my patches is following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  DocImpact Implements: blueprint refactoring-hbsd-driver  
__label__objective Refactor Hitachi Block Storage Driver (First patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is 1st one.  The class relationship of my patches is following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  DocImpact Implements: blueprint refactoring-hbsd-driver  
__label__integration Refactor Hitachi Block Storage Driver (First patch)  Our drivers have already supported FC and iSCSI protocols. Our drivers have two storage interfaces, named HORCM and SNM2. Our drivers have already supported three kinds of drivers on our code, HORCMFC, SNM2FC and SNM2ISCSI.  I found that it is hard to maintain the present code. So I refactor our code drastically.  I submit following four patches: (1) refactor base libraries. And delete the existing test driver to not     break the existing unit tests. (2) refactor SNM2FC drivers based on libraries change. (3) refactor SNM2ISCSI drivers based on libraries change. (4) refactor HORCMFC drivers based on libraries change.  This patch is 1st one.  The class relationship of my patches is following: 1. The most upper classes are HBSDFC. These classes inherit    VolumeDriver class. These classes have HBSDCOMMON. 2. HBSDCOMMON class has common methods with HORCM and SNM2. 3. HBSDHORCM and HBSDSNM2 classes inherit HBSDCOMMON.    HBSDHORCM class has the characteristic methods for HORCM interface.    HBSDSNM2 class has the characteristic methods for SNM2 interface. 4. HBSDHORCMFC class inherit HBSDHORCM.    HBSDHORCMFC class has the characteristic interfaces for HORCM and FC 5. HBSDSNM2FC and HBSDSNM2ISCSI classes inherit HBSDSNM2.    These classes have characteristic interfaces respectively.  DocImpact Implements: blueprint refactoring-hbsd-driver  
__label__testing Refactor unit test test_neutron_autoscaling  refactor test_neutron_autoscaling, make it easier to add new tests.  - remove redundant resources: monitor, pool. These are already   tested in test_neutron. - make stub funtions reusable  
__label__objective Refactor unit test test_neutron_autoscaling  refactor test_neutron_autoscaling, make it easier to add new tests.  - remove redundant resources: monitor, pool. These are already   tested in test_neutron. - make stub funtions reusable  
__label__quality Refactor unit test test_neutron_autoscaling  refactor test_neutron_autoscaling, make it easier to add new tests.  - remove redundant resources: monitor, pool. These are already   tested in test_neutron. - make stub funtions reusable  
__label__testing WIP test tempest without refactoring  jsut try the repo gates without refactoring to see if tempest still fails.  
__label__objective WIP test tempest without refactoring  jsut try the repo gates without refactoring to see if tempest still fails.  
__label__objective WIP test tempest without refactoring  jsut try the repo gates without refactoring to see if tempest still fails.  
__label__testing Refactor os-services unittest  - move feature toggle with extensions from common test to v2 only - add api versions to fake requests - rearange parameters in asserts, so unit test failure printouts   correctly show reference and test results  
__label__testing refactor test_validate_ip_address()  Changed many test cases to use a for loop Removed an useless mock assert  
__label__objective refactor test_validate_ip_address()  Changed many test cases to use a for loop Removed an useless mock assert  
__label__quality refactor test_validate_ip_address()  Changed many test cases to use a for loop Removed an useless mock assert  
__label__testing Refactor test configs to a seperate files  Continuing modularity movement because the main file for python-jenkins is getting quite big.  This change refactors test configs to a seperate module.  
__label__quality Refactor test configs to a seperate files  Continuing modularity movement because the main file for python-jenkins is getting quite big.  This change refactors test configs to a seperate module.  
__label__objective Refactor test configs to a seperate files  Continuing modularity movement because the main file for python-jenkins is getting quite big.  This change refactors test configs to a seperate module.  
__label__integration ODL driver refactor - Unit test updates  Unit test coverage for ODL driver refactor. (Review: https://review.openstack.org/#/c/222409/)  Partially fixes Bug # 1493551  
__label__testing ODL driver refactor - Unit test updates  Unit test coverage for ODL driver refactor. (Review: https://review.openstack.org/#/c/222409/)  Partially fixes Bug # 1493551  
__label__objective ODL driver refactor - Unit test updates  Unit test coverage for ODL driver refactor. (Review: https://review.openstack.org/#/c/222409/)  Partially fixes Bug # 1493551  
__label__integration ODL driver refactor - Unit test updates  Unit test coverage for ODL driver refactor.  Partially fixes Bug # 1493551  
__label__testing ODL driver refactor - Unit test updates  Unit test coverage for ODL driver refactor.  Partially fixes Bug # 1493551  
__label__objective ODL driver refactor - Unit test updates  Unit test coverage for ODL driver refactor.  Partially fixes Bug # 1493551  
__label__testing [Tempest] Refactor base tests for share creation  Our Tempest jobs run out timeout very often. So, we need to make our tests be completed sooner than it is now. Currently, we have two tests with simple share creation for each share protocol. And the only difference - usage of different microversions that influence only view. So, combine these two tests into one verifying both microversions in one test creating only one share. In case of Generic driver, we test the same things reducing expanses for 2 share creations.  
__label__integration [Tempest] Refactor base tests for share creation  Our Tempest jobs run out timeout very often. So, we need to make our tests be completed sooner than it is now. Currently, we have two tests with simple share creation for each share protocol. And the only difference - usage of different microversions that influence only view. So, combine these two tests into one verifying both microversions in one test creating only one share. In case of Generic driver, we test the same things reducing expanses for 2 share creations.  
__label__objective [Tempest] Refactor base tests for share creation  Our Tempest jobs run out timeout very often. So, we need to make our tests be completed sooner than it is now. Currently, we have two tests with simple share creation for each share protocol. And the only difference - usage of different microversions that influence only view. So, combine these two tests into one verifying both microversions in one test creating only one share. In case of Generic driver, we test the same things reducing expanses for 2 share creations.  
__label__testing Refactor ssh_compute_remove() in nova  This removes one loop, but also changes the unit test so that it is not dependent on the implementation of the function, specifically w.r.t. the number of writes to the output file (which can now be changed in the future).  
__label__quality Refactor ssh_compute_remove() in nova  This removes one loop, but also changes the unit test so that it is not dependent on the implementation of the function, specifically w.r.t. the number of writes to the output file (which can now be changed in the future).  
__label__objective Refactor ssh_compute_remove() in nova  This removes one loop, but also changes the unit test so that it is not dependent on the implementation of the function, specifically w.r.t. the number of writes to the output file (which can now be changed in the future).  
__label__testing Revert "Refactor random naming"  This reverts commit e3e7b2722e6b78216373f392af5bfeba1e2da5ec.  After that change, if the test creates a volume type with a given name, it's not unique and therefore can hit a 409 conflict trying to create a volume type with a name that already exists, which can happen when running scenario tests concurrently since several encrypted volume tests use the same volume type name "luks".  See Iecf62d411d2da17c4c983915018e3ed9180ecd11 for an alternative but this is easier. It's not entirely clear why the original change was made anyway - why do we care if the tests create long names? They weren't unnecessary because they were random to avoid conflicts.  
__label__objective Revert "Refactor random naming"  This reverts commit e3e7b2722e6b78216373f392af5bfeba1e2da5ec.  After that change, if the test creates a volume type with a given name, it's not unique and therefore can hit a 409 conflict trying to create a volume type with a name that already exists, which can happen when running scenario tests concurrently since several encrypted volume tests use the same volume type name "luks".  See Iecf62d411d2da17c4c983915018e3ed9180ecd11 for an alternative but this is easier. It's not entirely clear why the original change was made anyway - why do we care if the tests create long names? They weren't unnecessary because they were random to avoid conflicts.  
__label__objective Revert "Refactor random naming"  This reverts commit e3e7b2722e6b78216373f392af5bfeba1e2da5ec.  After that change, if the test creates a volume type with a given name, it's not unique and therefore can hit a 409 conflict trying to create a volume type with a name that already exists, which can happen when running scenario tests concurrently since several encrypted volume tests use the same volume type name "luks".  See Iecf62d411d2da17c4c983915018e3ed9180ecd11 for an alternative but this is easier. It's not entirely clear why the original change was made anyway - why do we care if the tests create long names? They weren't unnecessary because they were random to avoid conflicts.  
__label__testing Refactor functional base test classes  The functional base test class should be implemented under os-vif. Other projects will inherit from this project to implement functional test cases.  
__label__objective Refactor functional base test classes  The functional base test class should be implemented under os-vif. Other projects will inherit from this project to implement functional test cases.  
__label__quality Refactor functional base test classes  The functional base test class should be implemented under os-vif. Other projects will inherit from this project to implement functional test cases.  
__label__testing Refactor required fixtures listing  - test methods requires fixtures of test class - test class requires fixtures of RequiredFixtureProperty - fix some minor problems (like getting object names)  
__label__objective Refactor required fixtures listing  - test methods requires fixtures of test class - test class requires fixtures of RequiredFixtureProperty - fix some minor problems (like getting object names)  
__label__objective Refactor required fixtures listing  - test methods requires fixtures of test class - test class requires fixtures of RequiredFixtureProperty - fix some minor problems (like getting object names)  
__label__testing Add a scenario test and refactor API tests  1. Adds a tempest scenario testcase in TaaS.  2. Refactor the existing API tests.  3. Adds a new API testcase to test the newly added Vlan Mirror input parameter in tap-flow-create API.  This patchset is an extension to following commit which adds SRIOV driver support in TaaS:  
__label__objective Add a scenario test and refactor API tests  1. Adds a tempest scenario testcase in TaaS.  2. Refactor the existing API tests.  3. Adds a new API testcase to test the newly added Vlan Mirror input parameter in tap-flow-create API.  This patchset is an extension to following commit which adds SRIOV driver support in TaaS:  
__label__integration Add a scenario test and refactor API tests  1. Adds a tempest scenario testcase in TaaS.  2. Refactor the existing API tests.  3. Adds a new API testcase to test the newly added Vlan Mirror input parameter in tap-flow-create API.  This patchset is an extension to following commit which adds SRIOV driver support in TaaS:  
__label__testing Refactor ResourceProviderListTestCase  Some tests in ResourceProviderListTestCase validated the number of resource providers returned by p_obj.get_all_by_filters(), but didn't validate if they are proper resource providers.  This patch adds that check adding a small test helper function, _run_get_all_by_filters().  
__label__objective Refactor ResourceProviderListTestCase  Some tests in ResourceProviderListTestCase validated the number of resource providers returned by p_obj.get_all_by_filters(), but didn't validate if they are proper resource providers.  This patch adds that check adding a small test helper function, _run_get_all_by_filters().  
__label__testing Add Stein Reno for keystone v3 usages and test refactoring  
__label__objective Add Stein Reno for keystone v3 usages and test refactoring  
__label__testing Add Stein Reno for keystone v3 usages and test refactoring  
__label__objective Add Stein Reno for keystone v3 usages and test refactoring  
__label__testing PowerMax Driver - Unit Test Refactoring  This submission refactors the unit tests pertaining to the PowerMax for Cinder driver. The single unit test file has been split into multiple files for ease of use.  
__label__quality PowerMax Driver - Unit Test Refactoring  This submission refactors the unit tests pertaining to the PowerMax for Cinder driver. The single unit test file has been split into multiple files for ease of use.  
__label__objective PowerMax Driver - Unit Test Refactoring  This submission refactors the unit tests pertaining to the PowerMax for Cinder driver. The single unit test file has been split into multiple files for ease of use.  
__label__testing Refactor fixture manager test cases.  
__label__testing Refactor on policy in code  Recently, we add the policy in code test, and put all these cases into test_volume_protection.py, but with the test case growing up, it's difficult to maintenance.  In this patch, we refactor these test cases: 1. Add a new unit test case path - "tests/unit/policies/". 2. Split policy in code test in their own file, which is one-to-one mapping to policy file.  Note that, there is no functional changes in this patch.  
__label__quality Refactor on policy in code  Recently, we add the policy in code test, and put all these cases into test_volume_protection.py, but with the test case growing up, it's difficult to maintenance.  In this patch, we refactor these test cases: 1. Add a new unit test case path - "tests/unit/policies/". 2. Split policy in code test in their own file, which is one-to-one mapping to policy file.  Note that, there is no functional changes in this patch.  
__label__objective Refactor on policy in code  Recently, we add the policy in code test, and put all these cases into test_volume_protection.py, but with the test case growing up, it's difficult to maintenance.  In this patch, we refactor these test cases: 1. Add a new unit test case path - "tests/unit/policies/". 2. Split policy in code test in their own file, which is one-to-one mapping to policy file.  Note that, there is no functional changes in this patch.  
__label__integration Refactor patches for rabbitmq-server package  Use rabbitmq-server-config package to package config files for rabbitmq-server package. We can remove related patches of it and use RPM instead of SRPM for it.  Deployment test and ping test between VMs pass Config files check pass.  Story: 2003768 Task: 28042 Depends-on: https://review.openstack.org/#/c/619882/  
__label__testing Refactor patches for rabbitmq-server package  Use rabbitmq-server-config package to package config files for rabbitmq-server package. We can remove related patches of it and use RPM instead of SRPM for it.  Deployment test and ping test between VMs pass Config files check pass.  Story: 2003768 Task: 28042 Depends-on: https://review.openstack.org/#/c/619882/  
__label__objective Refactor patches for rabbitmq-server package  Use rabbitmq-server-config package to package config files for rabbitmq-server package. We can remove related patches of it and use RPM instead of SRPM for it.  Deployment test and ping test between VMs pass Config files check pass.  Story: 2003768 Task: 28042 Depends-on: https://review.openstack.org/#/c/619882/  
__label__testing Refactor rsync unit test  The patch refactor rsync unit test  
__label__objective Refactor rsync unit test  The patch refactor rsync unit test  
__label__testing Refactor port creation code  Introduce a method 'create_port' in base test class. This allows subclass reuse the port creation logic.  
__label__quality Refactor port creation code  Introduce a method 'create_port' in base test class. This allows subclass reuse the port creation logic.  
__label__integration Refactor unit test about sqlalchemy  for supporting v1  
__label__testing Refactor unit test about sqlalchemy  for supporting v1  
__label__objective Refactor unit test about sqlalchemy  for supporting v1  
__label__integration Refactor meta patch for openstack-panko  Use openstack-panko-config package to package config file for openstack-panko package. Erase logrotate.d/openstack-panko instead of removing it in spec file.  Deployment test pass and config file check pass!  Story: 2003768 Task: 28362  
__label__testing Refactor meta patch for openstack-panko  Use openstack-panko-config package to package config file for openstack-panko package. Erase logrotate.d/openstack-panko instead of removing it in spec file.  Deployment test pass and config file check pass!  Story: 2003768 Task: 28362  
__label__objective Refactor meta patch for openstack-panko  Use openstack-panko-config package to package config file for openstack-panko package. Erase logrotate.d/openstack-panko instead of removing it in spec file.  Deployment test pass and config file check pass!  Story: 2003768 Task: 28362  
__label__integration Refactor source code patches for dhcp package  3 source patches can be removed. 2 patches adds support for wrs_install_uuid in the dhclient script. This added script part just copy the whole content of dhclient-enter-hooks. Following this script part, it will call this hook script if the hook exist under /etc/. However, our hook file existed in /etc/dhcp/ folder will be called by sbin/dhclient-script as well. I'd like to use dhcp config package to creat /etc/dhclient-enter-hooks soft linked to /etc/dhcp/dhclient-enter-hooks, so that it can call dhclient script and no need to add this 2 patches.  Support-disable-nsupdate.patch can be removed as we already fixed port conflict issue in https://review.openstack.org/#/c/622711/  Deployment test pass and related script file check pass!  Story: 2004473 Task: 28164  
__label__objective Refactor source code patches for dhcp package  3 source patches can be removed. 2 patches adds support for wrs_install_uuid in the dhclient script. This added script part just copy the whole content of dhclient-enter-hooks. Following this script part, it will call this hook script if the hook exist under /etc/. However, our hook file existed in /etc/dhcp/ folder will be called by sbin/dhclient-script as well. I'd like to use dhcp config package to creat /etc/dhclient-enter-hooks soft linked to /etc/dhcp/dhclient-enter-hooks, so that it can call dhclient script and no need to add this 2 patches.  Support-disable-nsupdate.patch can be removed as we already fixed port conflict issue in https://review.openstack.org/#/c/622711/  Deployment test pass and related script file check pass!  Story: 2004473 Task: 28164  
__label__integration Refactor harden server and client config patch for openssh package  Move ssh_config and sshd_config modification from openssh package to openssh-config package. Deployment test pass and configuration file check pass!  Story: 2004477 Task: 28185  
__label__objective Refactor harden server and client config patch for openssh package  Move ssh_config and sshd_config modification from openssh package to openssh-config package. Deployment test pass and configuration file check pass!  Story: 2004477 Task: 28185  
__label__testing Refactor test_mtu test case after base scenario test case changed.  
__label__objective Refactor test_mtu test case after base scenario test case changed.  
__label__testing Refactor scenario test case to create template in setUpClass method.  
__label__objective Refactor scenario test case to create template in setUpClass method.  
__label__integration Device Refactor  Replacing device with vnf in test cases in continuation of [1].  [1]: https://review.openstack.org/#/c/352205/  
__label__testing Device Refactor  Replacing device with vnf in test cases in continuation of [1].  [1]: https://review.openstack.org/#/c/352205/  
__label__objective Device Refactor  Replacing device with vnf in test cases in continuation of [1].  [1]: https://review.openstack.org/#/c/352205/  
__label__testing test: Refactor test handler  While authoring [0], it was discovered that Armada has duplicate logic for deciding if Helm test cleanup should be enabled as well as the tests themselves. Because of this, changes to test logic (e.g. adding pre-test actions), requires changing all traces of the repeated logic, which can lead to inconsistent behavior if not properly addressed. This change moves all test decision logic to a singular Test handler, implemented by the `Test` class. This change does NOT change the expected behavior of tests in Armada.  [0] https://review.openstack.org/617834  
__label__quality test: Refactor test handler  While authoring [0], it was discovered that Armada has duplicate logic for deciding if Helm test cleanup should be enabled as well as the tests themselves. Because of this, changes to test logic (e.g. adding pre-test actions), requires changing all traces of the repeated logic, which can lead to inconsistent behavior if not properly addressed. This change moves all test decision logic to a singular Test handler, implemented by the `Test` class. This change does NOT change the expected behavior of tests in Armada.  [0] https://review.openstack.org/617834  
__label__objective test: Refactor test handler  While authoring [0], it was discovered that Armada has duplicate logic for deciding if Helm test cleanup should be enabled as well as the tests themselves. Because of this, changes to test logic (e.g. adding pre-test actions), requires changing all traces of the repeated logic, which can lead to inconsistent behavior if not properly addressed. This change moves all test decision logic to a singular Test handler, implemented by the `Test` class. This change does NOT change the expected behavior of tests in Armada.  [0] https://review.openstack.org/617834  
__label__integration Refactor patches for openstack-aodh package  Use openstack-aodh-config package to package service and script files for openstack-aodh package.  Deployment test pass and service/script file check pass.  Story: 2003768 Task: 28044 Depends-on: https://review.openstack.org/#/c/620258/  
__label__objective Refactor patches for openstack-aodh package  Use openstack-aodh-config package to package service and script files for openstack-aodh package.  Deployment test pass and service/script file check pass.  Story: 2003768 Task: 28044 Depends-on: https://review.openstack.org/#/c/620258/  
__label__integration Refactor patches for setup package  Use setup-config package to package config files for setup package. Merged all passwd, group, uidgid patches to one patch.  Deployment test and ping test between WMs pass Config and service files check pass.  Story: 2003768 Task: 27592  
__label__objective Refactor patches for setup package  Use setup-config package to package config files for setup package. Merged all passwd, group, uidgid patches to one patch.  Deployment test and ping test between WMs pass Config and service files check pass.  Story: 2003768 Task: 27592  
__label__quality Refactor patches for nss-pam-ldapd package  The patch change mainly focus on %post section in spec file. The comment in the patch mentions that we don't want change our custom binddn and bindpw in nslcd.conf However, in spec file, "source" variabe could not be assigned to a valid file name as we could not find these *.conf files in /etc/ folder. if test -s /etc/nss-ldapd.conf ; then         source=/etc/nss-ldapd.conf elif test -s /etc/nss_ldap.conf ; then         source=/etc/nss_ldap.conf elif test -s /etc/pam_ldap.conf ; then         source=/etc/pam_ldap.conf else         source=/etc/ldap.conf  So it will not change nslcd.conf even if we do not remove below code.  if grep -E -q '^base[[:blank:]]' $source 2> /dev/null ; then      # Comment out the packaged default base and replace it.         sed -i -r -e 's,^(base[[:blank:]].*),# \1,g' $target         grep -E '^base[[:blank:]]' $source >> $target fi  grep -E '^(binddn|bindpw|port|scope|ssl|pagesize)[[:blank:]]'    $source 2> /dev/null >> $target  We can use RPM instead of SRPM for nss-pam-ldapd package, since related patches are not used anymore.  Deployment test pass.  Story: 2003768 Task: 28045 Depends-on: https://review.openstack.org/#/c/619976/  
__label__objective Refactor patches for nss-pam-ldapd package  The patch change mainly focus on %post section in spec file. The comment in the patch mentions that we don't want change our custom binddn and bindpw in nslcd.conf However, in spec file, "source" variabe could not be assigned to a valid file name as we could not find these *.conf files in /etc/ folder. if test -s /etc/nss-ldapd.conf ; then         source=/etc/nss-ldapd.conf elif test -s /etc/nss_ldap.conf ; then         source=/etc/nss_ldap.conf elif test -s /etc/pam_ldap.conf ; then         source=/etc/pam_ldap.conf else         source=/etc/ldap.conf  So it will not change nslcd.conf even if we do not remove below code.  if grep -E -q '^base[[:blank:]]' $source 2> /dev/null ; then      # Comment out the packaged default base and replace it.         sed -i -r -e 's,^(base[[:blank:]].*),# \1,g' $target         grep -E '^base[[:blank:]]' $source >> $target fi  grep -E '^(binddn|bindpw|port|scope|ssl|pagesize)[[:blank:]]'    $source 2> /dev/null >> $target  We can use RPM instead of SRPM for nss-pam-ldapd package, since related patches are not used anymore.  Deployment test pass.  Story: 2003768 Task: 28045 Depends-on: https://review.openstack.org/#/c/619976/  
__label__testing Refactor patches for nss-pam-ldapd package  The patch change mainly focus on %post section in spec file. The comment in the patch mentions that we don't want change our custom binddn and bindpw in nslcd.conf However, in spec file, "source" variabe could not be assigned to a valid file name as we could not find these *.conf files in /etc/ folder. if test -s /etc/nss-ldapd.conf ; then         source=/etc/nss-ldapd.conf elif test -s /etc/nss_ldap.conf ; then         source=/etc/nss_ldap.conf elif test -s /etc/pam_ldap.conf ; then         source=/etc/pam_ldap.conf else         source=/etc/ldap.conf  So it will not change nslcd.conf even if we do not remove below code.  if grep -E -q '^base[[:blank:]]' $source 2> /dev/null ; then      # Comment out the packaged default base and replace it.         sed -i -r -e 's,^(base[[:blank:]].*),# \1,g' $target         grep -E '^base[[:blank:]]' $source >> $target fi  grep -E '^(binddn|bindpw|port|scope|ssl|pagesize)[[:blank:]]'    $source 2> /dev/null >> $target  We can use RPM instead of SRPM for nss-pam-ldapd package, since related patches are not used anymore.  Deployment test pass.  Story: 2003768 Task: 28045 Depends-on: https://review.openstack.org/#/c/619976/  
__label__testing Refactor patches for nss-pam-ldapd package  Use RPM instead of SRPM for nss-pam-ldapd package, since related patches are not used anymore.  Deployment test pass.  Story: 2003768 Task: 28045  
__label__objective Refactor patches for nss-pam-ldapd package  Use RPM instead of SRPM for nss-pam-ldapd package, since related patches are not used anymore.  Deployment test pass.  Story: 2003768 Task: 28045  
__label__integration Refactor patches for nss-pam-ldapd package  Use RPM instead of SRPM for nss-pam-ldapd package, since related patches are not used anymore.  Deployment test pass.  Story: 2003768 Task: 28045  
__label__testing Refactor patches for net-snmp package  Use net-snmp-config package to package script and service file for net-snmp-config package. Removed servcie/config/script related patches and let net-snmp-config package to be responsible for it. Keep another one meta patch for build configuration related change.  Deployment test and ping test between VMs pass Config,serivce and script files check pass.  Story: 2003768 Task: 27586 Depends-on: https://review.openstack.org/#/c/616097  
__label__integration Refactor patches for net-snmp package  Use net-snmp-config package to package script and service file for net-snmp-config package. Removed servcie/config/script related patches and let net-snmp-config package to be responsible for it. Keep another one meta patch for build configuration related change.  Deployment test and ping test between VMs pass Config,serivce and script files check pass.  Story: 2003768 Task: 27586 Depends-on: https://review.openstack.org/#/c/616097  
__label__objective Refactor patches for net-snmp package  Use net-snmp-config package to package script and service file for net-snmp-config package. Removed servcie/config/script related patches and let net-snmp-config package to be responsible for it. Keep another one meta patch for build configuration related change.  Deployment test and ping test between VMs pass Config,serivce and script files check pass.  Story: 2003768 Task: 27586 Depends-on: https://review.openstack.org/#/c/616097  
__label__testing Refactor patches for net-snmp package.  Use net-snmp-config package to package script and service file for net-snmp-config package. Like net-snmp, net-snmp-config will also not be installed on computer and storage node.  Deployment test and ping test between VMs pass Config,serivce and script files check pass.  Story: 2003768 Task: 27586  
__label__integration Refactor patches for net-snmp package.  Use net-snmp-config package to package script and service file for net-snmp-config package. Like net-snmp, net-snmp-config will also not be installed on computer and storage node.  Deployment test and ping test between VMs pass Config,serivce and script files check pass.  Story: 2003768 Task: 27586  
__label__objective Refactor patches for net-snmp package.  Use net-snmp-config package to package script and service file for net-snmp-config package. Like net-snmp, net-snmp-config will also not be installed on computer and storage node.  Deployment test and ping test between VMs pass Config,serivce and script files check pass.  Story: 2003768 Task: 27586  
__label__testing Refactor patches for openssh package  Use openssh-config package to package config and service files for openssh package. Merge adding source patch and spec related change to one meta patch named spec-include-Tis-chnages.patch.  Deployment test and ping test between VMs pass Config files check pass.  Story: 2003768 Task: 27588  
__label__integration Refactor patches for openssh package  Use openssh-config package to package config and service files for openssh package. Merge adding source patch and spec related change to one meta patch named spec-include-Tis-chnages.patch.  Deployment test and ping test between VMs pass Config files check pass.  Story: 2003768 Task: 27588  
__label__objective Refactor patches for openssh package  Use openssh-config package to package config and service files for openssh package. Merge adding source patch and spec related change to one meta patch named spec-include-Tis-chnages.patch.  Deployment test and ping test between VMs pass Config files check pass.  Story: 2003768 Task: 27588  
__label__testing Refactor patches for util-linux package  Use util-linux-config package to package config files for util-linux Remove util-linux package folder and use RPM instead of SRPM for util-linux.  Deployment test and ping test between VMs pass Config file check pass.  Story: 2003768 Task: 27595  
__label__integration Refactor patches for util-linux package  Use util-linux-config package to package config files for util-linux Remove util-linux package folder and use RPM instead of SRPM for util-linux.  Deployment test and ping test between VMs pass Config file check pass.  Story: 2003768 Task: 27595  
__label__objective Refactor patches for util-linux package  Use util-linux-config package to package config files for util-linux Remove util-linux package folder and use RPM instead of SRPM for util-linux.  Deployment test and ping test between VMs pass Config file check pass.  Story: 2003768 Task: 27595  
__label__testing Fix or skip test cases after framework refactory.  
__label__objective Fix or skip test cases after framework refactory.  
__label__testing Refactor patches for initscripts package  Use initscripts-config package to package script and service file for initscripts package. Refactor 0001-Disable-zeroconf-route.patch��� spec-add-mountnfs-init-script.patch and spec-include-TiS-changes.patch, let initscripts-config to be responsible for the installation of config/script/service files. Merged some meta patches that just includes adding source code patch to spec-include-Tis-changes.patch. Removed base/procps since it just includes one file, sysctl.conf. And move this file to initscripts-config folder.  Deployment test and ping test between VMs pass Service, config and script files check pass.  Story: 2003768 Task: 27585  
__label__integration Refactor patches for initscripts package  Use initscripts-config package to package script and service file for initscripts package. Refactor 0001-Disable-zeroconf-route.patch��� spec-add-mountnfs-init-script.patch and spec-include-TiS-changes.patch, let initscripts-config to be responsible for the installation of config/script/service files. Merged some meta patches that just includes adding source code patch to spec-include-Tis-changes.patch. Removed base/procps since it just includes one file, sysctl.conf. And move this file to initscripts-config folder.  Deployment test and ping test between VMs pass Service, config and script files check pass.  Story: 2003768 Task: 27585  
__label__objective Refactor patches for initscripts package  Use initscripts-config package to package script and service file for initscripts package. Refactor 0001-Disable-zeroconf-route.patch��� spec-add-mountnfs-init-script.patch and spec-include-TiS-changes.patch, let initscripts-config to be responsible for the installation of config/script/service files. Merged some meta patches that just includes adding source code patch to spec-include-Tis-changes.patch. Removed base/procps since it just includes one file, sysctl.conf. And move this file to initscripts-config folder.  Deployment test and ping test between VMs pass Service, config and script files check pass.  Story: 2003768 Task: 27585  
__label__testing Refactor patches for iscsi-initiator-utils package  Use iscsi-initiator-utils-config package to package config and service file for iscsi-initiator-utils package.  Deployment test and ping test between WMs pass Config and service files check pass.  Story: 2003768 Task: 27596  
__label__integration Refactor patches for iscsi-initiator-utils package  Use iscsi-initiator-utils-config package to package config and service file for iscsi-initiator-utils package.  Deployment test and ping test between WMs pass Config and service files check pass.  Story: 2003768 Task: 27596  
__label__objective Refactor patches for iscsi-initiator-utils package  Use iscsi-initiator-utils-config package to package config and service file for iscsi-initiator-utils package.  Deployment test and ping test between WMs pass Config and service files check pass.  Story: 2003768 Task: 27596  
__label__integration refactor: Rename PluginRbacTest => ExtRbacTest  This patch set is a follow up on discussion in [0] which concluded that Patrole should not test Neutron plugins.  The pertinent discussion from [0] is:  Patrole can test Neutron extensions but not plugins in tree and that requires renaming the classes (.*PluginRbacTest => .*ExtensionRbacTest) to make it clearer.  Having to support all the Neutron plugins in tree is out of scope for Patrole. Clarifying documentation (which will be done in follow up) can be added to Patrole documentation to make it clear that it will only test "main" OpenStack projects, like Tempest.  [0] https://review.openstack.org/#/c/599869/  
__label__testing refactor: Rename PluginRbacTest => ExtRbacTest  This patch set is a follow up on discussion in [0] which concluded that Patrole should not test Neutron plugins.  The pertinent discussion from [0] is:  Patrole can test Neutron extensions but not plugins in tree and that requires renaming the classes (.*PluginRbacTest => .*ExtensionRbacTest) to make it clearer.  Having to support all the Neutron plugins in tree is out of scope for Patrole. Clarifying documentation (which will be done in follow up) can be added to Patrole documentation to make it clear that it will only test "main" OpenStack projects, like Tempest.  [0] https://review.openstack.org/#/c/599869/  
__label__quality refactor: Rename PluginRbacTest => ExtRbacTest  This patch set is a follow up on discussion in [0] which concluded that Patrole should not test Neutron plugins.  The pertinent discussion from [0] is:  Patrole can test Neutron extensions but not plugins in tree and that requires renaming the classes (.*PluginRbacTest => .*ExtensionRbacTest) to make it clearer.  Having to support all the Neutron plugins in tree is out of scope for Patrole. Clarifying documentation (which will be done in follow up) can be added to Patrole documentation to make it clear that it will only test "main" OpenStack projects, like Tempest.  [0] https://review.openstack.org/#/c/599869/  
__label__quality refactor: Rename PluginRbacTest => ExtRbacTest  This patch set is a follow up on discussion in [0] which concluded that Patrole should not test Neutron plugins.  The pertinent discussion from [0] is:  Patrole can test Neutron extensions but not plugins in tree and that requires renaming the classes (.*PluginRbacTest => .*ExtensionRbacTest) to make it clearer.  Having to support all the Neutron plugins in tree is out of scope for Patrole. Clarifying documentation (which will be done in follow up) can be added to Patrole documentation to make it clear that it will only test "main" OpenStack projects, like Tempest.  [0] https://review.openstack.org/#/c/599869/  
__label__testing Refactor patches for haproxy package.  Use haproxy-config package to package script and service file for haproxy package. Create patches sub-folder and move patches file from haproxy/haproxy folder to this sub-folder. Refactor haproxy-service-file.patch & haproxy-spec-add-init-script.patch as we use haproxy-config to package related files. Merged meta_add_support_for_tpm.patch & spec-add-haproxy-env-var-patch.patch to spec-include-TiS-changes.patch(renamed from spec-include-TiS-config.patch) as they just includes adding source code patches.  Deployment test and ping test between VMs pass config and script files check pass.  Story: 2003768 Task: 27584 Depends-on: https://review.openstack.org/#/c/614709/  
__label__integration Refactor patches for haproxy package.  Use haproxy-config package to package script and service file for haproxy package. Create patches sub-folder and move patches file from haproxy/haproxy folder to this sub-folder. Refactor haproxy-service-file.patch & haproxy-spec-add-init-script.patch as we use haproxy-config to package related files. Merged meta_add_support_for_tpm.patch & spec-add-haproxy-env-var-patch.patch to spec-include-TiS-changes.patch(renamed from spec-include-TiS-config.patch) as they just includes adding source code patches.  Deployment test and ping test between VMs pass config and script files check pass.  Story: 2003768 Task: 27584 Depends-on: https://review.openstack.org/#/c/614709/  
__label__objective Refactor patches for haproxy package.  Use haproxy-config package to package script and service file for haproxy package. Create patches sub-folder and move patches file from haproxy/haproxy folder to this sub-folder. Refactor haproxy-service-file.patch & haproxy-spec-add-init-script.patch as we use haproxy-config to package related files. Merged meta_add_support_for_tpm.patch & spec-add-haproxy-env-var-patch.patch to spec-include-TiS-changes.patch(renamed from spec-include-TiS-config.patch) as they just includes adding source code patches.  Deployment test and ping test between VMs pass config and script files check pass.  Story: 2003768 Task: 27584 Depends-on: https://review.openstack.org/#/c/614709/  
__label__testing Refactor patches for dnsmasq package.  Use dnsmasq-config package to add init script to system folder and remove related patches. Deployment test and script check pass.  
__label__integration Refactor patches for dnsmasq package.  Use dnsmasq-config package to add init script to system folder and remove related patches. Deployment test and script check pass.  
__label__objective Refactor patches for dnsmasq package.  Use dnsmasq-config package to add init script to system folder and remove related patches. Deployment test and script check pass.  
__label__testing Refactor action execution checker without using scheduler  * Removed using scheduler from action execution heartbeat checker   in favor of regular threads. * Added the new config options "batch_size" under [action_heartbeat]   group to limit a number of action executions being processed during   one iteration the checker. * Added a test checking that an action execution is automatically   failed by the heartbeat checker.  Closes-Bug: #1802065 
__label__objective Refactor action execution checker without using scheduler  * Removed using scheduler from action execution heartbeat checker   in favor of regular threads. * Added the new config options "batch_size" under [action_heartbeat]   group to limit a number of action executions being processed during   one iteration the checker. * Added a test checking that an action execution is automatically   failed by the heartbeat checker.  Closes-Bug: #1802065 
__label__quality Refactor action execution checker without using scheduler  * Removed using scheduler from action execution heartbeat checker   in favor of regular threads. * Added the new config options "batch_size" under [action_heartbeat]   group to limit a number of action executions being processed during   one iteration the checker. * Added a test checking that an action execution is automatically   failed by the heartbeat checker.  Closes-Bug: #1802065 
__label__testing refactor ntp  Add ntp-config package to config the customized ntp.conf and ntpd. With this change, ntp srpm is dropped to replaced by rpm. ntp-config is configured to depend on ntp, so ntp will be included in the ISO automatically. ntp package will be installed in all type node, so no change to filter.  Test has been done: build and deploy with multinode. confirm ntp.conf and ntpd is kept the same as before.  Story: 2003768 Task: 27587  
__label__integration refactor ntp  Add ntp-config package to config the customized ntp.conf and ntpd. With this change, ntp srpm is dropped to replaced by rpm. ntp-config is configured to depend on ntp, so ntp will be included in the ISO automatically. ntp package will be installed in all type node, so no change to filter.  Test has been done: build and deploy with multinode. confirm ntp.conf and ntpd is kept the same as before.  Story: 2003768 Task: 27587  
__label__objective refactor ntp  Add ntp-config package to config the customized ntp.conf and ntpd. With this change, ntp srpm is dropped to replaced by rpm. ntp-config is configured to depend on ntp, so ntp will be included in the ISO automatically. ntp package will be installed in all type node, so no change to filter.  Test has been done: build and deploy with multinode. confirm ntp.conf and ntpd is kept the same as before.  Story: 2003768 Task: 27587  
__label__testing WIP: Refactor CI testing scripts  This change is intended to ease the addition of new test scenarios, by splitting the existing setup_gate.sh script up into several smaller scripts. We may wish to further break these scripts up in future, depending on the requirements of new test jobs.  
__label__quality WIP: Refactor CI testing scripts  This change is intended to ease the addition of new test scenarios, by splitting the existing setup_gate.sh script up into several smaller scripts. We may wish to further break these scripts up in future, depending on the requirements of new test jobs.  
__label__testing Refactor patches for haproxy package.  Use haproxy-config package to package config files for haproxy package Haproxy & haproxy-config will not be installed on storage node.  Deployment test pass and ping pass between 2 VMs. Script file and service file have been checked in system folder.  Story: 2003768 Task: 27584  
__label__integration Refactor patches for haproxy package.  Use haproxy-config package to package config files for haproxy package Haproxy & haproxy-config will not be installed on storage node.  Deployment test pass and ping pass between 2 VMs. Script file and service file have been checked in system folder.  Story: 2003768 Task: 27584  
__label__objective Refactor patches for haproxy package.  Use haproxy-config package to package config files for haproxy package Haproxy & haproxy-config will not be installed on storage node.  Deployment test pass and ping pass between 2 VMs. Script file and service file have been checked in system folder.  Story: 2003768 Task: 27584  
__label__integration Refactor public share test cases  The RBAC policy defaults to create a public share or to update an existing share to public have changed since the Stein release. [1]  Let's stop assuming that regular users can perform these actions, so that manila can safely remove the policy rule deprecation support for these APIs.  [1] https://review.opendev.org/634864  
__label__testing Refactor public share test cases  The RBAC policy defaults to create a public share or to update an existing share to public have changed since the Stein release. [1]  Let's stop assuming that regular users can perform these actions, so that manila can safely remove the policy rule deprecation support for these APIs.  [1] https://review.opendev.org/634864  
__label__objective Refactor public share test cases  The RBAC policy defaults to create a public share or to update an existing share to public have changed since the Stein release. [1]  Let's stop assuming that regular users can perform these actions, so that manila can safely remove the policy rule deprecation support for these APIs.  [1] https://review.opendev.org/634864  
__label__testing Refactor: separate limiting GET /a_c results  This patch reduces the complexity of AllocationCandidates._get_by_requests by factoring out the piece that applies a limit to the results.  In the process of inspecting this code, I noticed what I thought was a bug, so I wrote a test to uncover it. Turns out there was no bug; but I kept the test case (and the "fix" for the bug - a slight refactor and optimization of the limiting algorithm) because it provides heretofore-absent coverage. (Since allocation requests are returned in nondeterministic order, it would be nearly impossible to write a functional test to ensure that the provider summaries are always trimmed correctly.)  
__label__quality Refactor: separate limiting GET /a_c results  This patch reduces the complexity of AllocationCandidates._get_by_requests by factoring out the piece that applies a limit to the results.  In the process of inspecting this code, I noticed what I thought was a bug, so I wrote a test to uncover it. Turns out there was no bug; but I kept the test case (and the "fix" for the bug - a slight refactor and optimization of the limiting algorithm) because it provides heretofore-absent coverage. (Since allocation requests are returned in nondeterministic order, it would be nearly impossible to write a functional test to ensure that the provider summaries are always trimmed correctly.)  
__label__objective Refactor: separate limiting GET /a_c results  This patch reduces the complexity of AllocationCandidates._get_by_requests by factoring out the piece that applies a limit to the results.  In the process of inspecting this code, I noticed what I thought was a bug, so I wrote a test to uncover it. Turns out there was no bug; but I kept the test case (and the "fix" for the bug - a slight refactor and optimization of the limiting algorithm) because it provides heretofore-absent coverage. (Since allocation requests are returned in nondeterministic order, it would be nearly impossible to write a functional test to ensure that the provider summaries are always trimmed correctly.)  
__label__testing Refactor allocation checking in functional tests  Factor out common allocation checking code in the functional test cases and make them nested provider tree aware. This prepare the ServerMovingTests class to be re-used in a nested RP tree and nested allocation environment.  
__label__quality Refactor allocation checking in functional tests  Factor out common allocation checking code in the functional test cases and make them nested provider tree aware. This prepare the ServerMovingTests class to be re-used in a nested RP tree and nested allocation environment.  
__label__objective Refactor allocation checking in functional tests  Factor out common allocation checking code in the functional test cases and make them nested provider tree aware. This prepare the ServerMovingTests class to be re-used in a nested RP tree and nested allocation environment.  
__label__testing refactor: Clean up jsonpath_replace method  This patch set cleans up jsonpath_replace method to increase its readability. Currently, there is some weird legacy code in there which doesn't make much sense and is most likely dead code. In fact, before this change, there was no unit test for validating that `MissingDocumentPattern` is raised correctly.  The `jsonpath_replace` is refactored to only call the inner private function _do_replace once, after performing data expansion (populating the data dictionary with nonexistent nested keys).  Unit tests have been added to validate the exception above.  
__label__objective refactor: Clean up jsonpath_replace method  This patch set cleans up jsonpath_replace method to increase its readability. Currently, there is some weird legacy code in there which doesn't make much sense and is most likely dead code. In fact, before this change, there was no unit test for validating that `MissingDocumentPattern` is raised correctly.  The `jsonpath_replace` is refactored to only call the inner private function _do_replace once, after performing data expansion (populating the data dictionary with nonexistent nested keys).  Unit tests have been added to validate the exception above.  
__label__quality refactor: Clean up jsonpath_replace method  This patch set cleans up jsonpath_replace method to increase its readability. Currently, there is some weird legacy code in there which doesn't make much sense and is most likely dead code. In fact, before this change, there was no unit test for validating that `MissingDocumentPattern` is raised correctly.  The `jsonpath_replace` is refactored to only call the inner private function _do_replace once, after performing data expansion (populating the data dictionary with nonexistent nested keys).  Unit tests have been added to validate the exception above.  
__label__testing [WIP] Validation refactor This PS removes the unnecessary validation call in update_manifests since the validation call already happens in pre_flight_ops.  Added exception handling in pre_flight_ops.  Also validate_armada_documents now throws the exception InvalidManifestException accordingly. Added exception handling in _validate_documents (test.py).  Introduced ArmadaNegativeHandlerTestCase class in test_armada.py, along with updating unit tests in test_validate.py, test_override.py, test_manifest.py.  Updated test_update_manifests_invalid to test something more meaningful because previously a non-existing yaml was passed into Override resulting in the override to be None.  
__label__objective [WIP] Validation refactor This PS removes the unnecessary validation call in update_manifests since the validation call already happens in pre_flight_ops.  Added exception handling in pre_flight_ops.  Also validate_armada_documents now throws the exception InvalidManifestException accordingly. Added exception handling in _validate_documents (test.py).  Introduced ArmadaNegativeHandlerTestCase class in test_armada.py, along with updating unit tests in test_validate.py, test_override.py, test_manifest.py.  Updated test_update_manifests_invalid to test something more meaningful because previously a non-existing yaml was passed into Override resulting in the override to be None.  
__label__testing Refactor AllocationFixture in placement test  This patch refactors the allocation fixture used in some placement api tests by substituting common functions in test_base.py for the existing object management functions.  
__label__objective Refactor AllocationFixture in placement test  This patch refactors the allocation fixture used in some placement api tests by substituting common functions in test_base.py for the existing object management functions.  
__label__quality Refactor AllocationFixture in placement test  This patch refactors the allocation fixture used in some placement api tests by substituting common functions in test_base.py for the existing object management functions.  
__label__testing move some project list tests to static (part 1)  This is part 1 of 2 commits to use existing credentials to execute part 1 aims to move the following tests:   * test_list_projects   * test_list_projects_with_name so that users with a cloud using the pre-provisioned credential provider can execute these tests. Part 2 will refactor.  The other tests cannot be moved because they require resources to be created explained below:   * test_list_projects_with_parent     - if this test requires a project with a parent then we cannot       use pre-provisioned credentials because there is no way to       provide an account with a parent using the current       implementation of the pre-provisioned credential provider.   * test_list_projects_with_enabled     - if this test requires projects that are disabled then we       cannot use pre-provisioned credentials because there is no       way to provide an account that is disabled with the current       implementation of the pre-provisioned credential provider.  
__label__objective move some project list tests to static (part 1)  This is part 1 of 2 commits to use existing credentials to execute part 1 aims to move the following tests:   * test_list_projects   * test_list_projects_with_name so that users with a cloud using the pre-provisioned credential provider can execute these tests. Part 2 will refactor.  The other tests cannot be moved because they require resources to be created explained below:   * test_list_projects_with_parent     - if this test requires a project with a parent then we cannot       use pre-provisioned credentials because there is no way to       provide an account with a parent using the current       implementation of the pre-provisioned credential provider.   * test_list_projects_with_enabled     - if this test requires projects that are disabled then we       cannot use pre-provisioned credentials because there is no       way to provide an account that is disabled with the current       implementation of the pre-provisioned credential provider.  
__label__integration refactor top-level pkg to vmware_nsx_tempest_plugin  This patch refactors the source and supporting files to use the top level package name of vmware_nsx_tempest_plugin. This better matches the project name as well as the name we plan to publish to PYPI with as per the discussion in [1].  A sample release has been published to the test pypi repo [2] to ensure this works.  [1] https://review.openstack.org/#/c/584498/ [2] https://test.pypi.org/project/vmware-nsx-tempest-plugin/  
__label__objective refactor top-level pkg to vmware_nsx_tempest_plugin  This patch refactors the source and supporting files to use the top level package name of vmware_nsx_tempest_plugin. This better matches the project name as well as the name we plan to publish to PYPI with as per the discussion in [1].  A sample release has been published to the test pypi repo [2] to ensure this works.  [1] https://review.openstack.org/#/c/584498/ [2] https://test.pypi.org/project/vmware-nsx-tempest-plugin/  
__label__integration Refactor DVR HA migarations DB operations  when a router is migrated from/to HA, router interface device_owner in DB is updated in the AFTER_UPDATE event handler. Because of this we see StaleDataError Trace as described in the bug report. Instead, we follow DVR approach and update it in PRECOMMIT_UPDATE handler, which only does DB changes. Here we update device_owner only between legacy and HA router modes as migration involving DVR is already handled in DVR code.  Also update distributed flag after all DB operations. Otherwise existing code may affect router unbinding during retry as distributed flag already updated before retry.  Testing is covered with scenario tempest test i.e DVR HA migrations tests from gate job "legacy-tempest-dsvm-neutron-dvr-multinode-scenario".  Closes-Bug: 1715163 
__label__testing Refactor DVR HA migarations DB operations  when a router is migrated from/to HA, router interface device_owner in DB is updated in the AFTER_UPDATE event handler. Because of this we see StaleDataError Trace as described in the bug report. Instead, we follow DVR approach and update it in PRECOMMIT_UPDATE handler, which only does DB changes. Here we update device_owner only between legacy and HA router modes as migration involving DVR is already handled in DVR code.  Also update distributed flag after all DB operations. Otherwise existing code may affect router unbinding during retry as distributed flag already updated before retry.  Testing is covered with scenario tempest test i.e DVR HA migrations tests from gate job "legacy-tempest-dsvm-neutron-dvr-multinode-scenario".  Closes-Bug: 1715163 
__label__objective Refactor DVR HA migarations DB operations  when a router is migrated from/to HA, router interface device_owner in DB is updated in the AFTER_UPDATE event handler. Because of this we see StaleDataError Trace as described in the bug report. Instead, we follow DVR approach and update it in PRECOMMIT_UPDATE handler, which only does DB changes. Here we update device_owner only between legacy and HA router modes as migration involving DVR is already handled in DVR code.  Also update distributed flag after all DB operations. Otherwise existing code may affect router unbinding during retry as distributed flag already updated before retry.  Testing is covered with scenario tempest test i.e DVR HA migrations tests from gate job "legacy-tempest-dsvm-neutron-dvr-multinode-scenario".  Closes-Bug: 1715163 
__label__testing Refactor imports to support loading dags for tests  Updates the imports for the dags and operators to support both "as deployed" and "as tested" package configurations. This allows for a simple test to be added that at least imorts and checks the dags to ensure they contain steps.  A future refactor may eliminate the need for some/much of this by moving the operators away from the plugin appraoch such that they can be statically built into the airflow pod and used like a third party library instead of being appended to the airflow plugins. For now though, this maintains the status quo for the way these are used in a deployed way.  
__label__quality Refactor imports to support loading dags for tests  Updates the imports for the dags and operators to support both "as deployed" and "as tested" package configurations. This allows for a simple test to be added that at least imorts and checks the dags to ensure they contain steps.  A future refactor may eliminate the need for some/much of this by moving the operators away from the plugin appraoch such that they can be statically built into the airflow pod and used like a third party library instead of being appended to the airflow plugins. For now though, this maintains the status quo for the way these are used in a deployed way.  
__label__objective Refactor imports to support loading dags for tests  Updates the imports for the dags and operators to support both "as deployed" and "as tested" package configurations. This allows for a simple test to be added that at least imorts and checks the dags to ensure they contain steps.  A future refactor may eliminate the need for some/much of this by moving the operators away from the plugin appraoch such that they can be statically built into the airflow pod and used like a third party library instead of being appended to the airflow plugins. For now though, this maintains the status quo for the way these are used in a deployed way.  
__label__testing refactor: Combine nearly duplicate group tests together  This patchset combines test_group_update_with_few_fields with test_group_create_update_get since the first one is almost the exact same as the update scenario in the second test.  test_group_update_with_few_fields just updates 1 field and checks whether the other fields remain unchanged. This is a unique test case that is very niche and so shouldn't really be its own test case. It can be combined with test_group_create_update_get.  Also this patchset adds better comments and also adds assertions for checking that the domain_id of the group is correct.  
__label__quality refactor: Combine nearly duplicate group tests together  This patchset combines test_group_update_with_few_fields with test_group_create_update_get since the first one is almost the exact same as the update scenario in the second test.  test_group_update_with_few_fields just updates 1 field and checks whether the other fields remain unchanged. This is a unique test case that is very niche and so shouldn't really be its own test case. It can be combined with test_group_create_update_get.  Also this patchset adds better comments and also adds assertions for checking that the domain_id of the group is correct.  
__label__objective refactor: Combine nearly duplicate group tests together  This patchset combines test_group_update_with_few_fields with test_group_create_update_get since the first one is almost the exact same as the update scenario in the second test.  test_group_update_with_few_fields just updates 1 field and checks whether the other fields remain unchanged. This is a unique test case that is very niche and so shouldn't really be its own test case. It can be combined with test_group_create_update_get.  Also this patchset adds better comments and also adds assertions for checking that the domain_id of the group is correct.  
__label__testing refactor: Add setup_test_group to identity admin base test class  This patchset adds a setup_test_group helper to identity admin base test class which is similar to other methods like setup_test_user to cut down on cookie cutter create/addCleanup code throughout tests that create groups. Note that this is an instance level method so class level group creation isn't refactored.  
__label__objective refactor: Add setup_test_group to identity admin base test class  This patchset adds a setup_test_group helper to identity admin base test class which is similar to other methods like setup_test_user to cut down on cookie cutter create/addCleanup code throughout tests that create groups. Note that this is an instance level method so class level group creation isn't refactored.  
__label__testing Refactor wait_for_scrubber_shutdown function  The wait_for_scrubber_shutdown function catches AssertionErrors and retries.  Refactor it so that it only retries for a specific error (namely, when glance scrubber is running in daemon mode when the test is being executed) by changing the function so that it returns values instead of relying on test assertions in the function passed to it.  Also refactor the tests that call wait_for_scrubber_shutdown so that they check the returned results instead of using assertions in the function they pass to wait_for_scrubber_shutdown.  This is a follow-up to https://review.openstack.org/#/c/566681/  
__label__objective Refactor wait_for_scrubber_shutdown function  The wait_for_scrubber_shutdown function catches AssertionErrors and retries.  Refactor it so that it only retries for a specific error (namely, when glance scrubber is running in daemon mode when the test is being executed) by changing the function so that it returns values instead of relying on test assertions in the function passed to it.  Also refactor the tests that call wait_for_scrubber_shutdown so that they check the returned results instead of using assertions in the function they pass to wait_for_scrubber_shutdown.  This is a follow-up to https://review.openstack.org/#/c/566681/  
__label__testing [refactor] logging refactor + redaction filter  Refactors the uwsgi-based logging filter to encapsulate better and adds a redaction filter for api logging.  This change now also includes bringing a stray test back into the correct location.  
__label__objective [refactor] logging refactor + redaction filter  Refactors the uwsgi-based logging filter to encapsulate better and adds a redaction filter for api logging.  This change now also includes bringing a stray test back into the correct location.  
__label__integration [refactor] logging refactor + redaction filter  Refactors the uwsgi-based logging filter to encapsulate better and adds a redaction filter for api logging.  This change now also includes bringing a stray test back into the correct location.  
__label__testing Refactoring, test infrastructure changes and cleanup  ...in preparation for the container sharding feature.  
__label__objective Refactoring, test infrastructure changes and cleanup  ...in preparation for the container sharding feature.  
__label__testing Refactor functions out of ProcessTemplateAction  This needs to be common utility code for the next change in this series, and breaking them out allows the test coverage to be improved.  
__label__objective Refactor functions out of ProcessTemplateAction  This needs to be common utility code for the next change in this series, and breaking them out allows the test coverage to be improved.  
__label__testing [WIP] ServerActionsSampleJsonTest refactor  Change the instance action content to a real world action.  In Setup, we create an instance and then stop it. That would be 2 actions(create and stop), and the stop action should have a "compute_stop_instance" event. And then we do 2.1/2.21/2.51 test case based on these actions, like we have done in 2.58.  
__label__objective [WIP] ServerActionsSampleJsonTest refactor  Change the instance action content to a real world action.  In Setup, we create an instance and then stop it. That would be 2 actions(create and stop), and the stop action should have a "compute_stop_instance" event. And then we do 2.1/2.21/2.51 test case based on these actions, like we have done in 2.58.  
__label__testing Refactor a test method including 3 test cases  The test_swap_volume_volume_api_usage method in test_compute_mgr.py has 3 test cases (1 normal, 2 errors). So devide it to the following 3 test methods.  * test_swap_volume_volume_api_usage * test_swap_volume_with_compute_driver_exception * test_swap_volume_with_initialize_connection_exception  
__label__objective Refactor a test method including 3 test cases  The test_swap_volume_volume_api_usage method in test_compute_mgr.py has 3 test cases (1 normal, 2 errors). So devide it to the following 3 test methods.  * test_swap_volume_volume_api_usage * test_swap_volume_with_compute_driver_exception * test_swap_volume_with_initialize_connection_exception  
__label__testing [WIP]Refactor scrubber functional test  Refactor scrubber functional test to remove the dependence on Glance V1 and Glance registry  
__label__objective [WIP]Refactor scrubber functional test  Refactor scrubber functional test to remove the dependence on Glance V1 and Glance registry  
__label__quality [WIP]Refactor scrubber functional test  Refactor scrubber functional test to remove the dependence on Glance V1 and Glance registry  
__label__testing Refactor background in-service start host services handling  The maintenance add_handler fsm loads inventory and recovers host state over a process restart. If the active controller's uptime is less than 15 minutes the restart event is treated as a Dead Office Recovery (DOR) and is more forgiving to host recovery by scheduling the 'start host services' as a background operation so as to not hold up the add operation.  The current implementation of the background handling of 'start host services' is not handling the AIO subfunction case properly in DOR mode as well as being difficult to follow and therfore fix and maintain. This miss handling leads to maintenance incorrectly failing the node with a subfunction configuration error over the DOR case.  This update refactors the background handling of 'start host services' to fix the issue and improve its clearity and maintainability.  Test Cases:  PASS: Verify AIO DX DOR handling PASS: Verify AIO DX active controller reboot handling       - standby with uptime ; < 15 min and > 15 min PASS: Verify AIO DX standby controller reboot handling PASS: Verify subfunction configuration error handling  Regression:  PASS: Verify start host services wait/retry handling. PASS: Verify start host services failure handling. PASS: Verify DOR of Standard system PASS: Verify DOR of AIO Plus system PASS: Verify AIO System Install PASS: Verify Standard System Install PASS: Verify AIO plus system install  
__label__quality Refactor background in-service start host services handling  The maintenance add_handler fsm loads inventory and recovers host state over a process restart. If the active controller's uptime is less than 15 minutes the restart event is treated as a Dead Office Recovery (DOR) and is more forgiving to host recovery by scheduling the 'start host services' as a background operation so as to not hold up the add operation.  The current implementation of the background handling of 'start host services' is not handling the AIO subfunction case properly in DOR mode as well as being difficult to follow and therfore fix and maintain. This miss handling leads to maintenance incorrectly failing the node with a subfunction configuration error over the DOR case.  This update refactors the background handling of 'start host services' to fix the issue and improve its clearity and maintainability.  Test Cases:  PASS: Verify AIO DX DOR handling PASS: Verify AIO DX active controller reboot handling       - standby with uptime ; < 15 min and > 15 min PASS: Verify AIO DX standby controller reboot handling PASS: Verify subfunction configuration error handling  Regression:  PASS: Verify start host services wait/retry handling. PASS: Verify start host services failure handling. PASS: Verify DOR of Standard system PASS: Verify DOR of AIO Plus system PASS: Verify AIO System Install PASS: Verify Standard System Install PASS: Verify AIO plus system install  
__label__objective Refactor background in-service start host services handling  The maintenance add_handler fsm loads inventory and recovers host state over a process restart. If the active controller's uptime is less than 15 minutes the restart event is treated as a Dead Office Recovery (DOR) and is more forgiving to host recovery by scheduling the 'start host services' as a background operation so as to not hold up the add operation.  The current implementation of the background handling of 'start host services' is not handling the AIO subfunction case properly in DOR mode as well as being difficult to follow and therfore fix and maintain. This miss handling leads to maintenance incorrectly failing the node with a subfunction configuration error over the DOR case.  This update refactors the background handling of 'start host services' to fix the issue and improve its clearity and maintainability.  Test Cases:  PASS: Verify AIO DX DOR handling PASS: Verify AIO DX active controller reboot handling       - standby with uptime ; < 15 min and > 15 min PASS: Verify AIO DX standby controller reboot handling PASS: Verify subfunction configuration error handling  Regression:  PASS: Verify start host services wait/retry handling. PASS: Verify start host services failure handling. PASS: Verify DOR of Standard system PASS: Verify DOR of AIO Plus system PASS: Verify AIO System Install PASS: Verify Standard System Install PASS: Verify AIO plus system install  
__label__testing Finish refactoring self.*_api out of tests  A previous change started remove the self magic:    Ic2094dca56158d8e4cd843eadff837f3a17ea38f  This commit finishes that work. A subsequent patch will remove the self manager logic all together and we'll fix up any trivial test infrastructure then.  
__label__objective Finish refactoring self.*_api out of tests  A previous change started remove the self magic:    Ic2094dca56158d8e4cd843eadff837f3a17ea38f  This commit finishes that work. A subsequent patch will remove the self manager logic all together and we'll fix up any trivial test infrastructure then.  
__label__integration Refactor self.*_api out of tests  Just like the APIs in keystone, we should be using the `keystone.common.provider_api.ProviderAPIs` to load managers instead of self.  This makes those changes for a few of the test modules. Finding occurrences can be done with `grep -R 'self.*_api' keystone/tests/`.  
__label__testing Refactor self.*_api out of tests  Just like the APIs in keystone, we should be using the `keystone.common.provider_api.ProviderAPIs` to load managers instead of self.  This makes those changes for a few of the test modules. Finding occurrences can be done with `grep -R 'self.*_api' keystone/tests/`.  
__label__testing Refactor reconstructor probe tests  Refactor the reconstructor probe test to share common setup and helper methods.  
__label__objective Refactor reconstructor probe tests  Refactor the reconstructor probe test to share common setup and helper methods.  
__label__quality Refactor reconstructor probe tests  Refactor the reconstructor probe test to share common setup and helper methods.  
__label__testing Refactor unit test to set up config fixture in setup class  
__label__testing Refactor unit tests for server network  * Consolidate unit test fake_interface to one global.    Instead of three implementations of the fake_interface. Use    one shared globally defined implementation. * Use create_old_net() instead of just writing the dict. * Adds the subnet_id property in fixed_ips of fake interfaces. * Use 'network' instead of deprecated 'uuid'  Related-Bug: #1696483 
__label__quality Refactor unit tests for server network  * Consolidate unit test fake_interface to one global.    Instead of three implementations of the fake_interface. Use    one shared globally defined implementation. * Use create_old_net() instead of just writing the dict. * Adds the subnet_id property in fixed_ips of fake interfaces. * Use 'network' instead of deprecated 'uuid'  Related-Bug: #1696483 
__label__objective Refactor unit tests for server network  * Consolidate unit test fake_interface to one global.    Instead of three implementations of the fake_interface. Use    one shared globally defined implementation. * Use create_old_net() instead of just writing the dict. * Adds the subnet_id property in fixed_ips of fake interfaces. * Use 'network' instead of deprecated 'uuid'  Related-Bug: #1696483 
__label__testing Refactor test_apps.py  The fullstack test file test_apps.py has become too big to maintain. This patch breaks it up into smaller, application-specifi chunks.  
__label__quality Refactor test_apps.py  The fullstack test file test_apps.py has become too big to maintain. This patch breaks it up into smaller, application-specifi chunks.  
__label__objective Refactor test_apps.py  The fullstack test file test_apps.py has become too big to maintain. This patch breaks it up into smaller, application-specifi chunks.  
__label__testing Refactor test_allocation_candidates  For the sake of code deduplication, LOC reduction, and readability (improved signal:noise ratio), this change set implements some convenience methods in AllocationCandidatesTestCase for creation of placement artifacts such as resource providers, inventory, and allocations, as well as for extracting and comparing results of get_allocation_candidates.  This only changes test code; and is just a refactor - no tests are added, removed, or substantively changed.  
__label__quality Refactor test_allocation_candidates  For the sake of code deduplication, LOC reduction, and readability (improved signal:noise ratio), this change set implements some convenience methods in AllocationCandidatesTestCase for creation of placement artifacts such as resource providers, inventory, and allocations, as well as for extracting and comparing results of get_allocation_candidates.  This only changes test code; and is just a refactor - no tests are added, removed, or substantively changed.  
__label__objective Refactor test_allocation_candidates  For the sake of code deduplication, LOC reduction, and readability (improved signal:noise ratio), this change set implements some convenience methods in AllocationCandidatesTestCase for creation of placement artifacts such as resource providers, inventory, and allocations, as well as for extracting and comparing results of get_allocation_candidates.  This only changes test code; and is just a refactor - no tests are added, removed, or substantively changed.  
__label__testing Refactor processing of track and admin commands  Separate the processing of track commands and admin commands into separate files, and normalize handling of messages.  Adjust test cases so that they match the new normalized messages.  
__label__objective Refactor processing of track and admin commands  Separate the processing of track commands and admin commands into separate files, and normalize handling of messages.  Adjust test cases so that they match the new normalized messages.  
__label__quality Refactor processing of track and admin commands  Separate the processing of track commands and admin commands into separate files, and normalize handling of messages.  Adjust test cases so that they match the new normalized messages.  
__label__testing Refactor test_backend_ldap tests  Currently, the testing backend for LDAP relies on multiple inheritance of many base and testing classes, which results in many of these tests being ran multiple times needlessly. This change puts the LDAPIdentity class, which is used by multiple other test cases into its own subclass in order that the testing framework will not run it on its own.  
__label__quality Refactor test_backend_ldap tests  Currently, the testing backend for LDAP relies on multiple inheritance of many base and testing classes, which results in many of these tests being ran multiple times needlessly. This change puts the LDAPIdentity class, which is used by multiple other test cases into its own subclass in order that the testing framework will not run it on its own.  
__label__objective Refactor test_backend_ldap tests  Currently, the testing backend for LDAP relies on multiple inheritance of many base and testing classes, which results in many of these tests being ran multiple times needlessly. This change puts the LDAPIdentity class, which is used by multiple other test cases into its own subclass in order that the testing framework will not run it on its own.  
__label__testing Refactor usage of RabbitMQ resources  This patch refactors all creation of RabbitMQ resources such as users and ACLs to a define called openstack_integration::mq_user.  This will make sure RabbitMQ is automatically installed as well, as there are times where dependencies to RabbitMQ are added to things like Keystone which break Beaker tests in other repos (but we don't know they're broken until the change merges).  In addition, instead of setting up dependencies on the tagged services, we use the anchors provided which should hopefully test against them as well.  
__label__integration Refactor usage of RabbitMQ resources  This patch refactors all creation of RabbitMQ resources such as users and ACLs to a define called openstack_integration::mq_user.  This will make sure RabbitMQ is automatically installed as well, as there are times where dependencies to RabbitMQ are added to things like Keystone which break Beaker tests in other repos (but we don't know they're broken until the change merges).  In addition, instead of setting up dependencies on the tagged services, we use the anchors provided which should hopefully test against them as well.  
__label__objective Refactor usage of RabbitMQ resources  This patch refactors all creation of RabbitMQ resources such as users and ACLs to a define called openstack_integration::mq_user.  This will make sure RabbitMQ is automatically installed as well, as there are times where dependencies to RabbitMQ are added to things like Keystone which break Beaker tests in other repos (but we don't know they're broken until the change merges).  In addition, instead of setting up dependencies on the tagged services, we use the anchors provided which should hopefully test against them as well.  
__label__testing API test refactoring about create_project  There are some calls to create project in API tests. This patch prepares create_project method so that the tests use.  
__label__objective API test refactoring about create_project  There are some calls to create project in API tests. This patch prepares create_project method so that the tests use.  
__label__testing placement: refactor healing of allocations in RT  Updates the RT method for "healing" instance allocations so that we only delete allocations (and delete the entirely for an instance) in the event that the instance has been SHELVED_OFFLOADED or DELETED. Adds log statements to the method to give us a good idea of what the state of various things are during test runs.  Note that this patch only partially fixes LP #1707071 to remove some of the back-and-forth allocation trampling that was going on for move operations. The next patch adds the final piece of the puzzle which is to have the confirm/revert resize step on the source or destination compute host *correct* a doubled-up allocation. What this patch does is prevent the healing function from deleting allocations unless the instance is deleted or shelved-offloaded.  Partial-bug: #1707071  
__label__integration placement: refactor healing of allocations in RT  Updates the RT method for "healing" instance allocations so that we only delete allocations (and delete the entirely for an instance) in the event that the instance has been SHELVED_OFFLOADED or DELETED. Adds log statements to the method to give us a good idea of what the state of various things are during test runs.  Note that this patch only partially fixes LP #1707071 to remove some of the back-and-forth allocation trampling that was going on for move operations. The next patch adds the final piece of the puzzle which is to have the confirm/revert resize step on the source or destination compute host *correct* a doubled-up allocation. What this patch does is prevent the healing function from deleting allocations unless the instance is deleted or shelved-offloaded.  Partial-bug: #1707071  
__label__objective placement: refactor healing of allocations in RT  Updates the RT method for "healing" instance allocations so that we only delete allocations (and delete the entirely for an instance) in the event that the instance has been SHELVED_OFFLOADED or DELETED. Adds log statements to the method to give us a good idea of what the state of various things are during test runs.  Note that this patch only partially fixes LP #1707071 to remove some of the back-and-forth allocation trampling that was going on for move operations. The next patch adds the final piece of the puzzle which is to have the confirm/revert resize step on the source or destination compute host *correct* a doubled-up allocation. What this patch does is prevent the healing function from deleting allocations unless the instance is deleted or shelved-offloaded.  Partial-bug: #1707071  
__label__integration [Refactor code] Support dynamic load Client module depend on given version  - Support dynamic load Client module depend on given version. At this time,   Zunclient has only 1 version, but this patch will be useful in the future. - Change related test cases. - Remove hardcode version.  
__label__testing [Refactor code] Support dynamic load Client module depend on given version  - Support dynamic load Client module depend on given version. At this time,   Zunclient has only 1 version, but this patch will be useful in the future. - Change related test cases. - Remove hardcode version.  
__label__testing Refactor/Refine the core automated vPC code  The main objective of this changeset is to refactor and refine the large method which is core to Nexus automated port channel creation. While refactoring, I found that we can also generate the action 'switchport mode trunk' without regard to whether it is a port channel interface or ethernet.  Also added to this changeset are failure test cases for the refactored/refined method.  
__label__quality Refactor/Refine the core automated vPC code  The main objective of this changeset is to refactor and refine the large method which is core to Nexus automated port channel creation. While refactoring, I found that we can also generate the action 'switchport mode trunk' without regard to whether it is a port channel interface or ethernet.  Also added to this changeset are failure test cases for the refactored/refined method.  
__label__objective Refactor/Refine the core automated vPC code  The main objective of this changeset is to refactor and refine the large method which is core to Nexus automated port channel creation. While refactoring, I found that we can also generate the action 'switchport mode trunk' without regard to whether it is a port channel interface or ethernet.  Also added to this changeset are failure test cases for the refactored/refined method.  
__label__testing Refactor test_user_update  test_user_update looks a little mess and not easy to distinguish the test steps from the continuous lines, so this is to refactor it to make it more readable.  
__label__quality Refactor test_user_update  test_user_update looks a little mess and not easy to distinguish the test steps from the continuous lines, so this is to refactor it to make it more readable.  
__label__objective Refactor test_user_update  test_user_update looks a little mess and not easy to distinguish the test steps from the continuous lines, so this is to refactor it to make it more readable.  
__label__testing Create rbac utils fixture and refactor tests  This commit creates a test fixture for rbac_utils.RbacUtils and refactors test_rbac_utils tests accordingly. This allows other tests to use the fixture as needed, improving code maintenance and readability, as well as the ease with which tests can be written.  Specifically:   - adds fixtures file for overriding conf settings and     for rbac_utils.RbacUtils   - refactors rbac_utils tests to use the appropriate     fixture  
__label__quality Create rbac utils fixture and refactor tests  This commit creates a test fixture for rbac_utils.RbacUtils and refactors test_rbac_utils tests accordingly. This allows other tests to use the fixture as needed, improving code maintenance and readability, as well as the ease with which tests can be written.  Specifically:   - adds fixtures file for overriding conf settings and     for rbac_utils.RbacUtils   - refactors rbac_utils tests to use the appropriate     fixture  
__label__objective Create rbac utils fixture and refactor tests  This commit creates a test fixture for rbac_utils.RbacUtils and refactors test_rbac_utils tests accordingly. This allows other tests to use the fixture as needed, improving code maintenance and readability, as well as the ease with which tests can be written.  Specifically:   - adds fixtures file for overriding conf settings and     for rbac_utils.RbacUtils   - refactors rbac_utils tests to use the appropriate     fixture  
__label__testing Refactor quota related unit tests  openstack_dashboard/dashboards/project/floating_ips/tests.py: The floating IP panel implementation calls openstack_dashboard.usage.quotas.tenant_quota_usages, but its unit test mocks functions called inside tenant_quota_usages. tenant_quota_usages itself should be mocked.  openstack_dashboard/test/unit/usage/test_quotas.py: Mocked methods were not verified test_tenant_quota_usages_non_legacy. Verifications for called methods are added. Mocking floating_ip_supported is dropped as it is not called and there is no need to mock it.  
__label__objective Refactor quota related unit tests  openstack_dashboard/dashboards/project/floating_ips/tests.py: The floating IP panel implementation calls openstack_dashboard.usage.quotas.tenant_quota_usages, but its unit test mocks functions called inside tenant_quota_usages. tenant_quota_usages itself should be mocked.  openstack_dashboard/test/unit/usage/test_quotas.py: Mocked methods were not verified test_tenant_quota_usages_non_legacy. Verifications for called methods are added. Mocking floating_ip_supported is dropped as it is not called and there is no need to mock it.  
__label__objective Refactor quota related unit tests  openstack_dashboard/dashboards/project/floating_ips/tests.py: The floating IP panel implementation calls openstack_dashboard.usage.quotas.tenant_quota_usages, but its unit test mocks functions called inside tenant_quota_usages. tenant_quota_usages itself should be mocked.  openstack_dashboard/test/unit/usage/test_quotas.py: Mocked methods were not verified test_tenant_quota_usages_non_legacy. Verifications for called methods are added. Mocking floating_ip_supported is dropped as it is not called and there is no need to mock it.  
__label__testing Refactor volume mock urls in identity_common tests  The large set of copy-pasta test urls make it hard to follow what is being mocked and what should be returned. Put in a class to manage it with clearly named things.  This exposes a bug, but fixing the bug is hairy. Comment out that bit with a note to fix it. The fix comes in the next patch, but is hopefully clearer to read with the test refactor decoupled.  
__label__quality Refactor volume mock urls in identity_common tests  The large set of copy-pasta test urls make it hard to follow what is being mocked and what should be returned. Put in a class to manage it with clearly named things.  This exposes a bug, but fixing the bug is hairy. Comment out that bit with a note to fix it. The fix comes in the next patch, but is hopefully clearer to read with the test refactor decoupled.  
__label__objective Refactor volume mock urls in identity_common tests  The large set of copy-pasta test urls make it hard to follow what is being mocked and what should be returned. Put in a class to manage it with clearly named things.  This exposes a bug, but fixing the bug is hairy. Comment out that bit with a note to fix it. The fix comes in the next patch, but is hopefully clearer to read with the test refactor decoupled.  
__label__objective Refactor volume mock urls in identity_common tests  The large set of copy-pasta test urls make it hard to follow what is being mocked and what should be returned. Put in a class to manage it with clearly named things.  This exposes a bug, but fixing the bug is hairy. Comment out that bit with a note to fix it. The fix comes in the next patch, but is hopefully clearer to read with the test refactor decoupled.  
__label__testing Refactor a test method including 7 test cases  The test_swap_volume_volume_api_usage method in test_compute_api.py has 7 test cases (1 normal, 6 errors). So devide it to the following 7 test methods.  * test_swap_volume_volume_api_usage * test_swap_volume_with_invalid_server_state * test_swap_volume_with_old_volume_not_attached * test_swap_volume_with_another_server_volume * test_swap_volume_with_new_volume_attached * test_swap_volume_with_smaller_new_volume * test_swap_volume_with_swap_volume_error  
__label__objective Refactor a test method including 7 test cases  The test_swap_volume_volume_api_usage method in test_compute_api.py has 7 test cases (1 normal, 6 errors). So devide it to the following 7 test methods.  * test_swap_volume_volume_api_usage * test_swap_volume_with_invalid_server_state * test_swap_volume_with_old_volume_not_attached * test_swap_volume_with_another_server_volume * test_swap_volume_with_new_volume_attached * test_swap_volume_with_smaller_new_volume * test_swap_volume_with_swap_volume_error  
__label__testing Refactor glance image tests to use OpenStackSDK  This reduces the number of direct dependencies, and makes the tests more uniform.  Since glance was the only remaining test with the direct client references, the imports and code using the clients directly have been removed.  
__label__quality Refactor glance image tests to use OpenStackSDK  This reduces the number of direct dependencies, and makes the tests more uniform.  Since glance was the only remaining test with the direct client references, the imports and code using the clients directly have been removed.  
__label__objective Refactor glance image tests to use OpenStackSDK  This reduces the number of direct dependencies, and makes the tests more uniform.  Since glance was the only remaining test with the direct client references, the imports and code using the clients directly have been removed.  
__label__testing Refactor Keystone test to use OpenStackSDK  By using OpenStack SDK, the tests are more uniform, and we reduce the direct dependencies we have to install.  
__label__objective Refactor Keystone test to use OpenStackSDK  By using OpenStack SDK, the tests are more uniform, and we reduce the direct dependencies we have to install.  
__label__quality Refactor Keystone test to use OpenStackSDK  By using OpenStack SDK, the tests are more uniform, and we reduce the direct dependencies we have to install.  
__label__testing refactor testing directory layout  This changes the layout of the tests. Before both unit and functional tests were in the same place. That made it so development really needed to happen on linux because of tests like uptime needing /proc/uptime This change puts those kind of tests into a functional testing dir and adds a unit and functional test arg to tox.  
__label__objective refactor testing directory layout  This changes the layout of the tests. Before both unit and functional tests were in the same place. That made it so development really needed to happen on linux because of tests like uptime needing /proc/uptime This change puts those kind of tests into a functional testing dir and adds a unit and functional test arg to tox.  
__label__quality refactor testing directory layout  This changes the layout of the tests. Before both unit and functional tests were in the same place. That made it so development really needed to happen on linux because of tests like uptime needing /proc/uptime This change puts those kind of tests into a functional testing dir and adds a unit and functional test arg to tox.  
__label__quality Refactor code of linux_net to more cleaner and increase performace  The patch adds new functions '_get_phys_port_name' for reading physical port name of the SR-IOV port and '_get_phys_switch_id' for reading physical port switch ID of the SR-IOV port, in addition to refactoring 'get_representor_port' to use the new functions and decrease calls for "_get_pf_func" and netdevs associated with the PF will now be processed in the loop, however it will not be matching 'phys_port_name' which ensures the correct behaviour.  In addition to updating the unit test for linux_net and remove not needed mocks  Related-Bug: #1892132 
__label__objective Refactor code of linux_net to more cleaner and increase performace  The patch adds new functions '_get_phys_port_name' for reading physical port name of the SR-IOV port and '_get_phys_switch_id' for reading physical port switch ID of the SR-IOV port, in addition to refactoring 'get_representor_port' to use the new functions and decrease calls for "_get_pf_func" and netdevs associated with the PF will now be processed in the loop, however it will not be matching 'phys_port_name' which ensures the correct behaviour.  In addition to updating the unit test for linux_net and remove not needed mocks  Related-Bug: #1892132 
__label__testing Refactor share instances tempest test  Use ddt in share instances tempest test, and use list_share_instances instead of get_instances_of_share  TrivialFix 
__label__objective Refactor share instances tempest test  Use ddt in share instances tempest test, and use list_share_instances instead of get_instances_of_share  TrivialFix 
__label__testing Refactor a test method including 3 test cases  The test_swap_volume_volume_api_usage method in test_compute_mgr.py has 3 test cases (1 normal, 2 errors). So devide it to the following 3 test cases.  * test_swap_volume_volume_api_usage * test_swap_volume_with_compute_driver_exception * test_swap_volume_with_initialize_connection_exception  
__label__objective Refactor a test method including 3 test cases  The test_swap_volume_volume_api_usage method in test_compute_mgr.py has 3 test cases (1 normal, 2 errors). So devide it to the following 3 test cases.  * test_swap_volume_volume_api_usage * test_swap_volume_with_compute_driver_exception * test_swap_volume_with_initialize_connection_exception  
__label__testing Refactor unit test of cdh plugin  Refactor some testcases of CDH plugin, and also add some tests to increase unit test coverage.  
__label__objective Refactor unit test of cdh plugin  Refactor some testcases of CDH plugin, and also add some tests to increase unit test coverage.  
__label__testing Refactor Object Range Request Test  * Refactor all tests to correctly use   object generators for data-driven   tests.  
__label__objective Refactor Object Range Request Test  * Refactor all tests to correctly use   object generators for data-driven   tests.  
__label__testing Draft: TestObjController refactoring  From the related change of ECDuplication, Swift have a couple of Test classes for EC policy, normal EC and EC Duplication, in the test/unit/proxy/test_server.py. To enable the classes, the related change abstracts the EC test cases as the ECTestMixin class to gather test methods into one place but it was worse because TestObjController did still have both test cases for replication and for ec that may be hard to understand the test class structure.  Hence, this patch attempts to refactor the structure as  From:       ECTestMixin             |     ----------------------------------     |                                | TestObjController           TestObjControllerECDuplication (for replication and EC)    (for EC Duplication Policy)  To:      BaseTestObjController             |     ----------------------------------     |                                | TestObjController           BaseTestECObjController (for replication)                    |                           --------------------------                           |                        |                   TestECObjController       TestECDuplicationObjController                   (for EC policy)           (for EC Duplication Policy)  TODO: 1. Make sure we could set `unpatch_policies` for TestECObjController and   TestECDuplicationObjController rather than call `unpatch_policies` for   all methods (patch_policies for those classes is for the reason?) 2. If we could do the item 1, perhaps setting ec_policy as class variable   is better than that setting ec_policy_index and than retrieve the   policy in each test method.  Related-Change: Idd155401982a2c48110c30b480966a863f6bd305 
__label__objective Draft: TestObjController refactoring  From the related change of ECDuplication, Swift have a couple of Test classes for EC policy, normal EC and EC Duplication, in the test/unit/proxy/test_server.py. To enable the classes, the related change abstracts the EC test cases as the ECTestMixin class to gather test methods into one place but it was worse because TestObjController did still have both test cases for replication and for ec that may be hard to understand the test class structure.  Hence, this patch attempts to refactor the structure as  From:       ECTestMixin             |     ----------------------------------     |                                | TestObjController           TestObjControllerECDuplication (for replication and EC)    (for EC Duplication Policy)  To:      BaseTestObjController             |     ----------------------------------     |                                | TestObjController           BaseTestECObjController (for replication)                    |                           --------------------------                           |                        |                   TestECObjController       TestECDuplicationObjController                   (for EC policy)           (for EC Duplication Policy)  TODO: 1. Make sure we could set `unpatch_policies` for TestECObjController and   TestECDuplicationObjController rather than call `unpatch_policies` for   all methods (patch_policies for those classes is for the reason?) 2. If we could do the item 1, perhaps setting ec_policy as class variable   is better than that setting ec_policy_index and than retrieve the   policy in each test method.  Related-Change: Idd155401982a2c48110c30b480966a863f6bd305 
__label__quality Draft: TestObjController refactoring  From the related change of ECDuplication, Swift have a couple of Test classes for EC policy, normal EC and EC Duplication, in the test/unit/proxy/test_server.py. To enable the classes, the related change abstracts the EC test cases as the ECTestMixin class to gather test methods into one place but it was worse because TestObjController did still have both test cases for replication and for ec that may be hard to understand the test class structure.  Hence, this patch attempts to refactor the structure as  From:       ECTestMixin             |     ----------------------------------     |                                | TestObjController           TestObjControllerECDuplication (for replication and EC)    (for EC Duplication Policy)  To:      BaseTestObjController             |     ----------------------------------     |                                | TestObjController           BaseTestECObjController (for replication)                    |                           --------------------------                           |                        |                   TestECObjController       TestECDuplicationObjController                   (for EC policy)           (for EC Duplication Policy)  TODO: 1. Make sure we could set `unpatch_policies` for TestECObjController and   TestECDuplicationObjController rather than call `unpatch_policies` for   all methods (patch_policies for those classes is for the reason?) 2. If we could do the item 1, perhaps setting ec_policy as class variable   is better than that setting ec_policy_index and than retrieve the   policy in each test method.  Related-Change: Idd155401982a2c48110c30b480966a863f6bd305 
__label__testing Refactoring _create_test methods for OVO UTs  Most of the _create_test methods create a property and only uses its id during their execution.  This change pretends to simplify the returned data and reduce the number of lines used for the creation of test data used during the execution of Unit Tests for Oslo-Versioned Objects.  
__label__quality Refactoring _create_test methods for OVO UTs  Most of the _create_test methods create a property and only uses its id during their execution.  This change pretends to simplify the returned data and reduce the number of lines used for the creation of test data used during the execution of Unit Tests for Oslo-Versioned Objects.  
__label__objective Refactoring _create_test methods for OVO UTs  Most of the _create_test methods create a property and only uses its id during their execution.  This change pretends to simplify the returned data and reduce the number of lines used for the creation of test data used during the execution of Unit Tests for Oslo-Versioned Objects.  
__label__integration Refactor host specific kernel module tasks  Update the 'openstack_host_specific_kernel_modules' tasks so that they no longer need to skip ansible lint checking. The kernel configuration file is now slurped and searched through to find out if the provided list of modules are valid and loadable.  For testing, a 'openstack_host_specific_kernel_modules' test var and assertion has been added.  
__label__objective Refactor host specific kernel module tasks  Update the 'openstack_host_specific_kernel_modules' tasks so that they no longer need to skip ansible lint checking. The kernel configuration file is now slurped and searched through to find out if the provided list of modules are valid and loadable.  For testing, a 'openstack_host_specific_kernel_modules' test var and assertion has been added.  
__label__quality Move and refactor test_revoke_by_audit_chain_id  This patch moves test_revoke_by_audit_chain_id and refactors it to test the revocation backend instead of using a spoofed backend _matches.  
__label__objective Move and refactor test_revoke_by_audit_chain_id  This patch moves test_revoke_by_audit_chain_id and refactors it to test the revocation backend instead of using a spoofed backend _matches.  
__label__quality Move and refactor project_and_user_and_role  This patch moves test_by_project_and_user_and_role and refactors it to test the revocation backend instead of using a spoofed backend _matches.  
__label__objective Move and refactor project_and_user_and_role  This patch moves test_by_project_and_user_and_role and refactors it to test the revocation backend instead of using a spoofed backend _matches.  
__label__quality Move and refactor test_by_domain_domain  This patch moves test_by_domain_domain and refactors it to test the revocation backend instead of using a spoofed backend _matches.  
__label__objective Move and refactor test_by_domain_domain  This patch moves test_by_domain_domain and refactors it to test the revocation backend instead of using a spoofed backend _matches.  
__label__quality Move and refactor test_by_domain_project  This patch moves test_by_domain_project and refactors it to test the revocation backend instead of using a spoofed backend _matches.  
__label__objective Move and refactor test_by_domain_project  This patch moves test_by_domain_project and refactors it to test the revocation backend instead of using a spoofed backend _matches.  
__label__quality Move and refactor test_by_domain_user  This patch moves test_by_domain_user and refactors it to test the revocation backend instead of using a spoofed backend _matches.  
__label__objective Move and refactor test_by_domain_user  This patch moves test_by_domain_user and refactors it to test the revocation backend instead of using a spoofed backend _matches.  
__label__testing Refactor code for extra route and add fullstack test  Since there is unique key for router, it can apply to extra route too.  And cookie for extra route openflow rule can be removed, because router interface can't be deleted if there is extra route associated with it. The only way to delete an extra route is through router update, so the deletion doesn't need cookie to match flow.  
__label__objective Refactor code for extra route and add fullstack test  Since there is unique key for router, it can apply to extra route too.  And cookie for extra route openflow rule can be removed, because router interface can't be deleted if there is extra route associated with it. The only way to delete an extra route is through router update, so the deletion doesn't need cookie to match flow.  
__label__quality Refactor code for extra route and add fullstack test  Since there is unique key for router, it can apply to extra route too.  And cookie for extra route openflow rule can be removed, because router interface can't be deleted if there is extra route associated with it. The only way to delete an extra route is through router update, so the deletion doesn't need cookie to match flow.  
__label__integration [Tempest] Refactor api/tests/admin/test_share_servers module  Doing following things:  - Use ddt module removing code duplication.  - Use v2 APIs instead of deprecated v1.  - Use correct 'share_server_id' for    'test_show_share_server_details' test to avoid concurrency issues.    For more details, see closed b_u_g.  
__label__quality [Tempest] Refactor api/tests/admin/test_share_servers module  Doing following things:  - Use ddt module removing code duplication.  - Use v2 APIs instead of deprecated v1.  - Use correct 'share_server_id' for    'test_show_share_server_details' test to avoid concurrency issues.    For more details, see closed b_u_g.  
__label__testing [Tempest] Refactor api/tests/admin/test_share_servers module  Doing following things:  - Use ddt module removing code duplication.  - Use v2 APIs instead of deprecated v1.  - Use correct 'share_server_id' for    'test_show_share_server_details' test to avoid concurrency issues.    For more details, see closed b_u_g.  
__label__objective [Tempest] Refactor api/tests/admin/test_share_servers module  Doing following things:  - Use ddt module removing code duplication.  - Use v2 APIs instead of deprecated v1.  - Use correct 'share_server_id' for    'test_show_share_server_details' test to avoid concurrency issues.    For more details, see closed b_u_g.  
__label__testing Refactor ServerTests and ServerEventTests functional test classes  Move common bits into a compute.v2.common.ComputeTestCase class so they are available as needed without calling into other test classes.  
__label__objective Refactor ServerTests and ServerEventTests functional test classes  Move common bits into a compute.v2.common.ComputeTestCase class so they are available as needed without calling into other test classes.  
__label__testing Refactor base test classes inheritance for reuse  Refactor base test class inheritance to allow for BaseTest class to be reused without needing to also import the TestCase class everywhere in order to avoid having the common test function executed on base classes.  This makes it easier to build base testing classes and then simplifies the subclassing of these for actual tests.  
__label__quality Refactor base test classes inheritance for reuse  Refactor base test class inheritance to allow for BaseTest class to be reused without needing to also import the TestCase class everywhere in order to avoid having the common test function executed on base classes.  This makes it easier to build base testing classes and then simplifies the subclassing of these for actual tests.  
__label__objective Refactor base test classes inheritance for reuse  Refactor base test class inheritance to allow for BaseTest class to be reused without needing to also import the TestCase class everywhere in order to avoid having the common test function executed on base classes.  This makes it easier to build base testing classes and then simplifies the subclassing of these for actual tests.  
__label__testing Refactor driver.py testcase  Refactor unit test case for driver.py specially remove vm.CONF = mock.Mock() vm.CONF.host = "fake-mini" vm.CONF.dpm.physical_storage_adapter_mappings = "mapping" because it is overriding other testcase in other module.  Also remove test case for vm.py and host.py because when we are trying to write test case for other module then few variables are getting overrided. Anyways we need to change the testcase using zhmcclient_mock framework then that time any how we have to delete these test cases. So we are deleting now to not get conflict in other module.  
__label__objective Refactor driver.py testcase  Refactor unit test case for driver.py specially remove vm.CONF = mock.Mock() vm.CONF.host = "fake-mini" vm.CONF.dpm.physical_storage_adapter_mappings = "mapping" because it is overriding other testcase in other module.  Also remove test case for vm.py and host.py because when we are trying to write test case for other module then few variables are getting overrided. Anyways we need to change the testcase using zhmcclient_mock framework then that time any how we have to delete these test cases. So we are deleting now to not get conflict in other module.  
__label__quality Refactor driver.py testcase  Refactor unit test case for driver.py specially remove vm.CONF = mock.Mock() vm.CONF.host = "fake-mini" vm.CONF.dpm.physical_storage_adapter_mappings = "mapping" because it is overriding other testcase in other module.  Also remove test case for vm.py and host.py because when we are trying to write test case for other module then few variables are getting overrided. Anyways we need to change the testcase using zhmcclient_mock framework then that time any how we have to delete these test cases. So we are deleting now to not get conflict in other module.  
__label__integration [Tempest] Refactor api/tests/admin/test_share_servers module  Doing following things:  - Use ddt module removing code duplication.  - Use v2 APIs instead of deprecated v1.  - Use correct 'share_server_id' for    'test_show_share_server_details' test to avoid concurrency issues.    For more details, see closed b_u_g.  
__label__quality [Tempest] Refactor api/tests/admin/test_share_servers module  Doing following things:  - Use ddt module removing code duplication.  - Use v2 APIs instead of deprecated v1.  - Use correct 'share_server_id' for    'test_show_share_server_details' test to avoid concurrency issues.    For more details, see closed b_u_g.  
__label__testing [Tempest] Refactor api/tests/admin/test_share_servers module  Doing following things:  - Use ddt module removing code duplication.  - Use v2 APIs instead of deprecated v1.  - Use correct 'share_server_id' for    'test_show_share_server_details' test to avoid concurrency issues.    For more details, see closed b_u_g.  
__label__objective [Tempest] Refactor api/tests/admin/test_share_servers module  Doing following things:  - Use ddt module removing code duplication.  - Use v2 APIs instead of deprecated v1.  - Use correct 'share_server_id' for    'test_show_share_server_details' test to avoid concurrency issues.    For more details, see closed b_u_g.  
__label__testing refactor test_dependency_validations  refactor test_dependency_validations to create fake test data. As bonus, we fix data. {'id': <id>} should be returned for network data. not <network id>  
__label__objective refactor test_dependency_validations  refactor test_dependency_validations to create fake test data. As bonus, we fix data. {'id': <id>} should be returned for network data. not <network id>  
__label__quality [11/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes different test cases that are connected with volumes. Just move file to volume directory.  
__label__testing [11/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes different test cases that are connected with volumes. Just move file to volume directory.  
__label__objective [11/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes different test cases that are connected with volumes. Just move file to volume directory.  
__label__testing Refactor volume functional test in volume v1  There is a patch for refactor of volume funtional test in volume v2 [1], but v1 is missing, this change add the v1 refactor with joson format.  [1]: https://review.openstack.org/#/c/417349  
__label__objective Refactor volume functional test in volume v1  There is a patch for refactor of volume funtional test in volume v2 [1], but v1 is missing, this change add the v1 refactor with joson format.  [1]: https://review.openstack.org/#/c/417349  
__label__objective Refactor volume functional test in volume v1  There is a patch for refactor of volume funtional test in volume v2 [1], but v1 is missing, this change add the v1 refactor with joson format.  [1]: https://review.openstack.org/#/c/417349  
__label__quality [5/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with capabilities and getting volumes by active window test cases.  
__label__testing [5/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with capabilities and getting volumes by active window test cases.  
__label__objective [5/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with capabilities and getting volumes by active window test cases.  
__label__quality [9/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with images.  
__label__testing [9/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with images.  
__label__objective [9/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with images.  
__label__quality [7/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with init host test cases.  
__label__testing [7/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with init host test cases.  
__label__objective [7/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with init host test cases.  
__label__quality [3/9] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with volume manage test cases.  
__label__testing [3/9] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with volume manage test cases.  
__label__objective [3/9] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with volume manage test cases.  
__label__quality [10/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with snapshots.  
__label__testing [10/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with snapshots.  
__label__objective [10/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with snapshots.  
__label__quality [6/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with initializing connection and attach/detach test cases.  
__label__testing [6/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with initializing connection and attach/detach test cases.  
__label__objective [6/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with initializing connection and attach/detach test cases.  
__label__quality [8/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with migration and retype volume operations test cases.  
__label__testing [8/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with migration and retype volume operations test cases.  
__label__objective [8/11] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with migration and retype volume operations test cases.  
__label__testing Refactor availability zone list functional test  Using json format output.  
__label__objective Refactor availability zone list functional test  Using json format output.  
__label__testing Refactor module functional test  Combine "test_module_list_no_options" and "test_module_list_with_all_option" into one test, and modify the test for "--all' option.  
__label__objective Refactor module functional test  Combine "test_module_list_no_options" and "test_module_list_with_all_option" into one test, and modify the test for "--all' option.  
__label__quality [4/9] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with replication and failover test cases.  
__label__testing [4/9] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with replication and failover test cases.  
__label__objective [4/9] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with replication and failover test cases.  
__label__quality [2/9] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with drivers and base driver test cases.  
__label__testing [2/9] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with drivers and base driver test cases.  
__label__objective [2/9] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with drivers and base driver test cases.  
__label__quality [1/9] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with: 1) Availability zone; 2) Policy  
__label__testing [1/9] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with: 1) Availability zone; 2) Policy  
__label__objective [1/9] Refactor test_volume file  Due to the situation, that we've already had more that 7000 lines of code in this file and it contains different test cases, it is reasonably to divide it into smaller files.  This patch includes test cases that are connected with: 1) Availability zone; 2) Policy  
__label__testing Refactor the flavor <-> profile work  There is a single interface to pass in an instance and get back a matching profile for the instance now: `flavor.to_profile`. It uses a map of functions to generate the config and devices from the instance and network/block device info.  All the unit tests that are added here were added *before* the beginning of the refactor, so there should be no broken functionality in this refactor. Along with that, this increases our test coverage by about 15%.  
__label__quality Refactor the flavor <-> profile work  There is a single interface to pass in an instance and get back a matching profile for the instance now: `flavor.to_profile`. It uses a map of functions to generate the config and devices from the instance and network/block device info.  All the unit tests that are added here were added *before* the beginning of the refactor, so there should be no broken functionality in this refactor. Along with that, this increases our test coverage by about 15%.  
__label__objective Refactor the flavor <-> profile work  There is a single interface to pass in an instance and get back a matching profile for the instance now: `flavor.to_profile`. It uses a map of functions to generate the config and devices from the instance and network/block device info.  All the unit tests that are added here were added *before* the beginning of the refactor, so there should be no broken functionality in this refactor. Along with that, this increases our test coverage by about 15%.  
__label__testing Refactor the connection code to be more robust  Remove some duplicated code, handle KerberosError and make get_host_and_realm() a top-level method.  Add integration test for IPA connection code. It must be run manually against a current installation at the moment.  Make the default IPA retry two so we actually do a retr  
__label__quality Refactor the connection code to be more robust  Remove some duplicated code, handle KerberosError and make get_host_and_realm() a top-level method.  Add integration test for IPA connection code. It must be run manually against a current installation at the moment.  Make the default IPA retry two so we actually do a retr  
__label__objective Refactor the connection code to be more robust  Remove some duplicated code, handle KerberosError and make get_host_and_realm() a top-level method.  Add integration test for IPA connection code. It must be run manually against a current installation at the moment.  Make the default IPA retry two so we actually do a retr  
__label__testing Refactor scheduler RPC API test cases  This commit refactors scheduler RPC API test cases using a generic RPCAPITestCase framework.  
__label__objective Refactor scheduler RPC API test cases  This commit refactors scheduler RPC API test cases using a generic RPCAPITestCase framework.  
__label__testing Refactore volume RPC API test cases  This commit refactors volume RPC API test cases using a generic RPCAPITestCase framework.  
__label__objective Refactore volume RPC API test cases  This commit refactors volume RPC API test cases using a generic RPCAPITestCase framework.  
__label__testing Refactor backup RPC API test cases  Our RPC API tests definitely need some refactoring. We have 3 different implementations of such TestCase, each going to it's own direction. Moreover these test cases aren't really asserting a lot and give us very little possiblities in writing tests.  This commit initiates refactoring effort with the simplest API - backup. It is moving the test case to a generic cinder.test.RPCAPITestcase class and enhances the checks there. Following commits will repeat the efforts for scheduler and volume RPC APIs.  
__label__objective Refactor backup RPC API test cases  Our RPC API tests definitely need some refactoring. We have 3 different implementations of such TestCase, each going to it's own direction. Moreover these test cases aren't really asserting a lot and give us very little possiblities in writing tests.  This commit initiates refactoring effort with the simplest API - backup. It is moving the test case to a generic cinder.test.RPCAPITestcase class and enhances the checks there. Following commits will repeat the efforts for scheduler and volume RPC APIs.  
__label__testing Refactor DRAC driver boot-device tests  This reduces the amount of copy-and-pasting in the tests, making it more obvious what changes between tests and what each test method is testing. It also makes it easier to extend the tests to handle UEFI-mode boot devices (in a followup patch).  
__label__objective Refactor DRAC driver boot-device tests  This reduces the amount of copy-and-pasting in the tests, making it more obvious what changes between tests and what each test method is testing. It also makes it easier to extend the tests to handle UEFI-mode boot devices (in a followup patch).  
__label__quality Refactor DRAC driver boot-device tests  This reduces the amount of copy-and-pasting in the tests, making it more obvious what changes between tests and what each test method is testing. It also makes it easier to extend the tests to handle UEFI-mode boot devices (in a followup patch).  
__label__testing Refactor test case for ml2 mech driver(subnet)  This patch makes the test case atomic and introduces ml2 test cases.  
__label__objective Refactor test case for ml2 mech driver(subnet)  This patch makes the test case atomic and introduces ml2 test cases.  
__label__testing Refactor test case for ml2 mech driver(port)  This patch makes the test case atomic and introduces ml2 test cases.  
__label__objective Refactor test case for ml2 mech driver(port)  This patch makes the test case atomic and introduces ml2 test cases.  
__label__testing Refactor rabbitmq ordering  - Refactor Service_status['rabbitmq'] in pacemaker and non pacemaker   mode. As a part cmd_check was changed to 'rabbitmqctl   node_health_check && rabbitmqctl cluster_status' as cluster_status may   fail due to issues on other nodes. Also it doesn't have timeout thus   operation may hang up. Instead node_health_check will check the node   and check cluster on success. - Staging::File as MODULES-1650 has been merged - Specify ordering between rabbitmq_user_permissions and rabbitmq_user - Write test that verifies that service is before the actual user  
__label__objective Refactor rabbitmq ordering  - Refactor Service_status['rabbitmq'] in pacemaker and non pacemaker   mode. As a part cmd_check was changed to 'rabbitmqctl   node_health_check && rabbitmqctl cluster_status' as cluster_status may   fail due to issues on other nodes. Also it doesn't have timeout thus   operation may hang up. Instead node_health_check will check the node   and check cluster on success. - Staging::File as MODULES-1650 has been merged - Specify ordering between rabbitmq_user_permissions and rabbitmq_user - Write test that verifies that service is before the actual user  
__label__integration Refactor rabbitmq ordering  - Refactor Service_status['rabbitmq'] in pacemaker and non pacemaker   mode. As a part cmd_check was changed to 'rabbitmqctl   node_health_check && rabbitmqctl cluster_status' as cluster_status may   fail due to issues on other nodes. Also it doesn't have timeout thus   operation may hang up. Instead node_health_check will check the node   and check cluster on success. - Staging::File as MODULES-1650 has been merged - Specify ordering between rabbitmq_user_permissions and rabbitmq_user - Write test that verifies that service is before the actual user  
__label__testing Refactor rabbitmq ordifing  - Refactor Service_status['rabbitmq'] in pacemaker and non pacemaker   mode. As a part cmd_check was changed to 'rabbitmqctl   node_health_check && rabbitmqctl cluster_status' as cluster_status may   fail due to issues on other nodes. Also it doesn't have timeout thus   operation may hang up. Instead node_health_check will check the node   and check cluster on success. - Staging::File as MODULES-1650 has been merged - Specify ordering between rabbitmq_user_permissions and rabbitmq_user - Write test that verifies that service is before the actual user  
__label__objective Refactor rabbitmq ordifing  - Refactor Service_status['rabbitmq'] in pacemaker and non pacemaker   mode. As a part cmd_check was changed to 'rabbitmqctl   node_health_check && rabbitmqctl cluster_status' as cluster_status may   fail due to issues on other nodes. Also it doesn't have timeout thus   operation may hang up. Instead node_health_check will check the node   and check cluster on success. - Staging::File as MODULES-1650 has been merged - Specify ordering between rabbitmq_user_permissions and rabbitmq_user - Write test that verifies that service is before the actual user  
__label__integration Refactor rabbitmq ordifing  - Refactor Service_status['rabbitmq'] in pacemaker and non pacemaker   mode. As a part cmd_check was changed to 'rabbitmqctl   node_health_check && rabbitmqctl cluster_status' as cluster_status may   fail due to issues on other nodes. Also it doesn't have timeout thus   operation may hang up. Instead node_health_check will check the node   and check cluster on success. - Staging::File as MODULES-1650 has been merged - Specify ordering between rabbitmq_user_permissions and rabbitmq_user - Write test that verifies that service is before the actual user  
__label__testing Refactor test case for ml2 mech driver(qos)  This patch makes the test case atomic.  
__label__objective Refactor test case for ml2 mech driver(qos)  This patch makes the test case atomic.  
__label__testing Update linux_net - Refactor code of linux_net to more cleaner and increase performace  This patch introduce new function '_get_phys_port_name' for reading physical port name of the SR-IOV port, and refactors 'get_representor_port' to use the new function and decrease calls for "_get_pf_func".  In addition to updating the unit test for linux_net and remove not needed mocks  
__label__quality Update linux_net - Refactor code of linux_net to more cleaner and increase performace  This patch introduce new function '_get_phys_port_name' for reading physical port name of the SR-IOV port, and refactors 'get_representor_port' to use the new function and decrease calls for "_get_pf_func".  In addition to updating the unit test for linux_net and remove not needed mocks  
__label__objective Update linux_net - Refactor code of linux_net to more cleaner and increase performace  This patch introduce new function '_get_phys_port_name' for reading physical port name of the SR-IOV port, and refactors 'get_representor_port' to use the new function and decrease calls for "_get_pf_func".  In addition to updating the unit test for linux_net and remove not needed mocks  
__label__testing Refactor directory structure for multiple plugins  - Add collectd_ceilometer.ceilometer dir - Add collectd_ceilometer.common dir - Move test files to collectd_ceilometer/tests/{ceilometer,common} - Add base code to collectd_ceilometer/tests  
__label__objective Refactor directory structure for multiple plugins  - Add collectd_ceilometer.ceilometer dir - Add collectd_ceilometer.common dir - Move test files to collectd_ceilometer/tests/{ceilometer,common} - Add base code to collectd_ceilometer/tests  
__label__quality Refactor directory structure for multiple plugins  - Add collectd_ceilometer.ceilometer dir - Add collectd_ceilometer.common dir - Move test files to collectd_ceilometer/tests/{ceilometer,common} - Add base code to collectd_ceilometer/tests  
__label__testing Refactor fixtures that check required files and settings  Refactor those fixtures in a more general way, so they can be used in any test, not only netchecker one. Just set class variables required_files and required_settings to use them In that way all required files and settings will be in the test class, and not in the fixture itself.  
__label__objective Refactor fixtures that check required files and settings  Refactor those fixtures in a more general way, so they can be used in any test, not only netchecker one. Just set class variables required_files and required_settings to use them In that way all required files and settings will be in the test class, and not in the fixture itself.  
__label__quality Refactor fixtures that check required files and settings  Refactor those fixtures in a more general way, so they can be used in any test, not only netchecker one. Just set class variables required_files and required_settings to use them In that way all required files and settings will be in the test class, and not in the fixture itself.  
__label__testing WIP: Refactor and test main entry point.  
__label__testing Refactor image test cases for shared images  
__label__testing refactor redis unit test code  
__label__testing refactor notification test to work with either format  The _test_notification_operation function only works with the `basic` notification format.  For the `cadf` format to work, it is necessary to mock the _create_cadf_payload call.  
__label__objective refactor notification test to work with either format  The _test_notification_operation function only works with the `basic` notification format.  For the `cadf` format to work, it is necessary to mock the _create_cadf_payload call.  
__label__testing Refactor cluster status command  This patch moves all cluster status functionality from cmd level to pkg level as well as unit tests, making code cleaner and improving actual test coverage.  
__label__objective Refactor cluster status command  This patch moves all cluster status functionality from cmd level to pkg level as well as unit tests, making code cleaner and improving actual test coverage.  
__label__quality Refactor cluster status command  This patch moves all cluster status functionality from cmd level to pkg level as well as unit tests, making code cleaner and improving actual test coverage.  
__label__testing Refactor test_domain_configs  Do not reuse the environment domain, create a new one to be fully controlled by the test cases.  
__label__objective Refactor test_domain_configs  Do not reuse the environment domain, create a new one to be fully controlled by the test cases.  
__label__quality Refactor test_domain_configs  Do not reuse the environment domain, create a new one to be fully controlled by the test cases.  
__label__testing Refactor test case for ml2 mech driver(remote port)  This patch makes the test case atomic.  
__label__objective Refactor test case for ml2 mech driver(remote port)  This patch makes the test case atomic.  
__label__testing Refactor shell unittests and add hosts shell tests  This refactors our shell unittest helpers into three base classes for further unit test classes to subclass and extend. This also corrects some problems with the hosts shell parameters that either didn't previous work or were wrong and no longer belong.  
__label__quality Refactor shell unittests and add hosts shell tests  This refactors our shell unittest helpers into three base classes for further unit test classes to subclass and extend. This also corrects some problems with the hosts shell parameters that either didn't previous work or were wrong and no longer belong.  
__label__objective Refactor shell unittests and add hosts shell tests  This refactors our shell unittest helpers into three base classes for further unit test classes to subclass and extend. This also corrects some problems with the hosts shell parameters that either didn't previous work or were wrong and no longer belong.  
__label__testing Refactor test case for ml2 mech driver(port security)  This patch makes the test case atomic and introduces ml2 test cases.  
__label__objective Refactor test case for ml2 mech driver(port security)  This patch makes the test case atomic and introduces ml2 test cases.  
__label__testing Refactor test case for ml2 mech driver(allow address pair)  This patch makes the test case atomic and introduces ml2 test cases.  
__label__objective Refactor test case for ml2 mech driver(allow address pair)  This patch makes the test case atomic and introduces ml2 test cases.  
__label__testing Refactor the using of dict.get() in the test assertion  In this patch, we will refactor the test assertions in which there are dict.get(key), with a explicit way(i.e. dict[key]), or assert the existence of key directly with assertNotIn().  
__label__objective Refactor the using of dict.get() in the test assertion  In this patch, we will refactor the test assertions in which there are dict.get(key), with a explicit way(i.e. dict[key]), or assert the existence of key directly with assertNotIn().  
__label__quality Refactor the using of dict.get() in the test assertion  In this patch, we will refactor the test assertions in which there are dict.get(key), with a explicit way(i.e. dict[key]), or assert the existence of key directly with assertNotIn().  
__label__testing Refactor and objectify flavor fakes used in api tests  This change reworks a lot of the flavor related fakes used in api tests and move them into the common fakes module for reuse between different test modules.  
__label__objective Refactor and objectify flavor fakes used in api tests  This change reworks a lot of the flavor related fakes used in api tests and move them into the common fakes module for reuse between different test modules.  
__label__quality Refactor and objectify flavor fakes used in api tests  This change reworks a lot of the flavor related fakes used in api tests and move them into the common fakes module for reuse between different test modules.  
__label__testing Refactor unit tests for the nova::compute class  ... and add some missing test cases.  
__label__testing Refactor qos spec unit test in volume v1  Refactor qos spec unit test with FakeQos class in volume v1.  
__label__testing Refactor test to allow additional  Adjust unit test checking to make way for additional tests to be added to the same class while ensuring can verify the resulting tree while different commit messages may be recorded.  Ensure separate parser is created for each test to prevent ensure the 'search_refs' option is isolated per test scenario as otherwise each scenario will append entries as it is set on the class.  These lay the ground work to adding tests to check that git-upstream can work with SHA1 and tags as inputs in addition to branches.  
__label__objective Refactor test to allow additional  Adjust unit test checking to make way for additional tests to be added to the same class while ensuring can verify the resulting tree while different commit messages may be recorded.  Ensure separate parser is created for each test to prevent ensure the 'search_refs' option is isolated per test scenario as otherwise each scenario will append entries as it is set on the class.  These lay the ground work to adding tests to check that git-upstream can work with SHA1 and tags as inputs in addition to branches.  
__label__testing Device refactor part4: move plugin and db to right directory  Next part is planned to move test cases.  
__label__objective Device refactor part4: move plugin and db to right directory  Next part is planned to move test cases.  
__label__testing Refactor volume unit test with FakeVolume class in volume v1  FakeVolume class has been added in the fake.py in volume v1, this patch refactors the volume command unit tests with the FakeVolume class.  
__label__objective Refactor volume unit test with FakeVolume class in volume v1  FakeVolume class has been added in the fake.py in volume v1, this patch refactors the volume command unit tests with the FakeVolume class.  
__label__integration tests: refactor objects test cases to use db models instead of dicts  This should reflect the code under test better, and is needed for one of patches in the review queue (I130609194f15b89df89e5606fb8193849edd14d8) to pass some of those test cases.  
__label__testing tests: refactor objects test cases to use db models instead of dicts  This should reflect the code under test better, and is needed for one of patches in the review queue (I130609194f15b89df89e5606fb8193849edd14d8) to pass some of those test cases.  
__label__objective tests: refactor objects test cases to use db models instead of dicts  This should reflect the code under test better, and is needed for one of patches in the review queue (I130609194f15b89df89e5606fb8193849edd14d8) to pass some of those test cases.  
__label__testing Refactor candidacy checkign tools  This is a large chnage as it does several things  1. Moves to using the gerrit REST API to collecting open reviews (as    opposed to ssh 2. Moves the selection of validating commits from scraping git logs to    the gerrit REST API 3. Uses the new utils.py function for getting the project data 4. Avoids any git checkouts/downloads during the validation process 5. tools/check-new-candidacy still checks all open changes 6. tools/check-ptl-candidacy.py checks a single change, now specified as    a change ID rather then a file path  Work to be done in follow-up commits  1. Add testing, now that this is more modular we can mock json blobs to    test code and avoid regressions 2. Add a manual toll to specify a project and community member and check    that, even if it doesn't match data in an open review 3. Add quality tools such as flake8 / yamllint to keep code/data neat 4. Modify the docs generation to understand that files are now IRC nicks    and to get thw chnage author as the candidate.  
__label__integration Refactor candidacy checkign tools  This is a large chnage as it does several things  1. Moves to using the gerrit REST API to collecting open reviews (as    opposed to ssh 2. Moves the selection of validating commits from scraping git logs to    the gerrit REST API 3. Uses the new utils.py function for getting the project data 4. Avoids any git checkouts/downloads during the validation process 5. tools/check-new-candidacy still checks all open changes 6. tools/check-ptl-candidacy.py checks a single change, now specified as    a change ID rather then a file path  Work to be done in follow-up commits  1. Add testing, now that this is more modular we can mock json blobs to    test code and avoid regressions 2. Add a manual toll to specify a project and community member and check    that, even if it doesn't match data in an open review 3. Add quality tools such as flake8 / yamllint to keep code/data neat 4. Modify the docs generation to understand that files are now IRC nicks    and to get thw chnage author as the candidate.  
__label__objective Refactor candidacy checkign tools  This is a large chnage as it does several things  1. Moves to using the gerrit REST API to collecting open reviews (as    opposed to ssh 2. Moves the selection of validating commits from scraping git logs to    the gerrit REST API 3. Uses the new utils.py function for getting the project data 4. Avoids any git checkouts/downloads during the validation process 5. tools/check-new-candidacy still checks all open changes 6. tools/check-ptl-candidacy.py checks a single change, now specified as    a change ID rather then a file path  Work to be done in follow-up commits  1. Add testing, now that this is more modular we can mock json blobs to    test code and avoid regressions 2. Add a manual toll to specify a project and community member and check    that, even if it doesn't match data in an open review 3. Add quality tools such as flake8 / yamllint to keep code/data neat 4. Modify the docs generation to understand that files are now IRC nicks    and to get thw chnage author as the candidate.  
__label__testing Refactor Tacker unit tests to remove xml support  In part of test refactoring, removing xml support form tacker/tests/unit and tacker/api  
__label__objective Refactor Tacker unit tests to remove xml support  In part of test refactoring, removing xml support form tacker/tests/unit and tacker/api  
__label__testing Refactor Isolated Env to use in unit tests  Refactor the setup of the Environment and base test directories to allow the same settings to be applied to the unit tests.  
__label__objective Refactor Isolated Env to use in unit tests  Refactor the setup of the Environment and base test directories to allow the same settings to be applied to the unit tests.  
__label__quality Refactor Isolated Env to use in unit tests  Refactor the setup of the Environment and base test directories to allow the same settings to be applied to the unit tests.  
__label__testing Refactor instance action notification sample test  Every instance action notification sample test needs an instance to work with. Until now each test booted a new instance. This patch refactors the tests to use a common instance where it is possible.  This optimization speeds up the test execution significantly. Before the commit:   Sum of execute time for each test: 151.7733 sec.  After the commit:   Sum of execute time for each test: 74.7535 sec.  Please note that only 6 actions are tested right now but there will be ~40 when every notification is transformed so this will give use speed in the future as well.  
__label__quality Refactor instance action notification sample test  Every instance action notification sample test needs an instance to work with. Until now each test booted a new instance. This patch refactors the tests to use a common instance where it is possible.  This optimization speeds up the test execution significantly. Before the commit:   Sum of execute time for each test: 151.7733 sec.  After the commit:   Sum of execute time for each test: 74.7535 sec.  Please note that only 6 actions are tested right now but there will be ~40 when every notification is transformed so this will give use speed in the future as well.  
__label__objective Refactor instance action notification sample test  Every instance action notification sample test needs an instance to work with. Until now each test booted a new instance. This patch refactors the tests to use a common instance where it is possible.  This optimization speeds up the test execution significantly. Before the commit:   Sum of execute time for each test: 151.7733 sec.  After the commit:   Sum of execute time for each test: 74.7535 sec.  Please note that only 6 actions are tested right now but there will be ~40 when every notification is transformed so this will give use speed in the future as well.  
__label__testing rt: Refactor unit test for trackable migrations  There was a functional test in test_resource_tracker.py call test_no_move_type() that was setting up a resource tracker instance and populating it only to test whether the migration's migration_type was one of three that are tracked by the resource tracker.  This was silly, so I converted this into a real unit test, derived from NoDBTestCase, in test_tracker.py and converted the _is_trackable_migration() method on ResourceTracker to just be a module-level method since it wasn't referencing self or anything.  
__label__objective rt: Refactor unit test for trackable migrations  There was a functional test in test_resource_tracker.py call test_no_move_type() that was setting up a resource tracker instance and populating it only to test whether the migration's migration_type was one of three that are tracked by the resource tracker.  This was silly, so I converted this into a real unit test, derived from NoDBTestCase, in test_tracker.py and converted the _is_trackable_migration() method on ResourceTracker to just be a module-level method since it wasn't referencing self or anything.  
__label__testing Refactor test_servers APIVersion setup  Set APIVersion in the base test class instead of in every derived test class.  
__label__quality Refactor test_servers APIVersion setup  Set APIVersion in the base test class instead of in every derived test class.  
__label__objective Refactor test_servers APIVersion setup  Set APIVersion in the base test class instead of in every derived test class.  
__label__testing rt: refactor test_dupe_filter unit test  The TestMoveClaim.test_dupe_filter() unit test was a poorly-written unit test. Not only was it not actually isolating the particular piece of code being tested properly, but the assertion it was making was not proving that filtering that the code was doing actually worked.  This patch refactors that unit test out of TestMoveClaim and into its own TestUpdateUsageFromMigrations test case class that isolates the area of tested code to just the function in question and puts assertions into the unit test that actually verify the *correct* migration is filtered not just *any* migration.  
__label__objective rt: refactor test_dupe_filter unit test  The TestMoveClaim.test_dupe_filter() unit test was a poorly-written unit test. Not only was it not actually isolating the particular piece of code being tested properly, but the assertion it was making was not proving that filtering that the code was doing actually worked.  This patch refactors that unit test out of TestMoveClaim and into its own TestUpdateUsageFromMigrations test case class that isolates the area of tested code to just the function in question and puts assertions into the unit test that actually verify the *correct* migration is filtered not just *any* migration.  
__label__testing rt: Refactor resize claim abort unit test  Next unit test to pull from the TestMoveClaim class and refactor is test_claim_abort(). For this, we simply add a few extra lines that test the claim abort behaviour to the test_resize_claim_same_host() test method introduced in the previous patch in this series.  Note: This patch removes two existing unit tests in test_tracker.TestMoveClaim: test_claim_abort() and test_same_host(). The refactored TestResizeClaim.test_resize_claim_same_host() contains all the assertions that both of these unit tests contained.  
__label__objective rt: Refactor resize claim abort unit test  Next unit test to pull from the TestMoveClaim class and refactor is test_claim_abort(). For this, we simply add a few extra lines that test the claim abort behaviour to the test_resize_claim_same_host() test method introduced in the previous patch in this series.  Note: This patch removes two existing unit tests in test_tracker.TestMoveClaim: test_claim_abort() and test_same_host(). The refactored TestResizeClaim.test_resize_claim_same_host() contains all the assertions that both of these unit tests contained.  
__label__testing rt: Refactor resize_claim unit test  I don't care for the way the migration and resize unit tests were done in the test_tracker.py file. It isn't clear what is being asserted in the unit tests because of layers of nested helper functions. This patch is the start of a series that refactors these tests to be more readable. First up was the unit test for resize_claim on the same host.  
__label__objective rt: Refactor resize_claim unit test  I don't care for the way the migration and resize unit tests were done in the test_tracker.py file. It isn't clear what is being asserted in the unit tests because of layers of nested helper functions. This patch is the start of a series that refactors these tests to be more readable. First up was the unit test for resize_claim on the same host.  
__label__quality rt: Refactor resize_claim unit test  I don't care for the way the migration and resize unit tests were done in the test_tracker.py file. It isn't clear what is being asserted in the unit tests because of layers of nested helper functions. This patch is the start of a series that refactors these tests to be more readable. First up was the unit test for resize_claim on the same host.  
__label__testing Refactor rally plugin  This patch refactors rally plugin for senlin. Since the plugin for basic cluster and profile operations has been merged into rally repo, we can remove duplicated util functions and test scenarios from senlin repo. Related test jobs are also changed accordingly.  
__label__objective Refactor rally plugin  This patch refactors rally plugin for senlin. Since the plugin for basic cluster and profile operations has been merged into rally repo, we can remove duplicated util functions and test scenarios from senlin repo. Related test jobs are also changed accordingly.  
__label__quality Refactor rally plugin  This patch refactors rally plugin for senlin. Since the plugin for basic cluster and profile operations has been merged into rally repo, we can remove duplicated util functions and test scenarios from senlin repo. Related test jobs are also changed accordingly.  
__label__integration Fix the issue introduced by Neutron config file refactorying  1.What is the problem core_opts has been moved from neutron/common.py to neutron/conf/common.py, the migration leads the py27 test failured in tricircle/tests/base.py.  2.What's need to be fixed: import common.py from neutron/conf/common.py instead from from neutron/common.py  3.What is the purpose of this patch set: fix the py27 check and gate test error introduced by Neutron config file refactorying.  
__label__integration Fix the issue introduced by Neutron config file refactorying  1.What is the problem core_opts has been moved from neutron/common.py to neutron/conf/common.py, the migration leads the py27 test failured in tricircle/tests/base.py.  2.What's need to be fixed: import common.py from neutron/conf/common.py instead from from neutron/common.py  3.What is the purpose of this patch set: fix the py27 check and gate test error introduced by Neutron config file refactorying.  
__label__objective Fix the issue introduced by Neutron config file refactorying  1.What is the problem core_opts has been moved from neutron/common.py to neutron/conf/common.py, the migration leads the py27 test failured in tricircle/tests/base.py.  2.What's need to be fixed: import common.py from neutron/conf/common.py instead from from neutron/common.py  3.What is the purpose of this patch set: fix the py27 check and gate test error introduced by Neutron config file refactorying.  
__label__testing NetApp: Refactor unit tests  Some of the older unit tests for the NetApp driver code have become obsolete since adding new unit tests over time. These tests also used mox in some places. So,  * Rewrite unit tests that were using mox * Move unit tests to the right place in the test code tree * Add unit tests and improve code coverage  
__label__objective NetApp: Refactor unit tests  Some of the older unit tests for the NetApp driver code have become obsolete since adding new unit tests over time. These tests also used mox in some places. So,  * Rewrite unit tests that were using mox * Move unit tests to the right place in the test code tree * Add unit tests and improve code coverage  
__label__quality NetApp: Refactor unit tests  Some of the older unit tests for the NetApp driver code have become obsolete since adding new unit tests over time. These tests also used mox in some places. So,  * Rewrite unit tests that were using mox * Move unit tests to the right place in the test code tree * Add unit tests and improve code coverage  
__label__testing Refactor namespace variable creation  This is needed for next patches to get rid of code duplication and for test  
__label__objective Refactor namespace variable creation  This is needed for next patches to get rid of code duplication and for test  
__label__quality Refactor namespace variable creation  This is needed for next patches to get rid of code duplication and for test  
__label__testing Refactor Ironic job macro  Ironic is getting more and more jobs to test the different deployment scenarios we support, every time we add a new optional feature we add a new conditional to the existing macro to enable it for one job, and then we have to add a new variable to every job template that uses that macro.  This is getting unmanageable and messy, so this patch refactors out the configurations we've been controlling using conditionals into their own builders which can be pulled into a job-template only if required. It does this by writing the optional script parts into a file call ironic-extra-vars which is then sourced in the main ironic macro.  This patch takes all the Ironic jobs that are largely the same, and refactors them into a single template, and then uses the jenkins job builder matrixing system to generate the jobs instead of explicitly defining each one.  
__label__quality Refactor Ironic job macro  Ironic is getting more and more jobs to test the different deployment scenarios we support, every time we add a new optional feature we add a new conditional to the existing macro to enable it for one job, and then we have to add a new variable to every job template that uses that macro.  This is getting unmanageable and messy, so this patch refactors out the configurations we've been controlling using conditionals into their own builders which can be pulled into a job-template only if required. It does this by writing the optional script parts into a file call ironic-extra-vars which is then sourced in the main ironic macro.  This patch takes all the Ironic jobs that are largely the same, and refactors them into a single template, and then uses the jenkins job builder matrixing system to generate the jobs instead of explicitly defining each one.  
__label__objective Refactor Ironic job macro  Ironic is getting more and more jobs to test the different deployment scenarios we support, every time we add a new optional feature we add a new conditional to the existing macro to enable it for one job, and then we have to add a new variable to every job template that uses that macro.  This is getting unmanageable and messy, so this patch refactors out the configurations we've been controlling using conditionals into their own builders which can be pulled into a job-template only if required. It does this by writing the optional script parts into a file call ironic-extra-vars which is then sourced in the main ironic macro.  This patch takes all the Ironic jobs that are largely the same, and refactors them into a single template, and then uses the jenkins job builder matrixing system to generate the jobs instead of explicitly defining each one.  
__label__integration Refactor run-playbooks  This changes the run playbooks script so that its using our core CLI tools and is no longer a special case script running bits outside of simply running the deployment tools as they've been designed.  The script is still executing all of the playbooks using the "scripts-library" function ``install_bits`` so that we ensure gate success by having a retry on a playbook execution in the case of transient failure.  A notice has been added to the script whenever it exits notifying the deployer that they should now work out of the playbooks directory and never execute the run-playbooks.sh script ever again. Within the notice links to our documentation have been added.  The ironic services were removed from the integrated gate because they're not ready for general consumption and not being tested at this time because no test configuration has been added into the tempest role or the ``run-tempest.sh`` script.  
__label__objective Refactor run-playbooks  This changes the run playbooks script so that its using our core CLI tools and is no longer a special case script running bits outside of simply running the deployment tools as they've been designed.  The script is still executing all of the playbooks using the "scripts-library" function ``install_bits`` so that we ensure gate success by having a retry on a playbook execution in the case of transient failure.  A notice has been added to the script whenever it exits notifying the deployer that they should now work out of the playbooks directory and never execute the run-playbooks.sh script ever again. Within the notice links to our documentation have been added.  The ironic services were removed from the integrated gate because they're not ready for general consumption and not being tested at this time because no test configuration has been added into the tempest role or the ``run-tempest.sh`` script.  
__label__testing Refactor run-playbooks  This changes the run playbooks script so that its using our core CLI tools and is no longer a special case script running bits outside of simply running the deployment tools as they've been designed.  The script is still executing all of the playbooks using the "scripts-library" function ``install_bits`` so that we ensure gate success by having a retry on a playbook execution in the case of transient failure.  A notice has been added to the script whenever it exits notifying the deployer that they should now work out of the playbooks directory and never execute the run-playbooks.sh script ever again. Within the notice links to our documentation have been added.  The ironic services were removed from the integrated gate because they're not ready for general consumption and not being tested at this time because no test configuration has been added into the tempest role or the ``run-tempest.sh`` script.  
__label__testing refactor: make TestFetchRevocationList test uuid  The TestFetchRevocationList should be inherited and tested by the uuid token provider. The other token providers don't support Revocation Lists, so don't test them with it.  This is an effort to break https://review.openstack.org/#/c/258650 into smaller, more reviewable pieces.  Co-Authored-By: Raildo Mascena <raildo@lsd.ufcg.edu.br> Co-Authored-By: Adam Young <ayound@redhat.com>  
__label__quality refactor: make TestFetchRevocationList test uuid  The TestFetchRevocationList should be inherited and tested by the uuid token provider. The other token providers don't support Revocation Lists, so don't test them with it.  This is an effort to break https://review.openstack.org/#/c/258650 into smaller, more reviewable pieces.  Co-Authored-By: Raildo Mascena <raildo@lsd.ufcg.edu.br> Co-Authored-By: Adam Young <ayound@redhat.com>  
__label__objective refactor: make TestFetchRevocationList test uuid  The TestFetchRevocationList should be inherited and tested by the uuid token provider. The other token providers don't support Revocation Lists, so don't test them with it.  This is an effort to break https://review.openstack.org/#/c/258650 into smaller, more reviewable pieces.  Co-Authored-By: Raildo Mascena <raildo@lsd.ufcg.edu.br> Co-Authored-By: Adam Young <ayound@redhat.com>  
__label__testing refactor: make TestAuthKerberos test pki/pkiz/uuid  This helps us move towards fernet because we don't support bind authentication with the Fernet provider, so when we set Fernet to be the default we won't run these tests. We will only run Kerberos tests against token providers that support it.  Co-Authored-By: Raildo Mascena <raildo@lsd.ufcg.edu.br> Co-Authored-By: Adam Young <ayound@redhat.com>  
__label__objective refactor: make TestAuthKerberos test pki/pkiz/uuid  This helps us move towards fernet because we don't support bind authentication with the Fernet provider, so when we set Fernet to be the default we won't run these tests. We will only run Kerberos tests against token providers that support it.  Co-Authored-By: Raildo Mascena <raildo@lsd.ufcg.edu.br> Co-Authored-By: Adam Young <ayound@redhat.com>  
__label__testing refactor: inherit AuthWithRemoteUser for other providers  This commit makes it so that the AuthWithRemoteUser class no longer inherits from other tests cases. Instead it inherits from `object` and I've added several other classes that setup each token provider to test the cases in AuthWithRemoteUser.  This helps us move towards making Fernet the default token provider.  Co-Authored-By: Raildo Mascena <raildo@lsd.ufcg.edu.br> Co-Authored-By: Adam Young <ayound@redhat.com>  
__label__quality refactor: inherit AuthWithRemoteUser for other providers  This commit makes it so that the AuthWithRemoteUser class no longer inherits from other tests cases. Instead it inherits from `object` and I've added several other classes that setup each token provider to test the cases in AuthWithRemoteUser.  This helps us move towards making Fernet the default token provider.  Co-Authored-By: Raildo Mascena <raildo@lsd.ufcg.edu.br> Co-Authored-By: Adam Young <ayound@redhat.com>  
__label__objective refactor: inherit AuthWithRemoteUser for other providers  This commit makes it so that the AuthWithRemoteUser class no longer inherits from other tests cases. Instead it inherits from `object` and I've added several other classes that setup each token provider to test the cases in AuthWithRemoteUser.  This helps us move towards making Fernet the default token provider.  Co-Authored-By: Raildo Mascena <raildo@lsd.ufcg.edu.br> Co-Authored-By: Adam Young <ayound@redhat.com>  
__label__testing Refactor TestAuthExternalDomain to not inherit tests  Previously, TestAuthExternalDomain was inheriting from test_v3.RestfulTestCase, which allowed it to run as part of the keystone test suite. This commit breaks it into a class that only inherits from `object` and introduces 3 other classes the inherit the old TestAuthExternalDomain and run the tests according to the setup needed.  Since the Fernet provider doesn't support bind authentication, there is no test class to setup Fernet and run the TestAuthExternalDomain behaviors. This change will make defaulting to Fernet easier.  This fix was originally a part of https://review.openstack.org/#/c/258650 but this is an attempt to break 258650 into smaller, more reviewable, pieces.  Co-Authored-By: Raildo Mascena <raildo@lsd.ufcg.edu.br> Co-Authored-By: Adam Young <ayound@redhat.com>  
__label__quality Refactor TestAuthExternalDomain to not inherit tests  Previously, TestAuthExternalDomain was inheriting from test_v3.RestfulTestCase, which allowed it to run as part of the keystone test suite. This commit breaks it into a class that only inherits from `object` and introduces 3 other classes the inherit the old TestAuthExternalDomain and run the tests according to the setup needed.  Since the Fernet provider doesn't support bind authentication, there is no test class to setup Fernet and run the TestAuthExternalDomain behaviors. This change will make defaulting to Fernet easier.  This fix was originally a part of https://review.openstack.org/#/c/258650 but this is an attempt to break 258650 into smaller, more reviewable, pieces.  Co-Authored-By: Raildo Mascena <raildo@lsd.ufcg.edu.br> Co-Authored-By: Adam Young <ayound@redhat.com>  
__label__objective Refactor TestAuthExternalDomain to not inherit tests  Previously, TestAuthExternalDomain was inheriting from test_v3.RestfulTestCase, which allowed it to run as part of the keystone test suite. This commit breaks it into a class that only inherits from `object` and introduces 3 other classes the inherit the old TestAuthExternalDomain and run the tests according to the setup needed.  Since the Fernet provider doesn't support bind authentication, there is no test class to setup Fernet and run the TestAuthExternalDomain behaviors. This change will make defaulting to Fernet easier.  This fix was originally a part of https://review.openstack.org/#/c/258650 but this is an attempt to break 258650 into smaller, more reviewable, pieces.  Co-Authored-By: Raildo Mascena <raildo@lsd.ufcg.edu.br> Co-Authored-By: Adam Young <ayound@redhat.com>  
__label__testing [WIP] Refactoring: RPC and namespace support  TODO: test cases  Implements blueprint code-refactoring  
__label__objective [WIP] Refactoring: RPC and namespace support  TODO: test cases  Implements blueprint code-refactoring  
__label__testing Refactored Auth test  Significantly refactored test for improper authorization checks to match the new style of tests.  
__label__objective Refactored Auth test  Significantly refactored test for improper authorization checks to match the new style of tests.  
__label__testing VMware: Refactor vmdk unit tests  The unit test for _get_vc_version() tests multiple cases. This patch refactors the unit test to fix the issue. Also, it refactors the unit tests for do_setup() to reduce code duplication.  
__label__objective VMware: Refactor vmdk unit tests  The unit test for _get_vc_version() tests multiple cases. This patch refactors the unit test to fix the issue. Also, it refactors the unit tests for do_setup() to reduce code duplication.  
__label__testing Refactoring of retry decorator  - retry decorator was changed and now requires to specify exception class.   Other exceptions won't be caught by retry decorator. - Added DevopsException class - Removed retries for minor libvirt driver methods - Removed redundant retry on SSHClient.__connect_sftp - Added unit test for retry decorator  
__label__quality Refactoring of retry decorator  - retry decorator was changed and now requires to specify exception class.   Other exceptions won't be caught by retry decorator. - Added DevopsException class - Removed retries for minor libvirt driver methods - Removed redundant retry on SSHClient.__connect_sftp - Added unit test for retry decorator  
__label__objective Refactoring of retry decorator  - retry decorator was changed and now requires to specify exception class.   Other exceptions won't be caught by retry decorator. - Added DevopsException class - Removed retries for minor libvirt driver methods - Removed redundant retry on SSHClient.__connect_sftp - Added unit test for retry decorator  
__label__testing Refactor tests and add tests  Relocates some test infrastructure in preparation for use with encryption tests, in particular moves the test server setup code from test/unit/proxy/test_server.py to a new helpers.py so that it can be re-used.  Adds unit test coverage for extract_swift_bytes and functional test coverage for container listings. Adds a check on the content and metadata of reconciled objects in probe tests.  
__label__objective Refactor tests and add tests  Relocates some test infrastructure in preparation for use with encryption tests, in particular moves the test server setup code from test/unit/proxy/test_server.py to a new helpers.py so that it can be re-used.  Adds unit test coverage for extract_swift_bytes and functional test coverage for container listings. Adds a check on the content and metadata of reconciled objects in probe tests.  
__label__testing Refactor API tests to not run middleware  The API tests don't really use the API, they just test the creation of an event so focus them on that.  There are two tests that are in the API class that really do test middleware so they are moved back.  
__label__integration Refactor API tests to not run middleware  The API tests don't really use the API, they just test the creation of an event so focus them on that.  There are two tests that are in the API class that really do test middleware so they are moved back.  
__label__objective Refactor API tests to not run middleware  The API tests don't really use the API, they just test the creation of an event so focus them on that.  There are two tests that are in the API class that really do test middleware so they are moved back.  
__label__testing Refactor main test module  Refactor to remove duplication of test code.  
__label__quality Refactor main test module  Refactor to remove duplication of test code.  
__label__objective Refactor main test module  Refactor to remove duplication of test code.  
__label__testing Refactor unit test of "compute service list" command  The unit test of "compute service list" only checked the "Disabled Reason" columns and its data. It is not enough. This patch change the test to check all datas in the list.  Also, this patch modify the "Id" to "ID" in this command.  
__label__objective Refactor unit test of "compute service list" command  The unit test of "compute service list" only checked the "Disabled Reason" columns and its data. It is not enough. This patch change the test to check all datas in the list.  Also, this patch modify the "Id" to "ID" in this command.  
__label__testing Refactor test_validate_v2_scoped_token_with_v3_api  This commit moves the test_validate_v2_scoped_token_with_v3_api test from the TestAuth module to the TokenAPITests module. It also renames the test to accurately reflect what it is doing. Lastly, it removes a utility method, get_v2_token() because it was no longer in use in TestAuth.  
__label__objective Refactor test_validate_v2_scoped_token_with_v3_api  This commit moves the test_validate_v2_scoped_token_with_v3_api test from the TestAuth module to the TokenAPITests module. It also renames the test to accurately reflect what it is doing. Lastly, it removes a utility method, get_v2_token() because it was no longer in use in TestAuth.  
__label__testing Refactor common auth token code in images test  This pulls out the authentication token manipulation used by some of the images functional tests, which is replicated in several places into a single helper. This will also be used by a subsequent functional test for cross-owner copy-image support.  
__label__quality Refactor common auth token code in images test  This pulls out the authentication token manipulation used by some of the images functional tests, which is replicated in several places into a single helper. This will also be used by a subsequent functional test for cross-owner copy-image support.  
__label__objective Refactor common auth token code in images test  This pulls out the authentication token manipulation used by some of the images functional tests, which is replicated in several places into a single helper. This will also be used by a subsequent functional test for cross-owner copy-image support.  
__label__testing Refactor Netrings fact and it's tests for:  1. passing test if run under OSX (stub :kernel fact into test) 2. make waiting cycle for all started threads 3. re-implement netrings properties gather as ruby class  
__label__integration Refactor Netrings fact and it's tests for:  1. passing test if run under OSX (stub :kernel fact into test) 2. make waiting cycle for all started threads 3. re-implement netrings properties gather as ruby class  
__label__objective Refactor Netrings fact and it's tests for:  1. passing test if run under OSX (stub :kernel fact into test) 2. make waiting cycle for all started threads 3. re-implement netrings properties gather as ruby class  
__label__testing VMware: Refactor unit tests  There are unit tests which test multiple code paths and methods. This patch refactors the unit tests for the following methods in the vmdk module to fix this: * _get_extra_spec_storage_profile * _get_storage_profile * _get_storage_profile_id  
__label__objective VMware: Refactor unit tests  There are unit tests which test multiple code paths and methods. This patch refactors the unit tests for the following methods in the vmdk module to fix this: * _get_extra_spec_storage_profile * _get_storage_profile * _get_storage_profile_id  
__label__testing Refactorize Puppet versions testing matrix  * Run puppet-unit-latest only on master, as non-voting.   The goal of this job is to test very latest versions of Puppet and   provide early feedback. * On master (current Newton), stop running unit tests on 3.3, 3.4, 3.7   and 4.0. A recent poll showed that 3.6, 3.8 and recent 4.x were the   most used by our community. * On stable/mitaka and master (current Newton), start running unit tests   on 4.5 (latest version) as voting.  Coverage summary: Liberty: 3.3, 3.4, 3.6, 3.7, 3.8, 4.0 Mitaka: 3.3, 3.4, 3.6, 3.7, 3.8, 4.0, 4.5 Newton: 3.6, 3.8, 4.5 and latest (non-voting)  
__label__objective Refactorize Puppet versions testing matrix  * Run puppet-unit-latest only on master, as non-voting.   The goal of this job is to test very latest versions of Puppet and   provide early feedback. * On master (current Newton), stop running unit tests on 3.3, 3.4, 3.7   and 4.0. A recent poll showed that 3.6, 3.8 and recent 4.x were the   most used by our community. * On stable/mitaka and master (current Newton), start running unit tests   on 4.5 (latest version) as voting.  Coverage summary: Liberty: 3.3, 3.4, 3.6, 3.7, 3.8, 4.0 Mitaka: 3.3, 3.4, 3.6, 3.7, 3.8, 4.0, 4.5 Newton: 3.6, 3.8, 4.5 and latest (non-voting)  
__label__integration Refactorize Puppet versions testing matrix  * Run puppet-unit-latest only on master, as non-voting.   The goal of this job is to test very latest versions of Puppet and   provide early feedback. * On master (current Newton), stop running unit tests on 3.3, 3.4, 3.7   and 4.0. A recent poll showed that 3.6, 3.8 and recent 4.x were the   most used by our community. * On stable/mitaka and master (current Newton), start running unit tests   on 4.5 (latest version) as voting.  Coverage summary: Liberty: 3.3, 3.4, 3.6, 3.7, 3.8, 4.0 Mitaka: 3.3, 3.4, 3.6, 3.7, 3.8, 4.0, 4.5 Newton: 3.6, 3.8, 4.5 and latest (non-voting)  
__label__testing Fixing __getattribute__ def and refactor from_json  The previous command left a __getattribute__ definition in models.OneViewObject that would enter a infinite loop when called with an argument that isn't on the attribute_map of the instance. I'm removing it since it was legacy of a test and shoudn't had remained on the code. This also refactors duplicate code on *_from_json methods.  
__label__quality Fixing __getattribute__ def and refactor from_json  The previous command left a __getattribute__ definition in models.OneViewObject that would enter a infinite loop when called with an argument that isn't on the attribute_map of the instance. I'm removing it since it was legacy of a test and shoudn't had remained on the code. This also refactors duplicate code on *_from_json methods.  
__label__objective Fixing __getattribute__ def and refactor from_json  The previous command left a __getattribute__ definition in models.OneViewObject that would enter a infinite loop when called with an argument that isn't on the attribute_map of the instance. I'm removing it since it was legacy of a test and shoudn't had remained on the code. This also refactors duplicate code on *_from_json methods.  
__label__testing Refactor process test  The tests relied on psutils Python module which is not part of monasca. The used functions and classes are substituted by mock objects that simulate their behavior, making the test independent of third party modules.  common.py is refactored to make it pep8 compatible  
__label__quality Refactor process test  The tests relied on psutils Python module which is not part of monasca. The used functions and classes are substituted by mock objects that simulate their behavior, making the test independent of third party modules.  common.py is refactored to make it pep8 compatible  
__label__objective Refactor process test  The tests relied on psutils Python module which is not part of monasca. The used functions and classes are substituted by mock objects that simulate their behavior, making the test independent of third party modules.  common.py is refactored to make it pep8 compatible  
__label__testing Refactor unit test for nova scenario utils  - Improve test cases for various methods - Add assertions and make them uniform across various   methods being tested  
__label__objective Refactor unit test for nova scenario utils  - Improve test cases for various methods - Add assertions and make them uniform across various   methods being tested  
__label__testing VMware: Unit test refactoring  There are unit tests which test multiple code paths and methods. This patch refactors the unit tests for the following methods in the vmdk module to fix this: * copy_volume_to_image * _in_use * retype  
__label__objective VMware: Unit test refactoring  There are unit tests which test multiple code paths and methods. This patch refactors the unit tests for the following methods in the vmdk module to fix this: * copy_volume_to_image * _in_use * retype  
__label__testing Refactor test_process  * Use fixtures instead of a self-invented decorator * Give proper names to mocks * Swift from inline mocks to @decorators * Split TestProcess into several test cases * Remove the old style of setting side_effect (via iter)  
__label__quality Refactor test_process  * Use fixtures instead of a self-invented decorator * Give proper names to mocks * Swift from inline mocks to @decorators * Split TestProcess into several test cases * Remove the old style of setting side_effect (via iter)  
__label__objective Refactor test_process  * Use fixtures instead of a self-invented decorator * Give proper names to mocks * Swift from inline mocks to @decorators * Split TestProcess into several test cases * Remove the old style of setting side_effect (via iter)  
__label__objective Add update testrail fields functionality for testrail reporter and small refactoring of description parsing  Add update_case() method to testrail client Pull parsing custom cases fields into _get_custom_cases_fields() method Add _get_fields_to_update() method to test cases uploader Change log message for up-to-date cases Add new file: datetime_util.py Add method that converts duration to testrail estimate format Register new file in the doc/testrail.rst Change duration regexp and pull it into compiled instance Pull tests discovering and test plan creation into   _create_test_plan_from_registry() function Pull various case checks into _is_case_processable() function Pull test case name getter actions into _get_test_case_name() function Pull case 'not included' verification into _is_not_included() function Pull case 'excluded' verification into _is_excluded() function Pull docstring getter actions into _get_docstring() function Pull docstring parsing actions into _parse_docstring() function Add support for multiline title and test case steps  
__label__testing Add update testrail fields functionality for testrail reporter and small refactoring of description parsing  Add update_case() method to testrail client Pull parsing custom cases fields into _get_custom_cases_fields() method Add _get_fields_to_update() method to test cases uploader Change log message for up-to-date cases Add new file: datetime_util.py Add method that converts duration to testrail estimate format Register new file in the doc/testrail.rst Change duration regexp and pull it into compiled instance Pull tests discovering and test plan creation into   _create_test_plan_from_registry() function Pull various case checks into _is_case_processable() function Pull test case name getter actions into _get_test_case_name() function Pull case 'not included' verification into _is_not_included() function Pull case 'excluded' verification into _is_excluded() function Pull docstring getter actions into _get_docstring() function Pull docstring parsing actions into _parse_docstring() function Add support for multiline title and test case steps  
__label__objective Add update testrail fields functionality for testrail reporter and small refactoring of description parsing  Add update_case() method to testrail client Pull parsing custom cases fields into _get_custom_cases_fields() method Add _get_fields_to_update() method to test cases uploader Change log message for up-to-date cases Add new file: datetime_util.py Add method that converts duration to testrail estimate format Register new file in the doc/testrail.rst Change duration regexp and pull it into compiled instance Pull tests discovering and test plan creation into   _create_test_plan_from_registry() function Pull various case checks into _is_case_processable() function Pull test case name getter actions into _get_test_case_name() function Pull case 'not included' verification into _is_not_included() function Pull case 'excluded' verification into _is_excluded() function Pull docstring getter actions into _get_docstring() function Pull docstring parsing actions into _parse_docstring() function Add support for multiline title and test case steps  
__label__testing Refactor main inventory function for testability  This change alters the dynamic_inventory.py file's main function with two main changes:      * main now accepts arguments, which could be the ArgParse parsed       arguments or a plain dictionary for testing     * return output to then be printed, instead of just printing.  With these changes, testing inventory can now be done via Python imports rather than a subprocess call. This make existing tests more clear, and allows for using pdb when creating future patches. With the subprocess method, a pdb in the dynamic_inventory.py would cause the test suite to hang, since the subprocess was waiting for input.  Existing functionality is *not* changed - arguments and output are simply being moved to make the code easier to test.  
__label__quality Refactor main inventory function for testability  This change alters the dynamic_inventory.py file's main function with two main changes:      * main now accepts arguments, which could be the ArgParse parsed       arguments or a plain dictionary for testing     * return output to then be printed, instead of just printing.  With these changes, testing inventory can now be done via Python imports rather than a subprocess call. This make existing tests more clear, and allows for using pdb when creating future patches. With the subprocess method, a pdb in the dynamic_inventory.py would cause the test suite to hang, since the subprocess was waiting for input.  Existing functionality is *not* changed - arguments and output are simply being moved to make the code easier to test.  
__label__objective Refactor main inventory function for testability  This change alters the dynamic_inventory.py file's main function with two main changes:      * main now accepts arguments, which could be the ArgParse parsed       arguments or a plain dictionary for testing     * return output to then be printed, instead of just printing.  With these changes, testing inventory can now be done via Python imports rather than a subprocess call. This make existing tests more clear, and allows for using pdb when creating future patches. With the subprocess method, a pdb in the dynamic_inventory.py would cause the test suite to hang, since the subprocess was waiting for input.  Existing functionality is *not* changed - arguments and output are simply being moved to make the code easier to test.  
__label__testing Refactor import command tests to use scenarios  Move import command tests to use scenarios to build the trees and consolidate the additional test code as much as possible to a single function.  Using yaml to describe the trees results in easier to read test cases, which by following the existing format for other tests allows for consistency throughout the unit tests.  
__label__quality Refactor import command tests to use scenarios  Move import command tests to use scenarios to build the trees and consolidate the additional test code as much as possible to a single function.  Using yaml to describe the trees results in easier to read test cases, which by following the existing format for other tests allows for consistency throughout the unit tests.  
__label__objective Refactor import command tests to use scenarios  Move import command tests to use scenarios to build the trees and consolidate the additional test code as much as possible to a single function.  Using yaml to describe the trees results in easier to read test cases, which by following the existing format for other tests allows for consistency throughout the unit tests.  
__label__testing Remove obsolete keepalived PID files before start  This is a combination of 2 commits. The first commit's message is:  keepalived refuses to start and claims "daemon already started" when there is already a process with the same PID as found in either the VRRP or the main process PID file. This happens even in case when the new process is not keepalived. The situation can happen when the neutron node is reset and the obsolete PID files are not cleaned before neutron is started.  This commit adds PID file cleanup before keepalived start.  Closes-Bug: 1561046 
__label__quality Remove obsolete keepalived PID files before start  This is a combination of 2 commits. The first commit's message is:  keepalived refuses to start and claims "daemon already started" when there is already a process with the same PID as found in either the VRRP or the main process PID file. This happens even in case when the new process is not keepalived. The situation can happen when the neutron node is reset and the obsolete PID files are not cleaned before neutron is started.  This commit adds PID file cleanup before keepalived start.  Closes-Bug: 1561046 
__label__objective Remove obsolete keepalived PID files before start  This is a combination of 2 commits. The first commit's message is:  keepalived refuses to start and claims "daemon already started" when there is already a process with the same PID as found in either the VRRP or the main process PID file. This happens even in case when the new process is not keepalived. The situation can happen when the neutron node is reset and the obsolete PID files are not cleaned before neutron is started.  This commit adds PID file cleanup before keepalived start.  Closes-Bug: 1561046 
__label__testing Refactor FFWD run to run on 1/3rd of controlplane  In order to pass the workload test we can't skip networker and other roles. We have to upgrade whole controlplane at once. Ceph OSD in this case can be updated together with Ceph Mon and it will not cause an outage.  
__label__integration Refactor FFWD run to run on 1/3rd of controlplane  In order to pass the workload test we can't skip networker and other roles. We have to upgrade whole controlplane at once. Ceph OSD in this case can be updated together with Ceph Mon and it will not cause an outage.  
__label__objective Refactor FFWD run to run on 1/3rd of controlplane  In order to pass the workload test we can't skip networker and other roles. We have to upgrade whole controlplane at once. Ceph OSD in this case can be updated together with Ceph Mon and it will not cause an outage.  
__label__testing Refactor FFWD run to run on 1/3rd of controlplane  In order to pass the workload test we can't skip networker and other roles. We have to upgrade whole controlplane at once. Ceph OSD in this case can be updated together with Ceph Mon and it will not cause an outage.  
__label__integration Refactor FFWD run to run on 1/3rd of controlplane  In order to pass the workload test we can't skip networker and other roles. We have to upgrade whole controlplane at once. Ceph OSD in this case can be updated together with Ceph Mon and it will not cause an outage.  
__label__objective Refactor FFWD run to run on 1/3rd of controlplane  In order to pass the workload test we can't skip networker and other roles. We have to upgrade whole controlplane at once. Ceph OSD in this case can be updated together with Ceph Mon and it will not cause an outage.  
__label__testing Refactor FFWD run to run on 1/3rd of controlplane  In order to pass the workload test we can't skip networker and other roles. We have to upgrade whole controlplane at once. Ceph OSD in this case can be updated together with Ceph Mon and it will not cause an outage.  
__label__integration Refactor FFWD run to run on 1/3rd of controlplane  In order to pass the workload test we can't skip networker and other roles. We have to upgrade whole controlplane at once. Ceph OSD in this case can be updated together with Ceph Mon and it will not cause an outage.  
__label__objective Refactor FFWD run to run on 1/3rd of controlplane  In order to pass the workload test we can't skip networker and other roles. We have to upgrade whole controlplane at once. Ceph OSD in this case can be updated together with Ceph Mon and it will not cause an outage.  
__label__testing Refactor user config loading into function  Refactoring into a testable function in order to add further test coverage as well as cleanup the implementation of the main function to be nothing more than a sequence of clear and concise function calls  
__label__quality Refactor user config loading into function  Refactoring into a testable function in order to add further test coverage as well as cleanup the implementation of the main function to be nothing more than a sequence of clear and concise function calls  
__label__objective Refactor user config loading into function  Refactoring into a testable function in order to add further test coverage as well as cleanup the implementation of the main function to be nothing more than a sequence of clear and concise function calls  
__label__testing Add CORS unit tests more  This is a follow-up patch for https://review.openstack.org/#/c/258392/ That one added good unit test cases for various kinds of allowe_origin like '*' or ''(empty). However, the result of handling in Swift proxy will depend on strict_cors_mode option configuration.  This patch refactors the unit tests to split out for strict_cors_mode = on/off and add some missing unit tests for each case.  
__label__objective Add CORS unit tests more  This is a follow-up patch for https://review.openstack.org/#/c/258392/ That one added good unit test cases for various kinds of allowe_origin like '*' or ''(empty). However, the result of handling in Swift proxy will depend on strict_cors_mode option configuration.  This patch refactors the unit tests to split out for strict_cors_mode = on/off and add some missing unit tests for each case.  
__label__testing Add/refactor functional API tests  More functional tests were added to increase coverage, and some existing test cases were fixed as they apparently were not formatted properly.  
__label__quality Add/refactor functional API tests  More functional tests were added to increase coverage, and some existing test cases were fixed as they apparently were not formatted properly.  
__label__objective Add/refactor functional API tests  More functional tests were added to increase coverage, and some existing test cases were fixed as they apparently were not formatted properly.  
__label__testing Refactoring of upgrade tests  Adding to function upgrade_master possibility of choosing rollback, refactoring some test cases to use upgrade_master method.  
__label__objective Refactoring of upgrade tests  Adding to function upgrade_master possibility of choosing rollback, refactoring some test cases to use upgrade_master method.  
__label__objective Refactoring of upgrade tests  Adding to function upgrade_master possibility of choosing rollback, refactoring some test cases to use upgrade_master method.  
__label__testing Remove obsolete keepalived PID files before start  This is a combination of 2 commits. The first commit's message is:  keepalived refuses to start and claims "daemon already started" when there is already a process with the same PID as found in either the VRRP or the main process PID file. This happens even in case when the new process is not keepalived. The situation can happen when the neutron node is reset and the obsolete PID files are not cleaned before neutron is started.  This commit adds PID file cleanup before keepalived start.  Closes-Bug: 1561046 
__label__quality Remove obsolete keepalived PID files before start  This is a combination of 2 commits. The first commit's message is:  keepalived refuses to start and claims "daemon already started" when there is already a process with the same PID as found in either the VRRP or the main process PID file. This happens even in case when the new process is not keepalived. The situation can happen when the neutron node is reset and the obsolete PID files are not cleaned before neutron is started.  This commit adds PID file cleanup before keepalived start.  Closes-Bug: 1561046 
__label__objective Remove obsolete keepalived PID files before start  This is a combination of 2 commits. The first commit's message is:  keepalived refuses to start and claims "daemon already started" when there is already a process with the same PID as found in either the VRRP or the main process PID file. This happens even in case when the new process is not keepalived. The situation can happen when the neutron node is reset and the obsolete PID files are not cleaned before neutron is started.  This commit adds PID file cleanup before keepalived start.  Closes-Bug: 1561046 
__label__testing Remove obsolete keepalived PID files before start  This is a combination of 2 commits. The first commit's message is:  keepalived refuses to start and claims "daemon already started" when there is already a process with the same PID as found in either the VRRP or the main process PID file. This happens even in case when the new process is not keepalived. The situation can happen when the neutron node is reset and the obsolete PID files are not cleaned before neutron is started.  This commit adds PID file cleanup before keepalived start.  Closes-Bug: 1561046 
__label__quality Remove obsolete keepalived PID files before start  This is a combination of 2 commits. The first commit's message is:  keepalived refuses to start and claims "daemon already started" when there is already a process with the same PID as found in either the VRRP or the main process PID file. This happens even in case when the new process is not keepalived. The situation can happen when the neutron node is reset and the obsolete PID files are not cleaned before neutron is started.  This commit adds PID file cleanup before keepalived start.  Closes-Bug: 1561046 
__label__objective Remove obsolete keepalived PID files before start  This is a combination of 2 commits. The first commit's message is:  keepalived refuses to start and claims "daemon already started" when there is already a process with the same PID as found in either the VRRP or the main process PID file. This happens even in case when the new process is not keepalived. The situation can happen when the neutron node is reset and the obsolete PID files are not cleaned before neutron is started.  This commit adds PID file cleanup before keepalived start.  Closes-Bug: 1561046 
__label__testing Refactor workflow controller and fix a bug in _fail010_workflow()  * Method get_controller is moved out from WorkflowController class   because it's not related with its functionality directly * Fixed tests accordingly * "not found" test has been removed because there's no way now to   make "not found" exceptin get raised. In order to make it happen   we need to have a new workflow specification class w/o corresponding   WorkflowController implementation. So that exception is just left   just to check ourselves when we're working on a new WorkflowController   implementation.  
__label__quality Refactor workflow controller and fix a bug in _fail010_workflow()  * Method get_controller is moved out from WorkflowController class   because it's not related with its functionality directly * Fixed tests accordingly * "not found" test has been removed because there's no way now to   make "not found" exceptin get raised. In order to make it happen   we need to have a new workflow specification class w/o corresponding   WorkflowController implementation. So that exception is just left   just to check ourselves when we're working on a new WorkflowController   implementation.  
__label__objective Refactor workflow controller and fix a bug in _fail010_workflow()  * Method get_controller is moved out from WorkflowController class   because it's not related with its functionality directly * Fixed tests accordingly * "not found" test has been removed because there's no way now to   make "not found" exceptin get raised. In order to make it happen   we need to have a new workflow specification class w/o corresponding   WorkflowController implementation. So that exception is just left   just to check ourselves when we're working on a new WorkflowController   implementation.  
__label__testing Refactor and fix dummy process fixture  Extracting the test fixture that creates a new process and leaves it running for a given amount of time into helpers where other fixtures for functional tests live. This both keeps the fixtures at one place and increases visibility of the fixture so that it can be reused in other tests. At the same time, the fixture is fixed as the original code omitted starting the process.  
__label__quality Refactor and fix dummy process fixture  Extracting the test fixture that creates a new process and leaves it running for a given amount of time into helpers where other fixtures for functional tests live. This both keeps the fixtures at one place and increases visibility of the fixture so that it can be reused in other tests. At the same time, the fixture is fixed as the original code omitted starting the process.  
__label__objective Refactor and fix dummy process fixture  Extracting the test fixture that creates a new process and leaves it running for a given amount of time into helpers where other fixtures for functional tests live. This both keeps the fixtures at one place and increases visibility of the fixture so that it can be reused in other tests. At the same time, the fixture is fixed as the original code omitted starting the process.  
__label__testing Refactor router delete processing  The discussion in [2] indicated that [1] would lead to orphaned items during error cases.  This refactoring replaces the optimistic approach followed by [1] with a separate delete code path that does not execute the operations that take place within the namespace that will be removed.  Operations that take place outside of those namespaces are still performed to ensure that no orphaned items result.  A comment has been added to the functional test to explain what case is being tested.  [1] https://review.openstack.org/#/c/240971 [2] conversation starting at http://goo.gl/bZgvqW  Conflicts:         neutron/agent/l3/dvr_edge_ha_router.py         neutron/agent/l3/router_info.py         neutron/tests/functional/agent/l3/test_dvr_router.py  
__label__quality Refactor router delete processing  The discussion in [2] indicated that [1] would lead to orphaned items during error cases.  This refactoring replaces the optimistic approach followed by [1] with a separate delete code path that does not execute the operations that take place within the namespace that will be removed.  Operations that take place outside of those namespaces are still performed to ensure that no orphaned items result.  A comment has been added to the functional test to explain what case is being tested.  [1] https://review.openstack.org/#/c/240971 [2] conversation starting at http://goo.gl/bZgvqW  Conflicts:         neutron/agent/l3/dvr_edge_ha_router.py         neutron/agent/l3/router_info.py         neutron/tests/functional/agent/l3/test_dvr_router.py  
__label__objective Refactor router delete processing  The discussion in [2] indicated that [1] would lead to orphaned items during error cases.  This refactoring replaces the optimistic approach followed by [1] with a separate delete code path that does not execute the operations that take place within the namespace that will be removed.  Operations that take place outside of those namespaces are still performed to ensure that no orphaned items result.  A comment has been added to the functional test to explain what case is being tested.  [1] https://review.openstack.org/#/c/240971 [2] conversation starting at http://goo.gl/bZgvqW  Conflicts:         neutron/agent/l3/dvr_edge_ha_router.py         neutron/agent/l3/router_info.py         neutron/tests/functional/agent/l3/test_dvr_router.py  
__label__testing Add and refactor cluster cmd unit tests  This patch adds some missing cmd unit tests for cluster module and refactors current ones as well, slightly improving test coverage.  
__label__objective Add and refactor cluster cmd unit tests  This patch adds some missing cmd unit tests for cluster module and refactors current ones as well, slightly improving test coverage.  
__label__testing Refactor Barbican Key Manager Tests  Refactor Barbican Key Manager Test Cases with different auth types to inherit from a common base class.  
__label__quality Refactor Barbican Key Manager Tests  Refactor Barbican Key Manager Test Cases with different auth types to inherit from a common base class.  
__label__objective Refactor Barbican Key Manager Tests  Refactor Barbican Key Manager Test Cases with different auth types to inherit from a common base class.  
__label__testing Refactoring of code:  1) new snapshot module with code vss, lvm and part of backup.py - create_snapshot and remove_snapshot This module should contain all code related shadow, vss and any new snapshots.  2) new openstack module with code from osclient, restore and backup (BackupOS) This module should contain code related to cinder/nova backups  3) new utils module with code from utils, win_utils, bandwidth, config, exec_cmd, validator, streaming This module should containd code related to anything that cannot be extracted to its own module  4) new test modules - snapshot, utils, openstack and apiclient. Test scheduler daemon is now located in scheduler module.  5) Backup.py is deleted and code placed to openstack.backup (BackupOS) and to job.BackupJob  
__label__quality Refactoring of code:  1) new snapshot module with code vss, lvm and part of backup.py - create_snapshot and remove_snapshot This module should contain all code related shadow, vss and any new snapshots.  2) new openstack module with code from osclient, restore and backup (BackupOS) This module should contain code related to cinder/nova backups  3) new utils module with code from utils, win_utils, bandwidth, config, exec_cmd, validator, streaming This module should containd code related to anything that cannot be extracted to its own module  4) new test modules - snapshot, utils, openstack and apiclient. Test scheduler daemon is now located in scheduler module.  5) Backup.py is deleted and code placed to openstack.backup (BackupOS) and to job.BackupJob  
__label__objective Refactoring of code:  1) new snapshot module with code vss, lvm and part of backup.py - create_snapshot and remove_snapshot This module should contain all code related shadow, vss and any new snapshots.  2) new openstack module with code from osclient, restore and backup (BackupOS) This module should contain code related to cinder/nova backups  3) new utils module with code from utils, win_utils, bandwidth, config, exec_cmd, validator, streaming This module should containd code related to anything that cannot be extracted to its own module  4) new test modules - snapshot, utils, openstack and apiclient. Test scheduler daemon is now located in scheduler module.  5) Backup.py is deleted and code placed to openstack.backup (BackupOS) and to job.BackupJob  
__label__testing add heat back to allinone role after refactoring  * added orchestration recipes to integration test (allinone role) * added heat queries back to basic_queries in Rakefile (were removed previously   until refactore)  
__label__objective add heat back to allinone role after refactoring  * added orchestration recipes to integration test (allinone role) * added heat queries back to basic_queries in Rakefile (were removed previously   until refactore)  
__label__objective add heat back to allinone role after refactoring  * added orchestration recipes to integration test (allinone role) * added heat queries back to basic_queries in Rakefile (were removed previously   until refactore)  
__label__testing Refactor the management verbs check to utils  There are some API version checks in the utils like fields, provisioning state: https://github.com/openstack/ironic/blob/master/ironic/api/controllers/v1/utils.py#L190 https://github.com/openstack/ironic/blob/master/ironic/api/controllers/v1/utils.py#L202  Also, there is a API version related check about management verbs: https://github.com/openstack/ironic/blob/master/ironic/api/controllers/v1/node.py#L107  Will move the management verbs check in the utils to contain all the API version related check code. Also add some related test cases.  
__label__objective Refactor the management verbs check to utils  There are some API version checks in the utils like fields, provisioning state: https://github.com/openstack/ironic/blob/master/ironic/api/controllers/v1/utils.py#L190 https://github.com/openstack/ironic/blob/master/ironic/api/controllers/v1/utils.py#L202  Also, there is a API version related check about management verbs: https://github.com/openstack/ironic/blob/master/ironic/api/controllers/v1/node.py#L107  Will move the management verbs check in the utils to contain all the API version related check code. Also add some related test cases.  
__label__testing Refactor base test classes  - use config fixture - explicitly different config init for unit vs functional tests  
__label__quality Refactor base test classes  - use config fixture - explicitly different config init for unit vs functional tests  
__label__objective Refactor base test classes  - use config fixture - explicitly different config init for unit vs functional tests  
__label__testing [WIP] Refactor master node noop test  
__label__objective [WIP] Refactor master node noop test  
__label__testing Refactor share metadata tests to use DB  For the moment tests in 'manila.tests.api.v1.test_share_metadata' module mock all DB requests. It leads to failures in main code if we use DB-specific things. So, refactor all tests in that module to use test DB to unblock usage of DB-specific things.  
__label__integration Refactor share metadata tests to use DB  For the moment tests in 'manila.tests.api.v1.test_share_metadata' module mock all DB requests. It leads to failures in main code if we use DB-specific things. So, refactor all tests in that module to use test DB to unblock usage of DB-specific things.  
__label__objective Refactor share metadata tests to use DB  For the moment tests in 'manila.tests.api.v1.test_share_metadata' module mock all DB requests. It leads to failures in main code if we use DB-specific things. So, refactor all tests in that module to use test DB to unblock usage of DB-specific things.  
__label__testing [WIP] Refactor test_storlet_handler  Remaining TODOs  * Refactor whole test cases  * Rebase to the ongoing refactoring patch  * Add Asserts about request parameters  
__label__objective [WIP] Refactor test_storlet_handler  Remaining TODOs  * Refactor whole test cases  * Rebase to the ongoing refactoring patch  * Add Asserts about request parameters  
__label__testing Refactoring all cli related tests   * Use ssh_manager instead of context manager and remote  * delete remote as variable of function, all methods are executed    on master node so it is not necessary  * changes was accepted for cli tests , test_cli_base, and    create_backup_reset_restore_and_deploy_via_cli test  
__label__quality Refactoring all cli related tests   * Use ssh_manager instead of context manager and remote  * delete remote as variable of function, all methods are executed    on master node so it is not necessary  * changes was accepted for cli tests , test_cli_base, and    create_backup_reset_restore_and_deploy_via_cli test  
__label__objective Refactoring all cli related tests   * Use ssh_manager instead of context manager and remote  * delete remote as variable of function, all methods are executed    on master node so it is not necessary  * changes was accepted for cli tests , test_cli_base, and    create_backup_reset_restore_and_deploy_via_cli test  
__label__testing refactor: Remove unused test method  This method was unused. Removing it from the test code.  
__label__objective refactor: Remove unused test method  This method was unused. Removing it from the test code.  
__label__testing refactor sphinxext and add unit tests  Break up the directive into separate functions that are easier to test individually, and start adding unit tests.  
__label__quality refactor sphinxext and add unit tests  Break up the directive into separate functions that are easier to test individually, and start adding unit tests.  
__label__objective refactor sphinxext and add unit tests  Break up the directive into separate functions that are easier to test individually, and start adding unit tests.  
__label__testing Refactor remove_router_interface() for DVR  Currently this method duplicates code from l3_db, looks complicated and hard to read. The patch refactors it to reuse code from l3_db just adding needed dvr related handling. New methods (introduced by parent patch) were used to know which dvr agents should router be deleted from. This will be needed when we remove explicit binding of dvr agents to routers in later patches.  The patch also removes useless 'mock all' kind of test and replaces it with a functional test.  Partially implements blueprint improve-dvr-l3-agent-binding  
__label__quality Refactor remove_router_interface() for DVR  Currently this method duplicates code from l3_db, looks complicated and hard to read. The patch refactors it to reuse code from l3_db just adding needed dvr related handling. New methods (introduced by parent patch) were used to know which dvr agents should router be deleted from. This will be needed when we remove explicit binding of dvr agents to routers in later patches.  The patch also removes useless 'mock all' kind of test and replaces it with a functional test.  Partially implements blueprint improve-dvr-l3-agent-binding  
__label__objective Refactor remove_router_interface() for DVR  Currently this method duplicates code from l3_db, looks complicated and hard to read. The patch refactors it to reuse code from l3_db just adding needed dvr related handling. New methods (introduced by parent patch) were used to know which dvr agents should router be deleted from. This will be needed when we remove explicit binding of dvr agents to routers in later patches.  The patch also removes useless 'mock all' kind of test and replaces it with a functional test.  Partially implements blueprint improve-dvr-l3-agent-binding  
__label__testing Refactor Nexus test code to remove duplication  In preparation for newer development, now is the time to eliminate redundancy in the file 'test_cisco_nexus.py' by splitting its content into three files:  test_cisco_nexus_base.py:   contains shared information test_cisco_nexus_events.py: contains tests for incoming events test_cisco_nexus_replay.py: contains tests focused on replay activity  
__label__quality Refactor Nexus test code to remove duplication  In preparation for newer development, now is the time to eliminate redundancy in the file 'test_cisco_nexus.py' by splitting its content into three files:  test_cisco_nexus_base.py:   contains shared information test_cisco_nexus_events.py: contains tests for incoming events test_cisco_nexus_replay.py: contains tests focused on replay activity  
__label__objective Refactor Nexus test code to remove duplication  In preparation for newer development, now is the time to eliminate redundancy in the file 'test_cisco_nexus.py' by splitting its content into three files:  test_cisco_nexus_base.py:   contains shared information test_cisco_nexus_events.py: contains tests for incoming events test_cisco_nexus_replay.py: contains tests focused on replay activity  
__label__testing Refactor test auth_plugin config into fixture  Moving the logic into a fixture so we can use it without the large class hierarchies.  
__label__quality Refactor test auth_plugin config into fixture  Moving the logic into a fixture so we can use it without the large class hierarchies.  
__label__objective Refactor test auth_plugin config into fixture  Moving the logic into a fixture so we can use it without the large class hierarchies.  
__label__quality Refactor abstract columns and datalist out in image,volume and object test cases  columns and datalist has been set in each test case in image, volume and object which is not necessary. This patch abstract it out and remove all redundant code.  
__label__objective Refactor abstract columns and datalist out in image,volume and object test cases  columns and datalist has been set in each test case in image, volume and object which is not necessary. This patch abstract it out and remove all redundant code.  
__label__testing Refactor: Abstract columns and datalist out in volume test cases  columns and datalist has been set in each test case in volume, which is not necessary. This patch abstract it out and remove all redundant code.  
__label__quality Refactor: Abstract columns and datalist out in volume test cases  columns and datalist has been set in each test case in volume, which is not necessary. This patch abstract it out and remove all redundant code.  
__label__objective Refactor: Abstract columns and datalist out in volume test cases  columns and datalist has been set in each test case in volume, which is not necessary. This patch abstract it out and remove all redundant code.  
__label__testing Refactor abstract columns and datalist out in compute test cases  columns and datalist has been set in each test case in compute, which is not necessary. This patch abstract it out and remove all redundant code.  
__label__quality Refactor abstract columns and datalist out in compute test cases  columns and datalist has been set in each test case in compute, which is not necessary. This patch abstract it out and remove all redundant code.  
__label__objective Refactor abstract columns and datalist out in compute test cases  columns and datalist has been set in each test case in compute, which is not necessary. This patch abstract it out and remove all redundant code.  
__label__testing Refactor stethoclient unit test  
__label__objective Refactor stethoclient unit test  
__label__testing [test-runner] Refactor mock unit-tests  Move asserts from Python to MuranoPL code, so now test case are fully written in MuranoPL.  
__label__objective [test-runner] Refactor mock unit-tests  Move asserts from Python to MuranoPL code, so now test case are fully written in MuranoPL.  
__label__testing Refactor share metadata tests to use DB  For the moment tests in 'manila.tests.api.v1.test_share_metadata' module mock all DB requests. It leads to failures in main code if we use DB-specific things. So, refactor all tests in that module to use test DB to unblock usage of DB-specific things.  
__label__integration Refactor share metadata tests to use DB  For the moment tests in 'manila.tests.api.v1.test_share_metadata' module mock all DB requests. It leads to failures in main code if we use DB-specific things. So, refactor all tests in that module to use test DB to unblock usage of DB-specific things.  
__label__objective Refactor share metadata tests to use DB  For the moment tests in 'manila.tests.api.v1.test_share_metadata' module mock all DB requests. It leads to failures in main code if we use DB-specific things. So, refactor all tests in that module to use test DB to unblock usage of DB-specific things.  
__label__testing Refactor Nexus test code to remove duplication  In preparation for newer development, now is the time to eliminate redundancy in the file 'test_cisco_nexus.py' by splitting its content into three files:  test_cisco_nexus_base.py:   contains shared information test_cisco_nexus_events.py: contains tests for incoming events test_cisco_nexus_replay.py: contains tests focused on replay activity  
__label__quality Refactor Nexus test code to remove duplication  In preparation for newer development, now is the time to eliminate redundancy in the file 'test_cisco_nexus.py' by splitting its content into three files:  test_cisco_nexus_base.py:   contains shared information test_cisco_nexus_events.py: contains tests for incoming events test_cisco_nexus_replay.py: contains tests focused on replay activity  
__label__objective Refactor Nexus test code to remove duplication  In preparation for newer development, now is the time to eliminate redundancy in the file 'test_cisco_nexus.py' by splitting its content into three files:  test_cisco_nexus_base.py:   contains shared information test_cisco_nexus_events.py: contains tests for incoming events test_cisco_nexus_replay.py: contains tests focused on replay activity  
__label__testing Refactor fullstack tests  Create base test class for creating the Neutron client and the DF NB_API client. Seperate the Neutron API-DB tests from the OVS flows tests with different file  
__label__objective Refactor fullstack tests  Create base test class for creating the Neutron client and the DF NB_API client. Seperate the Neutron API-DB tests from the OVS flows tests with different file  
__label__quality Refactor fullstack tests  Create base test class for creating the Neutron client and the DF NB_API client. Seperate the Neutron API-DB tests from the OVS flows tests with different file  
__label__testing Add key-listener to refactored timeline  This change adds a key-listener to navigate between test rectangles on the timeline. When an out-of-view test is selected, the timeline will refocus and bring it into view. Functionality for left and right arrow keys is supported, up and down (to navigate between workers) key are not supported, but may be added in a future patch.  
__label__objective Add key-listener to refactored timeline  This change adds a key-listener to navigate between test rectangles on the timeline. When an out-of-view test is selected, the timeline will refocus and bring it into view. Functionality for left and right arrow keys is supported, up and down (to navigate between workers) key are not supported, but may be added in a future patch.  
__label__objective Add key-listener to refactored timeline  This change adds a key-listener to navigate between test rectangles on the timeline. When an out-of-view test is selected, the timeline will refocus and bring it into view. Functionality for left and right arrow keys is supported, up and down (to navigate between workers) key are not supported, but may be added in a future patch.  
__label__testing Small refactoring in test_admin_actions.py  This patch adds the method tearDown(). This method will only be called if the setUp() succeeds, regardless of the outcome of the test method.  
__label__objective Small refactoring in test_admin_actions.py  This patch adds the method tearDown(). This method will only be called if the setUp() succeeds, regardless of the outcome of the test method.  
__label__testing Add new test and code refactoring  
__label__testing Refactor: Initialize parser in setUp() in TestKeyValueAction  No need to initialize parser in each test case. Do it in setUp(). Also remove the test_default_values case because it could be tested in the test_good_values case.  
__label__objective Refactor: Initialize parser in setUp() in TestKeyValueAction  No need to initialize parser in each test case. Do it in setUp(). Also remove the test_default_values case because it could be tested in the test_good_values case.  
__label__testing Refactor fullstack create network test  Exception throwing will fail test, no need to catch it, this reduce complexity of the test.  
__label__quality Refactor fullstack create network test  Exception throwing will fail test, no need to catch it, this reduce complexity of the test.  
__label__objective Refactor fullstack create network test  Exception throwing will fail test, no need to catch it, this reduce complexity of the test.  
__label__testing VMware: Unit test refactoring  There are cases where a single test tests multiple methods. This patch refactors the unit tests for the following methods in the vmdk module to fix this issue:    * copy_image_to_volume    * _create_volume_from_non_stream_optimized_image  There will be follow-up patches to fix the remaining unit tests.  
__label__objective VMware: Unit test refactoring  There are cases where a single test tests multiple methods. This patch refactors the unit tests for the following methods in the vmdk module to fix this issue:    * copy_image_to_volume    * _create_volume_from_non_stream_optimized_image  There will be follow-up patches to fix the remaining unit tests.  
__label__testing Refactor test use of new_*_ref  The new_*_ref functions were confusing because while some of them used the base new_ref() function, the ones that use it were often removing fields anyways. Then there were other new_*_ref functions that didn't use new_ref() at all. So new_ref() is removed and the functions just create the dict that they need.  
__label__objective Refactor test use of new_*_ref  The new_*_ref functions were confusing because while some of them used the base new_ref() function, the ones that use it were often removing fields anyways. Then there were other new_*_ref functions that didn't use new_ref() at all. So new_ref() is removed and the functions just create the dict that they need.  
__label__quality Refactor test use of new_*_ref  The new_*_ref functions were confusing because while some of them used the base new_ref() function, the ones that use it were often removing fields anyways. Then there were other new_*_ref functions that didn't use new_ref() at all. So new_ref() is removed and the functions just create the dict that they need.  
__label__testing Refactor: Remove use of self where not needed  In test_v3_resource, some tests create local entities scoped to the test class instance, as opposed to scoped only to the test method.  This patch fixes such occurrences.  
__label__objective Refactor: Remove use of self where not needed  In test_v3_resource, some tests create local entities scoped to the test class instance, as opposed to scoped only to the test method.  This patch fixes such occurrences.  
__label__testing VMware: Unit test refactoring  There are cases where a single test tests multiple methods. This patch refactors the unit tests for the following methods in the vmdk module to fix this issue:    * _create_virtual_disk_from_preallocated_image    * _create_virtual_disk_from_sparse_image    * _fetch_stream_optimized_image  There will be follow-up patches to fix the remaining unit tests.  
__label__objective VMware: Unit test refactoring  There are cases where a single test tests multiple methods. This patch refactors the unit tests for the following methods in the vmdk module to fix this issue:    * _create_virtual_disk_from_preallocated_image    * _create_virtual_disk_from_sparse_image    * _fetch_stream_optimized_image  There will be follow-up patches to fix the remaining unit tests.  
__label__testing Refactor common auth token code in images test  This pulls out the authentication token manipulation used by some of the images functional tests, which is replicated in several places into a single helper. This will also be used by a subsequent functional test for cross-owner copy-image support.  
__label__objective Refactor common auth token code in images test  This pulls out the authentication token manipulation used by some of the images functional tests, which is replicated in several places into a single helper. This will also be used by a subsequent functional test for cross-owner copy-image support.  
__label__quality Refactor common auth token code in images test  This pulls out the authentication token manipulation used by some of the images functional tests, which is replicated in several places into a single helper. This will also be used by a subsequent functional test for cross-owner copy-image support.  
__label__testing Refactor network test: Remove unusful test code.  openstackclient/tests/network/common.py won't be used anymore. Remove it.  
__label__objective Refactor network test: Remove unusful test code.  openstackclient/tests/network/common.py won't be used anymore. Remove it.  
__label__quality Refactor network test: Remove unusful test code.  openstackclient/tests/network/common.py won't be used anymore. Remove it.  
__label__testing Refactor TestSetNetwork: Use TestNetwork in TestSetNetwork  Use TestNetwork in TestSetNetwork, and also setup test command in setUp().  
__label__objective Refactor TestSetNetwork: Use TestNetwork in TestSetNetwork  Use TestNetwork in TestSetNetwork, and also setup test command in setUp().  
__label__testing Refactor TestDeleteNetwork: Use TestNetwork in TestDeleteNetwork.  Make TestDeleteNetwork inherit from TestNetwork, and have the same class architecture as the other test classes.  
__label__quality Refactor TestDeleteNetwork: Use TestNetwork in TestDeleteNetwork.  Make TestDeleteNetwork inherit from TestNetwork, and have the same class architecture as the other test classes.  
__label__objective Refactor TestDeleteNetwork: Use TestNetwork in TestDeleteNetwork.  Make TestDeleteNetwork inherit from TestNetwork, and have the same class architecture as the other test classes.  
__label__quality Refactor TestCreateNetwork: Split TestCreateNetwork into two classes for identity v2 and v3.  In TestCreateNetwork, both Identity v2 and v3 clients are tested. As a result, we should initialize the identity client again and again in each test function.  To reduce redundant code, this patch split TestCreateNetwork to TestCreateNetworkIdentityV2 and V3. And then initialize the identity client only once in each of them.  
__label__objective Refactor TestCreateNetwork: Split TestCreateNetwork into two classes for identity v2 and v3.  In TestCreateNetwork, both Identity v2 and v3 clients are tested. As a result, we should initialize the identity client again and again in each test function.  To reduce redundant code, this patch split TestCreateNetwork to TestCreateNetworkIdentityV2 and V3. And then initialize the identity client only once in each of them.  
__label__testing Refactor TestCreateNetwork: Split TestCreateNetwork into two classes for identity v2 and v3.  In TestCreateNetwork, both Identity v2 and v3 clients are tested. As a result, we should initialize the identity client again and again in each test function.  To reduce redundant code, this patch split TestCreateNetwork to TestCreateNetworkIdentityV2 and V3. And then initialize the identity client only once in each of them.  
__label__testing Refactor network test: Introduce TestNetworkv2 and TestNetwork to improve unit test of network.  The class inherit architecture in network unit test is different from other test classes, which leads to lots of redundant code. This patch will make it the same as the other test classes. And it will be more convenience for the coming up refactor.  
__label__quality Refactor network test: Introduce TestNetworkv2 and TestNetwork to improve unit test of network.  The class inherit architecture in network unit test is different from other test classes, which leads to lots of redundant code. This patch will make it the same as the other test classes. And it will be more convenience for the coming up refactor.  
__label__objective Refactor network test: Introduce TestNetworkv2 and TestNetwork to improve unit test of network.  The class inherit architecture in network unit test is different from other test classes, which leads to lots of redundant code. This patch will make it the same as the other test classes. And it will be more convenience for the coming up refactor.  
__label__testing Refactor: Abstract datalist out in TestFlavorList to avoid redundant code.  datalist has been set in each test case in TestFlavorList, which is not necessary. This patch abstract it out and remove all redundant code.  
__label__quality Refactor: Abstract datalist out in TestFlavorList to avoid redundant code.  datalist has been set in each test case in TestFlavorList, which is not necessary. This patch abstract it out and remove all redundant code.  
__label__objective Refactor: Abstract datalist out in TestFlavorList to avoid redundant code.  datalist has been set in each test case in TestFlavorList, which is not necessary. This patch abstract it out and remove all redundant code.  
__label__testing Refactor: Abstract columns out in TestFlavorList to avoid redundant code.  The columns has been set in each test case of TestFlavorList, which is not necessary. This patch abstract it out and remove all redundant code.  
__label__quality Refactor: Abstract columns out in TestFlavorList to avoid redundant code.  The columns has been set in each test case of TestFlavorList, which is not necessary. This patch abstract it out and remove all redundant code.  
__label__objective Refactor: Abstract columns out in TestFlavorList to avoid redundant code.  The columns has been set in each test case of TestFlavorList, which is not necessary. This patch abstract it out and remove all redundant code.  
__label__testing Refactor the test for Fuel Master migration  Refactor the test to use template based approach: - refactor the test to use template driven engine; - add a new nodes config - 1 controller + 1 compute; - add 2 new test configs - for VLAN and VXLAN net. providers :that use the new '1 controller + 1 compute' nodes config.  
__label__objective Refactor the test for Fuel Master migration  Refactor the test to use template based approach: - refactor the test to use template driven engine; - add a new nodes config - 1 controller + 1 compute; - add 2 new test configs - for VLAN and VXLAN net. providers :that use the new '1 controller + 1 compute' nodes config.  
__label__testing Refactor VPN functional tests to use common template  This will change the existing functional test jobs to use a common job template. To do this the following steps were taken:  - Make the jobs non-voting, so they don't break the gate. This means   that reviewers need to check the non-voting results, prior to +A.  - Removed experimental functional jobs that were previously created,   in both the neutron and neutron-vpnaas repos. These jobs were going to   replace the existing ones (but do the same thing). Aborting that   approach.  - Remove the experimental API job. A separate commit will add it back   in, and use the new common template, as part of work to getting the   API job working.  Partial-Bug: #1495584  
__label__objective Refactor VPN functional tests to use common template  This will change the existing functional test jobs to use a common job template. To do this the following steps were taken:  - Make the jobs non-voting, so they don't break the gate. This means   that reviewers need to check the non-voting results, prior to +A.  - Removed experimental functional jobs that were previously created,   in both the neutron and neutron-vpnaas repos. These jobs were going to   replace the existing ones (but do the same thing). Aborting that   approach.  - Remove the experimental API job. A separate commit will add it back   in, and use the new common template, as part of work to getting the   API job working.  Partial-Bug: #1495584  
__label__quality Refactor VPN functional tests to use common template  This will change the existing functional test jobs to use a common job template. To do this the following steps were taken:  - Make the jobs non-voting, so they don't break the gate. This means   that reviewers need to check the non-voting results, prior to +A.  - Removed experimental functional jobs that were previously created,   in both the neutron and neutron-vpnaas repos. These jobs were going to   replace the existing ones (but do the same thing). Aborting that   approach.  - Remove the experimental API job. A separate commit will add it back   in, and use the new common template, as part of work to getting the   API job working.  Partial-Bug: #1495584  
__label__testing EMC VNX Manila Driver Refactoring  EMC VNX Manila driver refactoring targets to the following aspects: 1. Make the object-oriented storage object-oriented 2. Improve the unit test coverage  
__label__objective EMC VNX Manila Driver Refactoring  EMC VNX Manila driver refactoring targets to the following aspects: 1. Make the object-oriented storage object-oriented 2. Improve the unit test coverage  
__label__testing Refactor home controller process data test  This test used to test more functionality than it was meant to. In particular, it should only be concerned about verifying whether the passes/failures were correctly calculated, but instead, if we changed the ordering of the projects, it would also fail.  This modifies it to be concerned only with the calculated project data.  
__label__objective Refactor home controller process data test  This test used to test more functionality than it was meant to. In particular, it should only be concerned about verifying whether the passes/failures were correctly calculated, but instead, if we changed the ordering of the projects, it would also fail.  This modifies it to be concerned only with the calculated project data.  
__label__testing Refactor DB unit test  
__label__testing Refactor volume_boot_pattern test  Replaced local timpestamp methods to common class methods.  
__label__objective Refactor volume_boot_pattern test  Replaced local timpestamp methods to common class methods.  
__label__testing VMware: Unit test refactoring  Some of the unit tests use mox instead of mock. Also, there are cases where a single test tests multiple cases and methods. This patch refactors the unit tests for the following methods in the vmdk module to fix these issues:  * get_volume_stats * _verify_volume_creation * create_volume * delete_volume * _get_extra_spec_disk_type * _get_disk_type * create_snapshot * delete_snapshot  There will be follow-up patches to fix the remaining unit tests.  Partial-bug: #1261097 
__label__quality VMware: Unit test refactoring  Some of the unit tests use mox instead of mock. Also, there are cases where a single test tests multiple cases and methods. This patch refactors the unit tests for the following methods in the vmdk module to fix these issues:  * get_volume_stats * _verify_volume_creation * create_volume * delete_volume * _get_extra_spec_disk_type * _get_disk_type * create_snapshot * delete_snapshot  There will be follow-up patches to fix the remaining unit tests.  Partial-bug: #1261097 
__label__objective VMware: Unit test refactoring  Some of the unit tests use mox instead of mock. Also, there are cases where a single test tests multiple cases and methods. This patch refactors the unit tests for the following methods in the vmdk module to fix these issues:  * get_volume_stats * _verify_volume_creation * create_volume * delete_volume * _get_extra_spec_disk_type * _get_disk_type * create_snapshot * delete_snapshot  There will be follow-up patches to fix the remaining unit tests.  Partial-bug: #1261097 
__label__testing Small refactoring of CLI tests for packages  - Removed running of local server from setUp method, because actually it is needed only for one test - Refactored 'import_package_by_url' method to allow it import package not only by url  
__label__objective Small refactoring of CLI tests for packages  - Removed running of local server from setUp method, because actually it is needed only for one test - Refactored 'import_package_by_url' method to allow it import package not only by url  
__label__testing Refactor _populate_ports_for_subnets for testability  I want to add to this function but I found it very difficult to test the additions that I was making (because this code isn't well covered by UTs).  This patch adds some unit testing so that I can change it more confidently but does not change any functionality.  
__label__quality Refactor _populate_ports_for_subnets for testability  I want to add to this function but I found it very difficult to test the additions that I was making (because this code isn't well covered by UTs).  This patch adds some unit testing so that I can change it more confidently but does not change any functionality.  
__label__objective Refactor _populate_ports_for_subnets for testability  I want to add to this function but I found it very difficult to test the additions that I was making (because this code isn't well covered by UTs).  This patch adds some unit testing so that I can change it more confidently but does not change any functionality.  
__label__testing Refactor: change 403 status codes in test names  Change I952cac73a9713bde4ad757371ca8b4ded93f207e refactored the keystone test cases to use the six.moves.http_client for HTTP status codes instead of integers. This change refactors the method names to follow the same pattern.  
__label__quality Refactor: change 403 status codes in test names  Change I952cac73a9713bde4ad757371ca8b4ded93f207e refactored the keystone test cases to use the six.moves.http_client for HTTP status codes instead of integers. This change refactors the method names to follow the same pattern.  
__label__objective Refactor: change 403 status codes in test names  Change I952cac73a9713bde4ad757371ca8b4ded93f207e refactored the keystone test cases to use the six.moves.http_client for HTTP status codes instead of integers. This change refactors the method names to follow the same pattern.  
__label__testing Refactor: change 410 status codes in test names  Change I952cac73a9713bde4ad757371ca8b4ded93f207e refactored the keystone test cases to use the six.moves.http_client for HTTP status codes instead of integers. This change refactors the method names to follow the same pattern.  
__label__quality Refactor: change 410 status codes in test names  Change I952cac73a9713bde4ad757371ca8b4ded93f207e refactored the keystone test cases to use the six.moves.http_client for HTTP status codes instead of integers. This change refactors the method names to follow the same pattern.  
__label__objective Refactor: change 410 status codes in test names  Change I952cac73a9713bde4ad757371ca8b4ded93f207e refactored the keystone test cases to use the six.moves.http_client for HTTP status codes instead of integers. This change refactors the method names to follow the same pattern.  
__label__testing Refactor: change 400 status codes in test names  Change I952cac73a9713bde4ad757371ca8b4ded93f207e refactored the keystone test cases to use the six.moves.http_client for HTTP status codes instead of integers. This change refactors the method names to follow the same pattern.  
__label__quality Refactor: change 400 status codes in test names  Change I952cac73a9713bde4ad757371ca8b4ded93f207e refactored the keystone test cases to use the six.moves.http_client for HTTP status codes instead of integers. This change refactors the method names to follow the same pattern.  
__label__objective Refactor: change 400 status codes in test names  Change I952cac73a9713bde4ad757371ca8b4ded93f207e refactored the keystone test cases to use the six.moves.http_client for HTTP status codes instead of integers. This change refactors the method names to follow the same pattern.  
__label__testing Refactor: change 404 status codes in test names  Change I952cac73a9713bde4ad757371ca8b4ded93f207e refactored the keystone test cases to use the six.moves.http_client for HTTP status codes instead of integers. This change refactors the method names to follow the same pattern.  
__label__quality Refactor: change 404 status codes in test names  Change I952cac73a9713bde4ad757371ca8b4ded93f207e refactored the keystone test cases to use the six.moves.http_client for HTTP status codes instead of integers. This change refactors the method names to follow the same pattern.  
__label__objective Refactor: change 404 status codes in test names  Change I952cac73a9713bde4ad757371ca8b4ded93f207e refactored the keystone test cases to use the six.moves.http_client for HTTP status codes instead of integers. This change refactors the method names to follow the same pattern.  
__label__testing Refactor reinstall and partition preservation tests  Follow changes were done in this patch: - create cluster with controller + mongo instead of   creating separate nodes for controller and mongo. - reinstall_single_mongo_node test was deleted. - merge mongo_partition_preservation and   mysql_partition_preservation tests in   mongo_mysql_partition_preservation test - merge cinder_partition_preservation and   nova_partition_preservation tests in   cinder_nova_partition_preservation test.  
__label__integration Refactor reinstall and partition preservation tests  Follow changes were done in this patch: - create cluster with controller + mongo instead of   creating separate nodes for controller and mongo. - reinstall_single_mongo_node test was deleted. - merge mongo_partition_preservation and   mysql_partition_preservation tests in   mongo_mysql_partition_preservation test - merge cinder_partition_preservation and   nova_partition_preservation tests in   cinder_nova_partition_preservation test.  
__label__quality Refactor reinstall and partition preservation tests  Follow changes were done in this patch: - create cluster with controller + mongo instead of   creating separate nodes for controller and mongo. - reinstall_single_mongo_node test was deleted. - merge mongo_partition_preservation and   mysql_partition_preservation tests in   mongo_mysql_partition_preservation test - merge cinder_partition_preservation and   nova_partition_preservation tests in   cinder_nova_partition_preservation test.  
__label__objective Refactor reinstall and partition preservation tests  Follow changes were done in this patch: - create cluster with controller + mongo instead of   creating separate nodes for controller and mongo. - reinstall_single_mongo_node test was deleted. - merge mongo_partition_preservation and   mysql_partition_preservation tests in   mongo_mysql_partition_preservation test - merge cinder_partition_preservation and   nova_partition_preservation tests in   cinder_nova_partition_preservation test.  
__label__testing Refactor grafana.py test coverage  Add 2 new tests for the __init__ function. Testing with / without the apikey.  Also rework our requests_mock logic.  
__label__objective Refactor grafana.py test coverage  Add 2 new tests for the __init__ function. Testing with / without the apikey.  Also rework our requests_mock logic.  
__label__testing Refactoring of upgrade tests  Deleting duplicated tests, Adding to function upgrade_master possibility of choosing rollback, refactoring some test cases to use upgrade_master method.  
__label__quality Refactoring of upgrade tests  Deleting duplicated tests, Adding to function upgrade_master possibility of choosing rollback, refactoring some test cases to use upgrade_master method.  
__label__objective Refactoring of upgrade tests  Deleting duplicated tests, Adding to function upgrade_master possibility of choosing rollback, refactoring some test cases to use upgrade_master method.  
__label__testing Refactoring test 'check_oswl_stat'  Changes in test 'check_oswl_stat' and in function 'get_oswls_by_resource_data' Closes-Bug: #1476208  
__label__objective Refactoring test 'check_oswl_stat'  Changes in test 'check_oswl_stat' and in function 'get_oswls_by_resource_data' Closes-Bug: #1476208  
__label__testing Refactoring test 'check_oswl_stat'  Changes in test 'check_oswl_stat' and in function 'get_oswls_by_resource_data' Closes-Bug: #1476208  
__label__objective Refactoring test 'check_oswl_stat'  Changes in test 'check_oswl_stat' and in function 'get_oswls_by_resource_data' Closes-Bug: #1476208  
__label__testing Refactor the test for /NetworkDriver.CreateNetwork  This patch renames TestKuryrNetworkFailrues to TestKuryrNetworkCreateFailrues and replaces the hardcoded messge test with the variable defined in the Flask exception.  
__label__quality Refactor the test for /NetworkDriver.CreateNetwork  This patch renames TestKuryrNetworkFailrues to TestKuryrNetworkCreateFailrues and replaces the hardcoded messge test with the variable defined in the Flask exception.  
__label__objective Refactor the test for /NetworkDriver.CreateNetwork  This patch renames TestKuryrNetworkFailrues to TestKuryrNetworkCreateFailrues and replaces the hardcoded messge test with the variable defined in the Flask exception.  
__label__testing Refactoring Unit Test Directories  This commit creates two paths in tests, /unit and /functional. As we begin to ensure proper unit test coverage we want to use conventions whenever possible to keep our tests properly separated and in conventional locations.  
__label__quality Refactoring Unit Test Directories  This commit creates two paths in tests, /unit and /functional. As we begin to ensure proper unit test coverage we want to use conventions whenever possible to keep our tests properly separated and in conventional locations.  
__label__objective Refactoring Unit Test Directories  This commit creates two paths in tests, /unit and /functional. As we begin to ensure proper unit test coverage we want to use conventions whenever possible to keep our tests properly separated and in conventional locations.  
__label__testing Refactory test cases for live-migrate error case  There are a few of exceptions can be raised from live-migrate function in conductor, this patch added some cases for more exceptions handling and refactory the util function with mock.  
__label__objective Refactory test cases for live-migrate error case  There are a few of exceptions can be raised from live-migrate function in conductor, this patch added some cases for more exceptions handling and refactory the util function with mock.  
__label__testing Refactor nova-network cases to neutron  - use neutron in tests migrate_vm_backed_with_ceph and   check_ceph_partitions_after_reboot - add showing "steps" from docstring into test cases - refactor fuel master backup/restore helper methods  
__label__objective Refactor nova-network cases to neutron  - use neutron in tests migrate_vm_backed_with_ceph and   check_ceph_partitions_after_reboot - add showing "steps" from docstring into test cases - refactor fuel master backup/restore helper methods  
__label__testing Remove test_rescue_server for reconsideration and refactor  The ability to rescue and unrescue a server as an admin api action is dependant on the configuration of the openstack cloud under test. This test should be refactored to more easily test the expected behavior based on the environment in which it is run.  
__label__objective Remove test_rescue_server for reconsideration and refactor  The ability to rescue and unrescue a server as an admin api action is dependant on the configuration of the openstack cloud under test. This test should be refactored to more easily test the expected behavior based on the environment in which it is run.  
__label__testing Remove test_connectivity_during_live_migration for later refactor.  This test is very sensitive to timing issues in an openstack environment and, during test failures, can enter into an unhappy path which throws test related code bugs. This test is being removed so that it can be reconsidered and refactored to be more resilient to environmental stressors and gracefully fail in the event of feature failure.  
__label__quality Remove test_connectivity_during_live_migration for later refactor.  This test is very sensitive to timing issues in an openstack environment and, during test failures, can enter into an unhappy path which throws test related code bugs. This test is being removed so that it can be reconsidered and refactored to be more resilient to environmental stressors and gracefully fail in the event of feature failure.  
__label__objective Remove test_connectivity_during_live_migration for later refactor.  This test is very sensitive to timing issues in an openstack environment and, during test failures, can enter into an unhappy path which throws test related code bugs. This test is being removed so that it can be reconsidered and refactored to be more resilient to environmental stressors and gracefully fail in the event of feature failure.  
__label__testing Refactor v2 scenario tests  When api and scenario tests were copied from tempest and test_healh_monitor_basic was added, scenario code suffered a number of changes which introduced code duplication, worsened its architecture and affected test performance (i.e. test_load_balancer_basic booted 2 instances instead of just one).  This change refactors scenario tests by:   1. Moving all tests into a single module and a single class,      which allows to make set-up easier.   2. Reducing some code duplication in the base module.  NOTE: This patch includes fixes from https://review.openstack.org/#/c/207196/1 . As soon as this change is rebase and ready to merge I'll rebase on top of it.  
__label__quality Refactor v2 scenario tests  When api and scenario tests were copied from tempest and test_healh_monitor_basic was added, scenario code suffered a number of changes which introduced code duplication, worsened its architecture and affected test performance (i.e. test_load_balancer_basic booted 2 instances instead of just one).  This change refactors scenario tests by:   1. Moving all tests into a single module and a single class,      which allows to make set-up easier.   2. Reducing some code duplication in the base module.  NOTE: This patch includes fixes from https://review.openstack.org/#/c/207196/1 . As soon as this change is rebase and ready to merge I'll rebase on top of it.  
__label__objective Refactor v2 scenario tests  When api and scenario tests were copied from tempest and test_healh_monitor_basic was added, scenario code suffered a number of changes which introduced code duplication, worsened its architecture and affected test performance (i.e. test_load_balancer_basic booted 2 instances instead of just one).  This change refactors scenario tests by:   1. Moving all tests into a single module and a single class,      which allows to make set-up easier.   2. Reducing some code duplication in the base module.  NOTE: This patch includes fixes from https://review.openstack.org/#/c/207196/1 . As soon as this change is rebase and ready to merge I'll rebase on top of it.  
__label__testing Refactor: move PKI-specific tests into the appropriate class  This patch moves PKI and PKIZ specific tests into a PKI specific test class. The PKIZ test class then inherits those tests from the PKI test class. The UUID test class no longer has to override the parent class to skip an irrelevant test.  
__label__quality Refactor: move PKI-specific tests into the appropriate class  This patch moves PKI and PKIZ specific tests into a PKI specific test class. The PKIZ test class then inherits those tests from the PKI test class. The UUID test class no longer has to override the parent class to skip an irrelevant test.  
__label__objective Refactor: move PKI-specific tests into the appropriate class  This patch moves PKI and PKIZ specific tests into a PKI specific test class. The PKIZ test class then inherits those tests from the PKI test class. The UUID test class no longer has to override the parent class to skip an irrelevant test.  
__label__testing Remove test_delete_for_deleted_image_fails for later refactor.  The test fails depending on the version of Glance used for Nova calls. This test is being removed and reconsidered.  
__label__objective Remove test_delete_for_deleted_image_fails for later refactor.  The test fails depending on the version of Glance used for Nova calls. This test is being removed and reconsidered.  
__label__testing Refactor of mysql test: test separated from controller databases  Rertieve data about mysql hosts from hiera instead of hardcoded controllers  
__label__quality Refactor of mysql test: test separated from controller databases  Rertieve data about mysql hosts from hiera instead of hardcoded controllers  
__label__objective Refactor of mysql test: test separated from controller databases  Rertieve data about mysql hosts from hiera instead of hardcoded controllers  
__label__testing Refactor unit test for InstanceGroup objects  The goal of this patch was to remove the use of the database in the unit tests for the InstanceGroup objects. We now mock out all database interactions in the object unit tests and verify that the calls to the DB API are appropriate.  
__label__integration Refactor unit test for InstanceGroup objects  The goal of this patch was to remove the use of the database in the unit tests for the InstanceGroup objects. We now mock out all database interactions in the object unit tests and verify that the calls to the DB API are appropriate.  
__label__objective Refactor unit test for InstanceGroup objects  The goal of this patch was to remove the use of the database in the unit tests for the InstanceGroup objects. We now mock out all database interactions in the object unit tests and verify that the calls to the DB API are appropriate.  
__label__testing refactor 'show' method from compute controller  This is part of the controller refactoring. The current desing is hard to test, since each API action is done in a single method.  This refactoring tries to split the construction of the OpenStack V2 api requests from all the other logic, so that we can test it separatedly.  Moreover, this refactoring introduces new unit testing, instead of the functional testing that is being done right now.  
__label__objective refactor 'show' method from compute controller  This is part of the controller refactoring. The current desing is hard to test, since each API action is done in a single method.  This refactoring tries to split the construction of the OpenStack V2 api requests from all the other logic, so that we can test it separatedly.  Moreover, this refactoring introduces new unit testing, instead of the functional testing that is being done right now.  
__label__quality refactor 'show' method from compute controller  This is part of the controller refactoring. The current desing is hard to test, since each API action is done in a single method.  This refactoring tries to split the construction of the OpenStack V2 api requests from all the other logic, so that we can test it separatedly.  Moreover, this refactoring introduces new unit testing, instead of the functional testing that is being done right now.  
__label__testing refactor action method from compute controller  This is part of the controller refactoring. The current desing is hard to test, since each API action is done in a single method.  This refactoring tries to split the construction of the OpenStack V2 api requests from all the other logic, so that we can test it separatedly. Moreover, this refactoring introduces new unit testing, instead of the functional testing that is being done right now.  
__label__objective refactor action method from compute controller  This is part of the controller refactoring. The current desing is hard to test, since each API action is done in a single method.  This refactoring tries to split the construction of the OpenStack V2 api requests from all the other logic, so that we can test it separatedly. Moreover, this refactoring introduces new unit testing, instead of the functional testing that is being done right now.  
__label__quality refactor action method from compute controller  This is part of the controller refactoring. The current desing is hard to test, since each API action is done in a single method.  This refactoring tries to split the construction of the OpenStack V2 api requests from all the other logic, so that we can test it separatedly. Moreover, this refactoring introduces new unit testing, instead of the functional testing that is being done right now.  
__label__testing Refactor assertEqual statement that includes 'True'  We have a hacking check to make sure assertTrue is used instead of assertEqual(True, something). The regex used for that likely needs to be fixed as it's overly complex for what it is trying to match.  We are seeing pep8 failures flagging an instance of assertEqual that is comparing a tuple that happens to contain True as one of its values. As an easier path to get around this failure until someone can reevaluate the hacking check regex, this just reformats the test code so that it no longer gets matched by the existing regex.  
__label__objective Refactor assertEqual statement that includes 'True'  We have a hacking check to make sure assertTrue is used instead of assertEqual(True, something). The regex used for that likely needs to be fixed as it's overly complex for what it is trying to match.  We are seeing pep8 failures flagging an instance of assertEqual that is comparing a tuple that happens to contain True as one of its values. As an easier path to get around this failure until someone can reevaluate the hacking check regex, this just reformats the test code so that it no longer gets matched by the existing regex.  
__label__quality Refactor assertEqual statement that includes 'True'  We have a hacking check to make sure assertTrue is used instead of assertEqual(True, something). The regex used for that likely needs to be fixed as it's overly complex for what it is trying to match.  We are seeing pep8 failures flagging an instance of assertEqual that is comparing a tuple that happens to contain True as one of its values. As an easier path to get around this failure until someone can reevaluate the hacking check regex, this just reformats the test code so that it no longer gets matched by the existing regex.  
__label__testing Refactor nova tests to use neutron  - Changed test_ha_one_controller_base to use neutron - Changed test_ha_one_controller to use neutron - deploy_ha_one_controller_vlan test was deleted as duplicate of deploy_ha_one_controller_neutron  
__label__objective Refactor nova tests to use neutron  - Changed test_ha_one_controller_base to use neutron - Changed test_ha_one_controller to use neutron - deploy_ha_one_controller_vlan test was deleted as duplicate of deploy_ha_one_controller_neutron  
__label__quality Refactor nova tests to use neutron  - Changed test_ha_one_controller_base to use neutron - Changed test_ha_one_controller to use neutron - deploy_ha_one_controller_vlan test was deleted as duplicate of deploy_ha_one_controller_neutron  
__label__testing refactoring nova ha system tests to use neutron network manager  Changed nova-network-manager to neutron-vlan on next test cases: Add and re-add cinder / compute + cinder to HA cluster Add compute node to cluster in HA mode with flat nova-network Check HA mode on scalability Backup/restore master node with cluster in ha mode  
__label__objective refactoring nova ha system tests to use neutron network manager  Changed nova-network-manager to neutron-vlan on next test cases: Add and re-add cinder / compute + cinder to HA cluster Add compute node to cluster in HA mode with flat nova-network Check HA mode on scalability Backup/restore master node with cluster in ha mode  
__label__testing Refactor plugin name checking logic  This patch reworks the plugin name checking so that it can be shared among different plugin types. Major revisions include:  - Add a new exception type 'InvalidPlugin' for plugin related   exceptions. - Remove the 'ProfileValidationFailure' exception type, which is not   useful and it is confusing. Replace it with 'InvalidPlugin'. - Remove the 'InvalidPolicyType' exception type, which is not very   useful. Replace it with 'InvalidPlugin'. - Combine profile name checking and policy name checking into a shared   function. Revised the test case as needed.  
__label__objective Refactor plugin name checking logic  This patch reworks the plugin name checking so that it can be shared among different plugin types. Major revisions include:  - Add a new exception type 'InvalidPlugin' for plugin related   exceptions. - Remove the 'ProfileValidationFailure' exception type, which is not   useful and it is confusing. Replace it with 'InvalidPlugin'. - Remove the 'InvalidPolicyType' exception type, which is not very   useful. Replace it with 'InvalidPlugin'. - Combine profile name checking and policy name checking into a shared   function. Revised the test case as needed.  
__label__quality Refactor plugin name checking logic  This patch reworks the plugin name checking so that it can be shared among different plugin types. Major revisions include:  - Add a new exception type 'InvalidPlugin' for plugin related   exceptions. - Remove the 'ProfileValidationFailure' exception type, which is not   useful and it is confusing. Replace it with 'InvalidPlugin'. - Remove the 'InvalidPolicyType' exception type, which is not very   useful. Replace it with 'InvalidPlugin'. - Combine profile name checking and policy name checking into a shared   function. Revised the test case as needed.  
__label__testing Refactor diskfile  This patch mostly eliminates the duplicate code that was deliberately left in place during EC review to avoid major churn of the diskfile module prior to the kilo release.  This focuses on obvious de-duplication and shuffling code between classes. It deliberately does not attempt to hammer out every last piece of de-duplication where that would introduce more complex changes - that can come later.  Code is moved from the module level and from ECDiskFile* classes into new BaseDiskFile* classes.  Concrete classes for replication and EC policy retain their existing names i.e. DiskFile[Manager|Writer|Reader|] and ECDiskFile[Manager|Writer|Reader|] respectively.  Knock-on changes:  - fix bug whereby get_hashes was ignoring self.reclaim_age   and always using the default arg value.  - replication diskfile manager now deletes a tombstone that is older   than reclaim_age even when there is a newer .meta file.  - replication diskfile manager will no longer raise an   AssertionError if only a .meta file is found during   hash_cleanup_listdir.  - fix stale test in test_auditor.py: test_with_tombstone didn't   make much sense other than to verify that a tombstone is not   removed by auditor, but the test setup was convoluted and I think   dates back to when object puts did not clean up the object dir.   Now that they do you have to try harder to create a dir with   a tombstone and a data file.  TODO: the naming of _get_hashes() and get_hashes() needs to be fixed:   - both are called from other modules so neither should have     the '_': the heritage is that before we had diskfile.get_hashes()     which was called by DiskFileManager.get_hashes() via     DiskFileManager._get_hashes().   - Now diskfile.get_hashes() has been moved in the class to be     DiskFileManager._get_hashes() but it is still called from the     replicator.   - Do we even need both? get_hashes() does a little more checking     wrt _get_hashes() but replicator has all the info it needs to call     get_hashes() instead and let it build the partition path.  
__label__quality Refactor diskfile  This patch mostly eliminates the duplicate code that was deliberately left in place during EC review to avoid major churn of the diskfile module prior to the kilo release.  This focuses on obvious de-duplication and shuffling code between classes. It deliberately does not attempt to hammer out every last piece of de-duplication where that would introduce more complex changes - that can come later.  Code is moved from the module level and from ECDiskFile* classes into new BaseDiskFile* classes.  Concrete classes for replication and EC policy retain their existing names i.e. DiskFile[Manager|Writer|Reader|] and ECDiskFile[Manager|Writer|Reader|] respectively.  Knock-on changes:  - fix bug whereby get_hashes was ignoring self.reclaim_age   and always using the default arg value.  - replication diskfile manager now deletes a tombstone that is older   than reclaim_age even when there is a newer .meta file.  - replication diskfile manager will no longer raise an   AssertionError if only a .meta file is found during   hash_cleanup_listdir.  - fix stale test in test_auditor.py: test_with_tombstone didn't   make much sense other than to verify that a tombstone is not   removed by auditor, but the test setup was convoluted and I think   dates back to when object puts did not clean up the object dir.   Now that they do you have to try harder to create a dir with   a tombstone and a data file.  TODO: the naming of _get_hashes() and get_hashes() needs to be fixed:   - both are called from other modules so neither should have     the '_': the heritage is that before we had diskfile.get_hashes()     which was called by DiskFileManager.get_hashes() via     DiskFileManager._get_hashes().   - Now diskfile.get_hashes() has been moved in the class to be     DiskFileManager._get_hashes() but it is still called from the     replicator.   - Do we even need both? get_hashes() does a little more checking     wrt _get_hashes() but replicator has all the info it needs to call     get_hashes() instead and let it build the partition path.  
__label__objective Refactor diskfile  This patch mostly eliminates the duplicate code that was deliberately left in place during EC review to avoid major churn of the diskfile module prior to the kilo release.  This focuses on obvious de-duplication and shuffling code between classes. It deliberately does not attempt to hammer out every last piece of de-duplication where that would introduce more complex changes - that can come later.  Code is moved from the module level and from ECDiskFile* classes into new BaseDiskFile* classes.  Concrete classes for replication and EC policy retain their existing names i.e. DiskFile[Manager|Writer|Reader|] and ECDiskFile[Manager|Writer|Reader|] respectively.  Knock-on changes:  - fix bug whereby get_hashes was ignoring self.reclaim_age   and always using the default arg value.  - replication diskfile manager now deletes a tombstone that is older   than reclaim_age even when there is a newer .meta file.  - replication diskfile manager will no longer raise an   AssertionError if only a .meta file is found during   hash_cleanup_listdir.  - fix stale test in test_auditor.py: test_with_tombstone didn't   make much sense other than to verify that a tombstone is not   removed by auditor, but the test setup was convoluted and I think   dates back to when object puts did not clean up the object dir.   Now that they do you have to try harder to create a dir with   a tombstone and a data file.  TODO: the naming of _get_hashes() and get_hashes() needs to be fixed:   - both are called from other modules so neither should have     the '_': the heritage is that before we had diskfile.get_hashes()     which was called by DiskFileManager.get_hashes() via     DiskFileManager._get_hashes().   - Now diskfile.get_hashes() has been moved in the class to be     DiskFileManager._get_hashes() but it is still called from the     replicator.   - Do we even need both? get_hashes() does a little more checking     wrt _get_hashes() but replicator has all the info it needs to call     get_hashes() instead and let it build the partition path.  
__label__testing Refactoring galera state test  1) Removed 1 extra indent level 2) Removed 'return result' expression 3) Changed method of analysis mysql output  
__label__objective Refactoring galera state test  1) Removed 1 extra indent level 2) Removed 'return result' expression 3) Changed method of analysis mysql output  
__label__quality Refactoring galera state test  1) Removed 1 extra indent level 2) Removed 'return result' expression 3) Changed method of analysis mysql output  
__label__testing test_zabbix_py system test refactoring  * Using neutron instead of nova * Segment type choose by env var NEUTRON_SEGMENT_TYPE   which is 'vlan' by default * Context manager for SSH sessions * 'assert_cluster_ready' calls removed, assume network   verification and ostf will check the same  
__label__objective test_zabbix_py system test refactoring  * Using neutron instead of nova * Segment type choose by env var NEUTRON_SEGMENT_TYPE   which is 'vlan' by default * Context manager for SSH sessions * 'assert_cluster_ready' calls removed, assume network   verification and ostf will check the same  
__label__quality test_zabbix_py system test refactoring  * Using neutron instead of nova * Segment type choose by env var NEUTRON_SEGMENT_TYPE   which is 'vlan' by default * Context manager for SSH sessions * 'assert_cluster_ready' calls removed, assume network   verification and ostf will check the same  
__label__testing Fix/refactor test_stack_update_existing_parameters  This test is supposed to prove that passing the "existing" flag to an update_stack call merges existing parameters with any new ones passed into the update, but atm it strangely starts with a stack containing zero existing parameters, and uses some convoluted mocks to prove that the new parameters are used.  So AFAICT it's not really testing what is required and it's pretty hard to read.  Refactoring so we look at the environment passed into the Stack constructor (mocked with mock) enables us to compare the before/ after parameters and ensure the existing and new ones are correctly combined as expected.  
__label__quality Fix/refactor test_stack_update_existing_parameters  This test is supposed to prove that passing the "existing" flag to an update_stack call merges existing parameters with any new ones passed into the update, but atm it strangely starts with a stack containing zero existing parameters, and uses some convoluted mocks to prove that the new parameters are used.  So AFAICT it's not really testing what is required and it's pretty hard to read.  Refactoring so we look at the environment passed into the Stack constructor (mocked with mock) enables us to compare the before/ after parameters and ensure the existing and new ones are correctly combined as expected.  
__label__objective Fix/refactor test_stack_update_existing_parameters  This test is supposed to prove that passing the "existing" flag to an update_stack call merges existing parameters with any new ones passed into the update, but atm it strangely starts with a stack containing zero existing parameters, and uses some convoluted mocks to prove that the new parameters are used.  So AFAICT it's not really testing what is required and it's pretty hard to read.  Refactoring so we look at the environment passed into the Stack constructor (mocked with mock) enables us to compare the before/ after parameters and ensure the existing and new ones are correctly combined as expected.  
__label__testing Refactor upgrade system tests  * Make same method names, test groups and snapshots for all tests. * Remove nova simple, replace nova to neutron. * Remove self.fuel_web.assert_cluster_ready calls. Assume it can be checked by OSTF.  
__label__objective Refactor upgrade system tests  * Make same method names, test groups and snapshots for all tests. * Remove nova simple, replace nova to neutron. * Remove self.fuel_web.assert_cluster_ready calls. Assume it can be checked by OSTF.  
__label__testing Refactoring of 'Check stack autoscaling' Heat OSTF test  - Made code style changes in test - Removed unused functions - Optimize some functions by removing dubbed code  Partially implements: blueprint heat-ostf-test-refactoring  
__label__quality Refactoring of 'Check stack autoscaling' Heat OSTF test  - Made code style changes in test - Removed unused functions - Optimize some functions by removing dubbed code  Partially implements: blueprint heat-ostf-test-refactoring  
__label__objective Refactoring of 'Check stack autoscaling' Heat OSTF test  - Made code style changes in test - Removed unused functions - Optimize some functions by removing dubbed code  Partially implements: blueprint heat-ostf-test-refactoring  
__label__testing Advanved stack actions' Heat OSTF test refactoring  - Optimized work with stack resources, added new method _get_stack_resources() that allows to return list of any desired stack resources (not only servers) by some criteria. In the next commits _get_stack_instances method will be removed and all other tests will use _get_stack_resources(). - Added checks for statuses of resources. - Made some code style changes.  Implements: heat-ostf-test-refactoring  
__label__quality Advanved stack actions' Heat OSTF test refactoring  - Optimized work with stack resources, added new method _get_stack_resources() that allows to return list of any desired stack resources (not only servers) by some criteria. In the next commits _get_stack_instances method will be removed and all other tests will use _get_stack_resources(). - Added checks for statuses of resources. - Made some code style changes.  Implements: heat-ostf-test-refactoring  
__label__objective Advanved stack actions' Heat OSTF test refactoring  - Optimized work with stack resources, added new method _get_stack_resources() that allows to return list of any desired stack resources (not only servers) by some criteria. In the next commits _get_stack_instances method will be removed and all other tests will use _get_stack_resources(). - Added checks for statuses of resources. - Made some code style changes.  Implements: heat-ostf-test-refactoring  
__label__testing Refactor alarm scenario tests (TestAlarmsBase)  Currently, 'TestAlarms' has several types of test objectives including api, alarm hitory and various alarm rules.  This patch adds new base class 'TestAlarmsBase' by which we can split tests mixed in TestAlarms into different classes.  
__label__objective Refactor alarm scenario tests (TestAlarmsBase)  Currently, 'TestAlarms' has several types of test objectives including api, alarm hitory and various alarm rules.  This patch adds new base class 'TestAlarmsBase' by which we can split tests mixed in TestAlarms into different classes.  
__label__testing Refactor configuration tests  Not used variables was deleted. SSH connetction in test 'Check usage of default credentials on master node' use credentials of master node.  
__label__quality Refactor configuration tests  Not used variables was deleted. SSH connetction in test 'Check usage of default credentials on master node' use credentials of master node.  
__label__objective Refactor configuration tests  Not used variables was deleted. SSH connetction in test 'Check usage of default credentials on master node' use credentials of master node.  
__label__testing Add 'default_mapping' to 'network_roles_metadata'    Add 'get_network_roles' method to 'objects.Cluster'   Add 'TestClusterObject.test_get_network_roles' unit test   Add 'default_mapping' to 'network_roles_metadata' of openstack.yaml fixture   Refactor 'NeutronNetworkDeploymentSerializer70.generate_network_scheme' in   order to fetch data using 'get_network_roles'  
__label__objective Add 'default_mapping' to 'network_roles_metadata'    Add 'get_network_roles' method to 'objects.Cluster'   Add 'TestClusterObject.test_get_network_roles' unit test   Add 'default_mapping' to 'network_roles_metadata' of openstack.yaml fixture   Refactor 'NeutronNetworkDeploymentSerializer70.generate_network_scheme' in   order to fetch data using 'get_network_roles'  
__label__testing Refactor test_share_create_failed test for Manila  test_share_create_failed check that check_create_complete raises ResourceInError exception, but there is no necessity to create all resource, because if ResourceInError has been raised, heat tries to recreate stack, thereforce test_share_create_failed runs 68 seconds. Now test only checks correct raising ResourceInError in check_create_complete.  Also, refactor such way test_share_create_unknown_status  
__label__quality Refactor test_share_create_failed test for Manila  test_share_create_failed check that check_create_complete raises ResourceInError exception, but there is no necessity to create all resource, because if ResourceInError has been raised, heat tries to recreate stack, thereforce test_share_create_failed runs 68 seconds. Now test only checks correct raising ResourceInError in check_create_complete.  Also, refactor such way test_share_create_unknown_status  
__label__objective Refactor test_share_create_failed test for Manila  test_share_create_failed check that check_create_complete raises ResourceInError exception, but there is no necessity to create all resource, because if ResourceInError has been raised, heat tries to recreate stack, thereforce test_share_create_failed runs 68 seconds. Now test only checks correct raising ResourceInError in check_create_complete.  Also, refactor such way test_share_create_unknown_status  
__label__testing Refactor verify_get tests  Remove the multiple approaches and use one verify_get test method.  
__label__objective Refactor verify_get tests  Remove the multiple approaches and use one verify_get test method.  
__label__testing Refactor: move PKI-specific tests into the appropriate class  This patch moves PKI and PKIZ specific tests into a PKI specific test class. The PKIZ test class then inherits those tests from the PKI test class. The UUID test class no longer has to override the parent class to skip an irrelevant test.  
__label__quality Refactor: move PKI-specific tests into the appropriate class  This patch moves PKI and PKIZ specific tests into a PKI specific test class. The PKIZ test class then inherits those tests from the PKI test class. The UUID test class no longer has to override the parent class to skip an irrelevant test.  
__label__objective Refactor: move PKI-specific tests into the appropriate class  This patch moves PKI and PKIZ specific tests into a PKI specific test class. The PKIZ test class then inherits those tests from the PKI test class. The UUID test class no longer has to override the parent class to skip an irrelevant test.  
__label__testing Refactor magnum functional test to add Kubernetes API test  To test Kubernetes API, we need bay created and as already in magnum functional test, we were creating bay. So this patch refactors the code to seperate methods for each operation. So that it can be used at other places.  
__label__objective Refactor magnum functional test to add Kubernetes API test  To test Kubernetes API, we need bay created and as already in magnum functional test, we were creating bay. So this patch refactors the code to seperate methods for each operation. So that it can be used at other places.  
__label__testing Targets test refactoring  The unit tests for iser inherit from the tgtAdm, it means that any time run tests for iser, tgtAdm tests run too. This chache add TargetFixture to tests, it allows to decouple tests and delete duplicated code.  Other changes:  -  deleted  __init__ in test's classes; __init__ may work as a replacement for setUp, but  setUp should be used instead because it is part of the protocol for writing tests. It also has a counterpart, tearDown, which __init__ does no;  - replaced stubs to mock.  
__label__quality Targets test refactoring  The unit tests for iser inherit from the tgtAdm, it means that any time run tests for iser, tgtAdm tests run too. This chache add TargetFixture to tests, it allows to decouple tests and delete duplicated code.  Other changes:  -  deleted  __init__ in test's classes; __init__ may work as a replacement for setUp, but  setUp should be used instead because it is part of the protocol for writing tests. It also has a counterpart, tearDown, which __init__ does no;  - replaced stubs to mock.  
__label__objective Targets test refactoring  The unit tests for iser inherit from the tgtAdm, it means that any time run tests for iser, tgtAdm tests run too. This chache add TargetFixture to tests, it allows to decouple tests and delete duplicated code.  Other changes:  -  deleted  __init__ in test's classes; __init__ may work as a replacement for setUp, but  setUp should be used instead because it is part of the protocol for writing tests. It also has a counterpart, tearDown, which __init__ does no;  - replaced stubs to mock.  
__label__testing Fixed refactored Keystone token names  Keystone token tests were moved in a refactoring. Fixed names of test to match latest Tempest.  
__label__objective Fixed refactored Keystone token names  Keystone token tests were moved in a refactoring. Fixed names of test to match latest Tempest.  
__label__testing Refactor an unit test to use urlencode()  Use urlencode() instead of formatting manually URL parameters.  
__label__objective Refactor an unit test to use urlencode()  Use urlencode() instead of formatting manually URL parameters.  
__label__testing refactor functional test base class to no inherit from tempest_lib  Test base classes inheriting outside the existing source tree to anything higher up the stack than testtools is really an anti pattern. It makes it *far* less clear what is going on. We really need to own and understand our base class setup for tests.  This does that unwind, so that we only now call out to tempest_lib in specific ways (like building clients, using decorators). The timeout and log capture pieces are pulled inline.  At the end of this we end up with a base test that defines:   - self.client - a Nova API client  - self.flavor - a workable flavor for booting guests  - self.image - a workable image for booting guests  - self.cli_clients - tempest_lib cli clients  
__label__quality refactor functional test base class to no inherit from tempest_lib  Test base classes inheriting outside the existing source tree to anything higher up the stack than testtools is really an anti pattern. It makes it *far* less clear what is going on. We really need to own and understand our base class setup for tests.  This does that unwind, so that we only now call out to tempest_lib in specific ways (like building clients, using decorators). The timeout and log capture pieces are pulled inline.  At the end of this we end up with a base test that defines:   - self.client - a Nova API client  - self.flavor - a workable flavor for booting guests  - self.image - a workable image for booting guests  - self.cli_clients - tempest_lib cli clients  
__label__objective refactor functional test base class to no inherit from tempest_lib  Test base classes inheriting outside the existing source tree to anything higher up the stack than testtools is really an anti pattern. It makes it *far* less clear what is going on. We really need to own and understand our base class setup for tests.  This does that unwind, so that we only now call out to tempest_lib in specific ways (like building clients, using decorators). The timeout and log capture pieces are pulled inline.  At the end of this we end up with a base test that defines:   - self.client - a Nova API client  - self.flavor - a workable flavor for booting guests  - self.image - a workable image for booting guests  - self.cli_clients - tempest_lib cli clients  
__label__testing Refactor cue client tests  - Added fixtures to test controllers  
__label__quality Refactor cue client tests  - Added fixtures to test controllers  
__label__objective Refactor cue client tests  - Added fixtures to test controllers  
__label__testing Refactor GBP resource mapping with Neutron RESTful APIs  1. Decouple GBP resource mapping from neutron plugins and use Neutron RESTful APIs instead.  2. Move neutron_client related calls to neutron_api_mixin for easier removing in the future.  3. Add mock_neutronv2_api to provide methods to patch the Neutron RESTful API calls with WSGI calls.  4. Modify the existing 'UT' for the resource mapping driver, by patching the RESTful APIs with the WSGI calls, to ensure the test scenarios are still examined and passed.  5. Modify the existing 'UT' for the APIC mapping driver, by patching the RESTful APIs with the WSGI calls, to ensure the test scenarios are still examined and passed.  
__label__quality Refactor GBP resource mapping with Neutron RESTful APIs  1. Decouple GBP resource mapping from neutron plugins and use Neutron RESTful APIs instead.  2. Move neutron_client related calls to neutron_api_mixin for easier removing in the future.  3. Add mock_neutronv2_api to provide methods to patch the Neutron RESTful API calls with WSGI calls.  4. Modify the existing 'UT' for the resource mapping driver, by patching the RESTful APIs with the WSGI calls, to ensure the test scenarios are still examined and passed.  5. Modify the existing 'UT' for the APIC mapping driver, by patching the RESTful APIs with the WSGI calls, to ensure the test scenarios are still examined and passed.  
__label__objective Refactor GBP resource mapping with Neutron RESTful APIs  1. Decouple GBP resource mapping from neutron plugins and use Neutron RESTful APIs instead.  2. Move neutron_client related calls to neutron_api_mixin for easier removing in the future.  3. Add mock_neutronv2_api to provide methods to patch the Neutron RESTful API calls with WSGI calls.  4. Modify the existing 'UT' for the resource mapping driver, by patching the RESTful APIs with the WSGI calls, to ensure the test scenarios are still examined and passed.  5. Modify the existing 'UT' for the APIC mapping driver, by patching the RESTful APIs with the WSGI calls, to ensure the test scenarios are still examined and passed.  
__label__testing VPNaaS: Refactor functional tests to use discover  (WIP: DO NOT MERGE)  Attempt to use OS_TEST_FILTERS to specify the test combinations to run, for the two functional test jobs.  Currently, it seems to only be running the tests in common area.  
__label__objective VPNaaS: Refactor functional tests to use discover  (WIP: DO NOT MERGE)  Attempt to use OS_TEST_FILTERS to specify the test combinations to run, for the two functional test jobs.  Currently, it seems to only be running the tests in common area.  
__label__testing refactored test in vmware test_read_write_util to pass with random PYTHONHASHSEED  changed request url param generation to respect param order before assertion Partial-Bug: #1348818  
__label__quality refactored test in vmware test_read_write_util to pass with random PYTHONHASHSEED  changed request url param generation to respect param order before assertion Partial-Bug: #1348818  
__label__objective refactored test in vmware test_read_write_util to pass with random PYTHONHASHSEED  changed request url param generation to respect param order before assertion Partial-Bug: #1348818  
__label__testing Minor refactor of the integration service test  remove the duplicate code  Closes-bug: #1432863 
__label__quality Minor refactor of the integration service test  remove the duplicate code  Closes-bug: #1432863 
__label__objective Minor refactor of the integration service test  remove the duplicate code  Closes-bug: #1432863 
__label__testing Refactor some service tests and make them not require db  This refactors service tests in a few different ways:   - Remove unnecessary calls  - Make tests test what they say instead of something that other tests    already cover (make TestLauncher into something else than testing    what test_service_random_port already does)  - Make them not require db  
__label__objective Refactor some service tests and make them not require db  This refactors service tests in a few different ways:   - Remove unnecessary calls  - Make tests test what they say instead of something that other tests    already cover (make TestLauncher into something else than testing    what test_service_random_port already does)  - Make them not require db  
__label__testing Refactor API function test class       - Move API requests to separate methods      - Update setUp to create a stable background for each test  Closes bug: #1293210  
__label__quality Refactor API function test class       - Move API requests to separate methods      - Update setUp to create a stable background for each test  Closes bug: #1293210  
__label__objective Refactor API function test class       - Move API requests to separate methods      - Update setUp to create a stable background for each test  Closes bug: #1293210  
__label__testing Refactor test code to reduce duplication  As part of review 163730 a helper method was identified as being duplicated.  This patch moves the code to a common location, and updates the users of it to use the new version.  There's no functionality change in this patch, just a refactoring.  
__label__quality Refactor test code to reduce duplication  As part of review 163730 a helper method was identified as being duplicated.  This patch moves the code to a common location, and updates the users of it to use the new version.  There's no functionality change in this patch, just a refactoring.  
__label__objective Refactor test code to reduce duplication  As part of review 163730 a helper method was identified as being duplicated.  This patch moves the code to a common location, and updates the users of it to use the new version.  There's no functionality change in this patch, just a refactoring.  
__label__testing Refactored test in linux_net to pass with random PYTHONHASHSEED  Previous implementation wraps dns list into set. With random PYTHONHASHSEED set elements iteration order wasn't guaranteed.  
__label__objective Refactored test in linux_net to pass with random PYTHONHASHSEED  Previous implementation wraps dns list into set. With random PYTHONHASHSEED set elements iteration order wasn't guaranteed.  
__label__testing refactored test in test_neutron_driver to pass with random PYTHONHASHSEED  changed argument comparrison in mox.Stub from concrete list to mox.SameElementsAs.  
__label__objective refactored test in test_neutron_driver to pass with random PYTHONHASHSEED  changed argument comparrison in mox.Stub from concrete list to mox.SameElementsAs.  
__label__testing Murano OSTF tests refactoring  In 6.1 MOS Murano will not have packages by default. This patch adds skipping to tests, if user have no requested package in Murano.  Also this patch adds test, which imports package and test Murano engine. This is nessesary to be sure that Murano forks correctly in MOS.  Closes=Bug: #1436914  
__label__objective Murano OSTF tests refactoring  In 6.1 MOS Murano will not have packages by default. This patch adds skipping to tests, if user have no requested package in Murano.  Also this patch adds test, which imports package and test Murano engine. This is nessesary to be sure that Murano forks correctly in MOS.  Closes=Bug: #1436914  
__label__testing Fix failing after refactoring CLI test for execution  After refactoring tests need to wait a little bit more time before execution will be in 'SUCCESS' state, that's why it was needed to add extra method that will check execution state and wait for 'Success'.  
__label__objective Fix failing after refactoring CLI test for execution  After refactoring tests need to wait a little bit more time before execution will be in 'SUCCESS' state, that's why it was needed to add extra method that will check execution state and wait for 'Success'.  
__label__quality Fix failing after refactoring CLI test for execution  After refactoring tests need to wait a little bit more time before execution will be in 'SUCCESS' state, that's why it was needed to add extra method that will check execution state and wait for 'Success'.  
__label__testing Refactor Functional Test Cases  To simplify the setup code, a base class "Swift3FanctionalTestCase" expeced to keep common procedures there is added to __init__.py.  
__label__quality Refactor Functional Test Cases  To simplify the setup code, a base class "Swift3FanctionalTestCase" expeced to keep common procedures there is added to __init__.py.  
__label__objective Refactor Functional Test Cases  To simplify the setup code, a base class "Swift3FanctionalTestCase" expeced to keep common procedures there is added to __init__.py.  
__label__testing Split out and refactored more secret tests  This is a continuation of the refactor effort of test resources. Also removed invalid bit test due to it being an impossible scenario. This should increase readability and remove a reliance on magic mock.  
__label__quality Split out and refactored more secret tests  This is a continuation of the refactor effort of test resources. Also removed invalid bit test due to it being an impossible scenario. This should increase readability and remove a reliance on magic mock.  
__label__objective Split out and refactored more secret tests  This is a continuation of the refactor effort of test resources. Also removed invalid bit test due to it being an impossible scenario. This should increase readability and remove a reliance on magic mock.  
__label__testing Refactor _regex_instance_filter for testing  _regex_instance_filter was determing which regex operation to use based on the database connection config.  This led to writing tests that modified the connection config to be different than the one which created the engine.  This was mostly harmless but now that we're looking to add the ability to get different engines based on that config value this can lead to confusion and errors.  There was a test class intended to test this behavior but only a few of the tests in there actually did.  The class has renamed more appropriately and tests which did not belong were moved to other test classes.  
__label__objective Refactor _regex_instance_filter for testing  _regex_instance_filter was determing which regex operation to use based on the database connection config.  This led to writing tests that modified the connection config to be different than the one which created the engine.  This was mostly harmless but now that we're looking to add the ability to get different engines based on that config value this can lead to confusion and errors.  There was a test class intended to test this behavior but only a few of the tests in there actually did.  The class has renamed more appropriately and tests which did not belong were moved to other test classes.  
__label__quality Refactor _regex_instance_filter for testing  _regex_instance_filter was determing which regex operation to use based on the database connection config.  This led to writing tests that modified the connection config to be different than the one which created the engine.  This was mostly harmless but now that we're looking to add the ability to get different engines based on that config value this can lead to confusion and errors.  There was a test class intended to test this behavior but only a few of the tests in there actually did.  The class has renamed more appropriately and tests which did not belong were moved to other test classes.  
__label__testing Refactor: move initiator test to cadf specific section  the initiator tests are only applicable to cadf notifications, so move them into that test suite.  
__label__objective Refactor: move initiator test to cadf specific section  the initiator tests are only applicable to cadf notifications, so move them into that test suite.  
__label__testing Refactor: create a common base for notification tests  this should allow other test classes to mixin the base test and take advantage of the mocked notifications.  
__label__quality Refactor: create a common base for notification tests  this should allow other test classes to mixin the base test and take advantage of the mocked notifications.  
__label__objective Refactor: create a common base for notification tests  this should allow other test classes to mixin the base test and take advantage of the mocked notifications.  
__label__testing Refactoring: use BaseTestCase instead of TestCase  The majority of setup from TestCase isn't used by these subclasses. This means that the extra CPU work per test is wasted.  
__label__quality Refactoring: use BaseTestCase instead of TestCase  The majority of setup from TestCase isn't used by these subclasses. This means that the extra CPU work per test is wasted.  
__label__objective Refactoring: use BaseTestCase instead of TestCase  The majority of setup from TestCase isn't used by these subclasses. This means that the extra CPU work per test is wasted.  
__label__testing Integration scenario test refactoring  - Added new base class for scenario tests with common parameters initialization in the setUpClass - Added short description for every test - Scenario tests structure has become more similar  
__label__quality Integration scenario test refactoring  - Added new base class for scenario tests with common parameters initialization in the setUpClass - Added short description for every test - Scenario tests structure has become more similar  
__label__objective Integration scenario test refactoring  - Added new base class for scenario tests with common parameters initialization in the setUpClass - Added short description for every test - Scenario tests structure has become more similar  
__label__testing Refactor test modules  Renamed test directory to tests to be consistent with other OpenStack client projects.  Renamed some modules to match the pattern of test_<name of module under test>.py  
__label__objective Refactor test modules  Renamed test directory to tests to be consistent with other OpenStack client projects.  Renamed some modules to match the pattern of test_<name of module under test>.py  
__label__testing Starting refactor of test_resources  Starting to split out tests for the version and secrets controller into their own test modules. For each test that I'm splitting out, the goal is to remove as many mocks as possible from the equation and clean up the individual tests a bit.  
__label__objective Starting refactor of test_resources  Starting to split out tests for the version and secrets controller into their own test modules. For each test that I'm splitting out, the goal is to remove as many mocks as possible from the equation and clean up the individual tests a bit.  
__label__testing Refactor api  -renaming v1.py to cluster.py -moving cluster.py to v1 module -adding v1 controller to support querying version v1 -required some changes in api tests for refactoring -adding test cases for root and v1 controller  
__label__objective Refactor api  -renaming v1.py to cluster.py -moving cluster.py to v1 module -adding v1 controller to support querying version v1 -required some changes in api tests for refactoring -adding test cases for root and v1 controller  
__label__integration Refactor api  -renaming v1.py to cluster.py -moving cluster.py to v1 module -adding v1 controller to support querying version v1 -required some changes in api tests for refactoring -adding test cases for root and v1 controller  
__label__testing Refactor functional tests to clarify scoring.  Explicitly state how many "info", "warn", and "error" results are expected in each functional test.  Make each test a single call to a helper method, which reduces copy-pasted code.  
__label__quality Refactor functional tests to clarify scoring.  Explicitly state how many "info", "warn", and "error" results are expected in each functional test.  Make each test a single call to a helper method, which reduces copy-pasted code.  
__label__objective Refactor functional tests to clarify scoring.  Explicitly state how many "info", "warn", and "error" results are expected in each functional test.  Make each test a single call to a helper method, which reduces copy-pasted code.  
__label__testing Clean up test property decorators after refactor  This change removes several decorator functions that are deprecated due to a refactor.  These functions are no longer used within the Bandit code base: $ grep -r checks_ * core/test_properties.py:        logger.debug('checks_decorator function executed') core/test_properties.py:def checks_functions(func): core/test_properties.py:def checks_calls(func): core/test_properties.py:def checks_imports(func): core/test_properties.py:def checks_strings(func): core/test_properties.py:def checks_exec(func):  It also make a minor tweak to correct debug output.  
__label__quality Clean up test property decorators after refactor  This change removes several decorator functions that are deprecated due to a refactor.  These functions are no longer used within the Bandit code base: $ grep -r checks_ * core/test_properties.py:        logger.debug('checks_decorator function executed') core/test_properties.py:def checks_functions(func): core/test_properties.py:def checks_calls(func): core/test_properties.py:def checks_imports(func): core/test_properties.py:def checks_strings(func): core/test_properties.py:def checks_exec(func):  It also make a minor tweak to correct debug output.  
__label__objective Clean up test property decorators after refactor  This change removes several decorator functions that are deprecated due to a refactor.  These functions are no longer used within the Bandit code base: $ grep -r checks_ * core/test_properties.py:        logger.debug('checks_decorator function executed') core/test_properties.py:def checks_functions(func): core/test_properties.py:def checks_calls(func): core/test_properties.py:def checks_imports(func): core/test_properties.py:def checks_strings(func): core/test_properties.py:def checks_exec(func):  It also make a minor tweak to correct debug output.  
__label__testing Refactored AST processing  AST now Parses by statement. Added StatementBuffer class to manage statement processing. Fixed a bug with multi-line numbering, moved to statement object. Updated sql injection test to implement statement context knowledge POC. Added node_visitor unit tests Completed test_node_visitor StatementBuffer coverage  
__label__quality Refactored AST processing  AST now Parses by statement. Added StatementBuffer class to manage statement processing. Fixed a bug with multi-line numbering, moved to statement object. Updated sql injection test to implement statement context knowledge POC. Added node_visitor unit tests Completed test_node_visitor StatementBuffer coverage  
__label__objective Refactored AST processing  AST now Parses by statement. Added StatementBuffer class to manage statement processing. Fixed a bug with multi-line numbering, moved to statement object. Updated sql injection test to implement statement context knowledge POC. Added node_visitor unit tests Completed test_node_visitor StatementBuffer coverage  
__label__testing Refactor tests for migrations in heat  test_walk_version test in HeatMigrationCheckers has checked that the version of oslo.db should be more than 0.4. We have oslo.db >= 1.4.0 in our project requirements. So this redundant check in the test has been removed.  
__label__quality Refactor tests for migrations in heat  test_walk_version test in HeatMigrationCheckers has checked that the version of oslo.db should be more than 0.4. We have oslo.db >= 1.4.0 in our project requirements. So this redundant check in the test has been removed.  
__label__objective Refactor tests for migrations in heat  test_walk_version test in HeatMigrationCheckers has checked that the version of oslo.db should be more than 0.4. We have oslo.db >= 1.4.0 in our project requirements. So this redundant check in the test has been removed.  
__label__testing Refactoring functional tests based on standard usages  Refactoring the functional tests by using the standard usages [1] and best pratices available in the oslo.cache documentation.  The main goal of these changes is to help us to test oslo.cache in the way that it's used in the real life.  It reduce the complexity to test new backends by using the corresponding configuration.  These changes allow to test a new backend by: - passing the right environment variables with the related backend to test; - adding the corresponding zuul job that will dedicated to test this backend. - adding the right server backend to bindep  [1] https://docs.openstack.org/oslo.cache/latest/user/usage.html  
__label__quality Refactoring functional tests based on standard usages  Refactoring the functional tests by using the standard usages [1] and best pratices available in the oslo.cache documentation.  The main goal of these changes is to help us to test oslo.cache in the way that it's used in the real life.  It reduce the complexity to test new backends by using the corresponding configuration.  These changes allow to test a new backend by: - passing the right environment variables with the related backend to test; - adding the corresponding zuul job that will dedicated to test this backend. - adding the right server backend to bindep  [1] https://docs.openstack.org/oslo.cache/latest/user/usage.html  
__label__objective Refactoring functional tests based on standard usages  Refactoring the functional tests by using the standard usages [1] and best pratices available in the oslo.cache documentation.  The main goal of these changes is to help us to test oslo.cache in the way that it's used in the real life.  It reduce the complexity to test new backends by using the corresponding configuration.  These changes allow to test a new backend by: - passing the right environment variables with the related backend to test; - adding the corresponding zuul job that will dedicated to test this backend. - adding the right server backend to bindep  [1] https://docs.openstack.org/oslo.cache/latest/user/usage.html  
__label__testing Refactor filter tests in prepartion for LDAP support  Some aspects of the tests aren't suitable for an LDAP backend, so make them more generic - without reducing test coverage.  Partially implements: blueprint ldap-filtering  
__label__quality Refactor filter tests in prepartion for LDAP support  Some aspects of the tests aren't suitable for an LDAP backend, so make them more generic - without reducing test coverage.  Partially implements: blueprint ldap-filtering  
__label__objective Refactor filter tests in prepartion for LDAP support  Some aspects of the tests aren't suitable for an LDAP backend, so make them more generic - without reducing test coverage.  Partially implements: blueprint ldap-filtering  
__label__testing Refactor the pool tests to only test pool  The mon creation and teardown already get tested and should not get retested here.  
__label__objective Refactor the pool tests to only test pool  The mon creation and teardown already get tested and should not get retested here.  
__label__testing more probe test refactoring  * move get_to_final_state into ProbeTest * get rid of kill_servers  (this is all going someplace, i promise)  
__label__objective more probe test refactoring  * move get_to_final_state into ProbeTest * get rid of kill_servers  (this is all going someplace, i promise)  
__label__testing Refactored unit test cases to improve coverage  The patch set handles additional exception in agent/ovsdb/connection.py The patch set also contains minor fixes in unit test cases to prevent printing of warnings/errors in the output while running unit test cases. Also, includes additional test cases to improve the coverage with respect to [1].  1. https://review.openstack.org/#/c/154806  
__label__objective Refactored unit test cases to improve coverage  The patch set handles additional exception in agent/ovsdb/connection.py The patch set also contains minor fixes in unit test cases to prevent printing of warnings/errors in the output while running unit test cases. Also, includes additional test cases to improve the coverage with respect to [1].  1. https://review.openstack.org/#/c/154806  
__label__testing Refactor unit test code for disk pollsters  There are four test methods in tests/compute/pollsters/test_diskio.py which look very similar except the cache name are different.  This patch adds a class atrribute named CACHE_KEY to reduce the four methods to one.  
__label__objective Refactor unit test code for disk pollsters  There are four test methods in tests/compute/pollsters/test_diskio.py which look very similar except the cache name are different.  This patch adds a class atrribute named CACHE_KEY to reduce the four methods to one.  
__label__quality Refactor unit test code for disk pollsters  There are four test methods in tests/compute/pollsters/test_diskio.py which look very similar except the cache name are different.  This patch adds a class atrribute named CACHE_KEY to reduce the four methods to one.  
__label__testing Refactor lib/neutron rootwrap conf for reuse  This change separates out the creation and permision setting for the /etc/neutron so that it can be reused by functional test setup in rootwrap deployment.  
__label__quality Refactor lib/neutron rootwrap conf for reuse  This change separates out the creation and permision setting for the /etc/neutron so that it can be reused by functional test setup in rootwrap deployment.  
__label__objective Refactor lib/neutron rootwrap conf for reuse  This change separates out the creation and permision setting for the /etc/neutron so that it can be reused by functional test setup in rootwrap deployment.  
__label__testing Refactoring swift binary retrievers to allow context auth  This change is needed to fix an issue with using proxy domains and downloading job binaries through the ".../data" endpoint. A new function is added to retrieve binaries from swift using the context credentials. The raw data retrievers for swift have been refactored to allow a more modular approach.  Changes * adding an option to the raw binary dispatch routine to allow   requesting of context authentication * adding a new swift client method to create a connection with an auth   token * adding a new binary retriever function to use the context auth token * refactoring the internal swift retrievers module to be more modular * adding tests for all internal swift retrievers * adding a new test suite for binary dispatch  
__label__quality Refactoring swift binary retrievers to allow context auth  This change is needed to fix an issue with using proxy domains and downloading job binaries through the ".../data" endpoint. A new function is added to retrieve binaries from swift using the context credentials. The raw data retrievers for swift have been refactored to allow a more modular approach.  Changes * adding an option to the raw binary dispatch routine to allow   requesting of context authentication * adding a new swift client method to create a connection with an auth   token * adding a new binary retriever function to use the context auth token * refactoring the internal swift retrievers module to be more modular * adding tests for all internal swift retrievers * adding a new test suite for binary dispatch  
__label__objective Refactoring swift binary retrievers to allow context auth  This change is needed to fix an issue with using proxy domains and downloading job binaries through the ".../data" endpoint. A new function is added to retrieve binaries from swift using the context credentials. The raw data retrievers for swift have been refactored to allow a more modular approach.  Changes * adding an option to the raw binary dispatch routine to allow   requesting of context authentication * adding a new swift client method to create a connection with an auth   token * adding a new binary retriever function to use the context auth token * refactoring the internal swift retrievers module to be more modular * adding tests for all internal swift retrievers * adding a new test suite for binary dispatch  
__label__testing zmq: Refactor test case shared code  A number of the ZMQ test cases shared the same setUp method; refactor and introduce a base test case class to share this code across all appropriate ZMQ test cases.  
__label__quality zmq: Refactor test case shared code  A number of the ZMQ test cases shared the same setUp method; refactor and introduce a base test case class to share this code across all appropriate ZMQ test cases.  
__label__objective zmq: Refactor test case shared code  A number of the ZMQ test cases shared the same setUp method; refactor and introduce a base test case class to share this code across all appropriate ZMQ test cases.  
__label__testing Refactoring datasource, job and job_binary name validations  This change adds the ability to have leading numerals in the names of data sources, jobs, and job binaries. It also separates the name validation of user keypairs to be inline with nova's validation rules.  Changes * refactoring validate_name_format to allow leading numeral * adding validate_keypair_name_format * adding tests for keypair name validation * fixing tests for new name rules * removing outdated test from test_cluster_create_v_keypair_type  
__label__quality Refactoring datasource, job and job_binary name validations  This change adds the ability to have leading numerals in the names of data sources, jobs, and job binaries. It also separates the name validation of user keypairs to be inline with nova's validation rules.  Changes * refactoring validate_name_format to allow leading numeral * adding validate_keypair_name_format * adding tests for keypair name validation * fixing tests for new name rules * removing outdated test from test_cluster_create_v_keypair_type  
__label__objective Refactoring datasource, job and job_binary name validations  This change adds the ability to have leading numerals in the names of data sources, jobs, and job binaries. It also separates the name validation of user keypairs to be inline with nova's validation rules.  Changes * refactoring validate_name_format to allow leading numeral * adding validate_keypair_name_format * adding tests for keypair name validation * fixing tests for new name rules * removing outdated test from test_cluster_create_v_keypair_type  
__label__testing Initial commit for progress calculator test refactoring  
__label__objective Initial commit for progress calculator test refactoring  
__label__testing Refactor db migration tests  Common oslo.db code contains a base test classes for migration testing, so we can use it in Murano.  
__label__integration Refactor db migration tests  Common oslo.db code contains a base test classes for migration testing, so we can use it in Murano.  
__label__quality Refactor db migration tests  Common oslo.db code contains a base test classes for migration testing, so we can use it in Murano.  
__label__objective Refactor db migration tests  Common oslo.db code contains a base test classes for migration testing, so we can use it in Murano.  
__label__testing Refactored notification engine types  Added more test coverage for email notifications.  Moved notification methods from notification_processor to new types directory.  types/interface.py now automatically records statsd information for configured types.  Configuration for a type is now optional.  Uncofigured types are not able to send notifications.  Notifications that come across for unconfigured types generate a warning.  Email notification type now explicity exits when unable to connect to an SMTP server.  
__label__objective Refactored notification engine types  Added more test coverage for email notifications.  Moved notification methods from notification_processor to new types directory.  types/interface.py now automatically records statsd information for configured types.  Configuration for a type is now optional.  Uncofigured types are not able to send notifications.  Notifications that come across for unconfigured types generate a warning.  Email notification type now explicity exits when unable to connect to an SMTP server.  
__label__testing Refactor tempest test 'test_create_share_with_size_bigger_than_quota'  Test 'test_create_share_with_size_bigger_than_quota' verifies that we fail when try create share that exceeds gigabytes quota. But this tests creates isolated creds that are indeed redundant. It contains creation of tenant, user, network, subnet and router. Existing approach takes up to 8 seconds.  Make test 'test_create_share_with_size_bigger_than_quota' use common client, that will perform only two actions - get quotas and share creation request. New approach takes about 1 second.  
__label__objective Refactor tempest test 'test_create_share_with_size_bigger_than_quota'  Test 'test_create_share_with_size_bigger_than_quota' verifies that we fail when try create share that exceeds gigabytes quota. But this tests creates isolated creds that are indeed redundant. It contains creation of tenant, user, network, subnet and router. Existing approach takes up to 8 seconds.  Make test 'test_create_share_with_size_bigger_than_quota' use common client, that will perform only two actions - get quotas and share creation request. New approach takes about 1 second.  
__label__quality Refactor tempest test 'test_create_share_with_size_bigger_than_quota'  Test 'test_create_share_with_size_bigger_than_quota' verifies that we fail when try create share that exceeds gigabytes quota. But this tests creates isolated creds that are indeed redundant. It contains creation of tenant, user, network, subnet and router. Existing approach takes up to 8 seconds.  Make test 'test_create_share_with_size_bigger_than_quota' use common client, that will perform only two actions - get quotas and share creation request. New approach takes about 1 second.  
__label__testing Refactor stable API to be /v1/introspection/<UUID>  Also: * Stop doing bulk-processing of discovery requests   Seems like nobody is actually using it and it complicates testing. * Rename discover.discover -> introspect * Fix one missing retry_on_conflict (found during test refactor) * Stop setting unused /extra/discovery_timestamp * Refactor tests * Keep old API around of compatibility  
__label__quality Refactor stable API to be /v1/introspection/<UUID>  Also: * Stop doing bulk-processing of discovery requests   Seems like nobody is actually using it and it complicates testing. * Rename discover.discover -> introspect * Fix one missing retry_on_conflict (found during test refactor) * Stop setting unused /extra/discovery_timestamp * Refactor tests * Keep old API around of compatibility  
__label__objective Refactor stable API to be /v1/introspection/<UUID>  Also: * Stop doing bulk-processing of discovery requests   Seems like nobody is actually using it and it complicates testing. * Rename discover.discover -> introspect * Fix one missing retry_on_conflict (found during test refactor) * Stop setting unused /extra/discovery_timestamp * Refactor tests * Keep old API around of compatibility  
__label__integration Refactor stable API to be /v1/introspection/<UUID>  Also: * Stop doing bulk-processing of discovery requests   Seems like nobody is actually using it and it complicates testing. * Rename discover.discover -> introspect * Fix one missing retry_on_conflict (found during test refactor) * Stop setting unused /extra/discovery_timestamp * Refactor tests * Keep old API around of compatibility  
__label__testing Refactor db migration tests  Common oslo.db code contains a base test classes for migration testing, so we can use it in Sahara.  
__label__integration Refactor db migration tests  Common oslo.db code contains a base test classes for migration testing, so we can use it in Sahara.  
__label__quality Refactor db migration tests  Common oslo.db code contains a base test classes for migration testing, so we can use it in Sahara.  
__label__objective Refactor db migration tests  Common oslo.db code contains a base test classes for migration testing, so we can use it in Sahara.  
__label__integration Refactoring DB transaction component  * ensure autonomous DB transaction when creating a new cluster. * move DB read/write access calls from DB models to DB API. * update DB unit tests to test model composition (DB API tests   will be added as separate commit.  
__label__objective Refactoring DB transaction component  * ensure autonomous DB transaction when creating a new cluster. * move DB read/write access calls from DB models to DB API. * update DB unit tests to test model composition (DB API tests   will be added as separate commit.  
__label__quality Refactor async helper methods in conductor/manager.py  This patch performs multiple refactorings of conductor/manager.py: - re-arrange a few class methods without changes - move some async helper methods out of the ConductorManager class:     _do_node_deploy, _do_node_teardown,     _provisioning_error_handler, _power_state_error_handler - move _do_sync_power_state out of the main class.   However, this required returning the count instead of simply updating   self.power_state_sync_count, so a few test changes were required.  
__label__objective Refactor async helper methods in conductor/manager.py  This patch performs multiple refactorings of conductor/manager.py: - re-arrange a few class methods without changes - move some async helper methods out of the ConductorManager class:     _do_node_deploy, _do_node_teardown,     _provisioning_error_handler, _power_state_error_handler - move _do_sync_power_state out of the main class.   However, this required returning the count instead of simply updating   self.power_state_sync_count, so a few test changes were required.  
__label__testing Add test and refactor bay_create on rpc handler  This contains temporary implementation of updating master_address, refactor rpc handler and some tests.  
__label__objective Add test and refactor bay_create on rpc handler  This contains temporary implementation of updating master_address, refactor rpc handler and some tests.  
__label__testing Refactor test against template  test_titles originated in nova-specs.  The version in nova-specs has received several improvements that would be worth bringing over.  This started when I was writing a spec and the test code wouldn't let me add any additional sections on top of the required ones.  Here's a list of key differences in the new version:  * Instead of hard coding the list of required sections, dynamically   discover the sections by reading the template.  * Ensure all sections from the template are present, but allow   additional sections to be included.  * Include the code for ensuring lines are wrapped, but disable it for   now since it doesn't pass.  * Make sure the spec doesn't have \r in it.  * Make sure the spec doesn't have trailing whitespace.  
__label__quality Refactor test against template  test_titles originated in nova-specs.  The version in nova-specs has received several improvements that would be worth bringing over.  This started when I was writing a spec and the test code wouldn't let me add any additional sections on top of the required ones.  Here's a list of key differences in the new version:  * Instead of hard coding the list of required sections, dynamically   discover the sections by reading the template.  * Ensure all sections from the template are present, but allow   additional sections to be included.  * Include the code for ensuring lines are wrapped, but disable it for   now since it doesn't pass.  * Make sure the spec doesn't have \r in it.  * Make sure the spec doesn't have trailing whitespace.  
__label__objective Refactor test against template  test_titles originated in nova-specs.  The version in nova-specs has received several improvements that would be worth bringing over.  This started when I was writing a spec and the test code wouldn't let me add any additional sections on top of the required ones.  Here's a list of key differences in the new version:  * Instead of hard coding the list of required sections, dynamically   discover the sections by reading the template.  * Ensure all sections from the template are present, but allow   additional sections to be included.  * Include the code for ensuring lines are wrapped, but disable it for   now since it doesn't pass.  * Make sure the spec doesn't have \r in it.  * Make sure the spec doesn't have trailing whitespace.  
__label__testing Refactor kwapi unit test  ceilometer/tests/energy/test_kwapi.py has very similar test cases, this patch refactors those unit test code.  
__label__quality Refactor kwapi unit test  ceilometer/tests/energy/test_kwapi.py has very similar test cases, this patch refactors those unit test code.  
__label__objective Refactor kwapi unit test  ceilometer/tests/energy/test_kwapi.py has very similar test cases, this patch refactors those unit test code.  
__label__testing Refactor test_s3_acl  This patch introduces generate_s3acl_environ() function for refactoring of test_s3_acl. It registers necessary verbs against to both a bucket and an object which keep ACL information for testing.  It achieves really good portability to make s3_acl testing environment for other test cases so that What we have to do for s3_acl testing is just calling generate_s3acl_environ() before testing.  
__label__quality Refactor test_s3_acl  This patch introduces generate_s3acl_environ() function for refactoring of test_s3_acl. It registers necessary verbs against to both a bucket and an object which keep ACL information for testing.  It achieves really good portability to make s3_acl testing environment for other test cases so that What we have to do for s3_acl testing is just calling generate_s3acl_environ() before testing.  
__label__objective Refactor test_s3_acl  This patch introduces generate_s3acl_environ() function for refactoring of test_s3_acl. It registers necessary verbs against to both a bucket and an object which keep ACL information for testing.  It achieves really good portability to make s3_acl testing environment for other test cases so that What we have to do for s3_acl testing is just calling generate_s3acl_environ() before testing.  
__label__testing Refactor timeout policy test  
__label__objective Refactor timeout policy test  
__label__testing Refactoring to allow addition of FibreChannel drivers  NetApp's five Cinder drivers have been in continuous development for nearly 3 years, and it is now necessary to do some housecleaning.  This commit splits long files that contain multiple classes, normalizes the class hierarchies to enable subclassing different driver classes (ISCSIDriver, FibreChannelDriver), and renames classes.  It also begins the process of moving unit test files into a matching hierarchy in the "tests" tree.  Implements blueprint netapp-cinder-driver-refactoring-phase-1 
__label__quality Refactoring to allow addition of FibreChannel drivers  NetApp's five Cinder drivers have been in continuous development for nearly 3 years, and it is now necessary to do some housecleaning.  This commit splits long files that contain multiple classes, normalizes the class hierarchies to enable subclassing different driver classes (ISCSIDriver, FibreChannelDriver), and renames classes.  It also begins the process of moving unit test files into a matching hierarchy in the "tests" tree.  Implements blueprint netapp-cinder-driver-refactoring-phase-1 
__label__objective Refactoring to allow addition of FibreChannel drivers  NetApp's five Cinder drivers have been in continuous development for nearly 3 years, and it is now necessary to do some housecleaning.  This commit splits long files that contain multiple classes, normalizes the class hierarchies to enable subclassing different driver classes (ISCSIDriver, FibreChannelDriver), and renames classes.  It also begins the process of moving unit test files into a matching hierarchy in the "tests" tree.  Implements blueprint netapp-cinder-driver-refactoring-phase-1 
__label__testing Ilo tests refactoring  IloValidateParametersTestCase tests create node in test functions, this change moves it to setUp. Based on commit I81c5deaa4c578c29c32788bd248f9db7166975e3.  
__label__objective Ilo tests refactoring  IloValidateParametersTestCase tests create node in test functions, this change moves it to setUp. Based on commit I81c5deaa4c578c29c32788bd248f9db7166975e3.  
__label__testing Refactor tests/test_shell.py  Remove unnecessary help test for keystone shell test.  
__label__objective Refactor tests/test_shell.py  Remove unnecessary help test for keystone shell test.  
__label__testing resource-tracker: Begin refactor unit tests  The current unit tests for the resource tracker are in /nova/tests/compute/test_resource_tracker.py, and they are virtually impossible to work with, due to a number of things:   * They rely on a real conductor service being started during    each test method  * They rely on database state since they are not NoDBTestCase-derived  * They use random nested dicts all over the place for fixtures, instead    of nova.objects where appropriate, making the unit tests very    difficult to alter along with changes to "objectify" the resource    tracker.  This patch is the start of a refactoring effort that removes the database and conductor service calls and replaces them with mocks and derives the unit test cases from nova.test.NoDBTestCase. This first patch simply tests the logic of a single important method of the resource tracker: update_available_resource(). The test methods test the various code branches that can occur if the compute node has active instances running on it, no instances running on it, migrations running on it, and more.  This patch introduces a new test file called test_tracker.py. When all code paths in the resource tracker have been tested in test_tracker.py, I will delete the original test_resource_tracker.py and rename test_tracker.py to test_resource_tracker.py.  
__label__quality resource-tracker: Begin refactor unit tests  The current unit tests for the resource tracker are in /nova/tests/compute/test_resource_tracker.py, and they are virtually impossible to work with, due to a number of things:   * They rely on a real conductor service being started during    each test method  * They rely on database state since they are not NoDBTestCase-derived  * They use random nested dicts all over the place for fixtures, instead    of nova.objects where appropriate, making the unit tests very    difficult to alter along with changes to "objectify" the resource    tracker.  This patch is the start of a refactoring effort that removes the database and conductor service calls and replaces them with mocks and derives the unit test cases from nova.test.NoDBTestCase. This first patch simply tests the logic of a single important method of the resource tracker: update_available_resource(). The test methods test the various code branches that can occur if the compute node has active instances running on it, no instances running on it, migrations running on it, and more.  This patch introduces a new test file called test_tracker.py. When all code paths in the resource tracker have been tested in test_tracker.py, I will delete the original test_resource_tracker.py and rename test_tracker.py to test_resource_tracker.py.  
__label__objective resource-tracker: Begin refactor unit tests  The current unit tests for the resource tracker are in /nova/tests/compute/test_resource_tracker.py, and they are virtually impossible to work with, due to a number of things:   * They rely on a real conductor service being started during    each test method  * They rely on database state since they are not NoDBTestCase-derived  * They use random nested dicts all over the place for fixtures, instead    of nova.objects where appropriate, making the unit tests very    difficult to alter along with changes to "objectify" the resource    tracker.  This patch is the start of a refactoring effort that removes the database and conductor service calls and replaces them with mocks and derives the unit test cases from nova.test.NoDBTestCase. This first patch simply tests the logic of a single important method of the resource tracker: update_available_resource(). The test methods test the various code branches that can occur if the compute node has active instances running on it, no instances running on it, migrations running on it, and more.  This patch introduces a new test file called test_tracker.py. When all code paths in the resource tracker have been tested in test_tracker.py, I will delete the original test_resource_tracker.py and rename test_tracker.py to test_resource_tracker.py.  
__label__testing Refactoring UI tests  Added teadDown method to cluster test and fixed method of delete job executions  
__label__testing Code refactoring and adding ssh test  Classes L2HostroutesGatewayMixin and Instance are refactored to a common module so other scenario tests can use them in the future.  ssh connectivity test between 'origin' and 'destination' instances is added to L2HostroutesGatewayTest.  
__label__objective Code refactoring and adding ssh test  Classes L2HostroutesGatewayMixin and Instance are refactored to a common module so other scenario tests can use them in the future.  ssh connectivity test between 'origin' and 'destination' instances is added to L2HostroutesGatewayTest.  
__label__testing Refactor CLI tests  - tearDown logic was updated. Now we collect all test items and then delete only them.  Closes-Bug: #1386804  
__label__objective Refactor CLI tests  - tearDown logic was updated. Now we collect all test items and then delete only them.  Closes-Bug: #1386804  
__label__testing refactor of hideci for readability and modularity  This is a refactors the hideci code into much smaller functions, making the whole thing a bit more readable for fixing this going forward. This was done in order to add a couple of new features. The smaller functions should also make this code much easier to review.  After the refactor we now do a top down parsing off all comments in a review, classifying them as 'is_ci' and 'is_trusted_ci' so that we can more easily compute the results we want going forward.  In the process a few additional features were added.  1) CI results are only shown for the latest patch set, even if no CI system has reported on it. This is accomplished via ci_latest_patchset.  2) If CI system is in merge conflict, that's displayed in the results box.  3) Test results records are lifted in total to the test results display panel, and each set of test results includes the date that we got it from. This means that for patches that get 'rechecked' a lot, you'll see the whole history of test results on current patch. You will also be able to quickly realize that the current test results are older than the last recheck comment.  The UX for part 3 is different, and may need tweaking going forward, however the merge of results from different runs was creating a lot of confusion to reviewers, so this errors on the side of more clarity.  Because of the largely inconvenient workflow for development (the fact that you basically need to copy / paste function definitions into chrome dev console) this isn't broken up as smaller patches. This should, hopefully, make future patches much easier on this code though.  
__label__objective refactor of hideci for readability and modularity  This is a refactors the hideci code into much smaller functions, making the whole thing a bit more readable for fixing this going forward. This was done in order to add a couple of new features. The smaller functions should also make this code much easier to review.  After the refactor we now do a top down parsing off all comments in a review, classifying them as 'is_ci' and 'is_trusted_ci' so that we can more easily compute the results we want going forward.  In the process a few additional features were added.  1) CI results are only shown for the latest patch set, even if no CI system has reported on it. This is accomplished via ci_latest_patchset.  2) If CI system is in merge conflict, that's displayed in the results box.  3) Test results records are lifted in total to the test results display panel, and each set of test results includes the date that we got it from. This means that for patches that get 'rechecked' a lot, you'll see the whole history of test results on current patch. You will also be able to quickly realize that the current test results are older than the last recheck comment.  The UX for part 3 is different, and may need tweaking going forward, however the merge of results from different runs was creating a lot of confusion to reviewers, so this errors on the side of more clarity.  Because of the largely inconvenient workflow for development (the fact that you basically need to copy / paste function definitions into chrome dev console) this isn't broken up as smaller patches. This should, hopefully, make future patches much easier on this code though.  
__label__quality refactor of hideci for readability and modularity  This is a refactors the hideci code into much smaller functions, making the whole thing a bit more readable for fixing this going forward. This was done in order to add a couple of new features. The smaller functions should also make this code much easier to review.  After the refactor we now do a top down parsing off all comments in a review, classifying them as 'is_ci' and 'is_trusted_ci' so that we can more easily compute the results we want going forward.  In the process a few additional features were added.  1) CI results are only shown for the latest patch set, even if no CI system has reported on it. This is accomplished via ci_latest_patchset.  2) If CI system is in merge conflict, that's displayed in the results box.  3) Test results records are lifted in total to the test results display panel, and each set of test results includes the date that we got it from. This means that for patches that get 'rechecked' a lot, you'll see the whole history of test results on current patch. You will also be able to quickly realize that the current test results are older than the last recheck comment.  The UX for part 3 is different, and may need tweaking going forward, however the merge of results from different runs was creating a lot of confusion to reviewers, so this errors on the side of more clarity.  Because of the largely inconvenient workflow for development (the fact that you basically need to copy / paste function definitions into chrome dev console) this isn't broken up as smaller patches. This should, hopefully, make future patches much easier on this code though.  
__label__objective refactor of hideci for readability and modularity  This is a refactors the hideci code into much smaller functions, making the whole thing a bit more readable for fixing this going forward. This was done in order to add a couple of new features. The smaller functions should also make this code much easier to review.  After the refactor we now do a top down parsing off all comments in a review, classifying them as 'is_ci' and 'is_trusted_ci' so that we can more easily compute the results we want going forward.  In the process a few additional features were added.  1) CI results are only shown for the latest patch set, even if no CI system has reported on it. This is accomplished via ci_latest_patchset.  2) If CI system is in merge conflict, that's displayed in the results box.  3) Test results records are lifted in total to the test results display panel, and each set of test results includes the date that we got it from. This means that for patches that get 'rechecked' a lot, you'll see the whole history of test results on current patch. You will also be able to quickly realize that the current test results are older than the last recheck comment.  The UX for part 3 is different, and may need tweaking going forward, however the merge of results from different runs was creating a lot of confusion to reviewers, so this errors on the side of more clarity.  Because of the largely inconvenient workflow for development (the fact that you basically need to copy / paste function definitions into chrome dev console) this isn't broken up as smaller patches. This should, hopefully, make future patches much easier on this code though.  
__label__testing Separate and refactor RAM filter unit tests  The Aggregate RAM filter unit tests were accessing the database to create Aggregate records. This patch moves all the RAM filter unit tests out of test_host_filters.py into their own test file and updates the unit tests to remove any database accesses entirely.  
__label__integration Separate and refactor RAM filter unit tests  The Aggregate RAM filter unit tests were accessing the database to create Aggregate records. This patch moves all the RAM filter unit tests out of test_host_filters.py into their own test file and updates the unit tests to remove any database accesses entirely.  
__label__objective Separate and refactor RAM filter unit tests  The Aggregate RAM filter unit tests were accessing the database to create Aggregate records. This patch moves all the RAM filter unit tests out of test_host_filters.py into their own test file and updates the unit tests to remove any database accesses entirely.  
__label__quality Separate and refactor RAM filter unit tests  The Aggregate RAM filter unit tests were accessing the database to create Aggregate records. This patch moves all the RAM filter unit tests out of test_host_filters.py into their own test file and updates the unit tests to remove any database accesses entirely.  
__label__testing Refactored Client to use Keystone Sessions  This CR changes the Client to use Keystone Sessions exclusively. All authentication that was previously available in barbicanclient is removed so that we can defer all authentication to keystoneclient.  Unit tests for the client module have been refactored to test the new functionality.  The README file has been updated to give an example of how to authenticate using Sessions.  The Client will now give priority to an endpoint that is passed in over endpoints found in the service catalog, which closes bug #1276002.  This is helpful for development, where you might be running an instance of Barbican locally that uses a Keystone instance for authentication that does not have the Barbican service in its catalog.  DocImpact Implements: blueprint use-keystone-sessions Closes-Bug: #1276002  
__label__quality Refactored Client to use Keystone Sessions  This CR changes the Client to use Keystone Sessions exclusively. All authentication that was previously available in barbicanclient is removed so that we can defer all authentication to keystoneclient.  Unit tests for the client module have been refactored to test the new functionality.  The README file has been updated to give an example of how to authenticate using Sessions.  The Client will now give priority to an endpoint that is passed in over endpoints found in the service catalog, which closes bug #1276002.  This is helpful for development, where you might be running an instance of Barbican locally that uses a Keystone instance for authentication that does not have the Barbican service in its catalog.  DocImpact Implements: blueprint use-keystone-sessions Closes-Bug: #1276002  
__label__objective Refactored Client to use Keystone Sessions  This CR changes the Client to use Keystone Sessions exclusively. All authentication that was previously available in barbicanclient is removed so that we can defer all authentication to keystoneclient.  Unit tests for the client module have been refactored to test the new functionality.  The README file has been updated to give an example of how to authenticate using Sessions.  The Client will now give priority to an endpoint that is passed in over endpoints found in the service catalog, which closes bug #1276002.  This is helpful for development, where you might be running an instance of Barbican locally that uses a Keystone instance for authentication that does not have the Barbican service in its catalog.  DocImpact Implements: blueprint use-keystone-sessions Closes-Bug: #1276002  
__label__testing Small refactoring for Sahara platform test  * Method "_test_image" was renamed into "check_image"   because we check image but not test  * Steps to list node group templates and cluster templates were removed   because sanity tests have these checks  * Some messages were corrected  * Sahara platform test was renamed  
__label__quality Small refactoring for Sahara platform test  * Method "_test_image" was renamed into "check_image"   because we check image but not test  * Steps to list node group templates and cluster templates were removed   because sanity tests have these checks  * Some messages were corrected  * Sahara platform test was renamed  
__label__objective Small refactoring for Sahara platform test  * Method "_test_image" was renamed into "check_image"   because we check image but not test  * Steps to list node group templates and cluster templates were removed   because sanity tests have these checks  * Some messages were corrected  * Sahara platform test was renamed  
__label__testing Refactor of test case of floating_ips  This patch is prepare for porting floating_ips to v2.1, and make v2.1 and v2 share same test cases.  
__label__objective Refactor of test case of floating_ips  This patch is prepare for porting floating_ips to v2.1, and make v2.1 and v2 share same test cases.  
__label__testing Refactor the Tuskar storage tests  This test refactor generalises the test cases in a way that they can be configured to run against multiple storage backents or different configurations such as sqlite, MySQL and PostgreSQL.  
__label__objective Refactor the Tuskar storage tests  This test refactor generalises the test cases in a way that they can be configured to run against multiple storage backents or different configurations such as sqlite, MySQL and PostgreSQL.  
__label__testing Finish small unit test refactor of API v2 tests  Leverage a utility function for all of the tests that create something in the API and expect a failure.  
__label__objective Finish small unit test refactor of API v2 tests  Leverage a utility function for all of the tests that create something in the API and expect a failure.  
__label__testing Refactor test code to reduce duplication  
__label__quality Refactor test code to reduce duplication  
__label__testing Refactor ways of creating anonymous test user  Some Swift tests require random user creation to test ACL features or prepare special data by reseller admin's requests, but that occurs code duplication. Especially, assigning role id code was too lengthy.  This commit aggregates common codes and remove unused clean-up statements.  
__label__quality Refactor ways of creating anonymous test user  Some Swift tests require random user creation to test ACL features or prepare special data by reseller admin's requests, but that occurs code duplication. Especially, assigning role id code was too lengthy.  This commit aggregates common codes and remove unused clean-up statements.  
__label__objective Refactor ways of creating anonymous test user  Some Swift tests require random user creation to test ACL features or prepare special data by reseller admin's requests, but that occurs code duplication. Especially, assigning role id code was too lengthy.  This commit aggregates common codes and remove unused clean-up statements.  
__label__testing Refactoring DataSources to use proxy user  Changes * adding constants for trust id and domain name to swift_helper * refactoring oozie edp workflows to use proxy configs when necessary * adding tests to exercise proxy domain usage in workflows * removing credentials requirement for DataSource models when using   proxy domain * pruning duplicate MapReduce test * adding tests for DataSource creation without credentials  Partial-implements: blueprint edp-swift-trust-authentication 
__label__objective Refactoring DataSources to use proxy user  Changes * adding constants for trust id and domain name to swift_helper * refactoring oozie edp workflows to use proxy configs when necessary * adding tests to exercise proxy domain usage in workflows * removing credentials requirement for DataSource models when using   proxy domain * pruning duplicate MapReduce test * adding tests for DataSource creation without credentials  Partial-implements: blueprint edp-swift-trust-authentication 
__label__quality Refactoring DataSources to use proxy user  Changes * adding constants for trust id and domain name to swift_helper * refactoring oozie edp workflows to use proxy configs when necessary * adding tests to exercise proxy domain usage in workflows * removing credentials requirement for DataSource models when using   proxy domain * pruning duplicate MapReduce test * adding tests for DataSource creation without credentials  Partial-implements: blueprint edp-swift-trust-authentication 
__label__testing VMware: spawn refactor - image handling  From examining the exist vmops spawn() coder, as-yet unmerged patches undergoing review that impacts it, as well as anticipating additional changes proposed in blueprints, it is apparent that the high branching factor is a result of inefficient attempts to address various permutations of the following:  - different types image to spawn with (sparse, flat, iso,   streamOptimized, ova, ...) - different ways to obtain the image (http download, datastore copy,   direct use, ...) - different ways to prepare the downloaded image bits into a usable   image in the image cache (replace -flat.vmdk extent, convert from   sparse, pick from imported VM, ...) - different ways to employed the image that has made available (fully   copy, as base of COW disk, direct use, ...)  This patch attempts to tease apart into three main areas of responsibilites:  - ImageHandler classes : for obtaining bits of various kinds of images - ImageProcessor classes : for processing the bits into a usable form to                            be cached in the iamge cache - Image user callbacks : for dealing with using a prepared/cached image                          in a VM in various ways.  The hope is that this will allow for more self-contained additions/changes to behaviors in these areas, as well as more avenues to test different aspects of the spawn operation in isolation.  TODO: Try to break this further into a few smaller patches, add a couple more tests.  partial blueprint vmware-spawn-refactor  
__label__quality VMware: spawn refactor - image handling  From examining the exist vmops spawn() coder, as-yet unmerged patches undergoing review that impacts it, as well as anticipating additional changes proposed in blueprints, it is apparent that the high branching factor is a result of inefficient attempts to address various permutations of the following:  - different types image to spawn with (sparse, flat, iso,   streamOptimized, ova, ...) - different ways to obtain the image (http download, datastore copy,   direct use, ...) - different ways to prepare the downloaded image bits into a usable   image in the image cache (replace -flat.vmdk extent, convert from   sparse, pick from imported VM, ...) - different ways to employed the image that has made available (fully   copy, as base of COW disk, direct use, ...)  This patch attempts to tease apart into three main areas of responsibilites:  - ImageHandler classes : for obtaining bits of various kinds of images - ImageProcessor classes : for processing the bits into a usable form to                            be cached in the iamge cache - Image user callbacks : for dealing with using a prepared/cached image                          in a VM in various ways.  The hope is that this will allow for more self-contained additions/changes to behaviors in these areas, as well as more avenues to test different aspects of the spawn operation in isolation.  TODO: Try to break this further into a few smaller patches, add a couple more tests.  partial blueprint vmware-spawn-refactor  
__label__objective VMware: spawn refactor - image handling  From examining the exist vmops spawn() coder, as-yet unmerged patches undergoing review that impacts it, as well as anticipating additional changes proposed in blueprints, it is apparent that the high branching factor is a result of inefficient attempts to address various permutations of the following:  - different types image to spawn with (sparse, flat, iso,   streamOptimized, ova, ...) - different ways to obtain the image (http download, datastore copy,   direct use, ...) - different ways to prepare the downloaded image bits into a usable   image in the image cache (replace -flat.vmdk extent, convert from   sparse, pick from imported VM, ...) - different ways to employed the image that has made available (fully   copy, as base of COW disk, direct use, ...)  This patch attempts to tease apart into three main areas of responsibilites:  - ImageHandler classes : for obtaining bits of various kinds of images - ImageProcessor classes : for processing the bits into a usable form to                            be cached in the iamge cache - Image user callbacks : for dealing with using a prepared/cached image                          in a VM in various ways.  The hope is that this will allow for more self-contained additions/changes to behaviors in these areas, as well as more avenues to test different aspects of the spawn operation in isolation.  TODO: Try to break this further into a few smaller patches, add a couple more tests.  partial blueprint vmware-spawn-refactor  
__label__testing Refactor admin_action plugin and test cases  add expected_attrs=None when calling  self.compute_api.get() add expected_attrs=None when setup mock in test case.  this patches is aimed to share v2.1 patches and v2 test cases. a test cases porting patch will be followed.  Partially implements blueprint v2-on-v3-api 
__label__integration Refactor admin_action plugin and test cases  add expected_attrs=None when calling  self.compute_api.get() add expected_attrs=None when setup mock in test case.  this patches is aimed to share v2.1 patches and v2 test cases. a test cases porting patch will be followed.  Partially implements blueprint v2-on-v3-api 
__label__objective Refactor admin_action plugin and test cases  add expected_attrs=None when calling  self.compute_api.get() add expected_attrs=None when setup mock in test case.  this patches is aimed to share v2.1 patches and v2 test cases. a test cases porting patch will be followed.  Partially implements blueprint v2-on-v3-api 
__label__testing Unittests: Refactor Volume resources tests  Changes include: - use native HOT template with native Cinder resources for Cinder   resources tests - split tests in two test cases, one for AWS, another for native   resources - added base test case with most common boilerplate mocking  
__label__objective Unittests: Refactor Volume resources tests  Changes include: - use native HOT template with native Cinder resources for Cinder   resources tests - split tests in two test cases, one for AWS, another for native   resources - added base test case with most common boilerplate mocking  
__label__testing Minor refactoring of auto_schedule_routers  The method has bloated out of proportion, so bring it back in line in a way that we can do more targeted fixes.  This is done in preparation of fix for DB lock timeout errors observed while dealing with DVR routers.  Test coverage is already provided, even though it should be adjusted to reflect the new structure being introduced.  Partial-bug: #1356121  
__label__objective Minor refactoring of auto_schedule_routers  The method has bloated out of proportion, so bring it back in line in a way that we can do more targeted fixes.  This is done in preparation of fix for DB lock timeout errors observed while dealing with DVR routers.  Test coverage is already provided, even though it should be adjusted to reflect the new structure being introduced.  Partial-bug: #1356121  
__label__quality Minor refactoring of auto_schedule_routers  The method has bloated out of proportion, so bring it back in line in a way that we can do more targeted fixes.  This is done in preparation of fix for DB lock timeout errors observed while dealing with DVR routers.  Test coverage is already provided, even though it should be adjusted to reflect the new structure being introduced.  Partial-bug: #1356121  
__label__testing Refactoring Glance logging lowering levels  This change fixes translations to be using correct translation functions. Contains few log level drops for too high logging levels.  This PS does not address logging changes for modules under glance/store/ due to the new repo request. After stores are moved to their own repo new PS will be submitted for those.  This PS does not touch the test code.  Separate PS will be submitted for log lever raises withing codebase as requested during the spec review.  Related to bp refactoring-glance-logging  
__label__objective Refactoring Glance logging lowering levels  This change fixes translations to be using correct translation functions. Contains few log level drops for too high logging levels.  This PS does not address logging changes for modules under glance/store/ due to the new repo request. After stores are moved to their own repo new PS will be submitted for those.  This PS does not touch the test code.  Separate PS will be submitted for log lever raises withing codebase as requested during the spec review.  Related to bp refactoring-glance-logging  
__label__testing Refactor test framework  Manila's test framework is pretty old and requires update.  Changes: - usage of nose replaced with testr - now all the tests a thread safe - added new options for run_tests.sh, such as --concurrency, --debug, etc... - new '--concurrency' option for run_tests.sh defaults to 1, examples:     ./run_tests.sh  # will run in 1 thread     ./run_tests.sh --concurrency 2  # will run tests in 2 threads - added tools/colorizer.py for colorizing output of testrun with run_tests.sh - tests running with tox use as much threads as cores available by default - Added 'Database' class to manila.test module, for more conveniant db testing - updated policy file 'manila/tests/policy.json' to allow share-network actions - removed nose-related requirements - added new requirements for testrepository, subunit  With merge of this change all old installed virtual environments becomes incompatible and should be removed with "rm -rf .tox .venv" before testrun.  Implements blueprint testr-with-unittests  
__label__quality Refactor test framework  Manila's test framework is pretty old and requires update.  Changes: - usage of nose replaced with testr - now all the tests a thread safe - added new options for run_tests.sh, such as --concurrency, --debug, etc... - new '--concurrency' option for run_tests.sh defaults to 1, examples:     ./run_tests.sh  # will run in 1 thread     ./run_tests.sh --concurrency 2  # will run tests in 2 threads - added tools/colorizer.py for colorizing output of testrun with run_tests.sh - tests running with tox use as much threads as cores available by default - Added 'Database' class to manila.test module, for more conveniant db testing - updated policy file 'manila/tests/policy.json' to allow share-network actions - removed nose-related requirements - added new requirements for testrepository, subunit  With merge of this change all old installed virtual environments becomes incompatible and should be removed with "rm -rf .tox .venv" before testrun.  Implements blueprint testr-with-unittests  
__label__integration Refactor test framework  Manila's test framework is pretty old and requires update.  Changes: - usage of nose replaced with testr - now all the tests a thread safe - added new options for run_tests.sh, such as --concurrency, --debug, etc... - new '--concurrency' option for run_tests.sh defaults to 1, examples:     ./run_tests.sh  # will run in 1 thread     ./run_tests.sh --concurrency 2  # will run tests in 2 threads - added tools/colorizer.py for colorizing output of testrun with run_tests.sh - tests running with tox use as much threads as cores available by default - Added 'Database' class to manila.test module, for more conveniant db testing - updated policy file 'manila/tests/policy.json' to allow share-network actions - removed nose-related requirements - added new requirements for testrepository, subunit  With merge of this change all old installed virtual environments becomes incompatible and should be removed with "rm -rf .tox .venv" before testrun.  Implements blueprint testr-with-unittests  
__label__objective Refactor test framework  Manila's test framework is pretty old and requires update.  Changes: - usage of nose replaced with testr - now all the tests a thread safe - added new options for run_tests.sh, such as --concurrency, --debug, etc... - new '--concurrency' option for run_tests.sh defaults to 1, examples:     ./run_tests.sh  # will run in 1 thread     ./run_tests.sh --concurrency 2  # will run tests in 2 threads - added tools/colorizer.py for colorizing output of testrun with run_tests.sh - tests running with tox use as much threads as cores available by default - Added 'Database' class to manila.test module, for more conveniant db testing - updated policy file 'manila/tests/policy.json' to allow share-network actions - removed nose-related requirements - added new requirements for testrepository, subunit  With merge of this change all old installed virtual environments becomes incompatible and should be removed with "rm -rf .tox .venv" before testrun.  Implements blueprint testr-with-unittests  
__label__testing WIP. Refactoring build-app and unittest-app  Created app-common Replaced with tlog function with TLOG Added elapsed function, replaced print_end_timestamp Replaced get_image_id with app_glance_id Replaced run_timed_command with PRUN Removed use of EXIT_STATUS Replaced argument -z tests with $# test Prepended docker unittest with PRUN Removed commented code and other cleanup  
__label__objective WIP. Refactoring build-app and unittest-app  Created app-common Replaced with tlog function with TLOG Added elapsed function, replaced print_end_timestamp Replaced get_image_id with app_glance_id Replaced run_timed_command with PRUN Removed use of EXIT_STATUS Replaced argument -z tests with $# test Prepended docker unittest with PRUN Removed commented code and other cleanup  
__label__testing Refactor congress eventlet server code  This patch removes the current wsgi-server in place of the one that keystone uses which is basically identical to the one that was already in congress. The only reason I switched it out for the keystone one is just so copying the keystone integration out of keystone to congress would be easier. In addition, this patch adds mutiworker support so can use multiple processes to run our api server (though currently we just default that to 1). This patch also includes test cases for the eventlet server.  
__label__quality Refactor congress eventlet server code  This patch removes the current wsgi-server in place of the one that keystone uses which is basically identical to the one that was already in congress. The only reason I switched it out for the keystone one is just so copying the keystone integration out of keystone to congress would be easier. In addition, this patch adds mutiworker support so can use multiple processes to run our api server (though currently we just default that to 1). This patch also includes test cases for the eventlet server.  
__label__objective Refactor congress eventlet server code  This patch removes the current wsgi-server in place of the one that keystone uses which is basically identical to the one that was already in congress. The only reason I switched it out for the keystone one is just so copying the keystone integration out of keystone to congress would be easier. In addition, this patch adds mutiworker support so can use multiple processes to run our api server (though currently we just default that to 1). This patch also includes test cases for the eventlet server.  
__label__testing Code refactoring and improvements for MuranoPL testing mini-framework  * Stack-traces of caught exceptions are no longer printed in Python 2.6 * No more warning on Exception.message being deprecated * Loaded YAML files are cached instead of being re-read for each test    greatly increasing performance without side effects because class-loader    is still new on each test * object_model helper objects can be used as a test method arguments * Path to core library classes was relative to the test. That prevented grouping    tests into sub-folders * Preserve original stack-trace for Python exceptions thrown by the engine * Ability to delete (clear) traces (produced by calls to trace(...) in MuranoPL code) * Code refactoring  
__label__quality Code refactoring and improvements for MuranoPL testing mini-framework  * Stack-traces of caught exceptions are no longer printed in Python 2.6 * No more warning on Exception.message being deprecated * Loaded YAML files are cached instead of being re-read for each test    greatly increasing performance without side effects because class-loader    is still new on each test * object_model helper objects can be used as a test method arguments * Path to core library classes was relative to the test. That prevented grouping    tests into sub-folders * Preserve original stack-trace for Python exceptions thrown by the engine * Ability to delete (clear) traces (produced by calls to trace(...) in MuranoPL code) * Code refactoring  
__label__objective Code refactoring and improvements for MuranoPL testing mini-framework  * Stack-traces of caught exceptions are no longer printed in Python 2.6 * No more warning on Exception.message being deprecated * Loaded YAML files are cached instead of being re-read for each test    greatly increasing performance without side effects because class-loader    is still new on each test * object_model helper objects can be used as a test method arguments * Path to core library classes was relative to the test. That prevented grouping    tests into sub-folders * Preserve original stack-trace for Python exceptions thrown by the engine * Ability to delete (clear) traces (produced by calls to trace(...) in MuranoPL code) * Code refactoring  
__label__testing refactor cmd processor to make it slightly easier to test  * make logger global * create methods for setting up of parser and jjb configuration.  
__label__quality refactor cmd processor to make it slightly easier to test  * make logger global * create methods for setting up of parser and jjb configuration.  
__label__objective refactor cmd processor to make it slightly easier to test  * make logger global * create methods for setting up of parser and jjb configuration.  
__label__testing Make WebUI tests refactoring  A bunch of tests for creation/deletion apps from app-incubator were remowed because every changes in ui forms in app-incubator leads to failure in murano-ci jobs. To avoid this intersection with changes in other repository these tests were removed. Lately will be created test application which will be used in such tests.  
__label__objective Make WebUI tests refactoring  A bunch of tests for creation/deletion apps from app-incubator were remowed because every changes in ui forms in app-incubator leads to failure in murano-ci jobs. To avoid this intersection with changes in other repository these tests were removed. Lately will be created test application which will be used in such tests.  
__label__objective Make WebUI tests refactoring  A bunch of tests for creation/deletion apps from app-incubator were remowed because every changes in ui forms in app-incubator leads to failure in murano-ci jobs. To avoid this intersection with changes in other repository these tests were removed. Lately will be created test application which will be used in such tests.  
__label__testing Refactor in BashateRun class  Grab the module level functions that seemed to belong under the 'runtime logic' category and tuck them into a BashateRun class that should encapsulate the options and checks that are used in doing a bashate run against a set of files. Primarily, this makes it easier to unit test the bashate logic, but also opens up some API possibilities.  Leaving the 'check_*' functions at module level, as they have a relatively simple contract they need to fulfill for the time being.  
__label__quality Refactor in BashateRun class  Grab the module level functions that seemed to belong under the 'runtime logic' category and tuck them into a BashateRun class that should encapsulate the options and checks that are used in doing a bashate run against a set of files. Primarily, this makes it easier to unit test the bashate logic, but also opens up some API possibilities.  Leaving the 'check_*' functions at module level, as they have a relatively simple contract they need to fulfill for the time being.  
__label__objective Refactor in BashateRun class  Grab the module level functions that seemed to belong under the 'runtime logic' category and tuck them into a BashateRun class that should encapsulate the options and checks that are used in doing a bashate run against a set of files. Primarily, this makes it easier to unit test the bashate logic, but also opens up some API possibilities.  Leaving the 'check_*' functions at module level, as they have a relatively simple contract they need to fulfill for the time being.  
__label__testing Refactor WSGI.middleware and imporve test coverage  *) Move all logic related to secure transport of trace info to osprofiler/utils.py *) Add to methods singed_pack, signed_unpack that hides all complexity of packing data, generating hmac, and validating hmac data. *) Cover osprofiler/utils.py by separated tests *) Remove mess from WSGI middleware and add_trace_id_header *) Simplify web tests *) Disable possibility to setup empty hmac keys, cause of security reasons  
__label__quality Refactor WSGI.middleware and imporve test coverage  *) Move all logic related to secure transport of trace info to osprofiler/utils.py *) Add to methods singed_pack, signed_unpack that hides all complexity of packing data, generating hmac, and validating hmac data. *) Cover osprofiler/utils.py by separated tests *) Remove mess from WSGI middleware and add_trace_id_header *) Simplify web tests *) Disable possibility to setup empty hmac keys, cause of security reasons  
__label__objective Refactor WSGI.middleware and imporve test coverage  *) Move all logic related to secure transport of trace info to osprofiler/utils.py *) Add to methods singed_pack, signed_unpack that hides all complexity of packing data, generating hmac, and validating hmac data. *) Cover osprofiler/utils.py by separated tests *) Remove mess from WSGI middleware and add_trace_id_header *) Simplify web tests *) Disable possibility to setup empty hmac keys, cause of security reasons  
__label__testing Refactor tests to remove direct access to test DBManagers  This is needed to enable running tests without the need to specify DBManager explicitly. One will only have to provide an URL for tests to use.  Related to blueprint sql-unit-tests-on-real-backend  
__label__integration Refactor tests to remove direct access to test DBManagers  This is needed to enable running tests without the need to specify DBManager explicitly. One will only have to provide an URL for tests to use.  Related to blueprint sql-unit-tests-on-real-backend  
__label__objective Refactor tests to remove direct access to test DBManagers  This is needed to enable running tests without the need to specify DBManager explicitly. One will only have to provide an URL for tests to use.  Related to blueprint sql-unit-tests-on-real-backend  
__label__testing VMware: spawn refactor - phase 1 - test for spawn  Adding a test case for spawn to ensure all the correct methods are called  partial blueprint vmware-spawn-refactor  
__label__objective VMware: spawn refactor - phase 1 - test for spawn  Adding a test case for spawn to ensure all the correct methods are called  partial blueprint vmware-spawn-refactor  
__label__testing xenapi: refactor detach volume  Share more code between detach and detach_all, and make it easier to read. At the same time, improve the test coverage.  
__label__quality xenapi: refactor detach volume  Share more code between detach and detach_all, and make it easier to read. At the same time, improve the test coverage.  
__label__objective xenapi: refactor detach volume  Share more code between detach and detach_all, and make it easier to read. At the same time, improve the test coverage.  
__label__testing Refactor test_rescue_unrescue into compute api/manager unit tests  As part of converting the rescue/unrescue compute API flows to using objects, i.e. dot notation for accessing attributes on the instance object and updating the database via instance.save() rather than compute_api.update, we want to move some of the integration-style tests found in test_compute.py to test_compute_api.py and test_compute_mgr.py.  This is to help with the conversion so we don't have to use exotic stubs in the cells API flows to make integration tests work.  This change is mainly concerned with moving test_rescue_unrescue out of test_compute.py and into the api/manager specific test modules and then later changes will build on top of the new tests.  Part of blueprint compute-manager-objects-juno  
__label__objective Refactor test_rescue_unrescue into compute api/manager unit tests  As part of converting the rescue/unrescue compute API flows to using objects, i.e. dot notation for accessing attributes on the instance object and updating the database via instance.save() rather than compute_api.update, we want to move some of the integration-style tests found in test_compute.py to test_compute_api.py and test_compute_mgr.py.  This is to help with the conversion so we don't have to use exotic stubs in the cells API flows to make integration tests work.  This change is mainly concerned with moving test_rescue_unrescue out of test_compute.py and into the api/manager specific test modules and then later changes will build on top of the new tests.  Part of blueprint compute-manager-objects-juno  
__label__quality Refactor test_rescue_unrescue into compute api/manager unit tests  As part of converting the rescue/unrescue compute API flows to using objects, i.e. dot notation for accessing attributes on the instance object and updating the database via instance.save() rather than compute_api.update, we want to move some of the integration-style tests found in test_compute.py to test_compute_api.py and test_compute_mgr.py.  This is to help with the conversion so we don't have to use exotic stubs in the cells API flows to make integration tests work.  This change is mainly concerned with moving test_rescue_unrescue out of test_compute.py and into the api/manager specific test modules and then later changes will build on top of the new tests.  Part of blueprint compute-manager-objects-juno  
__label__testing Refactor the plan/app commands to respect the CrudManager Design  Add update method to the CrudManager More robust test around the solum app create method  
__label__objective Refactor the plan/app commands to respect the CrudManager Design  Add update method to the CrudManager More robust test around the solum app create method  
__label__testing Refactor test_auth trust related tests  The tests in the AuthWithTrust fixture had many dependencies on global variables that were not necessarily used; for instance, every time the setUp function is called, there was a new trust created. This was ran even for classes that don't need the creation of this initial valid trust.  This commit gets rid of this behaviour, thus making the test less dependent on the fixture's state (class variables) in favor of a more on-demand approach to getting trusts and tokens.  
__label__quality Refactor test_auth trust related tests  The tests in the AuthWithTrust fixture had many dependencies on global variables that were not necessarily used; for instance, every time the setUp function is called, there was a new trust created. This was ran even for classes that don't need the creation of this initial valid trust.  This commit gets rid of this behaviour, thus making the test less dependent on the fixture's state (class variables) in favor of a more on-demand approach to getting trusts and tokens.  
__label__objective Refactor test_auth trust related tests  The tests in the AuthWithTrust fixture had many dependencies on global variables that were not necessarily used; for instance, every time the setUp function is called, there was a new trust created. This was ran even for classes that don't need the creation of this initial valid trust.  This commit gets rid of this behaviour, thus making the test less dependent on the fixture's state (class variables) in favor of a more on-demand approach to getting trusts and tokens.  
__label__testing Refactor _find_caller into a public test finder utility  This moves the _find_caller utility method from rest_client into it's own public utility so that we can use it elsewhere in Tempest, like to uniquely identify which test case fails in a TimeoutException.  This is useful to uniquely fingerprint timeout failures with elastic-recheck which is not always possible right now because we don't have multi-line query support with elastic-recheck.  Unit tests are added but note that setUpClass can't be tested due to pep8 check T105.  Related-Bug: #1315201  
__label__objective Refactor _find_caller into a public test finder utility  This moves the _find_caller utility method from rest_client into it's own public utility so that we can use it elsewhere in Tempest, like to uniquely identify which test case fails in a TimeoutException.  This is useful to uniquely fingerprint timeout failures with elastic-recheck which is not always possible right now because we don't have multi-line query support with elastic-recheck.  Unit tests are added but note that setUpClass can't be tested due to pep8 check T105.  Related-Bug: #1315201  
__label__quality Refactor _find_caller into a public test finder utility  This moves the _find_caller utility method from rest_client into it's own public utility so that we can use it elsewhere in Tempest, like to uniquely identify which test case fails in a TimeoutException.  This is useful to uniquely fingerprint timeout failures with elastic-recheck which is not always possible right now because we don't have multi-line query support with elastic-recheck.  Unit tests are added but note that setUpClass can't be tested due to pep8 check T105.  Related-Bug: #1315201  
__label__testing Refactor notifications  I'm replacing the implementation of notifications with the blinker library. In order to do this properly I wanted to have a more defined interface and less coupling in the tests. Test should be unaware of the implementation of the thing they are testing so that the implementation can be changed later.  
__label__quality Refactor notifications  I'm replacing the implementation of notifications with the blinker library. In order to do this properly I wanted to have a more defined interface and less coupling in the tests. Test should be unaware of the implementation of the thing they are testing so that the implementation can be changed later.  
__label__objective Refactor notifications  I'm replacing the implementation of notifications with the blinker library. In order to do this properly I wanted to have a more defined interface and less coupling in the tests. Test should be unaware of the implementation of the thing they are testing so that the implementation can be changed later.  
__label__testing Refactor test_password_hashed to the backend testers  The test_password_hashed method was defined in test_backend.IdentityTests. This is a bad place for it because not all backends do password hashing (for example, the LDAP backend doesn't), and it was also implemented in a way where it called a private method of the backend, which the SQL backend implemented differently (it requires an SQLAlchemy session).  The test_password_hashed method is moved into the KVS backend test class, since the current implementation is specific to the KVS backend.  
__label__integration Refactor test_password_hashed to the backend testers  The test_password_hashed method was defined in test_backend.IdentityTests. This is a bad place for it because not all backends do password hashing (for example, the LDAP backend doesn't), and it was also implemented in a way where it called a private method of the backend, which the SQL backend implemented differently (it requires an SQLAlchemy session).  The test_password_hashed method is moved into the KVS backend test class, since the current implementation is specific to the KVS backend.  
__label__quality Refactor test_password_hashed to the backend testers  The test_password_hashed method was defined in test_backend.IdentityTests. This is a bad place for it because not all backends do password hashing (for example, the LDAP backend doesn't), and it was also implemented in a way where it called a private method of the backend, which the SQL backend implemented differently (it requires an SQLAlchemy session).  The test_password_hashed method is moved into the KVS backend test class, since the current implementation is specific to the KVS backend.  
__label__objective Refactor test_password_hashed to the backend testers  The test_password_hashed method was defined in test_backend.IdentityTests. This is a bad place for it because not all backends do password hashing (for example, the LDAP backend doesn't), and it was also implemented in a way where it called a private method of the backend, which the SQL backend implemented differently (it requires an SQLAlchemy session).  The test_password_hashed method is moved into the KVS backend test class, since the current implementation is specific to the KVS backend.  
__label__testing orchestration API refactor test_list_resources  Rework test_list_resources so we do a more explicit test of the resource list which is returned - we expect exactly one resource, so using assertIn is less explicit than assertEqual.  Refactoring the code which reads and validates the resource list will enable other tests to more easily reuse the resource-listing code.  
__label__integration orchestration API refactor test_list_resources  Rework test_list_resources so we do a more explicit test of the resource list which is returned - we expect exactly one resource, so using assertIn is less explicit than assertEqual.  Refactoring the code which reads and validates the resource list will enable other tests to more easily reuse the resource-listing code.  
__label__quality orchestration API refactor test_list_resources  Rework test_list_resources so we do a more explicit test of the resource list which is returned - we expect exactly one resource, so using assertIn is less explicit than assertEqual.  Refactoring the code which reads and validates the resource list will enable other tests to more easily reuse the resource-listing code.  
__label__objective orchestration API refactor test_list_resources  Rework test_list_resources so we do a more explicit test of the resource list which is returned - we expect exactly one resource, so using assertIn is less explicit than assertEqual.  Refactoring the code which reads and validates the resource list will enable other tests to more easily reuse the resource-listing code.  
__label__testing Refactor unit tests for image service CRUD  Refactors the image service unit tests of the create() method to be unit tests and not functional tests. There is no need to test whether an image ID that is specified in the payload to the glance image service is preserved; the unit and functional tests in the glanceclient package do that, and besides, all this was testing was the behavior of the fake glance client, which is pointless. There was also a test that created an image and then tested the show method would raise InstanceNotFound if not passing in the same instance name that was just created. This test was removed, as ImageNotFound is already thoroughly tested in the show() unit tests.  Missing in the existing unit tests was a test of failure conditions resulting in error codes returned from the glanceclient.create() call, and this patch adds a unit test that stresses the failure paths.  These new unit tests use mocks and assert that all code paths in the create(), update() and delete() methods are fully tested.  
__label__quality Refactor unit tests for image service CRUD  Refactors the image service unit tests of the create() method to be unit tests and not functional tests. There is no need to test whether an image ID that is specified in the payload to the glance image service is preserved; the unit and functional tests in the glanceclient package do that, and besides, all this was testing was the behavior of the fake glance client, which is pointless. There was also a test that created an image and then tested the show method would raise InstanceNotFound if not passing in the same instance name that was just created. This test was removed, as ImageNotFound is already thoroughly tested in the show() unit tests.  Missing in the existing unit tests was a test of failure conditions resulting in error codes returned from the glanceclient.create() call, and this patch adds a unit test that stresses the failure paths.  These new unit tests use mocks and assert that all code paths in the create(), update() and delete() methods are fully tested.  
__label__objective Refactor unit tests for image service CRUD  Refactors the image service unit tests of the create() method to be unit tests and not functional tests. There is no need to test whether an image ID that is specified in the payload to the glance image service is preserved; the unit and functional tests in the glanceclient package do that, and besides, all this was testing was the behavior of the fake glance client, which is pointless. There was also a test that created an image and then tested the show method would raise InstanceNotFound if not passing in the same instance name that was just created. This test was removed, as ImageNotFound is already thoroughly tested in the show() unit tests.  Missing in the existing unit tests was a test of failure conditions resulting in error codes returned from the glanceclient.create() call, and this patch adds a unit test that stresses the failure paths.  These new unit tests use mocks and assert that all code paths in the create(), update() and delete() methods are fully tested.  
__label__testing Refactored fake connection URL classes  Changed the way how DB tests are run to make them coope with concurrent databases. FakeUrl -> DbManager. DbManager becomes a context manager that is able to create a separate DB for each test and perform a cleanup action if needed (delete database)  This is a preparational work for adding new database backends.  Related to blueprint sql-unit-tests-on-real-backend  
__label__integration Refactored fake connection URL classes  Changed the way how DB tests are run to make them coope with concurrent databases. FakeUrl -> DbManager. DbManager becomes a context manager that is able to create a separate DB for each test and perform a cleanup action if needed (delete database)  This is a preparational work for adding new database backends.  Related to blueprint sql-unit-tests-on-real-backend  
__label__objective Refactored fake connection URL classes  Changed the way how DB tests are run to make them coope with concurrent databases. FakeUrl -> DbManager. DbManager becomes a context manager that is able to create a separate DB for each test and perform a cleanup action if needed (delete database)  This is a preparational work for adding new database backends.  Related to blueprint sql-unit-tests-on-real-backend  
__label__testing Refactored the way how testscenarios tests are run  Instead of using custom loader we now use a base class from testscenarios. This allows us to retain compatibility with unittest test runner and run a single test if needed.  
__label__objective Refactored the way how testscenarios tests are run  Instead of using custom loader we now use a base class from testscenarios. This allows us to retain compatibility with unittest test runner and run a single test if needed.  
__label__testing Refactors unit tests of image service detail()  We do not need to have "unit" tests that test the things like pagination work with the glanceclient.images.detail() call. glanceclient and glance have unit tests for that. What the unit tests for the glance image service detail() method in Nova need is to test only the code boundary that exists within the detail() method -- i.e. verify that the calls to the glanceclient and other helper methods are made with the right parameters.  This patch pulls the various unit tests out of the TestGlanceImageService test class and into their own test class that uses mocks and verifies each code path within the detail() method.  Next up is the create, update and delete methods of the GlanceImageService class. The final piece is to rework the download unit tests (which aren't unit tests but more functional tests that take around a second each to run :(  
__label__objective Refactors unit tests of image service detail()  We do not need to have "unit" tests that test the things like pagination work with the glanceclient.images.detail() call. glanceclient and glance have unit tests for that. What the unit tests for the glance image service detail() method in Nova need is to test only the code boundary that exists within the detail() method -- i.e. verify that the calls to the glanceclient and other helper methods are made with the right parameters.  This patch pulls the various unit tests out of the TestGlanceImageService test class and into their own test class that uses mocks and verifies each code path within the detail() method.  Next up is the create, update and delete methods of the GlanceImageService class. The final piece is to rework the download unit tests (which aren't unit tests but more functional tests that take around a second each to run :(  
__label__quality Refactors unit tests of image service detail()  We do not need to have "unit" tests that test the things like pagination work with the glanceclient.images.detail() call. glanceclient and glance have unit tests for that. What the unit tests for the glance image service detail() method in Nova need is to test only the code boundary that exists within the detail() method -- i.e. verify that the calls to the glanceclient and other helper methods are made with the right parameters.  This patch pulls the various unit tests out of the TestGlanceImageService test class and into their own test class that uses mocks and verifies each code path within the detail() method.  Next up is the create, update and delete methods of the GlanceImageService class. The final piece is to rework the download unit tests (which aren't unit tests but more functional tests that take around a second each to run :(  
__label__integration Refactoring of diskimage-create script  The script is divided into blocks corresponding version of installed plugin.  Added options for specifying image type and hadoop version. By using option you can choose image that you want to test instead of creating them all.  
__label__objective Refactoring of diskimage-create script  The script is divided into blocks corresponding version of installed plugin.  Added options for specifying image type and hadoop version. By using option you can choose image that you want to test instead of creating them all.  
__label__testing test(wsgi): Refactor tests in preparation for API v1.1  The tests were refactored into an inheritance model so that we can share as much of the testing code as possible between v1.0 and v1.1.  As a part of this process, test class names were normalized.  
__label__quality test(wsgi): Refactor tests in preparation for API v1.1  The tests were refactored into an inheritance model so that we can share as much of the testing code as possible between v1.0 and v1.1.  As a part of this process, test class names were normalized.  
__label__objective test(wsgi): Refactor tests in preparation for API v1.1  The tests were refactored into an inheritance model so that we can share as much of the testing code as possible between v1.0 and v1.1.  As a part of this process, test class names were normalized.  
__label__testing Refactor UUID test  Oslo is removing uuidutils during the icehouse cycle. We had removed uuidutils.generate_uuid() in https://review.openstack.org/#/c/60643/ It seems the UUID test was not executed, for example, there is no method called generate_uuid() in common/utils, the Jekins still passed. This patch move the testcase and remove the test method for generate_uuid.  
__label__objective Refactor UUID test  Oslo is removing uuidutils during the icehouse cycle. We had removed uuidutils.generate_uuid() in https://review.openstack.org/#/c/60643/ It seems the UUID test was not executed, for example, there is no method called generate_uuid() in common/utils, the Jekins still passed. This patch move the testcase and remove the test method for generate_uuid.  
__label__testing Refactor test of 'operation' object  The method 'utils.create_models_from_data' should have been used to avoid duplications of code  
__label__quality Refactor test of 'operation' object  The method 'utils.create_models_from_data' should have been used to avoid duplications of code  
__label__objective Refactor test of 'operation' object  The method 'utils.create_models_from_data' should have been used to avoid duplications of code  
__label__testing Refactor test of 'service' object by using 'utils.create_models_from_data'  The method create_models_from_data should have been used to avoid duplications of code  
__label__quality Refactor test of 'service' object by using 'utils.create_models_from_data'  The method create_models_from_data should have been used to avoid duplications of code  
__label__objective Refactor test of 'service' object by using 'utils.create_models_from_data'  The method create_models_from_data should have been used to avoid duplications of code  
__label__testing Fixing and refactoring authtication  * Moved pecan configuration to oslo config * Refactored functional base test * Got rig of thread local related code in mistral/context.py * Added new exception ApplicationContextNotFoundException * Fixed example configuration file * Made minor cosmetic changes (blank lines, naming)  
__label__objective Fixing and refactoring authtication  * Moved pecan configuration to oslo config * Refactored functional base test * Got rig of thread local related code in mistral/context.py * Added new exception ApplicationContextNotFoundException * Fixed example configuration file * Made minor cosmetic changes (blank lines, naming)  
__label__quality Fixing and refactoring authtication  * Moved pecan configuration to oslo config * Refactored functional base test * Got rig of thread local related code in mistral/context.py * Added new exception ApplicationContextNotFoundException * Fixed example configuration file * Made minor cosmetic changes (blank lines, naming)  
__label__testing Refactor add contrib into heat gate testing  The existing code is running twice, one for heat, one for contrib via adding two commands in tox.  This is breaking tox single run. For example:    tox -e py27 -- heat.tests.test_software_config  Except heat.tests.test_software_config is executed, all test cases in contrib will be executed.  The patch added contrib in discover list, which can make sure both contrib in heat gate testing and does not break single test run.  
__label__objective Refactor add contrib into heat gate testing  The existing code is running twice, one for heat, one for contrib via adding two commands in tox.  This is breaking tox single run. For example:    tox -e py27 -- heat.tests.test_software_config  Except heat.tests.test_software_config is executed, all test cases in contrib will be executed.  The patch added contrib in discover list, which can make sure both contrib in heat gate testing and does not break single test run.  
__label__quality Refactor add contrib into heat gate testing  The existing code is running twice, one for heat, one for contrib via adding two commands in tox.  This is breaking tox single run. For example:    tox -e py27 -- heat.tests.test_software_config  Except heat.tests.test_software_config is executed, all test cases in contrib will be executed.  The patch added contrib in discover list, which can make sure both contrib in heat gate testing and does not break single test run.  
__label__testing Refactor context trust_id check to wsgi.Application base class  Move the ec2 controller check for a trust_id in the token specified in the request context, renaming it to match the existing convention in the controller base classes.  This function can be used by both v2 and v3 controllers hence putting it into the common Application base class.  Test coverage for this is provided via existing tests in test_keystoneclient_sql.py  
__label__objective Refactor context trust_id check to wsgi.Application base class  Move the ec2 controller check for a trust_id in the token specified in the request context, renaming it to match the existing convention in the controller base classes.  This function can be used by both v2 and v3 controllers hence putting it into the common Application base class.  Test coverage for this is provided via existing tests in test_keystoneclient_sql.py  
__label__testing Refactor unit tests for dummy engine  This patch removes a duplicate test from TestDummyDeployEngine and also renames/reorders several test methods to make the code more consistent.  Blueprint unit-tests-refactoring  
__label__quality Refactor unit tests for dummy engine  This patch removes a duplicate test from TestDummyDeployEngine and also renames/reorders several test methods to make the code more consistent.  Blueprint unit-tests-refactoring  
__label__objective Refactor unit tests for dummy engine  This patch removes a duplicate test from TestDummyDeployEngine and also renames/reorders several test methods to make the code more consistent.  Blueprint unit-tests-refactoring  
__label__testing refactor bot to be based on argparse  this makes the bot based on argparse, and provides a tox job that makes running the bot in test mode a little more sane. It also provides for a new '-n' nocomment item so you can run the bot and not be worried that it will report to gerrit with findings.  
__label__quality refactor bot to be based on argparse  this makes the bot based on argparse, and provides a tox job that makes running the bot in test mode a little more sane. It also provides for a new '-n' nocomment item so you can run the bot and not be worried that it will report to gerrit with findings.  
__label__objective refactor bot to be based on argparse  this makes the bot based on argparse, and provides a tox job that makes running the bot in test mode a little more sane. It also provides for a new '-n' nocomment item so you can run the bot and not be worried that it will report to gerrit with findings.  
__label__testing Step 1 refactoring Mistral engines   * Action definition was combined in actions module  * workflow from single engine was deleted  * task from single engine was deleted  * unit test 'test_workflow' was deleted due to deleting workflow   Next step will be extracting and combining common parts  of scalable and single engine.  
__label__quality Step 1 refactoring Mistral engines   * Action definition was combined in actions module  * workflow from single engine was deleted  * task from single engine was deleted  * unit test 'test_workflow' was deleted due to deleting workflow   Next step will be extracting and combining common parts  of scalable and single engine.  
__label__objective Step 1 refactoring Mistral engines   * Action definition was combined in actions module  * workflow from single engine was deleted  * task from single engine was deleted  * unit test 'test_workflow' was deleted due to deleting workflow   Next step will be extracting and combining common parts  of scalable and single engine.  
__label__testing Refactor Images API v2.0 Tenant Permisions Test  Test and fixtures refactoring:  - refactored the test to account for changes made on the fixtures, behaviors, config and image model  - used non admin users for the implementation of the tests  - added new test steps to improve implementation  - added admin user access data, behavior and images client in the fixtures,    to distinguish between privileges of a normal user, an alternate user (both non admin) and the admin user.  
__label__integration Refactor Images API v2.0 Tenant Permisions Test  Test and fixtures refactoring:  - refactored the test to account for changes made on the fixtures, behaviors, config and image model  - used non admin users for the implementation of the tests  - added new test steps to improve implementation  - added admin user access data, behavior and images client in the fixtures,    to distinguish between privileges of a normal user, an alternate user (both non admin) and the admin user.  
__label__objective Refactor Images API v2.0 Tenant Permisions Test  Test and fixtures refactoring:  - refactored the test to account for changes made on the fixtures, behaviors, config and image model  - used non admin users for the implementation of the tests  - added new test steps to improve implementation  - added admin user access data, behavior and images client in the fixtures,    to distinguish between privileges of a normal user, an alternate user (both non admin) and the admin user.  
__label__testing Refactor engine internals WIP  TODO: - test multithreading - fix eventlet execution (it hangs now)  What's done: - single GraphAction   - with parallel revert!   - using executor - TaskAction's method split - parallel task executor used for parallel engine - other minor c00l stufff  
__label__integration Refactor engine internals WIP  TODO: - test multithreading - fix eventlet execution (it hangs now)  What's done: - single GraphAction   - with parallel revert!   - using executor - TaskAction's method split - parallel task executor used for parallel engine - other minor c00l stufff  
__label__quality Refactor engine internals WIP  TODO: - test multithreading - fix eventlet execution (it hangs now)  What's done: - single GraphAction   - with parallel revert!   - using executor - TaskAction's method split - parallel task executor used for parallel engine - other minor c00l stufff  
__label__objective Refactor engine internals WIP  TODO: - test multithreading - fix eventlet execution (it hangs now)  What's done: - single GraphAction   - with parallel revert!   - using executor - TaskAction's method split - parallel task executor used for parallel engine - other minor c00l stufff  
__label__testing Blockstorage test refactor and buildout  * Fixes and expands blockstorage test fixtures * Adds working auth integration. * Adds blockstorage data driven test dataset list generator class. * Adds volume type dataset list generator. * Adds volume and snapshot datadriven smoketests. * Updates os-volume_attachments api integration to reflect upstream   changes. * Updates compute volume integration tests to reflact upstream changes.  
__label__objective Blockstorage test refactor and buildout  * Fixes and expands blockstorage test fixtures * Adds working auth integration. * Adds blockstorage data driven test dataset list generator class. * Adds volume type dataset list generator. * Adds volume and snapshot datadriven smoketests. * Updates os-volume_attachments api integration to reflect upstream   changes. * Updates compute volume integration tests to reflact upstream changes.  
__label__quality Blockstorage test refactor and buildout  * Fixes and expands blockstorage test fixtures * Adds working auth integration. * Adds blockstorage data driven test dataset list generator class. * Adds volume type dataset list generator. * Adds volume and snapshot datadriven smoketests. * Updates os-volume_attachments api integration to reflect upstream   changes. * Updates compute volume integration tests to reflact upstream changes.  
__label__testing Refactor Images API v2.0 client  Refactors 'store_image_file' method signator:   - added content type as a new parameter in order to test for     upload of image file with a different (from the default 'application/octet-stream')     content type.  
__label__integration Refactor Images API v2.0 client  Refactors 'store_image_file' method signator:   - added content type as a new parameter in order to test for     upload of image file with a different (from the default 'application/octet-stream')     content type.  
__label__objective Refactor Images API v2.0 client  Refactors 'store_image_file' method signator:   - added content type as a new parameter in order to test for     upload of image file with a different (from the default 'application/octet-stream')     content type.  
__label__testing baremetal: volume driver refactoring and tests  Refactor the LibVirtVolumeDriver to test each step of attaching and detaching a volume. And add tests.  
__label__integration baremetal: volume driver refactoring and tests  Refactor the LibVirtVolumeDriver to test each step of attaching and detaching a volume. And add tests.  
__label__objective baremetal: volume driver refactoring and tests  Refactor the LibVirtVolumeDriver to test each step of attaching and detaching a volume. And add tests.  
__label__testing Refactor StorageQuotaFull test cases in test_quota  There were two test cases in test_quota that shared the same name, but did almost the same thing. After a bit of digging, it looked like most of the test cases did the almost same thing, so I refactored the common bits and fixed the test case name duplication.  
__label__quality Refactor StorageQuotaFull test cases in test_quota  There were two test cases in test_quota that shared the same name, but did almost the same thing. After a bit of digging, it looked like most of the test cases did the almost same thing, so I refactored the common bits and fixed the test case name duplication.  
__label__objective Refactor StorageQuotaFull test cases in test_quota  There were two test cases in test_quota that shared the same name, but did almost the same thing. After a bit of digging, it looked like most of the test cases did the almost same thing, so I refactored the common bits and fixed the test case name duplication.  
__label__testing refactor test_catalog  - Tests for "missing" attributes are actually testing with null values,   not missing keys. - Not being able to explicitly provide alternative URLs resulting in   hacky workarounds that can be avoiding by simply exposing kwargs with   reasonable defaults - Several tests redundantly asserted the expected response status, which   is already handled by the test framework  
__label__quality refactor test_catalog  - Tests for "missing" attributes are actually testing with null values,   not missing keys. - Not being able to explicitly provide alternative URLs resulting in   hacky workarounds that can be avoiding by simply exposing kwargs with   reasonable defaults - Several tests redundantly asserted the expected response status, which   is already handled by the test framework  
__label__objective refactor test_catalog  - Tests for "missing" attributes are actually testing with null values,   not missing keys. - Not being able to explicitly provide alternative URLs resulting in   hacky workarounds that can be avoiding by simply exposing kwargs with   reasonable defaults - Several tests redundantly asserted the expected response status, which   is already handled by the test framework  
__label__testing Refactor assertEqualXML into a testtool matcher  Not all tests inheriting from TestCase will need to check XML equality. Moving this functionality to a matcher leaves it up to the test class to decided whether or not it needs it.  
__label__quality Refactor assertEqualXML into a testtool matcher  Not all tests inheriting from TestCase will need to check XML equality. Moving this functionality to a matcher leaves it up to the test class to decided whether or not it needs it.  
__label__objective Refactor assertEqualXML into a testtool matcher  Not all tests inheriting from TestCase will need to check XML equality. Moving this functionality to a matcher leaves it up to the test class to decided whether or not it needs it.  
__label__testing Refactor new options into a new config file.  From now on all releases configurations will be available, which will make easier to test more than two versions upgrade (meaning test upgrades like g->h->i). Note that grizzly files will not be necessary since we don't test folsom->grizzly  
__label__objective Refactor new options into a new config file.  From now on all releases configurations will be available, which will make easier to test more than two versions upgrade (meaning test upgrades like g->h->i). Note that grizzly files will not be necessary since we don't test folsom->grizzly  
__label__testing Fix server deletion issues, add test refactoring  Meged with changes from 3.2-fixes  
__label__quality Fix server deletion issues, add test refactoring  Meged with changes from 3.2-fixes  
__label__objective Fix server deletion issues, add test refactoring  Meged with changes from 3.2-fixes  
__label__testing Fix server deletion issues, add test refactoring  
__label__quality Fix server deletion issues, add test refactoring  
__label__objective Fix server deletion issues, add test refactoring  
__label__testing Discovering refactoring  Discovering logic has been changed in order to perform some optimisation. Now discovering process takes place at the time of ostf-server startup and it loads to db all existing tests. Also some data from db (test set and corresponding to them tests data) is cached to provide fast access to this test repository in future. Further discovering for particualar cluster is done by adding to database some information that links needed test sets and tests with cluster. Linking process uses data from cache so discovering takes less time to be performed.  
__label__integration Discovering refactoring  Discovering logic has been changed in order to perform some optimisation. Now discovering process takes place at the time of ostf-server startup and it loads to db all existing tests. Also some data from db (test set and corresponding to them tests data) is cached to provide fast access to this test repository in future. Further discovering for particualar cluster is done by adding to database some information that links needed test sets and tests with cluster. Linking process uses data from cache so discovering takes less time to be performed.  
__label__objective Discovering refactoring  Discovering logic has been changed in order to perform some optimisation. Now discovering process takes place at the time of ostf-server startup and it loads to db all existing tests. Also some data from db (test set and corresponding to them tests data) is cached to provide fast access to this test repository in future. Further discovering for particualar cluster is done by adding to database some information that links needed test sets and tests with cluster. Linking process uses data from cache so discovering takes less time to be performed.  
__label__quality Discovering refactoring  Discovering logic has been changed in order to perform some optimisation. Now discovering process takes place at the time of ostf-server startup and it loads to db all existing tests. Also some data from db (test set and corresponding to them tests data) is cached to provide fast access to this test repository in future. Further discovering for particualar cluster is done by adding to database some information that links needed test sets and tests with cluster. Linking process uses data from cache so discovering takes less time to be performed.  
__label__testing Refactor duplicate isolated creds code  The code to set the isolated credentials and the client manager for the compute and volume base test classes was duplicated. The duplicated code has been moved to tempest.test.BaseTestCase.  Closes-Bug: #1177411 
__label__quality Refactor duplicate isolated creds code  The code to set the isolated credentials and the client manager for the compute and volume base test classes was duplicated. The duplicated code has been moved to tempest.test.BaseTestCase.  Closes-Bug: #1177411 
__label__objective Refactor duplicate isolated creds code  The code to set the isolated credentials and the client manager for the compute and volume base test classes was duplicated. The duplicated code has been moved to tempest.test.BaseTestCase.  Closes-Bug: #1177411 
__label__quality Use static IP address instead of dhcp for admin network * pass netcfg/choose_interface parameter for Ubuntu and Centos\RedHat * pass to orchestrator static ip instead of dhcp for admin network * fix ip order for admin ips, it was broken for deployment   and provisioning assigned other ip addresses * small stylistic refactoring of network manager * fix test for capacity which some times fails  
__label__objective Use static IP address instead of dhcp for admin network * pass netcfg/choose_interface parameter for Ubuntu and Centos\RedHat * pass to orchestrator static ip instead of dhcp for admin network * fix ip order for admin ips, it was broken for deployment   and provisioning assigned other ip addresses * small stylistic refactoring of network manager * fix test for capacity which some times fails  
__label__testing Refactoring of log preparation initial ubuntu progress bar * small refactoring * add support log progress for multiple OSes * create separate file for exceptions * fix indentations * remove pending test  Tested by hand for centos/ubuntu in simple mode. More tests will be in next patches.  
__label__quality Refactoring of log preparation initial ubuntu progress bar * small refactoring * add support log progress for multiple OSes * create separate file for exceptions * fix indentations * remove pending test  Tested by hand for centos/ubuntu in simple mode. More tests will be in next patches.  
__label__objective Refactoring of log preparation initial ubuntu progress bar * small refactoring * add support log progress for multiple OSes * create separate file for exceptions * fix indentations * remove pending test  Tested by hand for centos/ubuntu in simple mode. More tests will be in next patches.  
__label__testing Field 'deployment_tags' for tests and test_sets alongside with migration to support these changes were added. To fabfile task that performs creation of new alembic migration was added. Additional refactoring and non-major fixes.  cluster_id field was added for test_sets (migration script was supplied). Logic of discovering test_sets and tests was moved to controllers (test-set controller). Nose plugin was refactored. Tests was not be supplied for new features.  Test discovering in controllers. Models description and discovery logic changing  New pure init revision for alembic (other have been deleted). Some non-major refactoring to other files  All system was refactored in order to support new logic of discovering test_sets and tests in ostf runtime  Non-major fix in fabfile. For unit tests logic that controlls data writing to db from tests has been added. Test for nose_discovery have been supplied  Some non-major fixes to nose_discovery plugin. Unit tests for nose_discovery have been finished  deployments_types_tests were added for the purpose of testing new discovery behaviour and with intesions to keep logic defined with dummy_tests. Unit tests for nose discovery have been fixed.  New fake empty tests were added just to keep logic defined in dummy_tests  Unit tests for wsgi_controllers have been fixed  unit tests for wsgi controllers have been finished  Some fixes to wsgi contorollers (now test_set controller returns non first result from query but all; test controller return all tests with no test_run id present within it). Nose discovery function was fixed: now it searches for test_sets for given cluster id without checking data in db (in this case sqlalchemy merge should prevent from making dublicates). Some methods in nose_storage_plugin were fixed for the sake of supporting new behaviour of get_description function (with new addition value returning - deployment_tags). Attemptings to rewrite functional tests were made thus TestingAdapterClient was modified. Some other non-major fixes were added.  New changes to nose_discovery func (checking out of cluster's redeploying, implementing is not finished). Some changed to controllers (mostly to returning value). Nose discovery tests were changed in order to implement future changes. Proper processing of debug_tests path was added to wsgi_utils.  Some fixes to discovery logic and different tests  BaseTestingAdapter was simplified. Several functional tests have been fixed.  For Test class new element 'disabled' for statuses enumerate was added. New initial_migration was added (since models were modified). Functional tests were fixed to support new logic.  Smth strange with wsgi_utils.  Test for redeployed cluster were added to test_wsgi_controllers.py. multinode_deployment_tests were fixed.  
__label__objective Field 'deployment_tags' for tests and test_sets alongside with migration to support these changes were added. To fabfile task that performs creation of new alembic migration was added. Additional refactoring and non-major fixes.  cluster_id field was added for test_sets (migration script was supplied). Logic of discovering test_sets and tests was moved to controllers (test-set controller). Nose plugin was refactored. Tests was not be supplied for new features.  Test discovering in controllers. Models description and discovery logic changing  New pure init revision for alembic (other have been deleted). Some non-major refactoring to other files  All system was refactored in order to support new logic of discovering test_sets and tests in ostf runtime  Non-major fix in fabfile. For unit tests logic that controlls data writing to db from tests has been added. Test for nose_discovery have been supplied  Some non-major fixes to nose_discovery plugin. Unit tests for nose_discovery have been finished  deployments_types_tests were added for the purpose of testing new discovery behaviour and with intesions to keep logic defined with dummy_tests. Unit tests for nose discovery have been fixed.  New fake empty tests were added just to keep logic defined in dummy_tests  Unit tests for wsgi_controllers have been fixed  unit tests for wsgi controllers have been finished  Some fixes to wsgi contorollers (now test_set controller returns non first result from query but all; test controller return all tests with no test_run id present within it). Nose discovery function was fixed: now it searches for test_sets for given cluster id without checking data in db (in this case sqlalchemy merge should prevent from making dublicates). Some methods in nose_storage_plugin were fixed for the sake of supporting new behaviour of get_description function (with new addition value returning - deployment_tags). Attemptings to rewrite functional tests were made thus TestingAdapterClient was modified. Some other non-major fixes were added.  New changes to nose_discovery func (checking out of cluster's redeploying, implementing is not finished). Some changed to controllers (mostly to returning value). Nose discovery tests were changed in order to implement future changes. Proper processing of debug_tests path was added to wsgi_utils.  Some fixes to discovery logic and different tests  BaseTestingAdapter was simplified. Several functional tests have been fixed.  For Test class new element 'disabled' for statuses enumerate was added. New initial_migration was added (since models were modified). Functional tests were fixed to support new logic.  Smth strange with wsgi_utils.  Test for redeployed cluster were added to test_wsgi_controllers.py. multinode_deployment_tests were fixed.  
__label__testing Refactor test cases related to instance oject  After the blueprint unified-object-model, all of the instance should be represtend by an instance object but not a db instance dict.  But for some test cases, they were still using db instance dict, we should change those test cases to use instance object.  The fix include three parts: 1) Add a new stub method fake_fault_obj in nova/tests/fake_instance.py to help convert a dict fault to an object fault. 2) Add a new stub method fake_instance_obj in nova/tests/fake_instance.py to help convert a dict instance to an object instance. 3) Make sure all test cases related to "fault" and "instance" passed.  Fix bug 1230125 Fix part of bug 1212915  
__label__quality Refactor test cases related to instance oject  After the blueprint unified-object-model, all of the instance should be represtend by an instance object but not a db instance dict.  But for some test cases, they were still using db instance dict, we should change those test cases to use instance object.  The fix include three parts: 1) Add a new stub method fake_fault_obj in nova/tests/fake_instance.py to help convert a dict fault to an object fault. 2) Add a new stub method fake_instance_obj in nova/tests/fake_instance.py to help convert a dict instance to an object instance. 3) Make sure all test cases related to "fault" and "instance" passed.  Fix bug 1230125 Fix part of bug 1212915  
__label__integration Refactor test cases related to instance oject  After the blueprint unified-object-model, all of the instance should be represtend by an instance object but not a db instance dict.  But for some test cases, they were still using db instance dict, we should change those test cases to use instance object.  The fix include three parts: 1) Add a new stub method fake_fault_obj in nova/tests/fake_instance.py to help convert a dict fault to an object fault. 2) Add a new stub method fake_instance_obj in nova/tests/fake_instance.py to help convert a dict instance to an object instance. 3) Make sure all test cases related to "fault" and "instance" passed.  Fix bug 1230125 Fix part of bug 1212915  
__label__objective Refactor test cases related to instance oject  After the blueprint unified-object-model, all of the instance should be represtend by an instance object but not a db instance dict.  But for some test cases, they were still using db instance dict, we should change those test cases to use instance object.  The fix include three parts: 1) Add a new stub method fake_fault_obj in nova/tests/fake_instance.py to help convert a dict fault to an object fault. 2) Add a new stub method fake_instance_obj in nova/tests/fake_instance.py to help convert a dict instance to an object instance. 3) Make sure all test cases related to "fault" and "instance" passed.  Fix bug 1230125 Fix part of bug 1212915  
__label__testing Integration test refactoring  * Test for Haddop configs was changed; * Helper script for Hadoop config testing was changed; * File base.py was changed.  
__label__objective Integration test refactoring  * Test for Haddop configs was changed; * Helper script for Hadoop config testing was changed; * File base.py was changed.  
__label__quality Integration test refactoring  * Test for Haddop configs was changed; * Helper script for Hadoop config testing was changed; * File base.py was changed.  
__label__testing Subject: refactor container smoke test  * changed assertion messages * moved container and object creation to the setupClass * added a tearDownClass  
__label__objective Subject: refactor container smoke test  * changed assertion messages * moved container and object creation to the setupClass * added a tearDownClass  
__label__testing refactor db2 get_meter_statistics method to support mongodb and db2  db2 driver for get_meter_statistics method did not work against mongodb which caused many test cases being skipped. This patch set will fix that problem also made sure that all statistics functions are supported by db2 driver against db2 and mongodb database  
__label__objective refactor db2 get_meter_statistics method to support mongodb and db2  db2 driver for get_meter_statistics method did not work against mongodb which caused many test cases being skipped. This patch set will fix that problem also made sure that all statistics functions are supported by db2 driver against db2 and mongodb database  
__label__integration refactor db2 get_meter_statistics method to support mongodb and db2  db2 driver for get_meter_statistics method did not work against mongodb which caused many test cases being skipped. This patch set will fix that problem also made sure that all statistics functions are supported by db2 driver against db2 and mongodb database  
__label__testing Slight refactoring of the Tester.run() method  This is a slight refactoring of the test case for the utils.Tester.run() method which removes code duplicate and adds one extra assertion (the method is a really central one for Rally and should be carefully tested).  Blueprint test-engine  
__label__objective Slight refactoring of the Tester.run() method  This is a slight refactoring of the test case for the utils.Tester.run() method which removes code duplicate and adds one extra assertion (the method is a really central one for Rally and should be carefully tested).  Blueprint test-engine  
__label__quality Slight refactoring of the Tester.run() method  This is a slight refactoring of the test case for the utils.Tester.run() method which removes code duplicate and adds one extra assertion (the method is a really central one for Rally and should be carefully tested).  Blueprint test-engine  
__label__testing Refactor huawei Dorado array iSCSI driver  This is the second patch, changes as follows: 1.Add ISCSIDriver for Dorado arrays. The ISCSIDriver inherit from T. 1.Add a common class DoradoCommon for both FC and iSCSI drivers. The common class inherit from T common for they have many common functions. 2.Add unit test for Dorado drivers.  
__label__quality Refactor huawei Dorado array iSCSI driver  This is the second patch, changes as follows: 1.Add ISCSIDriver for Dorado arrays. The ISCSIDriver inherit from T. 1.Add a common class DoradoCommon for both FC and iSCSI drivers. The common class inherit from T common for they have many common functions. 2.Add unit test for Dorado drivers.  
__label__objective Refactor huawei Dorado array iSCSI driver  This is the second patch, changes as follows: 1.Add ISCSIDriver for Dorado arrays. The ISCSIDriver inherit from T. 1.Add a common class DoradoCommon for both FC and iSCSI drivers. The common class inherit from T common for they have many common functions. 2.Add unit test for Dorado drivers.  
__label__testing Refactor System Tests  This patch, 1. Renames 'System Tests' to 'Functional Tests'. 2. Reduces LOC by using ddt. 3. Removes test dependencies & the numbering convention used earlier. 4. Re-organizes the test suite structure.  blueprint refactor-system-tests  
__label__quality Refactor System Tests  This patch, 1. Renames 'System Tests' to 'Functional Tests'. 2. Reduces LOC by using ddt. 3. Removes test dependencies & the numbering convention used earlier. 4. Re-organizes the test suite structure.  blueprint refactor-system-tests  
__label__objective Refactor System Tests  This patch, 1. Renames 'System Tests' to 'Functional Tests'. 2. Reduces LOC by using ddt. 3. Removes test dependencies & the numbering convention used earlier. 4. Re-organizes the test suite structure.  blueprint refactor-system-tests  
__label__testing Adds tests for client module and refactors  Refactors client/get_client() function into separate client/_get_client_with_token() and client/_get_client_with_credentials().  Refactors some dict manipulation from test into tests/utils.  Raises ValueError in client/get_client() when kwargs do not meet requirements.  Adds tests for client/_get_client_with_token() Adds tests for client._get_client_with_credentials() Adds tests for client/_get_token_and_endpoint() Adds tests for client/get_client() Adds test for client/Client()  
__label__quality Adds tests for client module and refactors  Refactors client/get_client() function into separate client/_get_client_with_token() and client/_get_client_with_credentials().  Refactors some dict manipulation from test into tests/utils.  Raises ValueError in client/get_client() when kwargs do not meet requirements.  Adds tests for client/_get_client_with_token() Adds tests for client._get_client_with_credentials() Adds tests for client/_get_token_and_endpoint() Adds tests for client/get_client() Adds test for client/Client()  
__label__objective Adds tests for client module and refactors  Refactors client/get_client() function into separate client/_get_client_with_token() and client/_get_client_with_credentials().  Refactors some dict manipulation from test into tests/utils.  Raises ValueError in client/get_client() when kwargs do not meet requirements.  Adds tests for client/_get_client_with_token() Adds tests for client._get_client_with_credentials() Adds tests for client/_get_token_and_endpoint() Adds tests for client/get_client() Adds test for client/Client()  
__label__testing Refactored storage tests to use testscenarios  This refactore storage tests to use testscenarios  The test_impl_* files now have only test related the a particular backend.  All common tests are in test_impl_scenarios.py (previously named base.py)  Parts of blueprint db-tests-with-scenarios  
__label__quality Refactored storage tests to use testscenarios  This refactore storage tests to use testscenarios  The test_impl_* files now have only test related the a particular backend.  All common tests are in test_impl_scenarios.py (previously named base.py)  Parts of blueprint db-tests-with-scenarios  
__label__objective Refactored storage tests to use testscenarios  This refactore storage tests to use testscenarios  The test_impl_* files now have only test related the a particular backend.  All common tests are in test_impl_scenarios.py (previously named base.py)  Parts of blueprint db-tests-with-scenarios  
__label__testing Refactor integrated tests  Refactors the integrated test classes so they can be used for both V2 and V3 API testing. No actual V3 testing is added in this changeset  Partially implements v3-api-unittests Partially implements v3-api-specification  
__label__integration Refactor integrated tests  Refactors the integrated test classes so they can be used for both V2 and V3 API testing. No actual V3 testing is added in this changeset  Partially implements v3-api-unittests Partially implements v3-api-specification  
__label__objective Refactor integrated tests  Refactors the integrated test classes so they can be used for both V2 and V3 API testing. No actual V3 testing is added in this changeset  Partially implements v3-api-unittests Partially implements v3-api-specification  
__label__testing Refactor the code in heat/tests/test_volume.py  The test code in heat/tests/test_volume.py has lots of duplicated code and logic. Extract them into common method and reuse the methods.  
__label__quality Refactor the code in heat/tests/test_volume.py  The test code in heat/tests/test_volume.py has lots of duplicated code and logic. Extract them into common method and reuse the methods.  
__label__objective Refactor the code in heat/tests/test_volume.py  The test code in heat/tests/test_volume.py has lots of duplicated code and logic. Extract them into common method and reuse the methods.  
__label__testing Refactor unit tests for NEC Plugin  blueprint nec-plugin-test-coverage  This commit refactors the base class of unit tests for NEC Plugin to make writing new tests easier.  Add fake OFC Manager and change unit tests which use OFC Manager mock to using this fake.  With this fake, we don't need to set return_value and side_effect to the mock instance of OFC Manager in each test case. This fake keeps all resources on OFC, and returns existence of resources properly.  This fake is attached to OFC Manager mock instance by setting all side_effects.  We can also set it to raise an exception.  Make NEC Plugin configurable in each test case.  Now we can configure NEC Plugin by setting string in class value "_nec_ini" which will be written into a temporal file and loaded by NEC plugin.  Move setup for callbacks into NecPluginV2TestCase() so that other unit tests can use callbacks.  
__label__quality Refactor unit tests for NEC Plugin  blueprint nec-plugin-test-coverage  This commit refactors the base class of unit tests for NEC Plugin to make writing new tests easier.  Add fake OFC Manager and change unit tests which use OFC Manager mock to using this fake.  With this fake, we don't need to set return_value and side_effect to the mock instance of OFC Manager in each test case. This fake keeps all resources on OFC, and returns existence of resources properly.  This fake is attached to OFC Manager mock instance by setting all side_effects.  We can also set it to raise an exception.  Make NEC Plugin configurable in each test case.  Now we can configure NEC Plugin by setting string in class value "_nec_ini" which will be written into a temporal file and loaded by NEC plugin.  Move setup for callbacks into NecPluginV2TestCase() so that other unit tests can use callbacks.  
__label__objective Refactor unit tests for NEC Plugin  blueprint nec-plugin-test-coverage  This commit refactors the base class of unit tests for NEC Plugin to make writing new tests easier.  Add fake OFC Manager and change unit tests which use OFC Manager mock to using this fake.  With this fake, we don't need to set return_value and side_effect to the mock instance of OFC Manager in each test case. This fake keeps all resources on OFC, and returns existence of resources properly.  This fake is attached to OFC Manager mock instance by setting all side_effects.  We can also set it to raise an exception.  Make NEC Plugin configurable in each test case.  Now we can configure NEC Plugin by setting string in class value "_nec_ini" which will be written into a temporal file and loaded by NEC plugin.  Move setup for callbacks into NecPluginV2TestCase() so that other unit tests can use callbacks.  
__label__testing Refactor unsupported default store testing  This change improves coverage while saving ~10 seconds per test run.  Part of bp:faster-better-stronger-functional-tests  
__label__quality Refactor unsupported default store testing  This change improves coverage while saving ~10 seconds per test run.  Part of bp:faster-better-stronger-functional-tests  
__label__objective Refactor unsupported default store testing  This change improves coverage while saving ~10 seconds per test run.  Part of bp:faster-better-stronger-functional-tests  
__label__testing Refactored tests for instance_actions_*  Moved tests to separate test case Improved test assertions Added tests to cover exceptions in db.api  blueprint db-api-tests  
__label__objective Refactored tests for instance_actions_*  Moved tests to separate test case Improved test assertions Added tests to cover exceptions in db.api  blueprint db-api-tests  
__label__testing Refactored tests for instance_fault_*  Moved tests to separate test case Improved test assertions  blueprint db-api-tests  
__label__objective Refactored tests for instance_fault_*  Moved tests to separate test case Improved test assertions  blueprint db-api-tests  
__label__testing Refactor hooks file.  It was long and rambly. It's also in need of unittesting. So split it into some classes so that we can test the inputs and outputs more sensibly.  
__label__quality Refactor hooks file.  It was long and rambly. It's also in need of unittesting. So split it into some classes so that we can test the inputs and outputs more sensibly.  
__label__objective Refactor hooks file.  It was long and rambly. It's also in need of unittesting. So split it into some classes so that we can test the inputs and outputs more sensibly.  
__label__testing refactor of cinder manifests  This commit refactors the cinder manifests to make them more consistent with other manifests:  * removed default value for keystone_password * removed the prefix cinder_ from class parameters (it is redundant) * set package_ensure defaults to present * removed extra package_ensure parameter * changed $iscsi_enabled to $volume_driver (this change is being done in anticipation of needing additional volume drivers) * add test coverage * simple updates to .gitignore  It also delete the openstack::cinder class b/c I could not seem to declare ::cinder while it existed.  
__label__quality refactor of cinder manifests  This commit refactors the cinder manifests to make them more consistent with other manifests:  * removed default value for keystone_password * removed the prefix cinder_ from class parameters (it is redundant) * set package_ensure defaults to present * removed extra package_ensure parameter * changed $iscsi_enabled to $volume_driver (this change is being done in anticipation of needing additional volume drivers) * add test coverage * simple updates to .gitignore  It also delete the openstack::cinder class b/c I could not seem to declare ::cinder while it existed.  
__label__objective refactor of cinder manifests  This commit refactors the cinder manifests to make them more consistent with other manifests:  * removed default value for keystone_password * removed the prefix cinder_ from class parameters (it is redundant) * set package_ensure defaults to present * removed extra package_ensure parameter * changed $iscsi_enabled to $volume_driver (this change is being done in anticipation of needing additional volume drivers) * add test coverage * simple updates to .gitignore  It also delete the openstack::cinder class b/c I could not seem to declare ::cinder while it existed.  
__label__testing Refactored admin flavors test  * Removed original admin flavor test class * Added test_delete_flavor module * Fixed pep8 issues in existing code * Modified tests to use auto-generated ids  
__label__objective Refactored admin flavors test  * Removed original admin flavor test class * Added test_delete_flavor module * Fixed pep8 issues in existing code * Modified tests to use auto-generated ids  
__label__testing refactor: Hoist helpers.expect into package namespace  It's silly to have to import a package's submodule directly, since in this case that only introduces another module name that the developer has to keep track of, just to gain access to a solitary function. This patch hoists marconi.tests.util.helpers.expect into marocni.tests.util so that it can be referenced more naturally by the test author.  Accordingly, the Hacking.rst guide has been updated to allow this sort of thing (with some discretion).  Implements: blueprint grizzly-debt 
__label__quality refactor: Hoist helpers.expect into package namespace  It's silly to have to import a package's submodule directly, since in this case that only introduces another module name that the developer has to keep track of, just to gain access to a solitary function. This patch hoists marconi.tests.util.helpers.expect into marocni.tests.util so that it can be referenced more naturally by the test author.  Accordingly, the Hacking.rst guide has been updated to allow this sort of thing (with some discretion).  Implements: blueprint grizzly-debt 
__label__objective refactor: Hoist helpers.expect into package namespace  It's silly to have to import a package's submodule directly, since in this case that only introduces another module name that the developer has to keep track of, just to gain access to a solitary function. This patch hoists marconi.tests.util.helpers.expect into marocni.tests.util so that it can be referenced more naturally by the test author.  Accordingly, the Hacking.rst guide has been updated to allow this sort of thing (with some discretion).  Implements: blueprint grizzly-debt 
__label__testing This code refactors the openstack test script  This script was updated so that I could test swift as well as cherry-pick commits from openstack's gerrit git repo.  it adds conditionally logic for when the repo is swift (to build out the swift test env which includes a puppetmaster)  it also adds a test_mode=puppet_swift which runs the basic swift smoke tests.  it also adds code so that I can run the gerrit cherry-pick command to test patches from gerrit that are being reviewed.  
__label__quality This code refactors the openstack test script  This script was updated so that I could test swift as well as cherry-pick commits from openstack's gerrit git repo.  it adds conditionally logic for when the repo is swift (to build out the swift test env which includes a puppetmaster)  it also adds a test_mode=puppet_swift which runs the basic swift smoke tests.  it also adds code so that I can run the gerrit cherry-pick command to test patches from gerrit that are being reviewed.  
__label__objective This code refactors the openstack test script  This script was updated so that I could test swift as well as cherry-pick commits from openstack's gerrit git repo.  it adds conditionally logic for when the repo is swift (to build out the swift test env which includes a puppetmaster)  it also adds a test_mode=puppet_swift which runs the basic swift smoke tests.  it also adds code so that I can run the gerrit cherry-pick command to test patches from gerrit that are being reviewed.  
__label__testing Refactor DB tests  This is a big change but a necessary one. It moves all the database connection stuff, even for test purpose, in ceilometer.storage.impl_<backend> rather than redeclaring stuff inside the tests.db module. That means less code and the possibility to run the API test against various database backends for free.  
__label__quality Refactor DB tests  This is a big change but a necessary one. It moves all the database connection stuff, even for test purpose, in ceilometer.storage.impl_<backend> rather than redeclaring stuff inside the tests.db module. That means less code and the possibility to run the API test against various database backends for free.  
__label__objective Refactor DB tests  This is a big change but a necessary one. It moves all the database connection stuff, even for test purpose, in ceilometer.storage.impl_<backend> rather than redeclaring stuff inside the tests.db module. That means less code and the possibility to run the API test against various database backends for free.  
__label__integration Refactor DB tests  This is a big change but a necessary one. It moves all the database connection stuff, even for test purpose, in ceilometer.storage.impl_<backend> rather than redeclaring stuff inside the tests.db module. That means less code and the possibility to run the API test against various database backends for free.  
__label__testing Refactored client code and test to consume XML  
__label__objective Refactored client code and test to consume XML  
__label__testing Refactor data migration tests  This commit adds a more general framework for testing data transitions at any db migration. Based on the test migration framework in nova.  This commit also updates the 2 existing individual migration tests to use the new framework.  
__label__quality Refactor data migration tests  This commit adds a more general framework for testing data transitions at any db migration. Based on the test migration framework in nova.  This commit also updates the 2 existing individual migration tests to use the new framework.  
__label__objective Refactor data migration tests  This commit adds a more general framework for testing data transitions at any db migration. Based on the test migration framework in nova.  This commit also updates the 2 existing individual migration tests to use the new framework.  
__label__integration Refactor data migration tests  This commit adds a more general framework for testing data transitions at any db migration. Based on the test migration framework in nova.  This commit also updates the 2 existing individual migration tests to use the new framework.  
__label__testing Refactor loguserdata.py so it can be tested.  - Use distutils.version.LooseVersion for cloud-init version check - Fix bug 1100287 by setting the following modes:   - 0600 /var/log/heat-provision.log   - 0700 /var/lib/heat   - 0700 /var/lib/cloud/data/cfn-userdata (was 0111!) - Full test coverage except for where __name__ == '__main__' - File size has gone from 1218 bytes to 1636. If necessary we could reduce size in the future by using short names  This works for me when launching a template. At least if there are any regressions they can have a test written for the fix. 
__label__quality Refactor loguserdata.py so it can be tested.  - Use distutils.version.LooseVersion for cloud-init version check - Fix bug 1100287 by setting the following modes:   - 0600 /var/log/heat-provision.log   - 0700 /var/lib/heat   - 0700 /var/lib/cloud/data/cfn-userdata (was 0111!) - Full test coverage except for where __name__ == '__main__' - File size has gone from 1218 bytes to 1636. If necessary we could reduce size in the future by using short names  This works for me when launching a template. At least if there are any regressions they can have a test written for the fix. 
__label__objective Refactor loguserdata.py so it can be tested.  - Use distutils.version.LooseVersion for cloud-init version check - Fix bug 1100287 by setting the following modes:   - 0600 /var/log/heat-provision.log   - 0700 /var/lib/heat   - 0700 /var/lib/cloud/data/cfn-userdata (was 0111!) - Full test coverage except for where __name__ == '__main__' - File size has gone from 1218 bytes to 1636. If necessary we could reduce size in the future by using short names  This works for me when launching a template. At least if there are any regressions they can have a test written for the fix. 
__label__testing Refactor code for setting up libvirt disk mappings  Currently the libvirt disk bus is fixed at the time the driver is started. The get_guest_storage_config and _create_image methods thus use some variables initialized in the libvirt driver constructor to determine disk bus / dev name mappings.  It will shortly become possible to configure a different disk bus per instance, which invalidates the current assumptions in the code. A further complication is that the _create_image and get_guest_storage_config methods needs to duplicate each others logic for determining disk mapping.  To simplify the current code and make it more make flexible introduce a new get_guest_disk_mapping method. This method is responsible for examining the instance type and block device info dicts and figuring out the complete list of disks that will be attached to the guest & their optimal disk bus + dev name values. This info is returned in a dict and then passed to _create_image and get_guest_storage_config  Thus the logic for determining disk dev names is now isolated in one single place.  Many, many test cases are added to try to thoroughly validate the disk mapping code, since there are a huge set of possible configurations the user may request, making it easy to break the code accidentally.  Blueprint: libvirt-custom-hardware 
__label__quality Refactor code for setting up libvirt disk mappings  Currently the libvirt disk bus is fixed at the time the driver is started. The get_guest_storage_config and _create_image methods thus use some variables initialized in the libvirt driver constructor to determine disk bus / dev name mappings.  It will shortly become possible to configure a different disk bus per instance, which invalidates the current assumptions in the code. A further complication is that the _create_image and get_guest_storage_config methods needs to duplicate each others logic for determining disk mapping.  To simplify the current code and make it more make flexible introduce a new get_guest_disk_mapping method. This method is responsible for examining the instance type and block device info dicts and figuring out the complete list of disks that will be attached to the guest & their optimal disk bus + dev name values. This info is returned in a dict and then passed to _create_image and get_guest_storage_config  Thus the logic for determining disk dev names is now isolated in one single place.  Many, many test cases are added to try to thoroughly validate the disk mapping code, since there are a huge set of possible configurations the user may request, making it easy to break the code accidentally.  Blueprint: libvirt-custom-hardware 
__label__objective Refactor code for setting up libvirt disk mappings  Currently the libvirt disk bus is fixed at the time the driver is started. The get_guest_storage_config and _create_image methods thus use some variables initialized in the libvirt driver constructor to determine disk bus / dev name mappings.  It will shortly become possible to configure a different disk bus per instance, which invalidates the current assumptions in the code. A further complication is that the _create_image and get_guest_storage_config methods needs to duplicate each others logic for determining disk mapping.  To simplify the current code and make it more make flexible introduce a new get_guest_disk_mapping method. This method is responsible for examining the instance type and block device info dicts and figuring out the complete list of disks that will be attached to the guest & their optimal disk bus + dev name values. This info is returned in a dict and then passed to _create_image and get_guest_storage_config  Thus the logic for determining disk dev names is now isolated in one single place.  Many, many test cases are added to try to thoroughly validate the disk mapping code, since there are a huge set of possible configurations the user may request, making it easy to break the code accidentally.  Blueprint: libvirt-custom-hardware 
__label__testing Refactor compute image tests  Several test cases are combined to use a single server instance instead of creating dozens of servers.  Bug: #1010980  
__label__quality Refactor compute image tests  Several test cases are combined to use a single server instance instead of creating dozens of servers.  Bug: #1010980  
__label__objective Refactor compute image tests  Several test cases are combined to use a single server instance instead of creating dozens of servers.  Bug: #1010980  
__label__integration refactor: extract method: connect_volume  Related to blueprint xenapi-volume-drivers  Extract connect_volume call from attach_volume, and a test for attach_volume.  
__label__objective refactor: extract method: connect_volume  Related to blueprint xenapi-volume-drivers  Extract connect_volume call from attach_volume, and a test for attach_volume.  
__label__testing Refactor resource tracker claims and test logic.  In preparation for adding resize support to resource tracker:  * Claim class has been factored out of resource tracker. * Broke out claim testing logic for easier re-use  This patch is pre-work to ease adding resize claims to resource tracker:  bug 1065267  
__label__quality Refactor resource tracker claims and test logic.  In preparation for adding resize support to resource tracker:  * Claim class has been factored out of resource tracker. * Broke out claim testing logic for easier re-use  This patch is pre-work to ease adding resize claims to resource tracker:  bug 1065267  
__label__objective Refactor resource tracker claims and test logic.  In preparation for adding resize support to resource tracker:  * Claim class has been factored out of resource tracker. * Broke out claim testing logic for easier re-use  This patch is pre-work to ease adding resize claims to resource tracker:  bug 1065267  
__label__testing Refactor list servers negative test and fix remaining gate bugs  test_list_servers_negative had so many issues with it, it's hard to list them here... but at least the following has been fixed:  * No longer will the test flatly delete all instances the tenant   and alt tenant have during every test method run (!!) * Fixtures -- 2 active and 1 deleted server -- are created in the   class' setUpClass() method instead of having test methods   constantly re-launch instances -- this reduces the test time   down about 3 minutes * Removed all non-negative tests * Removed all tests that were skipped due to bugs that have been * Skip the XML create_service() test for Identity Admin tests   because of the upstream Keystone bug 1061738  This patch also includes patches for bug fixes that Sean Gallagher contributed but needed to be rebased into this one in order to get the full gate to pass.  
__label__objective Refactor list servers negative test and fix remaining gate bugs  test_list_servers_negative had so many issues with it, it's hard to list them here... but at least the following has been fixed:  * No longer will the test flatly delete all instances the tenant   and alt tenant have during every test method run (!!) * Fixtures -- 2 active and 1 deleted server -- are created in the   class' setUpClass() method instead of having test methods   constantly re-launch instances -- this reduces the test time   down about 3 minutes * Removed all non-negative tests * Removed all tests that were skipped due to bugs that have been * Skip the XML create_service() test for Identity Admin tests   because of the upstream Keystone bug 1061738  This patch also includes patches for bug fixes that Sean Gallagher contributed but needed to be rebased into this one in order to get the full gate to pass.  
__label__quality Refactor list servers negative test and fix remaining gate bugs  test_list_servers_negative had so many issues with it, it's hard to list them here... but at least the following has been fixed:  * No longer will the test flatly delete all instances the tenant   and alt tenant have during every test method run (!!) * Fixtures -- 2 active and 1 deleted server -- are created in the   class' setUpClass() method instead of having test methods   constantly re-launch instances -- this reduces the test time   down about 3 minutes * Removed all non-negative tests * Removed all tests that were skipped due to bugs that have been * Skip the XML create_service() test for Identity Admin tests   because of the upstream Keystone bug 1061738  This patch also includes patches for bug fixes that Sean Gallagher contributed but needed to be rebased into this one in order to get the full gate to pass.  
__label__objective Refactor list servers negative test and fix remaining gate bugs  test_list_servers_negative had so many issues with it, it's hard to list them here... but at least the following has been fixed:  * No longer will the test flatly delete all instances the tenant   and alt tenant have during every test method run (!!) * Fixtures -- 2 active and 1 deleted server -- are created in the   class' setUpClass() method instead of having test methods   constantly re-launch instances -- this reduces the test time   down about 3 minutes * Removed all non-negative tests * Removed all tests that were skipped due to bugs that have been * Skip the XML create_service() test for Identity Admin tests   because of the upstream Keystone bug 1061738  This patch also includes patches for bug fixes that Sean Gallagher contributed but needed to be rebased into this one in order to get the full gate to pass.  
__label__testing Refactor change queue.  Move most of the change queue logic into the model.  This should be a little cleaner, and it should be easier to follow what happens when a build is complete.  Run launch jobs over the whole queue. Collapse addChange into the base manager.  Makes reading the logic around adding a change simpler.  Several hooks are provided for the dependent manager subclass to extend the method around dependent changes.  Move onbuildcompleted and reporting methods to base class.  Simplifies the code path when a build is completed.  Move to a more generalized model where updates are applied to changes as received, then search for changes ready to be reported, then search for jobs that need to be launched.  Also,  * test check queue functionality  * assert all queues are empty at ends of tests  * move formatting methods to pipeline/queue classes  * add queue-only mode notification to status screen  
__label__quality Refactor change queue.  Move most of the change queue logic into the model.  This should be a little cleaner, and it should be easier to follow what happens when a build is complete.  Run launch jobs over the whole queue. Collapse addChange into the base manager.  Makes reading the logic around adding a change simpler.  Several hooks are provided for the dependent manager subclass to extend the method around dependent changes.  Move onbuildcompleted and reporting methods to base class.  Simplifies the code path when a build is completed.  Move to a more generalized model where updates are applied to changes as received, then search for changes ready to be reported, then search for jobs that need to be launched.  Also,  * test check queue functionality  * assert all queues are empty at ends of tests  * move formatting methods to pipeline/queue classes  * add queue-only mode notification to status screen  
__label__objective Refactor change queue.  Move most of the change queue logic into the model.  This should be a little cleaner, and it should be easier to follow what happens when a build is complete.  Run launch jobs over the whole queue. Collapse addChange into the base manager.  Makes reading the logic around adding a change simpler.  Several hooks are provided for the dependent manager subclass to extend the method around dependent changes.  Move onbuildcompleted and reporting methods to base class.  Simplifies the code path when a build is completed.  Move to a more generalized model where updates are applied to changes as received, then search for changes ready to be reported, then search for jobs that need to be launched.  Also,  * test check queue functionality  * assert all queues are empty at ends of tests  * move formatting methods to pipeline/queue classes  * add queue-only mode notification to status screen  
__label__testing Refactor ComputeCapabilitiesFilter test cases  With so much duplicated code in the test cases, it's really very difficult to figure out what each of the cases are testing. DRY the tests up to make them much more clear.  
__label__quality Refactor ComputeCapabilitiesFilter test cases  With so much duplicated code in the test cases, it's really very difficult to figure out what each of the cases are testing. DRY the tests up to make them much more clear.  
__label__objective Refactor ComputeCapabilitiesFilter test cases  With so much duplicated code in the test cases, it's really very difficult to figure out what each of the cases are testing. DRY the tests up to make them much more clear.  
__label__testing Refactor ComputeCapabilitiesFilter test cases  With so much duplicated code in the test cases, it's really very difficult to figure out what each of the cases are testing. DRY the tests up to make them much more clear.  
__label__quality Refactor ComputeCapabilitiesFilter test cases  With so much duplicated code in the test cases, it's really very difficult to figure out what each of the cases are testing. DRY the tests up to make them much more clear.  
__label__objective Refactor ComputeCapabilitiesFilter test cases  With so much duplicated code in the test cases, it's really very difficult to figure out what each of the cases are testing. DRY the tests up to make them much more clear.  
__label__testing Refactor HTTP-related exceptions  * Refactor helper function that builds the map of http status codes   to local http exceptions - now we don't have to explicitly list   every single exception name * Add several exceptions to represent http status codes that were not   previously represented * Improve consistency of exceptions naming by prepending 'HTTP' to   necessary exception names * Use HTTPException instead of ClientException * Deprecate old http exceptions (those that aren't prefixed with HTTP) * Deprecate ClientException * Deprecate unused NoTokenLookupException and EndpointNotFound * Add test module to spot-check the from_response helper  
__label__quality Refactor HTTP-related exceptions  * Refactor helper function that builds the map of http status codes   to local http exceptions - now we don't have to explicitly list   every single exception name * Add several exceptions to represent http status codes that were not   previously represented * Improve consistency of exceptions naming by prepending 'HTTP' to   necessary exception names * Use HTTPException instead of ClientException * Deprecate old http exceptions (those that aren't prefixed with HTTP) * Deprecate ClientException * Deprecate unused NoTokenLookupException and EndpointNotFound * Add test module to spot-check the from_response helper  
__label__objective Refactor HTTP-related exceptions  * Refactor helper function that builds the map of http status codes   to local http exceptions - now we don't have to explicitly list   every single exception name * Add several exceptions to represent http status codes that were not   previously represented * Improve consistency of exceptions naming by prepending 'HTTP' to   necessary exception names * Use HTTPException instead of ClientException * Deprecate old http exceptions (those that aren't prefixed with HTTP) * Deprecate ClientException * Deprecate unused NoTokenLookupException and EndpointNotFound * Add test module to spot-check the from_response helper  
__label__testing Refactor glance image service code  Fixes bug 1029397  This adds better retry support, making sure that if we need to retry requests to glance, we cycle through all hosts before potentially attemping the hosts that failed.  The old random selection could cause immediate retrying of the same host that failed.  This also adds logging of the host:port that failed and fixes a bug in the retry test, which didn't actually successfully test retrying.  Tests for new code added.  
__label__quality Refactor glance image service code  Fixes bug 1029397  This adds better retry support, making sure that if we need to retry requests to glance, we cycle through all hosts before potentially attemping the hosts that failed.  The old random selection could cause immediate retrying of the same host that failed.  This also adds logging of the host:port that failed and fixes a bug in the retry test, which didn't actually successfully test retrying.  Tests for new code added.  
__label__objective Refactor glance image service code  Fixes bug 1029397  This adds better retry support, making sure that if we need to retry requests to glance, we cycle through all hosts before potentially attemping the hosts that failed.  The old random selection could cause immediate retrying of the same host that failed.  This also adds logging of the host:port that failed and fixes a bug in the retry test, which didn't actually successfully test retrying.  Tests for new code added.  
__label__testing Refactor the test cases so that all the test cases are under one test class.  
__label__quality Refactor the test cases so that all the test cases are under one test class.  
__label__objective Refactor the test cases so that all the test cases are under one test class.  
__label__testing Refactor pagination db functional tests  The pagination-related functional tests are overly complex and aren't adding a lot of value. This rewrites them in a more straightforward way by incorporating them into the main test class.  Related to bp refactor-db-layer  
__label__quality Refactor pagination db functional tests  The pagination-related functional tests are overly complex and aren't adding a lot of value. This rewrites them in a more straightforward way by incorporating them into the main test class.  Related to bp refactor-db-layer  
__label__objective Refactor pagination db functional tests  The pagination-related functional tests are overly complex and aren't adding a lot of value. This rewrites them in a more straightforward way by incorporating them into the main test class.  Related to bp refactor-db-layer  
__label__integration Refactor pagination db functional tests  The pagination-related functional tests are overly complex and aren't adding a lot of value. This rewrites them in a more straightforward way by incorporating them into the main test class.  Related to bp refactor-db-layer  
__label__testing Refactor Tempest to be parallel-test friendly  * Allows a tenant/user to be created by the base test   class, allowing isolation of the tests * Moves identity admin stuff into appropriate directly * Puts _multiprocess_shared_ into base compute test class  
__label__objective Refactor Tempest to be parallel-test friendly  * Allows a tenant/user to be created by the base test   class, allowing isolation of the tests * Moves identity admin stuff into appropriate directly * Puts _multiprocess_shared_ into base compute test class  
__label__testing Refactor 404's into drivers (bug 968519)  The goal is to move the responsibility of reference checks away from controllers and into their underlying drivers, which can handle the task with equal or greater efficiency.  - Tenant references from create_user/update_user are NOT tested   due to inconsistencies between backends - Additional test coverage improvements  
__label__quality Refactor 404's into drivers (bug 968519)  The goal is to move the responsibility of reference checks away from controllers and into their underlying drivers, which can handle the task with equal or greater efficiency.  - Tenant references from create_user/update_user are NOT tested   due to inconsistencies between backends - Additional test coverage improvements  
__label__objective Refactor 404's into drivers (bug 968519)  The goal is to move the responsibility of reference checks away from controllers and into their underlying drivers, which can handle the task with equal or greater efficiency.  - Tenant references from create_user/update_user are NOT tested   due to inconsistencies between backends - Additional test coverage improvements  
__label__testing JavaScript Refactor.  Cleans up Horizon's JavaScript to make it properly modular and well-organized.  Adds unit tests written in QUnit for some of the JS modules as a starting point for the JS test framework. You can visit /qunit/ with DEBUG=True in your settings to access the JS test runner.  Fixes bug 961509.  
__label__quality JavaScript Refactor.  Cleans up Horizon's JavaScript to make it properly modular and well-organized.  Adds unit tests written in QUnit for some of the JS modules as a starting point for the JS test framework. You can visit /qunit/ with DEBUG=True in your settings to access the JS test runner.  Fixes bug 961509.  
__label__objective JavaScript Refactor.  Cleans up Horizon's JavaScript to make it properly modular and well-organized.  Adds unit tests written in QUnit for some of the JS modules as a starting point for the JS test framework. You can visit /qunit/ with DEBUG=True in your settings to access the JS test runner.  Fixes bug 961509.  
__label__testing Refactor configuration setup and document config  * Adds documentation to the sample config file/template * Adds some log output for making diagnosing config issues easier * Rework the authorization test config option names * Remove obselete release_name config options * Remove ssh_timeout unused option  
__label__quality Refactor configuration setup and document config  * Adds documentation to the sample config file/template * Adds some log output for making diagnosing config issues easier * Rework the authorization test config option names * Remove obselete release_name config options * Remove ssh_timeout unused option  
__label__objective Refactor configuration setup and document config  * Adds documentation to the sample config file/template * Adds some log output for making diagnosing config issues easier * Rework the authorization test config option names * Remove obselete release_name config options * Remove ssh_timeout unused option  
__label__testing Refactored test suite.    * Moves all tests to use a single set of central test data and     Adds a nifty manager for it.     Implements blueprint unified-test-data.    * Cleans up API code and API tests so that we're not testing     code that has no custom logic, or wrapping objects unnecessarily.     Implements blueprint api-simplification.    * Adds lots of docs on testing. It's a good step towards     blueprint improve-dev-documentation.    * Improves API exception handling for duplicate objects and containers.     Fixes bug 930816.  
__label__objective Refactored test suite.    * Moves all tests to use a single set of central test data and     Adds a nifty manager for it.     Implements blueprint unified-test-data.    * Cleans up API code and API tests so that we're not testing     code that has no custom logic, or wrapping objects unnecessarily.     Implements blueprint api-simplification.    * Adds lots of docs on testing. It's a good step towards     blueprint improve-dev-documentation.    * Improves API exception handling for duplicate objects and containers.     Fixes bug 930816.  
__label__quality Refactored test suite.    * Moves all tests to use a single set of central test data and     Adds a nifty manager for it.     Implements blueprint unified-test-data.    * Cleans up API code and API tests so that we're not testing     code that has no custom logic, or wrapping objects unnecessarily.     Implements blueprint api-simplification.    * Adds lots of docs on testing. It's a good step towards     blueprint improve-dev-documentation.    * Improves API exception handling for duplicate objects and containers.     Fixes bug 930816.  
__label__testing Refactor test_scheduler into unit tests  Also adds a service_is_up test for utils/service_is_up, which used to be in the scheduler.  
__label__objective Refactor test_scheduler into unit tests  Also adds a service_is_up test for utils/service_is_up, which used to be in the scheduler.  
__label__testing Refactor models and backends  Blueprints:   bp keystone-refactor-backend   bp refactor-keystone-models  This is a combination of 9 commits. Originals here: github.com/ziadsawalha/keystone/commits/models  Move token calls in service.py to managers.token - removed direct backend calls from service.py to token backend - implementing blueprint keystone-refactor-backend  Refactor: move tenant calls to managers.tenant - Not all calls removed yet  Implement models.Service in backends - Adding functionality needed to models.Role - Using models.Service in sqlalchemy.service - additional serialization changes and tests.  Implement models.service - remove logic.types.service:Service class  Implement user.manager - remove direct backend calls to api.USER from service.py  Remove user_get_update from backend API - No idea why that is there. It seems to be a   duplicate of plain get.  Backend updates - Document some user APIs - Update user.check_password to take user ID and password only - Implement more user.manager calls in service.py - remove user.delete_ternant_user call (probably existed when   we had the concept of users under tenants  Completed moving api.USER to user_manager in service.py - Completed remove of api.USER - Additional backend API documentation  Removed logic.types.service - Completed moving to models.Service(s) - Added basic test module for models.Services - pep8/pylint cleanup  
__label__quality Refactor models and backends  Blueprints:   bp keystone-refactor-backend   bp refactor-keystone-models  This is a combination of 9 commits. Originals here: github.com/ziadsawalha/keystone/commits/models  Move token calls in service.py to managers.token - removed direct backend calls from service.py to token backend - implementing blueprint keystone-refactor-backend  Refactor: move tenant calls to managers.tenant - Not all calls removed yet  Implement models.Service in backends - Adding functionality needed to models.Role - Using models.Service in sqlalchemy.service - additional serialization changes and tests.  Implement models.service - remove logic.types.service:Service class  Implement user.manager - remove direct backend calls to api.USER from service.py  Remove user_get_update from backend API - No idea why that is there. It seems to be a   duplicate of plain get.  Backend updates - Document some user APIs - Update user.check_password to take user ID and password only - Implement more user.manager calls in service.py - remove user.delete_ternant_user call (probably existed when   we had the concept of users under tenants  Completed moving api.USER to user_manager in service.py - Completed remove of api.USER - Additional backend API documentation  Removed logic.types.service - Completed moving to models.Service(s) - Added basic test module for models.Services - pep8/pylint cleanup  
__label__quality Refactor models and backends  Blueprints:   bp keystone-refactor-backend   bp refactor-keystone-models  This is a combination of 9 commits. Originals here: github.com/ziadsawalha/keystone/commits/models  Move token calls in service.py to managers.token - removed direct backend calls from service.py to token backend - implementing blueprint keystone-refactor-backend  Refactor: move tenant calls to managers.tenant - Not all calls removed yet  Implement models.Service in backends - Adding functionality needed to models.Role - Using models.Service in sqlalchemy.service - additional serialization changes and tests.  Implement models.service - remove logic.types.service:Service class  Implement user.manager - remove direct backend calls to api.USER from service.py  Remove user_get_update from backend API - No idea why that is there. It seems to be a   duplicate of plain get.  Backend updates - Document some user APIs - Update user.check_password to take user ID and password only - Implement more user.manager calls in service.py - remove user.delete_ternant_user call (probably existed when   we had the concept of users under tenants  Completed moving api.USER to user_manager in service.py - Completed remove of api.USER - Additional backend API documentation  Removed logic.types.service - Completed moving to models.Service(s) - Added basic test module for models.Services - pep8/pylint cleanup  
__label__objective Refactor models and backends  Blueprints:   bp keystone-refactor-backend   bp refactor-keystone-models  This is a combination of 9 commits. Originals here: github.com/ziadsawalha/keystone/commits/models  Move token calls in service.py to managers.token - removed direct backend calls from service.py to token backend - implementing blueprint keystone-refactor-backend  Refactor: move tenant calls to managers.tenant - Not all calls removed yet  Implement models.Service in backends - Adding functionality needed to models.Role - Using models.Service in sqlalchemy.service - additional serialization changes and tests.  Implement models.service - remove logic.types.service:Service class  Implement user.manager - remove direct backend calls to api.USER from service.py  Remove user_get_update from backend API - No idea why that is there. It seems to be a   duplicate of plain get.  Backend updates - Document some user APIs - Update user.check_password to take user ID and password only - Implement more user.manager calls in service.py - remove user.delete_ternant_user call (probably existed when   we had the concept of users under tenants  Completed moving api.USER to user_manager in service.py - Completed remove of api.USER - Additional backend API documentation  Removed logic.types.service - Completed moving to models.Service(s) - Added basic test module for models.Services - pep8/pylint cleanup  
__label__testing Remove test dependency on sampledata - added fixtures in FunctionalTestCase class - updated tests to use created fixtures - only kept boot-strap creations in KeystoneTestCase  This has significantly slowed down tests, but this will allow us to start refactoring tests to not go through HTTP and not require a running server (where not needed).  Tests don't use http  Update to Tenant serialization  - Correctly handle description as an optional attribute   of tenant - added tests that fail where blank description was coming   back as 'None' string. - added fixes to handle None correctly (check for None   before calling str(value)  Separated out test suites  - Unit, Functional, and Client (HTTP) suites can be run separately - -O flag in run_tests now accepts UnitTests and ClientTests as options - run_tests will run all suites (but end up executing less tests   overall since Unit tests run once and client tests run twice; for   HTTP and HTTPS/SSL tests  Fixed 'setup.py test' not running  
__label__quality Remove test dependency on sampledata - added fixtures in FunctionalTestCase class - updated tests to use created fixtures - only kept boot-strap creations in KeystoneTestCase  This has significantly slowed down tests, but this will allow us to start refactoring tests to not go through HTTP and not require a running server (where not needed).  Tests don't use http  Update to Tenant serialization  - Correctly handle description as an optional attribute   of tenant - added tests that fail where blank description was coming   back as 'None' string. - added fixes to handle None correctly (check for None   before calling str(value)  Separated out test suites  - Unit, Functional, and Client (HTTP) suites can be run separately - -O flag in run_tests now accepts UnitTests and ClientTests as options - run_tests will run all suites (but end up executing less tests   overall since Unit tests run once and client tests run twice; for   HTTP and HTTPS/SSL tests  Fixed 'setup.py test' not running  
__label__objective Remove test dependency on sampledata - added fixtures in FunctionalTestCase class - updated tests to use created fixtures - only kept boot-strap creations in KeystoneTestCase  This has significantly slowed down tests, but this will allow us to start refactoring tests to not go through HTTP and not require a running server (where not needed).  Tests don't use http  Update to Tenant serialization  - Correctly handle description as an optional attribute   of tenant - added tests that fail where blank description was coming   back as 'None' string. - added fixes to handle None correctly (check for None   before calling str(value)  Separated out test suites  - Unit, Functional, and Client (HTTP) suites can be run separately - -O flag in run_tests now accepts UnitTests and ClientTests as options - run_tests will run all suites (but end up executing less tests   overall since Unit tests run once and client tests run twice; for   HTTP and HTTPS/SSL tests  Fixed 'setup.py test' not running  
__label__testing Refactor: move initialization code to class  - Each script (keystone, keystone-admin, keystone-auth) had a copy   of the initialization code that handled options, arguments, and   starting the paste apps. The code was also duplicated in the   test SetUp code. This code has now been consolidated in one   class. - Created the keystone.Server class that has start/stop   methods to manage keystone servers. It also handles initializing   options and arguments. - This provides one point of entry into keystone where we can   now start refactoring logging and backend code.  
__label__quality Refactor: move initialization code to class  - Each script (keystone, keystone-admin, keystone-auth) had a copy   of the initialization code that handled options, arguments, and   starting the paste apps. The code was also duplicated in the   test SetUp code. This code has now been consolidated in one   class. - Created the keystone.Server class that has start/stop   methods to manage keystone servers. It also handles initializing   options and arguments. - This provides one point of entry into keystone where we can   now start refactoring logging and backend code.  
__label__objective Refactor: move initialization code to class  - Each script (keystone, keystone-admin, keystone-auth) had a copy   of the initialization code that handled options, arguments, and   starting the paste apps. The code was also duplicated in the   test SetUp code. This code has now been consolidated in one   class. - Created the keystone.Server class that has start/stop   methods to manage keystone servers. It also handles initializing   options and arguments. - This provides one point of entry into keystone where we can   now start refactoring logging and backend code.  
__label__testing Refactoring/cleanup of some view builders.  I have re-worked the "addresses", "flavors", "images", and "servers" view builders to share logic which was previously duplicated across many ViewBuilder classes. Also, I have re-worked the ViewBuilder class in general to persist longer (meaning that a new ViewBuilder is not created for every request but rather a single ViewBuilder is created and deals with each request as needed.)  During the re-factor I found an issue with test_servers.py where links were not containing the project_id like they should. This was fixed and tests were updated.  Overall we had good test coverage so not many tests had to be updated during the refactor.  
__label__quality Refactoring/cleanup of some view builders.  I have re-worked the "addresses", "flavors", "images", and "servers" view builders to share logic which was previously duplicated across many ViewBuilder classes. Also, I have re-worked the ViewBuilder class in general to persist longer (meaning that a new ViewBuilder is not created for every request but rather a single ViewBuilder is created and deals with each request as needed.)  During the re-factor I found an issue with test_servers.py where links were not containing the project_id like they should. This was fixed and tests were updated.  Overall we had good test coverage so not many tests had to be updated during the refactor.  
__label__objective Refactoring/cleanup of some view builders.  I have re-worked the "addresses", "flavors", "images", and "servers" view builders to share logic which was previously duplicated across many ViewBuilder classes. Also, I have re-worked the ViewBuilder class in general to persist longer (meaning that a new ViewBuilder is not created for every request but rather a single ViewBuilder is created and deals with each request as needed.)  During the re-factor I found an issue with test_servers.py where links were not containing the project_id like they should. This was fixed and tests were updated.  Overall we had good test coverage so not many tests had to be updated during the refactor.  
__label__testing More cache refactoring - Management Middleware  Fixes LP Bug#883236 - Cache management needs refactoring  Refactors cache management middleware by simplifying the middleware to image cache calls. The middleware now only contains calls for retrieving records of which images are cached, queueing an image to be cached, deleting a single cached image, and deleting all cached images. I removed the special calls for reaping invalid or stalled images, as that is handled by the cache cleaner utility...  Adds functional test case with caching and cache management middleware enabled.  Made a slight change to the way the functional test creates a config file: now it adds the configuration files used to start servers to $TEST_DIR/etc/$SERVER.conf so that test runner can see the config files that caused failures for tests.  TODO: Add test case for queue, then run prefetcher, then check image is cached... TODO: Add docs for cache management API TODO: Make bin/glance gracefully handle cache not existing  
__label__quality More cache refactoring - Management Middleware  Fixes LP Bug#883236 - Cache management needs refactoring  Refactors cache management middleware by simplifying the middleware to image cache calls. The middleware now only contains calls for retrieving records of which images are cached, queueing an image to be cached, deleting a single cached image, and deleting all cached images. I removed the special calls for reaping invalid or stalled images, as that is handled by the cache cleaner utility...  Adds functional test case with caching and cache management middleware enabled.  Made a slight change to the way the functional test creates a config file: now it adds the configuration files used to start servers to $TEST_DIR/etc/$SERVER.conf so that test runner can see the config files that caused failures for tests.  TODO: Add test case for queue, then run prefetcher, then check image is cached... TODO: Add docs for cache management API TODO: Make bin/glance gracefully handle cache not existing  
__label__objective More cache refactoring - Management Middleware  Fixes LP Bug#883236 - Cache management needs refactoring  Refactors cache management middleware by simplifying the middleware to image cache calls. The middleware now only contains calls for retrieving records of which images are cached, queueing an image to be cached, deleting a single cached image, and deleting all cached images. I removed the special calls for reaping invalid or stalled images, as that is handled by the cache cleaner utility...  Adds functional test case with caching and cache management middleware enabled.  Made a slight change to the way the functional test creates a config file: now it adds the configuration files used to start servers to $TEST_DIR/etc/$SERVER.conf so that test runner can see the config files that caused failures for tests.  TODO: Add test case for queue, then run prefetcher, then check image is cached... TODO: Add docs for cache management API TODO: Make bin/glance gracefully handle cache not existing  
__label__testing Refactor and unit test json auth parsing  There's a bunch of code copied-and-pasted between the json parsers in the two auth types. Refactor the code out into a base class.  First, though, unit test the code to ensure no regressions.  
__label__quality Refactor and unit test json auth parsing  There's a bunch of code copied-and-pasted between the json parsers in the two auth types. Refactor the code out into a base class.  First, though, unit test the code to ensure no regressions.  
__label__objective Refactor and unit test json auth parsing  There's a bunch of code copied-and-pasted between the json parsers in the two auth types. Refactor the code out into a base class.  First, though, unit test the code to ensure no regressions.  
__label__testing Refactor image upload command  In preparation for supporting deploys on a glance-less undercloud, this change refactors the upload command to move all glance interacting logic into a glance adapter class. This will allow the adapter abstraction to be used for an 'upload' adapter which only copies files on the local disk.  This change also does the following: - moves repeated update-or-upload logic to an adapter method, reducing   the complexity of take_action - cleans up the mock usage to consistently use the   patch decorator - the current approach may be causing unit test   failures in some environments - removes the GlanceV1 implementation, since the V1 API was removed in   Newton(!) this support is just a maintenance burden  
__label__quality Refactor image upload command  In preparation for supporting deploys on a glance-less undercloud, this change refactors the upload command to move all glance interacting logic into a glance adapter class. This will allow the adapter abstraction to be used for an 'upload' adapter which only copies files on the local disk.  This change also does the following: - moves repeated update-or-upload logic to an adapter method, reducing   the complexity of take_action - cleans up the mock usage to consistently use the   patch decorator - the current approach may be causing unit test   failures in some environments - removes the GlanceV1 implementation, since the V1 API was removed in   Newton(!) this support is just a maintenance burden  
__label__objective Refactor image upload command  In preparation for supporting deploys on a glance-less undercloud, this change refactors the upload command to move all glance interacting logic into a glance adapter class. This will allow the adapter abstraction to be used for an 'upload' adapter which only copies files on the local disk.  This change also does the following: - moves repeated update-or-upload logic to an adapter method, reducing   the complexity of take_action - cleans up the mock usage to consistently use the   patch decorator - the current approach may be causing unit test   failures in some environments - removes the GlanceV1 implementation, since the V1 API was removed in   Newton(!) this support is just a maintenance burden  
__label__testing Refactor branch protection test infrastructure  Branch protection rules are not just about required status so refactor it in the test framework so we can extend them in the future.  
__label__quality Refactor branch protection test infrastructure  Branch protection rules are not just about required status so refactor it in the test framework so we can extend them in the future.  
__label__objective Refactor branch protection test infrastructure  Branch protection rules are not just about required status so refactor it in the test framework so we can extend them in the future.  
__label__testing Refactor flag operations to be uniform  This also increases unit test coverage  
__label__objective Refactor flag operations to be uniform  This also increases unit test coverage  
__label__testing Refactor test_conditions functional test  Use the list_resources() method of the test base class.  
__label__quality Refactor test_conditions functional test  Use the list_resources() method of the test base class.  
__label__objective Refactor test_conditions functional test  Use the list_resources() method of the test base class.  
__label__testing Refactor image upload command  In preparation for supporting deploys on a glance-less undercloud, this change refactors the upload command to mqove all glance interacting logic into a glance adapter class. This will allow the adapter abstraction to be used for an 'upload' adapter which only copies files on the local disk.  This change also does the following: - moves repeated update-or-upload logic to an adapter method, reducing   the complexity of take_action - cleans up the mock usage to consistently use the   patch decorator - the current approach may be causing unit test   failures in some environments - removes the GlanceV1 implementation, since the V1 API was removed in   Newton(!) this support is just a maintenance burden  
__label__quality Refactor image upload command  In preparation for supporting deploys on a glance-less undercloud, this change refactors the upload command to mqove all glance interacting logic into a glance adapter class. This will allow the adapter abstraction to be used for an 'upload' adapter which only copies files on the local disk.  This change also does the following: - moves repeated update-or-upload logic to an adapter method, reducing   the complexity of take_action - cleans up the mock usage to consistently use the   patch decorator - the current approach may be causing unit test   failures in some environments - removes the GlanceV1 implementation, since the V1 API was removed in   Newton(!) this support is just a maintenance burden  
__label__objective Refactor image upload command  In preparation for supporting deploys on a glance-less undercloud, this change refactors the upload command to mqove all glance interacting logic into a glance adapter class. This will allow the adapter abstraction to be used for an 'upload' adapter which only copies files on the local disk.  This change also does the following: - moves repeated update-or-upload logic to an adapter method, reducing   the complexity of take_action - cleans up the mock usage to consistently use the   patch decorator - the current approach may be causing unit test   failures in some environments - removes the GlanceV1 implementation, since the V1 API was removed in   Newton(!) this support is just a maintenance burden  
__label__testing Refactor methods to be used by other tests  These methods are useful for a new snapshot test so moving them into manager to be reused.  
__label__quality Refactor methods to be used by other tests  These methods are useful for a new snapshot test so moving them into manager to be reused.  
__label__objective Refactor methods to be used by other tests  These methods are useful for a new snapshot test so moving them into manager to be reused.  
__label__testing Refactor basic integration jobs for Ansible versions  The latest supported version of Ansible (currently 2.9) is used in integration test jobs unless specified otherwise.  The basic integration test jobs ensure that we have coverage for all currently supported versions of Ansible as well as devel to let us know if there are any upcoming breaking changes.  
__label__integration Refactor basic integration jobs for Ansible versions  The latest supported version of Ansible (currently 2.9) is used in integration test jobs unless specified otherwise.  The basic integration test jobs ensure that we have coverage for all currently supported versions of Ansible as well as devel to let us know if there are any upcoming breaking changes.  
__label__objective Refactor basic integration jobs for Ansible versions  The latest supported version of Ansible (currently 2.9) is used in integration test jobs unless specified otherwise.  The basic integration test jobs ensure that we have coverage for all currently supported versions of Ansible as well as devel to let us know if there are any upcoming breaking changes.  
__label__integration Refactor basic integration jobs for Ansible versions  The latest supported version of Ansible (currently 2.9) is used in integration test jobs unless specified otherwise.  The basic integration test jobs ensure that we have coverage for all currently supported versions of Ansible as well as devel to let us know if there are any upcoming breaking changes.  
__label__testing Refactor and improve distributed sqlite integration test coverage  This removes the job "ansible-role-ara-api-fedora-distributed-sqlite" and replaces it by "ara-api-distributed-sqlite".  The job tests the support for the distributed sqlite database backend Fedora and Ubuntu simultaneously, allowing for the addition of CentOS8 in the future.  
__label__integration Refactor and improve distributed sqlite integration test coverage  This removes the job "ansible-role-ara-api-fedora-distributed-sqlite" and replaces it by "ara-api-distributed-sqlite".  The job tests the support for the distributed sqlite database backend Fedora and Ubuntu simultaneously, allowing for the addition of CentOS8 in the future.  
__label__objective Refactor and improve distributed sqlite integration test coverage  This removes the job "ansible-role-ara-api-fedora-distributed-sqlite" and replaces it by "ara-api-distributed-sqlite".  The job tests the support for the distributed sqlite database backend Fedora and Ubuntu simultaneously, allowing for the addition of CentOS8 in the future.  
__label__testing Refactor and improve PostgreSQL integration test coverage  This removes the job "ansible-role-ara-api-ubuntu-postgresql" and replaces it by "ara-api-postgresql".  The job is designed to have a single database server with multiple API servers on different Linux distributions in order to get test coverage for Ubuntu, Fedora and soon, CentOS8.  
__label__integration Refactor and improve PostgreSQL integration test coverage  This removes the job "ansible-role-ara-api-ubuntu-postgresql" and replaces it by "ara-api-postgresql".  The job is designed to have a single database server with multiple API servers on different Linux distributions in order to get test coverage for Ubuntu, Fedora and soon, CentOS8.  
__label__objective Refactor and improve PostgreSQL integration test coverage  This removes the job "ansible-role-ara-api-ubuntu-postgresql" and replaces it by "ara-api-postgresql".  The job is designed to have a single database server with multiple API servers on different Linux distributions in order to get test coverage for Ubuntu, Fedora and soon, CentOS8.  
__label__testing Refactor and improve MySQL integration test coverage  This removes the job "ansible-role-ara-api-ubuntu-mysql" and replaces it by "ara-api-mysql".  The job is designed to have a single database server with multiple API servers on different Linux distributions in order to get test coverage for Ubuntu, Fedora and soon, CentOS8.  
__label__integration Refactor and improve MySQL integration test coverage  This removes the job "ansible-role-ara-api-ubuntu-mysql" and replaces it by "ara-api-mysql".  The job is designed to have a single database server with multiple API servers on different Linux distributions in order to get test coverage for Ubuntu, Fedora and soon, CentOS8.  
__label__objective Refactor and improve MySQL integration test coverage  This removes the job "ansible-role-ara-api-ubuntu-mysql" and replaces it by "ara-api-mysql".  The job is designed to have a single database server with multiple API servers on different Linux distributions in order to get test coverage for Ubuntu, Fedora and soon, CentOS8.  
__label__testing Refactor of os_vif_util module.  Besides refactor itself, there was several issues resolved, like appropriate data handling - because macvlan driver is still using neutron client, we have to deal with dict data and openstacksdk objects at the same time in couple of helper methods in os_vif_util module.  Furthermore, helper method for creating port object for test purposes was moved to fake module, since it is also utilized in test for os vif utils.  
__label__quality Refactor of os_vif_util module.  Besides refactor itself, there was several issues resolved, like appropriate data handling - because macvlan driver is still using neutron client, we have to deal with dict data and openstacksdk objects at the same time in couple of helper methods in os_vif_util module.  Furthermore, helper method for creating port object for test purposes was moved to fake module, since it is also utilized in test for os vif utils.  
__label__objective Refactor of os_vif_util module.  Besides refactor itself, there was several issues resolved, like appropriate data handling - because macvlan driver is still using neutron client, we have to deal with dict data and openstacksdk objects at the same time in couple of helper methods in os_vif_util module.  Furthermore, helper method for creating port object for test purposes was moved to fake module, since it is also utilized in test for os vif utils.  
__label__testing Refactor unit test API example to use unit test mixins  The test_pv file is being used as a reference when writing new API unit tests, and has been refactored to use the mixin classes that other unit tests utilize.  This should allow other API configurations and permutations to be more easily testable.  
__label__quality Refactor unit test API example to use unit test mixins  The test_pv file is being used as a reference when writing new API unit tests, and has been refactored to use the mixin classes that other unit tests utilize.  This should allow other API configurations and permutations to be more easily testable.  
__label__objective Refactor unit test API example to use unit test mixins  The test_pv file is being used as a reference when writing new API unit tests, and has been refactored to use the mixin classes that other unit tests utilize.  This should allow other API configurations and permutations to be more easily testable.  
__label__integration Refactor unit test API example to use unit test mixins  The test_pv file is being used as a reference when writing new API unit tests, and has been refactored to use the mixin classes that other unit tests utilize.  This should allow other API configurations and permutations to be more easily testable.  
__label__testing Refactor unit tests for CLI usage  Prior to this change, CLI usage was hardcoded into the config opt fixture used for all tests. That CLI usage described two required positional arguments that were not actually part of the argument parser (FOO and BAR), but were instead just made up to have a valid-looking usage description.  The trouble is that you can't then extend that argument parser with additional real arguments, and then test the configuration of those arguments by inspecting the *real* usage and --help output from argparse. For example, a unit test could not assert whether argparse was configured correctly by oslo.config, because there's simply no way to know when the usage was just statically set to the arbitrary values of "FOO BAR."  This patch moves that specific unit test coverage (overriding usage with something arbitrary) into a dedicated unit test, while removing the arbitrary usage from all other unit tests. Instead, those unit tests now make assertions against the argparser's real configuration, hence options like --config-dir and --config-file now appear in those tests, because those options are included in every instance of cfg.ConfigOpts().  
__label__quality Refactor unit tests for CLI usage  Prior to this change, CLI usage was hardcoded into the config opt fixture used for all tests. That CLI usage described two required positional arguments that were not actually part of the argument parser (FOO and BAR), but were instead just made up to have a valid-looking usage description.  The trouble is that you can't then extend that argument parser with additional real arguments, and then test the configuration of those arguments by inspecting the *real* usage and --help output from argparse. For example, a unit test could not assert whether argparse was configured correctly by oslo.config, because there's simply no way to know when the usage was just statically set to the arbitrary values of "FOO BAR."  This patch moves that specific unit test coverage (overriding usage with something arbitrary) into a dedicated unit test, while removing the arbitrary usage from all other unit tests. Instead, those unit tests now make assertions against the argparser's real configuration, hence options like --config-dir and --config-file now appear in those tests, because those options are included in every instance of cfg.ConfigOpts().  
__label__objective Refactor unit tests for CLI usage  Prior to this change, CLI usage was hardcoded into the config opt fixture used for all tests. That CLI usage described two required positional arguments that were not actually part of the argument parser (FOO and BAR), but were instead just made up to have a valid-looking usage description.  The trouble is that you can't then extend that argument parser with additional real arguments, and then test the configuration of those arguments by inspecting the *real* usage and --help output from argparse. For example, a unit test could not assert whether argparse was configured correctly by oslo.config, because there's simply no way to know when the usage was just statically set to the arbitrary values of "FOO BAR."  This patch moves that specific unit test coverage (overriding usage with something arbitrary) into a dedicated unit test, while removing the arbitrary usage from all other unit tests. Instead, those unit tests now make assertions against the argparser's real configuration, hence options like --config-dir and --config-file now appear in those tests, because those options are included in every instance of cfg.ConfigOpts().  
__label__testing Refactor _gen_resource_inventory  This refactors _gen_resource_inventory as suggested in [1], simplifying by removing unused fields which duplicated defaults that are set by placement itself.  This patch introduces the previously absent test suite for conductor manager.  [1] I0aac84a1fc6b00b5523927bee27f7491daecd786  
__label__quality Refactor _gen_resource_inventory  This refactors _gen_resource_inventory as suggested in [1], simplifying by removing unused fields which duplicated defaults that are set by placement itself.  This patch introduces the previously absent test suite for conductor manager.  [1] I0aac84a1fc6b00b5523927bee27f7491daecd786  
__label__objective Refactor _gen_resource_inventory  This refactors _gen_resource_inventory as suggested in [1], simplifying by removing unused fields which duplicated defaults that are set by placement itself.  This patch introduces the previously absent test suite for conductor manager.  [1] I0aac84a1fc6b00b5523927bee27f7491daecd786  
__label__testing Refactor BMC provisioning in Maintenance  The current mechanism used to preserve the learned bmc protocol in the filesystem on the active controller is problematic over swact.  This update removes the file storage method in favor of preserving the learned protocol in the system inventory database as a key/value pair at the host level in already existing mtce_info database field.  The specified or learned bmc access protocol is then shared with the hardware monitor through inter-daemon maintenance messaging.  This update refactors bmc provisioning to accommodate bmc protocol selection at the host rather than system level. Towards that this update removes system level bmc_access_method selection in favor of host level selection through bm_type. A bm_type of 'bmc' specifies that the bmc access protocol for that host be learned. This has the effect of making it the same as what is delivered today but without support for changing it as the system level.  A system inventory update will be delivered shortly that enables bmc access protocol selection at the host level. That update allows the customer to specify the bmc access protocol at the host level to be either dynamic (aka learned) or to only use 'redfish' or 'ipmi'. That system inventory update delivers that information to maintenance through bm_type via bmc provisioning. Until that update is delivered bm_type always comes in as 'bmc' which get interpreted as 'dynamic' to maintain existing configuration.  The following additional issues were also fixed in this update.  1. The nodeTimers module defaults the 'ring' member of timers that are    not running to false but should be true.  2. Added a pingUtil_restart function to facilitate quicker sensor    monitoring following provisioning changes and bmc access failures.  3. Enhanced the hardware monitor sensor grouping filter to accommodate    non-standard Redfish readout labelling so that more sensors fall    into the existing canned groups ; leads to more monitored sensors.  4. Added a 'http security mode' to hardware monitor messaging. This    defaults to https as that is all that is supported by the Redfish    implementation today. This field can be used to specify non-secure    'http' mode in the future when that gets implemented.  5. Ensure the hardware monitor performs a bmc password re-fetch on every    provisioning change.  Test Plan:  PASS: Verify bmc access protocol store/fetched from the database (mtce_info) PASS: Verify inventory push from mtcAgent to hwmond over mtcAgent restart PASS: Verify inventory push from mtcAgent to hwmond over hwmon restart PASS: Verify bmc provisioning of ipmi and redfish servers PASS: Verify learned bmc protocol persists over process restart and swact PASS: Verify process startup with protocol already learned  Hardware Monitor:  PASS: Verify bmc_type=ipmi handling ; protocol forced to ipmi ; (re)prov PASS: Verify bmc_type=redfish handling ; protocol forced to redfish ; (re)prov PASS: Verify bmc_type=dynamic handling ; protocol is learned then persisted PASS: Verify sensor model delete and relearn over ip address change PASS: Verify sensor model delete and relearn over bm_type change change PASS: Verify sensor model not relearned username change PASS: Verify bm pw is re-fetched over any (re)provisioning change PASS: Verify bmc re-provisioning soak (test-bmc-reprovisioning.sh 50 loops) PASS: Verify protocol change handling, file cleanup, model recreation PASS: Verify End-2-End behavior for bm_type change from redfish to ipmi PASS: Verify End-2-End behavior for bm_type change from ipmi to redfish PASS: Verify End-2-End behavior for bm_type change from redfish to dynamic PASS: Verify End-2-End behavior for bm_type change from ipmi to dynamic PASS: Verify End-2-End behavior for bm_type change from dynamic to ipmi PASS: Verify End-2-End behavior for bm_type change from dynamic to redfish PASS: Verify sensor model creation waits for server power to be on PASS: Verify sensor relearn by provisioning change during model creation. (soak)  Regression:  PASS: Verify host power off and on. PASS: Verify BMC access alarm handling (assert and clear) PASS: Verify mtcAgent and hwmond logs add value PASS: Verify no core dumps / seg faults. PASS: Verify no mtcAgent and hwmond memory leak. PASS: Verify delete of BMC provisioned host PASS: Verify sensor monitoring, alarming, degrade and then clear cycle PASS: Verify static analysis report of changed modules. PASS: Verify host level bm_type=bmc functions as would dynamic selection PASS: Verify batch provisioning and deprovisioning (7 nodes) PASS: Verify batch provisioning to different protocol (5 nodes) PASS: Verify handling of flaky Redfish responses  PASS: Verify System Install  
__label__quality Refactor BMC provisioning in Maintenance  The current mechanism used to preserve the learned bmc protocol in the filesystem on the active controller is problematic over swact.  This update removes the file storage method in favor of preserving the learned protocol in the system inventory database as a key/value pair at the host level in already existing mtce_info database field.  The specified or learned bmc access protocol is then shared with the hardware monitor through inter-daemon maintenance messaging.  This update refactors bmc provisioning to accommodate bmc protocol selection at the host rather than system level. Towards that this update removes system level bmc_access_method selection in favor of host level selection through bm_type. A bm_type of 'bmc' specifies that the bmc access protocol for that host be learned. This has the effect of making it the same as what is delivered today but without support for changing it as the system level.  A system inventory update will be delivered shortly that enables bmc access protocol selection at the host level. That update allows the customer to specify the bmc access protocol at the host level to be either dynamic (aka learned) or to only use 'redfish' or 'ipmi'. That system inventory update delivers that information to maintenance through bm_type via bmc provisioning. Until that update is delivered bm_type always comes in as 'bmc' which get interpreted as 'dynamic' to maintain existing configuration.  The following additional issues were also fixed in this update.  1. The nodeTimers module defaults the 'ring' member of timers that are    not running to false but should be true.  2. Added a pingUtil_restart function to facilitate quicker sensor    monitoring following provisioning changes and bmc access failures.  3. Enhanced the hardware monitor sensor grouping filter to accommodate    non-standard Redfish readout labelling so that more sensors fall    into the existing canned groups ; leads to more monitored sensors.  4. Added a 'http security mode' to hardware monitor messaging. This    defaults to https as that is all that is supported by the Redfish    implementation today. This field can be used to specify non-secure    'http' mode in the future when that gets implemented.  5. Ensure the hardware monitor performs a bmc password re-fetch on every    provisioning change.  Test Plan:  PASS: Verify bmc access protocol store/fetched from the database (mtce_info) PASS: Verify inventory push from mtcAgent to hwmond over mtcAgent restart PASS: Verify inventory push from mtcAgent to hwmond over hwmon restart PASS: Verify bmc provisioning of ipmi and redfish servers PASS: Verify learned bmc protocol persists over process restart and swact PASS: Verify process startup with protocol already learned  Hardware Monitor:  PASS: Verify bmc_type=ipmi handling ; protocol forced to ipmi ; (re)prov PASS: Verify bmc_type=redfish handling ; protocol forced to redfish ; (re)prov PASS: Verify bmc_type=dynamic handling ; protocol is learned then persisted PASS: Verify sensor model delete and relearn over ip address change PASS: Verify sensor model delete and relearn over bm_type change change PASS: Verify sensor model not relearned username change PASS: Verify bm pw is re-fetched over any (re)provisioning change PASS: Verify bmc re-provisioning soak (test-bmc-reprovisioning.sh 50 loops) PASS: Verify protocol change handling, file cleanup, model recreation PASS: Verify End-2-End behavior for bm_type change from redfish to ipmi PASS: Verify End-2-End behavior for bm_type change from ipmi to redfish PASS: Verify End-2-End behavior for bm_type change from redfish to dynamic PASS: Verify End-2-End behavior for bm_type change from ipmi to dynamic PASS: Verify End-2-End behavior for bm_type change from dynamic to ipmi PASS: Verify End-2-End behavior for bm_type change from dynamic to redfish PASS: Verify sensor model creation waits for server power to be on PASS: Verify sensor relearn by provisioning change during model creation. (soak)  Regression:  PASS: Verify host power off and on. PASS: Verify BMC access alarm handling (assert and clear) PASS: Verify mtcAgent and hwmond logs add value PASS: Verify no core dumps / seg faults. PASS: Verify no mtcAgent and hwmond memory leak. PASS: Verify delete of BMC provisioned host PASS: Verify sensor monitoring, alarming, degrade and then clear cycle PASS: Verify static analysis report of changed modules. PASS: Verify host level bm_type=bmc functions as would dynamic selection PASS: Verify batch provisioning and deprovisioning (7 nodes) PASS: Verify batch provisioning to different protocol (5 nodes) PASS: Verify handling of flaky Redfish responses  PASS: Verify System Install  
__label__integration Refactor BMC provisioning in Maintenance  The current mechanism used to preserve the learned bmc protocol in the filesystem on the active controller is problematic over swact.  This update removes the file storage method in favor of preserving the learned protocol in the system inventory database as a key/value pair at the host level in already existing mtce_info database field.  The specified or learned bmc access protocol is then shared with the hardware monitor through inter-daemon maintenance messaging.  This update refactors bmc provisioning to accommodate bmc protocol selection at the host rather than system level. Towards that this update removes system level bmc_access_method selection in favor of host level selection through bm_type. A bm_type of 'bmc' specifies that the bmc access protocol for that host be learned. This has the effect of making it the same as what is delivered today but without support for changing it as the system level.  A system inventory update will be delivered shortly that enables bmc access protocol selection at the host level. That update allows the customer to specify the bmc access protocol at the host level to be either dynamic (aka learned) or to only use 'redfish' or 'ipmi'. That system inventory update delivers that information to maintenance through bm_type via bmc provisioning. Until that update is delivered bm_type always comes in as 'bmc' which get interpreted as 'dynamic' to maintain existing configuration.  The following additional issues were also fixed in this update.  1. The nodeTimers module defaults the 'ring' member of timers that are    not running to false but should be true.  2. Added a pingUtil_restart function to facilitate quicker sensor    monitoring following provisioning changes and bmc access failures.  3. Enhanced the hardware monitor sensor grouping filter to accommodate    non-standard Redfish readout labelling so that more sensors fall    into the existing canned groups ; leads to more monitored sensors.  4. Added a 'http security mode' to hardware monitor messaging. This    defaults to https as that is all that is supported by the Redfish    implementation today. This field can be used to specify non-secure    'http' mode in the future when that gets implemented.  5. Ensure the hardware monitor performs a bmc password re-fetch on every    provisioning change.  Test Plan:  PASS: Verify bmc access protocol store/fetched from the database (mtce_info) PASS: Verify inventory push from mtcAgent to hwmond over mtcAgent restart PASS: Verify inventory push from mtcAgent to hwmond over hwmon restart PASS: Verify bmc provisioning of ipmi and redfish servers PASS: Verify learned bmc protocol persists over process restart and swact PASS: Verify process startup with protocol already learned  Hardware Monitor:  PASS: Verify bmc_type=ipmi handling ; protocol forced to ipmi ; (re)prov PASS: Verify bmc_type=redfish handling ; protocol forced to redfish ; (re)prov PASS: Verify bmc_type=dynamic handling ; protocol is learned then persisted PASS: Verify sensor model delete and relearn over ip address change PASS: Verify sensor model delete and relearn over bm_type change change PASS: Verify sensor model not relearned username change PASS: Verify bm pw is re-fetched over any (re)provisioning change PASS: Verify bmc re-provisioning soak (test-bmc-reprovisioning.sh 50 loops) PASS: Verify protocol change handling, file cleanup, model recreation PASS: Verify End-2-End behavior for bm_type change from redfish to ipmi PASS: Verify End-2-End behavior for bm_type change from ipmi to redfish PASS: Verify End-2-End behavior for bm_type change from redfish to dynamic PASS: Verify End-2-End behavior for bm_type change from ipmi to dynamic PASS: Verify End-2-End behavior for bm_type change from dynamic to ipmi PASS: Verify End-2-End behavior for bm_type change from dynamic to redfish PASS: Verify sensor model creation waits for server power to be on PASS: Verify sensor relearn by provisioning change during model creation. (soak)  Regression:  PASS: Verify host power off and on. PASS: Verify BMC access alarm handling (assert and clear) PASS: Verify mtcAgent and hwmond logs add value PASS: Verify no core dumps / seg faults. PASS: Verify no mtcAgent and hwmond memory leak. PASS: Verify delete of BMC provisioned host PASS: Verify sensor monitoring, alarming, degrade and then clear cycle PASS: Verify static analysis report of changed modules. PASS: Verify host level bm_type=bmc functions as would dynamic selection PASS: Verify batch provisioning and deprovisioning (7 nodes) PASS: Verify batch provisioning to different protocol (5 nodes) PASS: Verify handling of flaky Redfish responses  PASS: Verify System Install  
__label__objective Refactor BMC provisioning in Maintenance  The current mechanism used to preserve the learned bmc protocol in the filesystem on the active controller is problematic over swact.  This update removes the file storage method in favor of preserving the learned protocol in the system inventory database as a key/value pair at the host level in already existing mtce_info database field.  The specified or learned bmc access protocol is then shared with the hardware monitor through inter-daemon maintenance messaging.  This update refactors bmc provisioning to accommodate bmc protocol selection at the host rather than system level. Towards that this update removes system level bmc_access_method selection in favor of host level selection through bm_type. A bm_type of 'bmc' specifies that the bmc access protocol for that host be learned. This has the effect of making it the same as what is delivered today but without support for changing it as the system level.  A system inventory update will be delivered shortly that enables bmc access protocol selection at the host level. That update allows the customer to specify the bmc access protocol at the host level to be either dynamic (aka learned) or to only use 'redfish' or 'ipmi'. That system inventory update delivers that information to maintenance through bm_type via bmc provisioning. Until that update is delivered bm_type always comes in as 'bmc' which get interpreted as 'dynamic' to maintain existing configuration.  The following additional issues were also fixed in this update.  1. The nodeTimers module defaults the 'ring' member of timers that are    not running to false but should be true.  2. Added a pingUtil_restart function to facilitate quicker sensor    monitoring following provisioning changes and bmc access failures.  3. Enhanced the hardware monitor sensor grouping filter to accommodate    non-standard Redfish readout labelling so that more sensors fall    into the existing canned groups ; leads to more monitored sensors.  4. Added a 'http security mode' to hardware monitor messaging. This    defaults to https as that is all that is supported by the Redfish    implementation today. This field can be used to specify non-secure    'http' mode in the future when that gets implemented.  5. Ensure the hardware monitor performs a bmc password re-fetch on every    provisioning change.  Test Plan:  PASS: Verify bmc access protocol store/fetched from the database (mtce_info) PASS: Verify inventory push from mtcAgent to hwmond over mtcAgent restart PASS: Verify inventory push from mtcAgent to hwmond over hwmon restart PASS: Verify bmc provisioning of ipmi and redfish servers PASS: Verify learned bmc protocol persists over process restart and swact PASS: Verify process startup with protocol already learned  Hardware Monitor:  PASS: Verify bmc_type=ipmi handling ; protocol forced to ipmi ; (re)prov PASS: Verify bmc_type=redfish handling ; protocol forced to redfish ; (re)prov PASS: Verify bmc_type=dynamic handling ; protocol is learned then persisted PASS: Verify sensor model delete and relearn over ip address change PASS: Verify sensor model delete and relearn over bm_type change change PASS: Verify sensor model not relearned username change PASS: Verify bm pw is re-fetched over any (re)provisioning change PASS: Verify bmc re-provisioning soak (test-bmc-reprovisioning.sh 50 loops) PASS: Verify protocol change handling, file cleanup, model recreation PASS: Verify End-2-End behavior for bm_type change from redfish to ipmi PASS: Verify End-2-End behavior for bm_type change from ipmi to redfish PASS: Verify End-2-End behavior for bm_type change from redfish to dynamic PASS: Verify End-2-End behavior for bm_type change from ipmi to dynamic PASS: Verify End-2-End behavior for bm_type change from dynamic to ipmi PASS: Verify End-2-End behavior for bm_type change from dynamic to redfish PASS: Verify sensor model creation waits for server power to be on PASS: Verify sensor relearn by provisioning change during model creation. (soak)  Regression:  PASS: Verify host power off and on. PASS: Verify BMC access alarm handling (assert and clear) PASS: Verify mtcAgent and hwmond logs add value PASS: Verify no core dumps / seg faults. PASS: Verify no mtcAgent and hwmond memory leak. PASS: Verify delete of BMC provisioned host PASS: Verify sensor monitoring, alarming, degrade and then clear cycle PASS: Verify static analysis report of changed modules. PASS: Verify host level bm_type=bmc functions as would dynamic selection PASS: Verify batch provisioning and deprovisioning (7 nodes) PASS: Verify batch provisioning to different protocol (5 nodes) PASS: Verify handling of flaky Redfish responses  PASS: Verify System Install  
__label__testing Refactor BMC provisioning in Maintenance  The current mechanism used to preserve the learned bmc protocol in the filesystem on the active controller is problematic over swact.  This update removes the file storage method in favor of preserving the learned protocol in the system inventory database as a key/value pair at the host level in already existing mtce_info database field.  The specified or learned bmc access protocol is then shared with the hardware monitor through inter-daemon maintenance messaging.  This update refactors bmc provisioning to accommodate bmc protocol selection at the host rather than system level. Towards that this update removes system level bmc_access_method selection in favor of host level selection through bm_type. A bm_type of 'bmc' specifies that the bmc access protocol for that host be learned. This has the effect of making it the same as what is delivered today but without support for changing it as the system level.  A system inventory update will be delivered shortly that enables bmc access protocol selection at the host level. That update allows the customer to specify the bmc access protocol at the host level to be either dynamic (aka learned) or to only use 'redfish' or 'ipmi'. That system inventory update delivers that information to maintenance through bm_type via bmc provisioning. Until that update is delivered bm_type always comes in as 'bmc' which get interpreted as 'dynamic' to maintain existing configuration.  The following additional issues were also fixed in this update.  1. The nodeTimers module defaults the 'ring' member of timers that are    not running to false but should be true.  2. Added a pingUtil_restart function to facilitate quicker sensor    monitoring following provisioning changes and bmc access failures.  3. Enhanced the hardware monitor sensor grouping filter to accommodate    non-standard Redfish readout labelling so that more sensors fall    into the existing canned groups ; leads to more monitored sensors.  4. Added a 'http security mode' to hardware monitor messaging. This    defaults to https as that is all that is supported by the Redfish    implementation today. This field can be used to specify non-secure    'http' mode in the future when that gets implemented.  5. Ensure the hardware monitor performs a bmc password re-fetch on every    provisioning change.  Test Plan:  PASS: Verify bmc access protocol store/fetched from the database (mtce_info) PASS: Verify inventory push from mtcAgent to hwmond over mtcAgent restart PASS: Verify inventory push from mtcAgent to hwmond over hwmon restart PASS: Verify bmc provisioning of ipmi and redfish servers PASS: Verify learned bmc protocol persists over process restart and swact PASS: Verify process startup with protocol already learned  Hardware Monitor:  PASS: Verify bmc_type=ipmi handling ; protocol forced to ipmi ; (re)prov PASS: Verify bmc_type=redfish handling ; protocol forced to redfish ; (re)prov PASS: Verify bmc_type=dynamic handling ; protocol is learned then persisted PASS: Verify sensor model delete and relearn over ip address change PASS: Verify sensor model delete and relearn over bm_type change change PASS: Verify sensor model not relearned username change PASS: Verify bm pw is re-fetched over any (re)provisioning change PASS: Verify bmc re-provisioning soak (test-bmc-reprovisioning.sh 50 loops) PASS: Verify protocol change handling, file cleanup, model recreation PASS: Verify End-2-End behavior for bm_type change from redfish to ipmi PASS: Verify End-2-End behavior for bm_type change from ipmi to redfish PASS: Verify End-2-End behavior for bm_type change from redfish to dynamic PASS: Verify End-2-End behavior for bm_type change from ipmi to dynamic PASS: Verify End-2-End behavior for bm_type change from dynamic to ipmi PASS: Verify End-2-End behavior for bm_type change from dynamic to redfish PASS: Verify sensor model creation waits for server power to be on PASS: Verify sensor relearn by provisioning change during model creation. (soak)  Regression:  PASS: Verify host power off and on. PASS: Verify BMC access alarm handling (assert and clear) PASS: Verify mtcAgent and hwmond logs add value PASS: Verify no core dumps / seg faults. PASS: Verify no mtcAgent and hwmond memory leak. PASS: Verify delete of BMC provisioned host PASS: Verify sensor monitoring, alarming, degrade and then clear cycle PASS: Verify static analysis report of changed modules. PASS: Verify host level bm_type=bmc functions as would dynamic selection PASS: Verify batch provisioning and deprovisioning (7 nodes) PASS: Verify batch provisioning to different protocol (5 nodes) PASS: Verify handling of flaky Redfish responses  PEND: Verify System Install  
__label__quality Refactor BMC provisioning in Maintenance  The current mechanism used to preserve the learned bmc protocol in the filesystem on the active controller is problematic over swact.  This update removes the file storage method in favor of preserving the learned protocol in the system inventory database as a key/value pair at the host level in already existing mtce_info database field.  The specified or learned bmc access protocol is then shared with the hardware monitor through inter-daemon maintenance messaging.  This update refactors bmc provisioning to accommodate bmc protocol selection at the host rather than system level. Towards that this update removes system level bmc_access_method selection in favor of host level selection through bm_type. A bm_type of 'bmc' specifies that the bmc access protocol for that host be learned. This has the effect of making it the same as what is delivered today but without support for changing it as the system level.  A system inventory update will be delivered shortly that enables bmc access protocol selection at the host level. That update allows the customer to specify the bmc access protocol at the host level to be either dynamic (aka learned) or to only use 'redfish' or 'ipmi'. That system inventory update delivers that information to maintenance through bm_type via bmc provisioning. Until that update is delivered bm_type always comes in as 'bmc' which get interpreted as 'dynamic' to maintain existing configuration.  The following additional issues were also fixed in this update.  1. The nodeTimers module defaults the 'ring' member of timers that are    not running to false but should be true.  2. Added a pingUtil_restart function to facilitate quicker sensor    monitoring following provisioning changes and bmc access failures.  3. Enhanced the hardware monitor sensor grouping filter to accommodate    non-standard Redfish readout labelling so that more sensors fall    into the existing canned groups ; leads to more monitored sensors.  4. Added a 'http security mode' to hardware monitor messaging. This    defaults to https as that is all that is supported by the Redfish    implementation today. This field can be used to specify non-secure    'http' mode in the future when that gets implemented.  5. Ensure the hardware monitor performs a bmc password re-fetch on every    provisioning change.  Test Plan:  PASS: Verify bmc access protocol store/fetched from the database (mtce_info) PASS: Verify inventory push from mtcAgent to hwmond over mtcAgent restart PASS: Verify inventory push from mtcAgent to hwmond over hwmon restart PASS: Verify bmc provisioning of ipmi and redfish servers PASS: Verify learned bmc protocol persists over process restart and swact PASS: Verify process startup with protocol already learned  Hardware Monitor:  PASS: Verify bmc_type=ipmi handling ; protocol forced to ipmi ; (re)prov PASS: Verify bmc_type=redfish handling ; protocol forced to redfish ; (re)prov PASS: Verify bmc_type=dynamic handling ; protocol is learned then persisted PASS: Verify sensor model delete and relearn over ip address change PASS: Verify sensor model delete and relearn over bm_type change change PASS: Verify sensor model not relearned username change PASS: Verify bm pw is re-fetched over any (re)provisioning change PASS: Verify bmc re-provisioning soak (test-bmc-reprovisioning.sh 50 loops) PASS: Verify protocol change handling, file cleanup, model recreation PASS: Verify End-2-End behavior for bm_type change from redfish to ipmi PASS: Verify End-2-End behavior for bm_type change from ipmi to redfish PASS: Verify End-2-End behavior for bm_type change from redfish to dynamic PASS: Verify End-2-End behavior for bm_type change from ipmi to dynamic PASS: Verify End-2-End behavior for bm_type change from dynamic to ipmi PASS: Verify End-2-End behavior for bm_type change from dynamic to redfish PASS: Verify sensor model creation waits for server power to be on PASS: Verify sensor relearn by provisioning change during model creation. (soak)  Regression:  PASS: Verify host power off and on. PASS: Verify BMC access alarm handling (assert and clear) PASS: Verify mtcAgent and hwmond logs add value PASS: Verify no core dumps / seg faults. PASS: Verify no mtcAgent and hwmond memory leak. PASS: Verify delete of BMC provisioned host PASS: Verify sensor monitoring, alarming, degrade and then clear cycle PASS: Verify static analysis report of changed modules. PASS: Verify host level bm_type=bmc functions as would dynamic selection PASS: Verify batch provisioning and deprovisioning (7 nodes) PASS: Verify batch provisioning to different protocol (5 nodes) PASS: Verify handling of flaky Redfish responses  PEND: Verify System Install  
__label__integration Refactor BMC provisioning in Maintenance  The current mechanism used to preserve the learned bmc protocol in the filesystem on the active controller is problematic over swact.  This update removes the file storage method in favor of preserving the learned protocol in the system inventory database as a key/value pair at the host level in already existing mtce_info database field.  The specified or learned bmc access protocol is then shared with the hardware monitor through inter-daemon maintenance messaging.  This update refactors bmc provisioning to accommodate bmc protocol selection at the host rather than system level. Towards that this update removes system level bmc_access_method selection in favor of host level selection through bm_type. A bm_type of 'bmc' specifies that the bmc access protocol for that host be learned. This has the effect of making it the same as what is delivered today but without support for changing it as the system level.  A system inventory update will be delivered shortly that enables bmc access protocol selection at the host level. That update allows the customer to specify the bmc access protocol at the host level to be either dynamic (aka learned) or to only use 'redfish' or 'ipmi'. That system inventory update delivers that information to maintenance through bm_type via bmc provisioning. Until that update is delivered bm_type always comes in as 'bmc' which get interpreted as 'dynamic' to maintain existing configuration.  The following additional issues were also fixed in this update.  1. The nodeTimers module defaults the 'ring' member of timers that are    not running to false but should be true.  2. Added a pingUtil_restart function to facilitate quicker sensor    monitoring following provisioning changes and bmc access failures.  3. Enhanced the hardware monitor sensor grouping filter to accommodate    non-standard Redfish readout labelling so that more sensors fall    into the existing canned groups ; leads to more monitored sensors.  4. Added a 'http security mode' to hardware monitor messaging. This    defaults to https as that is all that is supported by the Redfish    implementation today. This field can be used to specify non-secure    'http' mode in the future when that gets implemented.  5. Ensure the hardware monitor performs a bmc password re-fetch on every    provisioning change.  Test Plan:  PASS: Verify bmc access protocol store/fetched from the database (mtce_info) PASS: Verify inventory push from mtcAgent to hwmond over mtcAgent restart PASS: Verify inventory push from mtcAgent to hwmond over hwmon restart PASS: Verify bmc provisioning of ipmi and redfish servers PASS: Verify learned bmc protocol persists over process restart and swact PASS: Verify process startup with protocol already learned  Hardware Monitor:  PASS: Verify bmc_type=ipmi handling ; protocol forced to ipmi ; (re)prov PASS: Verify bmc_type=redfish handling ; protocol forced to redfish ; (re)prov PASS: Verify bmc_type=dynamic handling ; protocol is learned then persisted PASS: Verify sensor model delete and relearn over ip address change PASS: Verify sensor model delete and relearn over bm_type change change PASS: Verify sensor model not relearned username change PASS: Verify bm pw is re-fetched over any (re)provisioning change PASS: Verify bmc re-provisioning soak (test-bmc-reprovisioning.sh 50 loops) PASS: Verify protocol change handling, file cleanup, model recreation PASS: Verify End-2-End behavior for bm_type change from redfish to ipmi PASS: Verify End-2-End behavior for bm_type change from ipmi to redfish PASS: Verify End-2-End behavior for bm_type change from redfish to dynamic PASS: Verify End-2-End behavior for bm_type change from ipmi to dynamic PASS: Verify End-2-End behavior for bm_type change from dynamic to ipmi PASS: Verify End-2-End behavior for bm_type change from dynamic to redfish PASS: Verify sensor model creation waits for server power to be on PASS: Verify sensor relearn by provisioning change during model creation. (soak)  Regression:  PASS: Verify host power off and on. PASS: Verify BMC access alarm handling (assert and clear) PASS: Verify mtcAgent and hwmond logs add value PASS: Verify no core dumps / seg faults. PASS: Verify no mtcAgent and hwmond memory leak. PASS: Verify delete of BMC provisioned host PASS: Verify sensor monitoring, alarming, degrade and then clear cycle PASS: Verify static analysis report of changed modules. PASS: Verify host level bm_type=bmc functions as would dynamic selection PASS: Verify batch provisioning and deprovisioning (7 nodes) PASS: Verify batch provisioning to different protocol (5 nodes) PASS: Verify handling of flaky Redfish responses  PEND: Verify System Install  
__label__objective Refactor BMC provisioning in Maintenance  The current mechanism used to preserve the learned bmc protocol in the filesystem on the active controller is problematic over swact.  This update removes the file storage method in favor of preserving the learned protocol in the system inventory database as a key/value pair at the host level in already existing mtce_info database field.  The specified or learned bmc access protocol is then shared with the hardware monitor through inter-daemon maintenance messaging.  This update refactors bmc provisioning to accommodate bmc protocol selection at the host rather than system level. Towards that this update removes system level bmc_access_method selection in favor of host level selection through bm_type. A bm_type of 'bmc' specifies that the bmc access protocol for that host be learned. This has the effect of making it the same as what is delivered today but without support for changing it as the system level.  A system inventory update will be delivered shortly that enables bmc access protocol selection at the host level. That update allows the customer to specify the bmc access protocol at the host level to be either dynamic (aka learned) or to only use 'redfish' or 'ipmi'. That system inventory update delivers that information to maintenance through bm_type via bmc provisioning. Until that update is delivered bm_type always comes in as 'bmc' which get interpreted as 'dynamic' to maintain existing configuration.  The following additional issues were also fixed in this update.  1. The nodeTimers module defaults the 'ring' member of timers that are    not running to false but should be true.  2. Added a pingUtil_restart function to facilitate quicker sensor    monitoring following provisioning changes and bmc access failures.  3. Enhanced the hardware monitor sensor grouping filter to accommodate    non-standard Redfish readout labelling so that more sensors fall    into the existing canned groups ; leads to more monitored sensors.  4. Added a 'http security mode' to hardware monitor messaging. This    defaults to https as that is all that is supported by the Redfish    implementation today. This field can be used to specify non-secure    'http' mode in the future when that gets implemented.  5. Ensure the hardware monitor performs a bmc password re-fetch on every    provisioning change.  Test Plan:  PASS: Verify bmc access protocol store/fetched from the database (mtce_info) PASS: Verify inventory push from mtcAgent to hwmond over mtcAgent restart PASS: Verify inventory push from mtcAgent to hwmond over hwmon restart PASS: Verify bmc provisioning of ipmi and redfish servers PASS: Verify learned bmc protocol persists over process restart and swact PASS: Verify process startup with protocol already learned  Hardware Monitor:  PASS: Verify bmc_type=ipmi handling ; protocol forced to ipmi ; (re)prov PASS: Verify bmc_type=redfish handling ; protocol forced to redfish ; (re)prov PASS: Verify bmc_type=dynamic handling ; protocol is learned then persisted PASS: Verify sensor model delete and relearn over ip address change PASS: Verify sensor model delete and relearn over bm_type change change PASS: Verify sensor model not relearned username change PASS: Verify bm pw is re-fetched over any (re)provisioning change PASS: Verify bmc re-provisioning soak (test-bmc-reprovisioning.sh 50 loops) PASS: Verify protocol change handling, file cleanup, model recreation PASS: Verify End-2-End behavior for bm_type change from redfish to ipmi PASS: Verify End-2-End behavior for bm_type change from ipmi to redfish PASS: Verify End-2-End behavior for bm_type change from redfish to dynamic PASS: Verify End-2-End behavior for bm_type change from ipmi to dynamic PASS: Verify End-2-End behavior for bm_type change from dynamic to ipmi PASS: Verify End-2-End behavior for bm_type change from dynamic to redfish PASS: Verify sensor model creation waits for server power to be on PASS: Verify sensor relearn by provisioning change during model creation. (soak)  Regression:  PASS: Verify host power off and on. PASS: Verify BMC access alarm handling (assert and clear) PASS: Verify mtcAgent and hwmond logs add value PASS: Verify no core dumps / seg faults. PASS: Verify no mtcAgent and hwmond memory leak. PASS: Verify delete of BMC provisioned host PASS: Verify sensor monitoring, alarming, degrade and then clear cycle PASS: Verify static analysis report of changed modules. PASS: Verify host level bm_type=bmc functions as would dynamic selection PASS: Verify batch provisioning and deprovisioning (7 nodes) PASS: Verify batch provisioning to different protocol (5 nodes) PASS: Verify handling of flaky Redfish responses  PEND: Verify System Install  
__label__testing Refactor volume connection cleanup out of _post_live_migration  The _post_live_migration method is huge and hard to review/test/ maintain in isolation so we need to break down the complexity. To that end this change refactors the source host volume connection cleanup code into another method which also allows us to simplify a couple of unit tests that target that specific set of code. The error handling in that new method is tested by the functional test class LiveMigrationCinderFailure.  
__label__quality Refactor volume connection cleanup out of _post_live_migration  The _post_live_migration method is huge and hard to review/test/ maintain in isolation so we need to break down the complexity. To that end this change refactors the source host volume connection cleanup code into another method which also allows us to simplify a couple of unit tests that target that specific set of code. The error handling in that new method is tested by the functional test class LiveMigrationCinderFailure.  
__label__objective Refactor volume connection cleanup out of _post_live_migration  The _post_live_migration method is huge and hard to review/test/ maintain in isolation so we need to break down the complexity. To that end this change refactors the source host volume connection cleanup code into another method which also allows us to simplify a couple of unit tests that target that specific set of code. The error handling in that new method is tested by the functional test class LiveMigrationCinderFailure.  
__label__testing [WIP] Refactor Host API unit test  The host API unit tests are refactored to use the BaseHostTestCase class.  Story: 2004515 Task: tbd  
__label__objective [WIP] Refactor Host API unit test  The host API unit tests are refactored to use the BaseHostTestCase class.  Story: 2004515 Task: tbd  
__label__quality [WIP] Refactor Host API unit test  The host API unit tests are refactored to use the BaseHostTestCase class.  Story: 2004515 Task: tbd  
__label__testing Refactor and update test-kitchen suites  This provides a large collection of updates and refactoring to improve the development environment for the cookbooks using test-kitchen.  The primary change this provides is the addition of the 'minimal' suite which replicates what the integration test jobs run in Zuul. This is useful for testing and debugging issues that might be found during CI jobs.  - Switch run_list to using roles to better match how the zuul jobs work - Update to using Ubuntu 18.04 instead of 16.04 - Move all attributes from .kitchen.yml files to environments - Update multi-node and dokken test-kitchen - Use MariaDB 10.1 by default as 10.0 has been deprecated upstream for   ubuntu 18.04. Also use OSUOSL mirror as it's more stable than   upstream - Don't disable EPEL on RHEL systems - Synchronize attributes (within reason) between test-kitchen files - Update roles run_list - Create openstack_test cookbook and update /etc/apt/sources.list to   OSUOSL mirrors to improve stability on Ubuntu  
__label__quality Refactor and update test-kitchen suites  This provides a large collection of updates and refactoring to improve the development environment for the cookbooks using test-kitchen.  The primary change this provides is the addition of the 'minimal' suite which replicates what the integration test jobs run in Zuul. This is useful for testing and debugging issues that might be found during CI jobs.  - Switch run_list to using roles to better match how the zuul jobs work - Update to using Ubuntu 18.04 instead of 16.04 - Move all attributes from .kitchen.yml files to environments - Update multi-node and dokken test-kitchen - Use MariaDB 10.1 by default as 10.0 has been deprecated upstream for   ubuntu 18.04. Also use OSUOSL mirror as it's more stable than   upstream - Don't disable EPEL on RHEL systems - Synchronize attributes (within reason) between test-kitchen files - Update roles run_list - Create openstack_test cookbook and update /etc/apt/sources.list to   OSUOSL mirrors to improve stability on Ubuntu  
__label__objective Refactor and update test-kitchen suites  This provides a large collection of updates and refactoring to improve the development environment for the cookbooks using test-kitchen.  The primary change this provides is the addition of the 'minimal' suite which replicates what the integration test jobs run in Zuul. This is useful for testing and debugging issues that might be found during CI jobs.  - Switch run_list to using roles to better match how the zuul jobs work - Update to using Ubuntu 18.04 instead of 16.04 - Move all attributes from .kitchen.yml files to environments - Update multi-node and dokken test-kitchen - Use MariaDB 10.1 by default as 10.0 has been deprecated upstream for   ubuntu 18.04. Also use OSUOSL mirror as it's more stable than   upstream - Don't disable EPEL on RHEL systems - Synchronize attributes (within reason) between test-kitchen files - Update roles run_list - Create openstack_test cookbook and update /etc/apt/sources.list to   OSUOSL mirrors to improve stability on Ubuntu  
__label__integration Refactors tools/initrunonce  Previously runonce suffered from the following limitations:  1. Could only be run once. 2. Had hardcoded parameters.  This patch adds idempotentcy, allowing the tool to be safely run more than once. Additionally, config options have been parameterized providing flexibility for different dev environments.  Existing defaults have been persevered for backwards compatibility.  
__label__objective Refactors tools/initrunonce  Previously runonce suffered from the following limitations:  1. Could only be run once. 2. Had hardcoded parameters.  This patch adds idempotentcy, allowing the tool to be safely run more than once. Additionally, config options have been parameterized providing flexibility for different dev environments.  Existing defaults have been persevered for backwards compatibility.  
__label__integration VMWare: session management refactor - tools  introduce session diagnostic methods to Vim object. Start the process of eliminating the need for the VMwareAPISession object by folding tese functions back into the Vim object and authoring them to use the vSphere API as intended without wrappers.  
__label__integration VMWare: session management refactor - tools  introduce session diagnostic methods to Vim object. Start the process of eliminating the need for the VMwareAPISession object by folding tese functions back into the Vim object and authoring them to use the vSphere API as intended without wrappers.  
__label__objective VMWare: session management refactor - tools  introduce session diagnostic methods to Vim object. Start the process of eliminating the need for the VMwareAPISession object by folding tese functions back into the Vim object and authoring them to use the vSphere API as intended without wrappers.  
__label__integration DB toolkit refactoring  Code that controls db related toolkit (creating orm sessions and engines) has been refactored. This change was made with purpose of simplifiying and unifying of mentioned logic so that it can be reused by several processes withoud beind compromised by dependency on pecan.conf attribute.  
__label__quality DB toolkit refactoring  Code that controls db related toolkit (creating orm sessions and engines) has been refactored. This change was made with purpose of simplifiying and unifying of mentioned logic so that it can be reused by several processes withoud beind compromised by dependency on pecan.conf attribute.  
__label__integration DB toolkit refactoring  Code that controls db related toolkit (creating orm sessions and engines) has been refactored. This change was made with purpose of simplifiying and unifying of mentioned logic so that it can be reused by several processes withoud beind compromised by dependency on pecan.conf attribute.  
__label__objective DB toolkit refactoring  Code that controls db related toolkit (creating orm sessions and engines) has been refactored. This change was made with purpose of simplifiying and unifying of mentioned logic so that it can be reused by several processes withoud beind compromised by dependency on pecan.conf attribute.  
__label__integration WIP: Create base tools for refactoring configuration class  Create a base class to be eredited by a new configuration class to be used in a Pythonic way:      from collectd_ceilometer import attribute      class Configuration(attribute.HasAttributes):          VERBOSE = attribute.Boolean(False)  Configuration parsing could then be sued like this:       configuration = Configuration()      assert configuration.VERBOSE is False      configuration.VERBOSE = 1      assert configuration.VERBOSE is True  
__label__quality WIP: Create base tools for refactoring configuration class  Create a base class to be eredited by a new configuration class to be used in a Pythonic way:      from collectd_ceilometer import attribute      class Configuration(attribute.HasAttributes):          VERBOSE = attribute.Boolean(False)  Configuration parsing could then be sued like this:       configuration = Configuration()      assert configuration.VERBOSE is False      configuration.VERBOSE = 1      assert configuration.VERBOSE is True  
__label__objective WIP: Create base tools for refactoring configuration class  Create a base class to be eredited by a new configuration class to be used in a Pythonic way:      from collectd_ceilometer import attribute      class Configuration(attribute.HasAttributes):          VERBOSE = attribute.Boolean(False)  Configuration parsing could then be sued like this:       configuration = Configuration()      assert configuration.VERBOSE is False      configuration.VERBOSE = 1      assert configuration.VERBOSE is True  
__label__integration Helm-Toolkit: Simplify and refactor endpoint functions  This PS refactors the endpoint functions to reduce code repetition and improve readability.  
__label__quality Helm-Toolkit: Simplify and refactor endpoint functions  This PS refactors the endpoint functions to reduce code repetition and improve readability.  
__label__objective Helm-Toolkit: Simplify and refactor endpoint functions  This PS refactors the endpoint functions to reduce code repetition and improve readability.  
__label__integration Add #softwarefactory IRC channel to eavesdrop.o.o  We'd like to take advantage of the IRC logging that is managed by openstack-infra. #softwarefactory is a project that packages openstack-infra tooling:    https://softwarefactory-project.io/docs/  
__label__objective Add #softwarefactory IRC channel to eavesdrop.o.o  We'd like to take advantage of the IRC logging that is managed by openstack-infra. #softwarefactory is a project that packages openstack-infra tooling:    https://softwarefactory-project.io/docs/  
__label__objective Add #softwarefactory IRC channel to eavesdrop.o.o  We'd like to take advantage of the IRC logging that is managed by openstack-infra. #softwarefactory is a project that packages openstack-infra tooling:    https://softwarefactory-project.io/docs/  
__label__integration [WIP]Scrubber refactor  glance-scrubber is a pending-delete image clean tool for admin, so actually there is no need for authentication at all.  This patch removed the related registry logic and let glance-scrubber visit db directly.  
__label__objective [WIP]Scrubber refactor  glance-scrubber is a pending-delete image clean tool for admin, so actually there is no need for authentication at all.  This patch removed the related registry logic and let glance-scrubber visit db directly.  
__label__integration WIP: Refactor iSCSI connect  This patch refactors iSCSI connect code changing the approach to one that relies primarily on sysfs, instead of CLI tools, to retrieve all the required information: devices from the connection, multipath system device name, multipath name, the WWN for the block devices...  By doing so, not only do we fix a good number of bugs, but we also improve the reliability and speed of the mechanism.  A good example of improvements and benefits achieved by this patch are:  - Clean all leftovers on exceptions on a connection.  - Parallelize logins on multipath to increase speed on flaky network   connections.  - As long as there is at least one good path when working with multipath   we will return a multipath device instead of a single path device,   which helps with temporary flaky connections.  - Don't use the rescan retry parameter as log in retry on multipath   connections so both single and multipath cases are consistent.  - We no longer rely on just one device to get the wwn and look for the   multipath.  This would be problematic with flaky connections.  - No more querying iSCSI devices for their WWN (page 0x83) removing   delays and issue on flaky connections.  - It's no longer a problem for the mechanism the fact that a device   exists but is not accessible.  - We no longer use symlinks from `/dev/disk/by-path`, `/dev/disk/by-id`,   or `/dev/mapper` to find devices or multipaths, as they could be   leftovers from previous runs.  - We no longer need to rely on the WWN to determine the multipath, we   have the session and the LUN, so we trace the devices and from those   we get if they belong to a multipath.  - Stop polluting the logs with unnecessary exceptions from checking if   the node or session exist.  - Action retries will now only log the final exception instead of   logging all the exceptions.  - Warn when a multipath could not be formed and a single device is being   used, as performance will be degraded.  - We no longer do global rescans on single connections that could be   bringing in unrelated and unwanted devices (`iscsiadm -T iqn -p portal   --rescan`).  - Fix scan mechanism that would not request all scans when the same iqn   was shareed between portals and could send a scan request to the wrong   IP if they shared the same iqn.  - When doing single pathed connections we could end with a multipath   because we didn't clean up unfruitful connections.  It's worth mentioning that this patch does not touch the extend operation.  
__label__objective WIP: Refactor iSCSI connect  This patch refactors iSCSI connect code changing the approach to one that relies primarily on sysfs, instead of CLI tools, to retrieve all the required information: devices from the connection, multipath system device name, multipath name, the WWN for the block devices...  By doing so, not only do we fix a good number of bugs, but we also improve the reliability and speed of the mechanism.  A good example of improvements and benefits achieved by this patch are:  - Clean all leftovers on exceptions on a connection.  - Parallelize logins on multipath to increase speed on flaky network   connections.  - As long as there is at least one good path when working with multipath   we will return a multipath device instead of a single path device,   which helps with temporary flaky connections.  - Don't use the rescan retry parameter as log in retry on multipath   connections so both single and multipath cases are consistent.  - We no longer rely on just one device to get the wwn and look for the   multipath.  This would be problematic with flaky connections.  - No more querying iSCSI devices for their WWN (page 0x83) removing   delays and issue on flaky connections.  - It's no longer a problem for the mechanism the fact that a device   exists but is not accessible.  - We no longer use symlinks from `/dev/disk/by-path`, `/dev/disk/by-id`,   or `/dev/mapper` to find devices or multipaths, as they could be   leftovers from previous runs.  - We no longer need to rely on the WWN to determine the multipath, we   have the session and the LUN, so we trace the devices and from those   we get if they belong to a multipath.  - Stop polluting the logs with unnecessary exceptions from checking if   the node or session exist.  - Action retries will now only log the final exception instead of   logging all the exceptions.  - Warn when a multipath could not be formed and a single device is being   used, as performance will be degraded.  - We no longer do global rescans on single connections that could be   bringing in unrelated and unwanted devices (`iscsiadm -T iqn -p portal   --rescan`).  - Fix scan mechanism that would not request all scans when the same iqn   was shareed between portals and could send a scan request to the wrong   IP if they shared the same iqn.  - When doing single pathed connections we could end with a multipath   because we didn't clean up unfruitful connections.  It's worth mentioning that this patch does not touch the extend operation.  
__label__quality WIP: Refactor iSCSI connect  This patch refactors iSCSI connect code changing the approach to one that relies primarily on sysfs, instead of CLI tools, to retrieve all the required information: devices from the connection, multipath system device name, multipath name, the WWN for the block devices...  By doing so, not only do we fix a good number of bugs, but we also improve the reliability and speed of the mechanism.  A good example of improvements and benefits achieved by this patch are:  - Clean all leftovers on exceptions on a connection.  - Parallelize logins on multipath to increase speed on flaky network   connections.  - As long as there is at least one good path when working with multipath   we will return a multipath device instead of a single path device,   which helps with temporary flaky connections.  - Don't use the rescan retry parameter as log in retry on multipath   connections so both single and multipath cases are consistent.  - We no longer rely on just one device to get the wwn and look for the   multipath.  This would be problematic with flaky connections.  - No more querying iSCSI devices for their WWN (page 0x83) removing   delays and issue on flaky connections.  - It's no longer a problem for the mechanism the fact that a device   exists but is not accessible.  - We no longer use symlinks from `/dev/disk/by-path`, `/dev/disk/by-id`,   or `/dev/mapper` to find devices or multipaths, as they could be   leftovers from previous runs.  - We no longer need to rely on the WWN to determine the multipath, we   have the session and the LUN, so we trace the devices and from those   we get if they belong to a multipath.  - Stop polluting the logs with unnecessary exceptions from checking if   the node or session exist.  - Action retries will now only log the final exception instead of   logging all the exceptions.  - Warn when a multipath could not be formed and a single device is being   used, as performance will be degraded.  - We no longer do global rescans on single connections that could be   bringing in unrelated and unwanted devices (`iscsiadm -T iqn -p portal   --rescan`).  - Fix scan mechanism that would not request all scans when the same iqn   was shareed between portals and could send a scan request to the wrong   IP if they shared the same iqn.  - When doing single pathed connections we could end with a multipath   because we didn't clean up unfruitful connections.  It's worth mentioning that this patch does not touch the extend operation.  
__label__objective WIP: Refactor iSCSI connect  This patch refactors iSCSI connect code changing the approach to one that relies primarily on sysfs, instead of CLI tools, to retrieve all the required information: devices from the connection, multipath system device name, multipath name, the WWN for the block devices...  By doing so, not only do we fix a good number of bugs, but we also improve the reliability and speed of the mechanism.  A good example of improvements and benefits achieved by this patch are:  - Clean all leftovers on exceptions on a connection.  - Parallelize logins on multipath to increase speed on flaky network   connections.  - As long as there is at least one good path when working with multipath   we will return a multipath device instead of a single path device,   which helps with temporary flaky connections.  - Don't use the rescan retry parameter as log in retry on multipath   connections so both single and multipath cases are consistent.  - We no longer rely on just one device to get the wwn and look for the   multipath.  This would be problematic with flaky connections.  - No more querying iSCSI devices for their WWN (page 0x83) removing   delays and issue on flaky connections.  - It's no longer a problem for the mechanism the fact that a device   exists but is not accessible.  - We no longer use symlinks from `/dev/disk/by-path`, `/dev/disk/by-id`,   or `/dev/mapper` to find devices or multipaths, as they could be   leftovers from previous runs.  - We no longer need to rely on the WWN to determine the multipath, we   have the session and the LUN, so we trace the devices and from those   we get if they belong to a multipath.  - Stop polluting the logs with unnecessary exceptions from checking if   the node or session exist.  - Action retries will now only log the final exception instead of   logging all the exceptions.  - Warn when a multipath could not be formed and a single device is being   used, as performance will be degraded.  - We no longer do global rescans on single connections that could be   bringing in unrelated and unwanted devices (`iscsiadm -T iqn -p portal   --rescan`).  - Fix scan mechanism that would not request all scans when the same iqn   was shareed between portals and could send a scan request to the wrong   IP if they shared the same iqn.  - When doing single pathed connections we could end with a multipath   because we didn't clean up unfruitful connections.  It's worth mentioning that this patch does not touch the extend operation.  
__label__quality Refactor and enable shell access  When installing from binary, packaging tools create a user for Keystone which does not have a shell.  This results in fernet token operations failing due to the fact that `rsync` cannot connect over SSH because the Keystone user cannot login.  This patch addresses this issue by enabling shell access to the Keystone user, it also refactors the Nova SSH controller to use the pre-existing macro.  
__label__objective Refactor and enable shell access  When installing from binary, packaging tools create a user for Keystone which does not have a shell.  This results in fernet token operations failing due to the fact that `rsync` cannot connect over SSH because the Keystone user cannot login.  This patch addresses this issue by enabling shell access to the Keystone user, it also refactors the Nova SSH controller to use the pre-existing macro.  
__label__objective Refactor and enable shell access  When installing from binary, packaging tools create a user for Keystone which does not have a shell.  This results in fernet token operations failing due to the fact that `rsync` cannot connect over SSH because the Keystone user cannot login.  This patch addresses this issue by enabling shell access to the Keystone user, it also refactors the Nova SSH controller to use the pre-existing macro.  
__label__quality Refactor and enable shell access  When installing from binary, packaging tools create a user for Keystone which does not have a shell.  This results in fernet token operations failing due to the fact that `rsync` cannot connect over SSH because the Keystone user cannot login.  This patch addresses this issue by enabling shell access to the Keystone user, it also refactors the Nova SSH controller to use the pre-existing macro.  
__label__objective Refactor and enable shell access  When installing from binary, packaging tools create a user for Keystone which does not have a shell.  This results in fernet token operations failing due to the fact that `rsync` cannot connect over SSH because the Keystone user cannot login.  This patch addresses this issue by enabling shell access to the Keystone user, it also refactors the Nova SSH controller to use the pre-existing macro.  
__label__objective Refactor and enable shell access  When installing from binary, packaging tools create a user for Keystone which does not have a shell.  This results in fernet token operations failing due to the fact that `rsync` cannot connect over SSH because the Keystone user cannot login.  This patch addresses this issue by enabling shell access to the Keystone user, it also refactors the Nova SSH controller to use the pre-existing macro.  
__label__integration Refactor: abstract status setting for instance to utils  instance's status and power_state setting is in many place,  it could be abstracted to utils as a tool function.  
__label__quality Refactor: abstract status setting for instance to utils  instance's status and power_state setting is in many place,  it could be abstracted to utils as a tool function.  
__label__objective Refactor: abstract status setting for instance to utils  instance's status and power_state setting is in many place,  it could be abstracted to utils as a tool function.  
__label__integration Refactor: move fsm initiation to utils  Since we use fsm in many place, so the initation of it could be moved to utils as a tool function.  
__label__quality Refactor: move fsm initiation to utils  Since we use fsm in many place, so the initation of it could be moved to utils as a tool function.  
__label__objective Refactor: move fsm initiation to utils  Since we use fsm in many place, so the initation of it could be moved to utils as a tool function.  
__label__integration Refactor OVNMacAddressNetwork  Move the OVNMacAddressNetwork resource out of the Networks resource. This is a special network that we want to create internally.  Having this network nested in the Networks resource interfer with the work related to creating composable networks with non-heat tooling.  
__label__objective Refactor OVNMacAddressNetwork  Move the OVNMacAddressNetwork resource out of the Networks resource. This is a special network that we want to create internally.  Having this network nested in the Networks resource interfer with the work related to creating composable networks with non-heat tooling.  
__label__integration Refactor inventory generation load/save filesystem  Segmenting the storage-related operations from the rest of the inventory generation management tooling, in support of better maintainability testability and future support for alternate storage options.  Operations in manage.py are slightly updated to make use of common code.  
__label__quality Refactor inventory generation load/save filesystem  Segmenting the storage-related operations from the rest of the inventory generation management tooling, in support of better maintainability testability and future support for alternate storage options.  Operations in manage.py are slightly updated to make use of common code.  
__label__testing Refactor inventory generation load/save filesystem  Segmenting the storage-related operations from the rest of the inventory generation management tooling, in support of better maintainability testability and future support for alternate storage options.  Operations in manage.py are slightly updated to make use of common code.  
__label__objective Refactor inventory generation load/save filesystem  Segmenting the storage-related operations from the rest of the inventory generation management tooling, in support of better maintainability testability and future support for alternate storage options.  Operations in manage.py are slightly updated to make use of common code.  
__label__integration Refactor inventory management filesystem  Segmenting the storage-related operations from the rest of the inventory management tooling, in support of better maintainability testability and future support for alternate storage options.  
__label__quality Refactor inventory management filesystem  Segmenting the storage-related operations from the rest of the inventory management tooling, in support of better maintainability testability and future support for alternate storage options.  
__label__testing Refactor inventory management filesystem  Segmenting the storage-related operations from the rest of the inventory management tooling, in support of better maintainability testability and future support for alternate storage options.  
__label__objective Refactor inventory management filesystem  Segmenting the storage-related operations from the rest of the inventory management tooling, in support of better maintainability testability and future support for alternate storage options.  
__label__integration Refactor CommandSuccess/Failure class with functool.partial  We don't need to define each class for success/failure, but can use functool.partial to create an alias for them.  TrivialFix  
__label__objective Refactor CommandSuccess/Failure class with functool.partial  We don't need to define each class for success/failure, but can use functool.partial to create an alias for them.  TrivialFix  
__label__quality Refactor common checks when instantiating the ipmitool classes  The constructor for the ipmitool classes are the same but they are duplicated all over this patch is refactoring that code into a common function that can be called from the classes constructors.  The VendorPassthru class wasn't checking for the 'timing' option support of the ipmitool command, it should, this patch is fixing that too.  
__label__objective Refactor common checks when instantiating the ipmitool classes  The constructor for the ipmitool classes are the same but they are duplicated all over this patch is refactoring that code into a common function that can be called from the classes constructors.  The VendorPassthru class wasn't checking for the 'timing' option support of the ipmitool command, it should, this patch is fixing that too.  
__label__integration WIP: Refactor tools for functests  
__label__refactoring WIP: Refactor tools for functests  
__label__testing WIP: Refactor tools for functests  
__label__integration Refactor run-playbooks  This changes the run playbooks script so that its using our core CLI tools and is no longer a special case script running bits outside of simply running the deployment tools as they've been designed.  The script is still executing all of the playbooks using the "scripts-library" function ``install_bits`` so that we ensure gate success by having a retry on a playbook execution in the case of transient failure.  A notice has been added to the script whenever it exists notifying the deployer that they should now work out of the playbooks directory and never execute the run-playbooks.sh script ever again. Within the notice links to our documentation have been added.  
__label__quality Refactor run-playbooks  This changes the run playbooks script so that its using our core CLI tools and is no longer a special case script running bits outside of simply running the deployment tools as they've been designed.  The script is still executing all of the playbooks using the "scripts-library" function ``install_bits`` so that we ensure gate success by having a retry on a playbook execution in the case of transient failure.  A notice has been added to the script whenever it exists notifying the deployer that they should now work out of the playbooks directory and never execute the run-playbooks.sh script ever again. Within the notice links to our documentation have been added.  
__label__testing Refactor run-playbooks  This changes the run playbooks script so that its using our core CLI tools and is no longer a special case script running bits outside of simply running the deployment tools as they've been designed.  The script is still executing all of the playbooks using the "scripts-library" function ``install_bits`` so that we ensure gate success by having a retry on a playbook execution in the case of transient failure.  A notice has been added to the script whenever it exists notifying the deployer that they should now work out of the playbooks directory and never execute the run-playbooks.sh script ever again. Within the notice links to our documentation have been added.  
__label__objective Refactor run-playbooks  This changes the run playbooks script so that its using our core CLI tools and is no longer a special case script running bits outside of simply running the deployment tools as they've been designed.  The script is still executing all of the playbooks using the "scripts-library" function ``install_bits`` so that we ensure gate success by having a retry on a playbook execution in the case of transient failure.  A notice has been added to the script whenever it exists notifying the deployer that they should now work out of the playbooks directory and never execute the run-playbooks.sh script ever again. Within the notice links to our documentation have been added.  
__label__integration Refactor osnailyfacter/modular/tools  Refactor osnailyfacter/modular/tools to be compatible with Puppet Master  Blueprint: fuel-refactor-osnailyfacter-for-puppet-master-compatibility  
__label__objective Refactor osnailyfacter/modular/tools  Refactor osnailyfacter/modular/tools to be compatible with Puppet Master  Blueprint: fuel-refactor-osnailyfacter-for-puppet-master-compatibility  
__label__testing Code refactor for generating integer in testcase  This will remove the need of import random in unit/objects/test_base.py as its already done in tests/tools.py and some of the functions are called from there.  
__label__quality Code refactor for generating integer in testcase  This will remove the need of import random in unit/objects/test_base.py as its already done in tests/tools.py and some of the functions are called from there.  
__label__objective Code refactor for generating integer in testcase  This will remove the need of import random in unit/objects/test_base.py as its already done in tests/tools.py and some of the functions are called from there.  
__label__testing Significant refactor of base image  This refactor organizes the code as follows:  If RPM family:     execute YUM repo setup     if binary         install binary tools     if source         install source tools  IF yum family:    install source tools  I have tested building and everything seems fairly solid except possilby RHOS.  The long term goal of this patch is to allow us to add our own repos in the "execute YUM repo setup" section of the base file based upon OpenStack Infrastructure YUM repos.  
__label__quality Significant refactor of base image  This refactor organizes the code as follows:  If RPM family:     execute YUM repo setup     if binary         install binary tools     if source         install source tools  IF yum family:    install source tools  I have tested building and everything seems fairly solid except possilby RHOS.  The long term goal of this patch is to allow us to add our own repos in the "execute YUM repo setup" section of the base file based upon OpenStack Infrastructure YUM repos.  
__label__objective Significant refactor of base image  This refactor organizes the code as follows:  If RPM family:     execute YUM repo setup     if binary         install binary tools     if source         install source tools  IF yum family:    install source tools  I have tested building and everything seems fairly solid except possilby RHOS.  The long term goal of this patch is to allow us to add our own repos in the "execute YUM repo setup" section of the base file based upon OpenStack Infrastructure YUM repos.  
__label__integration Refactor ironic-install playbook to support CentOS & RHEL  Refactor the ironic-install role so that it can be used on Centos. Also add a new template for systemd configuration so we can install and run the ironic services.  Document the additional steps that RHEL and CentOS users will need to take to get bifrost up and running.  Install gcc in env-setup.sh as it is needed to install pip and we can't take it for granted.  Temporarily remove amttool from RedHat family dependencies since it's not currently packaged for RHEL or CentOS 7. We'll handle this in a separate patch.  Change libxslt-dev to libxslt1-dev as it is the correct name for the package.  
__label__quality Refactor ironic-install playbook to support CentOS & RHEL  Refactor the ironic-install role so that it can be used on Centos. Also add a new template for systemd configuration so we can install and run the ironic services.  Document the additional steps that RHEL and CentOS users will need to take to get bifrost up and running.  Install gcc in env-setup.sh as it is needed to install pip and we can't take it for granted.  Temporarily remove amttool from RedHat family dependencies since it's not currently packaged for RHEL or CentOS 7. We'll handle this in a separate patch.  Change libxslt-dev to libxslt1-dev as it is the correct name for the package.  
__label__quality Refactor ironic-install playbook to support CentOS & RHEL  Refactor the ironic-install role so that it can be used on Centos. Also add a new template for systemd configuration so we can install and run the ironic services.  Document the additional steps that RHEL and CentOS users will need to take to get bifrost up and running.  Install gcc in env-setup.sh as it is needed to install pip and we can't take it for granted.  Temporarily remove amttool from RedHat family dependencies since it's not currently packaged for RHEL or CentOS 7. We'll handle this in a separate patch.  Change libxslt-dev to libxslt1-dev as it is the correct name for the package.  
__label__objective Refactor ironic-install playbook to support CentOS & RHEL  Refactor the ironic-install role so that it can be used on Centos. Also add a new template for systemd configuration so we can install and run the ironic services.  Document the additional steps that RHEL and CentOS users will need to take to get bifrost up and running.  Install gcc in env-setup.sh as it is needed to install pip and we can't take it for granted.  Temporarily remove amttool from RedHat family dependencies since it's not currently packaged for RHEL or CentOS 7. We'll handle this in a separate patch.  Change libxslt-dev to libxslt1-dev as it is the correct name for the package.  
__label__integration Refactored github tools to prefer token-based auth  The github workflow still asks for username, password, and 2FA token if need be, but creates a repo token and uses that for further exchanges to save on user input fatigue.  
__label__objective Refactored github tools to prefer token-based auth  The github workflow still asks for username, password, and 2FA token if need be, but creates a repo token and uses that for further exchanges to save on user input fatigue.  
__label__integration Refactor oslo.conf handling for tool scripts  Move the oslo.conf handling for tool scripts to a module that can be reused.  
__label__quality Refactor oslo.conf handling for tool scripts  Move the oslo.conf handling for tool scripts to a module that can be reused.  
__label__objective Refactor oslo.conf handling for tool scripts  Move the oslo.conf handling for tool scripts to a module that can be reused.  
__label__quality Refactor tools/unit_tests.sh  unit_tests.sh has a lot of duplicated statements. This commits introduces run_test function to clarify the differences.  selenium_tests.sh is also updated to clarify which positional arguments are used. Direct usage of $1, $2 is not easy to understand.  
__label__testing Refactor tools/unit_tests.sh  unit_tests.sh has a lot of duplicated statements. This commits introduces run_test function to clarify the differences.  selenium_tests.sh is also updated to clarify which positional arguments are used. Direct usage of $1, $2 is not easy to understand.  
__label__objective Refactor tools/unit_tests.sh  unit_tests.sh has a lot of duplicated statements. This commits introduces run_test function to clarify the differences.  selenium_tests.sh is also updated to clarify which positional arguments are used. Direct usage of $1, $2 is not easy to understand.  
__label__quality Refactor the decorator which sets a default deploy_id  * The decorator is now more generic and is able to manage any default id. If you need to add a new default id, you have to add a _default_{name_id}_id function that will set your default id, you will have to fill the id_func_mapping dict (e.g id_func_mapping = {'deploy_id': _default_deploy_id} * And finally if you want to use it, simply specify your name_id in parameter of the decorator (e.g @default_id('deploy_id'))  * Replaced decorator.decorator by functools.wraps since we do not have method signature issues with the new implementation of the decorator @default_id. * Removed python-decorator dependency in requirements since we do not use this dependency somewhere else.  
__label__objective Refactor the decorator which sets a default deploy_id  * The decorator is now more generic and is able to manage any default id. If you need to add a new default id, you have to add a _default_{name_id}_id function that will set your default id, you will have to fill the id_func_mapping dict (e.g id_func_mapping = {'deploy_id': _default_deploy_id} * And finally if you want to use it, simply specify your name_id in parameter of the decorator (e.g @default_id('deploy_id'))  * Replaced decorator.decorator by functools.wraps since we do not have method signature issues with the new implementation of the decorator @default_id. * Removed python-decorator dependency in requirements since we do not use this dependency somewhere else.  
__label__integration refactor: change images and zuul  We no longer use underscores in image names, we instead use dashes because that is a sane pattern.  We also create a tool which updates zuul jobs automatically based on the images and builds each image in it's own job (only if necessary when we have Dockerfile changes).  
__label__objective refactor: change images and zuul  We no longer use underscores in image names, we instead use dashes because that is a sane pattern.  We also create a tool which updates zuul jobs automatically based on the images and builds each image in it's own job (only if necessary when we have Dockerfile changes).  
__label__testing - switch to testtools - remove pep8 warnings - more unit tests for dbaas.py, covers create_user, enable_root - refactoring  Bug # 1090139 Blueprint https://blueprints.launchpad.net/reddwarf/+spec/guestagent-unit-test-coverage  
__label__integration - switch to testtools - remove pep8 warnings - more unit tests for dbaas.py, covers create_user, enable_root - refactoring  Bug # 1090139 Blueprint https://blueprints.launchpad.net/reddwarf/+spec/guestagent-unit-test-coverage  
__label__objective - switch to testtools - remove pep8 warnings - more unit tests for dbaas.py, covers create_user, enable_root - refactoring  Bug # 1090139 Blueprint https://blueprints.launchpad.net/reddwarf/+spec/guestagent-unit-test-coverage  
__label__integration Refactor OVNMacAddressNetwork  Move the OVNMacAddressNetwork resource out of the Networks resource. This is a special network that we want to create internally.  Having this network nested in the Networks resource interfer with the work related to creating composable networks with non-heat tooling.  
__label__objective Refactor OVNMacAddressNetwork  Move the OVNMacAddressNetwork resource out of the Networks resource. This is a special network that we want to create internally.  Having this network nested in the Networks resource interfer with the work related to creating composable networks with non-heat tooling.  
__label__integration Refactor OVNMacAddressNetwork  Move the OVNMacAddressNetwork resource out of the Networks resource. This is a special network that we want to create internally.  Having this network nested in the Networks resource interfer with the work related to creating composable networks with non-heat tooling.  
__label__objective Refactor OVNMacAddressNetwork  Move the OVNMacAddressNetwork resource out of the Networks resource. This is a special network that we want to create internally.  Having this network nested in the Networks resource interfer with the work related to creating composable networks with non-heat tooling.  
__label__quality refactoring update_task  Function update_task will be too complex if we add another exception inside, but this is required by bug 1475057. Require small refactoring.  Conflicts:         heat/engine/stack.py         heat/tests/test_stack.py  
__label__objective refactoring update_task  Function update_task will be too complex if we add another exception inside, but this is required by bug 1475057. Require small refactoring.  Conflicts:         heat/engine/stack.py         heat/tests/test_stack.py  
__label__quality Refactors cleanup resource for scenario  Eliminate duplicate code with some refactor using _status_timeout to wait for resource deletion. Also removes a hardcoded 10 seconds timeout using CONF.compute.build_interval instead. This fixes the bug mentioned bellow.  Fixes bug #1276781  
__label__objective Refactors cleanup resource for scenario  Eliminate duplicate code with some refactor using _status_timeout to wait for resource deletion. Also removes a hardcoded 10 seconds timeout using CONF.compute.build_interval instead. This fixes the bug mentioned bellow.  Fixes bug #1276781  
__label__quality refactor proxy and close connections  The last time someone went after the close backend connections on PUT bug a refactoring of that method came up as something we should do.  And I've often given Swift's proxy.controller.obj.PUT as an example of a fairly complex method.  So I think this is better, but mostly just cause it started out so unruly. This may be able to improve (significantly?!) further, but I'll probably need to step away from it for a bit to come back and see if I've done anything really ugly - or you could just point it out to me (or just push over the change).  Also, close backend connections to object servers when we're done with them - always.  Fixes lp bug #667956  
__label__objective refactor proxy and close connections  The last time someone went after the close backend connections on PUT bug a refactoring of that method came up as something we should do.  And I've often given Swift's proxy.controller.obj.PUT as an example of a fairly complex method.  So I think this is better, but mostly just cause it started out so unruly. This may be able to improve (significantly?!) further, but I'll probably need to step away from it for a bit to come back and see if I've done anything really ugly - or you could just point it out to me (or just push over the change).  Also, close backend connections to object servers when we're done with them - always.  Fixes lp bug #667956  
__label__objective refactor proxy and close connections  The last time someone went after the close backend connections on PUT bug a refactoring of that method came up as something we should do.  And I've often given Swift's proxy.controller.obj.PUT as an example of a fairly complex method.  So I think this is better, but mostly just cause it started out so unruly. This may be able to improve (significantly?!) further, but I'll probably need to step away from it for a bit to come back and see if I've done anything really ugly - or you could just point it out to me (or just push over the change).  Also, close backend connections to object servers when we're done with them - always.  Fixes lp bug #667956  
__label__quality Allow query pool stat by pool name  This command needs to query two resources: pool and stats, and the query function and returned data are named differently. So I refactor the base showcommand to support it.  Bug #1227422  
__label__objective Allow query pool stat by pool name  This command needs to query two resources: pool and stats, and the query function and returned data are named differently. So I refactor the base showcommand to support it.  Bug #1227422  
__label__quality Refactor timestamp existence validation in V2 API  There was a bug in AlarmThresholdRule in v2.py, the timestamp_keys were defined with a missing comma: ['timestamp', 'start', 'start_timestamp' 'end', 'end_timestamp'].  The validation, if the timestamp field is used or not, was unclear in the current implementation. A new parameter, 'timestamp_is_valid', was added to the validation functions to show, if the timestamp is allowed to use or not in the validated query.  Fixes bug 1280975  
__label__objective Refactor timestamp existence validation in V2 API  There was a bug in AlarmThresholdRule in v2.py, the timestamp_keys were defined with a missing comma: ['timestamp', 'start', 'start_timestamp' 'end', 'end_timestamp'].  The validation, if the timestamp field is used or not, was unclear in the current implementation. A new parameter, 'timestamp_is_valid', was added to the validation functions to show, if the timestamp is allowed to use or not in the validated query.  Fixes bug 1280975  
__label__objective Refactor timestamp existence validation in V2 API  There was a bug in AlarmThresholdRule in v2.py, the timestamp_keys were defined with a missing comma: ['timestamp', 'start', 'start_timestamp' 'end', 'end_timestamp'].  The validation, if the timestamp field is used or not, was unclear in the current implementation. A new parameter, 'timestamp_is_valid', was added to the validation functions to show, if the timestamp is allowed to use or not in the validated query.  Fixes bug 1280975  
__label__quality xenapi: refactor: move RawTGZImage to common  During the review of https://review.openstack.org/40909 it was requested, that the RawTGZImage class should be moved to a common territory, so that others can re-use it later.  Fixes bug 1220596  
__label__objective xenapi: refactor: move RawTGZImage to common  During the review of https://review.openstack.org/40909 it was requested, that the RawTGZImage class should be moved to a common territory, so that others can re-use it later.  Fixes bug 1220596  
__label__objective xenapi: refactor: move RawTGZImage to common  During the review of https://review.openstack.org/40909 it was requested, that the RawTGZImage class should be moved to a common territory, so that others can re-use it later.  Fixes bug 1220596  
__label__integration Refactored compute/servers.py:update() to properly use API  Changed some integration tests to match API response  Related to blueprint unified-object-model Fixes: bug #1192012  
__label__objective Refactored compute/servers.py:update() to properly use API  Changed some integration tests to match API response  Related to blueprint unified-object-model Fixes: bug #1192012  
__label__testing Refactored compute/servers.py:update() to properly use API  Changed some integration tests to match API response  Related to blueprint unified-object-model Fixes: bug #1192012  
__label__quality Refactored compute/servers.py:update() to properly use API  Changed some integration tests to match API response  Related to blueprint unified-object-model Fixes: bug #1192012  
__label__objective xenapi: refactor spawn so more code can be shared  To fix a bug related to inconsistent behavior between spawn and finish_migration, I have refactored the spawn code so it will be easier to share with finish_migration.  At the same time there were some inconsistencies in the ordering of the step definitions and running. This has also be resolved as part of this change, including altering some of the grouping of the steps to show more granular progress as the instance is built.  
__label__quality xenapi: refactor spawn so more code can be shared  To fix a bug related to inconsistent behavior between spawn and finish_migration, I have refactored the spawn code so it will be easier to share with finish_migration.  At the same time there were some inconsistencies in the ordering of the step definitions and running. This has also be resolved as part of this change, including altering some of the grouping of the steps to show more granular progress as the instance is built.  
__label__objective xenapi: refactor spawn so more code can be shared  To fix a bug related to inconsistent behavior between spawn and finish_migration, I have refactored the spawn code so it will be easier to share with finish_migration.  At the same time there were some inconsistencies in the ordering of the step definitions and running. This has also be resolved as part of this change, including altering some of the grouping of the steps to show more granular progress as the instance is built.  
__label__objective Refactored parsing and detection of help arguments.  Simplified the code that detects help arguments (-h, --help, help) and displays a help message for the client or for a specified command.  Made help arguments position insensitive.  Fixes: bug #1116866 Fixes: bug #1158209  
__label__objective Refactored parsing and detection of help arguments.  Simplified the code that detects help arguments (-h, --help, help) and displays a help message for the client or for a specified command.  Made help arguments position insensitive.  Fixes: bug #1116866 Fixes: bug #1158209  
__label__refactoring A minor refactor in wsgi.py  A minor refactor to move the code up in the file as suggested by termie and henry regarding the review comments in https://review.openstack.org/#/c/26487/  Fix bug 1166697  
__label__objective A minor refactor in wsgi.py  A minor refactor to move the code up in the file as suggested by termie and henry regarding the review comments in https://review.openstack.org/#/c/26487/  Fix bug 1166697  
__label__refactoring Refactor the LBaaS templates code  Replace the LBaaS templates 'addvip.html', 'addpool.html', 'addmember.html' and 'addmonitor.html' with the one.  fixes bug 1173027  
__label__objective Refactor the LBaaS templates code  Replace the LBaaS templates 'addvip.html', 'addpool.html', 'addmember.html' and 'addmonitor.html' with the one.  fixes bug 1173027  
__label__testing Refactored tests for failing quota int-tests  
__label__objective Refactored tests for failing quota int-tests  
__label__objective Refactoring API 2.0 content to create a single long dev guide.  However, it doesn't build just yet. Will keep working on it.  The idea is to keep all the extension "dev guides" while also building a long all-in-one PDF/HTML dev guide containing all calls.  fix bug 961370 bug 1015119 bug 1039758  
__label__objective Refactoring API 2.0 content to create a single long dev guide.  However, it doesn't build just yet. Will keep working on it.  The idea is to keep all the extension "dev guides" while also building a long all-in-one PDF/HTML dev guide containing all calls.  fix bug 961370 bug 1015119 bug 1039758  
__label__quality LXC: Refactor attach and detach of volumes  In essex lxc attach and detach was doing the wrong thing, it was doing a bind mount of a block device from the host to the lxc container. This was ineffective and broken at best.  In this refactor, given the PID of the libvirt lxc container we can find the child process of the lxc container, via the ps command to find the init process of the lxc container.  Once we have found the init process.  To find the cgroups path for a given instance the container we traverse the cgroups filesystem to find where the devices.allow for the lxc instance and allow the device to be used by the container by giving the block device major and minor device information.  Once we have the init process we create a device via mknod in the /proc/<init process of container>/dev/ directory on the host, After the devices has been attached to the container it looks and acts like a real block device in the container.  To remove the device from the container we blacklist the device and remove the device from the container.  Note: In order for the block device to be used by the container we have to use the "real" block information on the host. Not what devmapper tells us.  This fixes bug LP: #1009701  
__label__objective LXC: Refactor attach and detach of volumes  In essex lxc attach and detach was doing the wrong thing, it was doing a bind mount of a block device from the host to the lxc container. This was ineffective and broken at best.  In this refactor, given the PID of the libvirt lxc container we can find the child process of the lxc container, via the ps command to find the init process of the lxc container.  Once we have found the init process.  To find the cgroups path for a given instance the container we traverse the cgroups filesystem to find where the devices.allow for the lxc instance and allow the device to be used by the container by giving the block device major and minor device information.  Once we have the init process we create a device via mknod in the /proc/<init process of container>/dev/ directory on the host, After the devices has been attached to the container it looks and acts like a real block device in the container.  To remove the device from the container we blacklist the device and remove the device from the container.  Note: In order for the block device to be used by the container we have to use the "real" block information on the host. Not what devmapper tells us.  This fixes bug LP: #1009701  
__label__objective Fix and refactor libvirt disk config generation.  * Deal with corner case where the root device is an iso image to fix bug 1023250.  * Refactor to reduce duplicated code in disk config generation.  
__label__quality Fix and refactor libvirt disk config generation.  * Deal with corner case where the root device is an iso image to fix bug 1023250.  * Refactor to reduce duplicated code in disk config generation.  
__label__refactoring Refactor namespace fallback imports for update.py  * Refixes Bug #951197  
__label__quality Refactor raw cache feature  Originally the raw cache feature is enabled in stx-glance. But upstream cinder already has the raw cache feature, so refactor the code to leverage this.  This patch did below things: 1. Add parameter 'cinder_raw_cache_gib' in 'system storage-backend-modify' 2. Get/Generate tenant id in sysinv-conductor 3. Fill tenant id, cache size, cache switch into yaml file 4. Update puppet file to write these information to cinder.conf  Some verification did: 1. Verified these code in starlingx storage dedicated deployment    - Run 'system storage-backend-modify ceph-store cinder_raw_cache_gib=10'    - Verified "cinder_raw_cache_gib": "10" is added in db table      'storage_backend', field 'capabilities'    - Verified tenent id (internal_project_id/internal_user_id),      image_volume_cache_enabled, image_volume_cache_max_size_gb is added in      /tmp/puppet/hieradata/system.yaml    - Verified these info has been added in /etc/cinder/cinder.conf    - Verified in starlingx running system, cache feature is enabled, but only      one volume is cached no matter how big the cache size is specified. This      is because starlingx is using cinder pike version, so not a bug  2. Verified in community version of openstack, if fill the same info in cinder.conf, it works as expected. Cinder cache feature: https://docs.openstack.org/cinder/latest/admin/blockstorage-image-volume-cache.html  Story: 2004869 Task: 29121 
__label__objective Refactor raw cache feature  Originally the raw cache feature is enabled in stx-glance. But upstream cinder already has the raw cache feature, so refactor the code to leverage this.  This patch did below things: 1. Add parameter 'cinder_raw_cache_gib' in 'system storage-backend-modify' 2. Get/Generate tenant id in sysinv-conductor 3. Fill tenant id, cache size, cache switch into yaml file 4. Update puppet file to write these information to cinder.conf  Some verification did: 1. Verified these code in starlingx storage dedicated deployment    - Run 'system storage-backend-modify ceph-store cinder_raw_cache_gib=10'    - Verified "cinder_raw_cache_gib": "10" is added in db table      'storage_backend', field 'capabilities'    - Verified tenent id (internal_project_id/internal_user_id),      image_volume_cache_enabled, image_volume_cache_max_size_gb is added in      /tmp/puppet/hieradata/system.yaml    - Verified these info has been added in /etc/cinder/cinder.conf    - Verified in starlingx running system, cache feature is enabled, but only      one volume is cached no matter how big the cache size is specified. This      is because starlingx is using cinder pike version, so not a bug  2. Verified in community version of openstack, if fill the same info in cinder.conf, it works as expected. Cinder cache feature: https://docs.openstack.org/cinder/latest/admin/blockstorage-image-volume-cache.html  Story: 2004869 Task: 29121 
__label__objective Refactor raw cache feature  Originally the raw cache feature is enabled in stx-glance. But upstream cinder already has the raw cache feature, so refactor the code to leverage this.  This patch did below things: 1. Add parameter 'cinder_raw_cache_gib' in 'system storage-backend-modify' 2. Get/Generate tenant id in sysinv-conductor 3. Fill tenant id, cache size, cache switch into yaml file 4. Update puppet file to write these information to cinder.conf  Some verification did: 1. Verified these code in starlingx storage dedicated deployment    - Run 'system storage-backend-modify ceph-store cinder_raw_cache_gib=10'    - Verified "cinder_raw_cache_gib": "10" is added in db table      'storage_backend', field 'capabilities'    - Verified tenent id (internal_project_id/internal_user_id),      image_volume_cache_enabled, image_volume_cache_max_size_gb is added in      /tmp/puppet/hieradata/system.yaml    - Verified these info has been added in /etc/cinder/cinder.conf    - Verified in starlingx running system, cache feature is enabled, but only      one volume is cached no matter how big the cache size is specified. This      is because starlingx is using cinder pike version, so not a bug  2. Verified in community version of openstack, if fill the same info in cinder.conf, it works as expected. Cinder cache feature: https://docs.openstack.org/cinder/latest/admin/blockstorage-image-volume-cache.html  Story: 2004869 Task: 29121 
__label__quality Refactor clients used in protect service  Refactor the way of creating client of other openstack service used in protect service, which includes several respects.  1. Move several public config items into the common config list. For example, move 'auth_insecure' to common/config.py/service_client_opts. Then there is no need to write same codes in each client's file.  2. Delete the codes which re-registers config options to parameter 'conf'. Because 'conf' is 'cfg.CONF' generally, except for the Swift which uses individual config. And for Swift, register the opts in the config instance to make sure 'conf' has been registered any opts needed before invoking the 'create' method.  3. Move 'protection/utils.py' to 'protection/clients/utils.py'. Because that file is only used by files in clients. Besides, add a new way to get endpoint of service in utils.py/get_url.  4. Add a new way to create clients, which is by session and can solve the bug that the token may expire during protecting works. Then we can create client once and use it all the time(<48h) without worry that the token may expire.  
__label__objective Refactor clients used in protect service  Refactor the way of creating client of other openstack service used in protect service, which includes several respects.  1. Move several public config items into the common config list. For example, move 'auth_insecure' to common/config.py/service_client_opts. Then there is no need to write same codes in each client's file.  2. Delete the codes which re-registers config options to parameter 'conf'. Because 'conf' is 'cfg.CONF' generally, except for the Swift which uses individual config. And for Swift, register the opts in the config instance to make sure 'conf' has been registered any opts needed before invoking the 'create' method.  3. Move 'protection/utils.py' to 'protection/clients/utils.py'. Because that file is only used by files in clients. Besides, add a new way to get endpoint of service in utils.py/get_url.  4. Add a new way to create clients, which is by session and can solve the bug that the token may expire during protecting works. Then we can create client once and use it all the time(<48h) without worry that the token may expire.  
__label__objective Refactor clients used in protect service  Refactor the way of creating client of other openstack service used in protect service, which includes several respects.  1. Move several public config items into the common config list. For example, move 'auth_insecure' to common/config.py/service_client_opts. Then there is no need to write same codes in each client's file.  2. Delete the codes which re-registers config options to parameter 'conf'. Because 'conf' is 'cfg.CONF' generally, except for the Swift which uses individual config. And for Swift, register the opts in the config instance to make sure 'conf' has been registered any opts needed before invoking the 'create' method.  3. Move 'protection/utils.py' to 'protection/clients/utils.py'. Because that file is only used by files in clients. Besides, add a new way to get endpoint of service in utils.py/get_url.  4. Add a new way to create clients, which is by session and can solve the bug that the token may expire during protecting works. Then we can create client once and use it all the time(<48h) without worry that the token may expire.  
__label__objective Refactor clients used in protect service  Refactor the way of creating client of other openstack service used in protect service, which includes several respects.  1. Move several public config items into the common config list. For example, move 'auth_insecure' to common/config.py/service_client_opts. Then there is no need to write same codes in each client's file.  2. Delete the codes which re-registers config options to parameter 'conf'. Because 'conf' is 'cfg.CONF' generally, except for the Swift which uses individual config. And for Swift, register the opts in the config instance to make sure 'conf' has been registered any opts needed before invoking the 'create' method.  3. Move 'protection/utils.py' to 'protection/clients/utils.py'. Because that file is only used by files in clients. Besides, add a new way to get endpoint of service in utils.py/get_url.  4. Add a new way to create clients, which is by session and can solve the bug that the token may expire during protecting works. Then we can create client once and use it all the time(<48h) without worry that the token may expire.  
__label__quality Refactor 55-heat-config related tasks  When 55-heat-config ran, it creates a json file for the output. We use jq to fetch the return code written in that file.  This patch aims to refactor the tasks which run this script and verification to avoid task duplication and also ensure that the file actually exists on the file system, with a retries/delay mechanism in order to avoid a race condition (see bug report).  
__label__objective Refactor 55-heat-config related tasks  When 55-heat-config ran, it creates a json file for the output. We use jq to fetch the return code written in that file.  This patch aims to refactor the tasks which run this script and verification to avoid task duplication and also ensure that the file actually exists on the file system, with a retries/delay mechanism in order to avoid a race condition (see bug report).  
__label__objective Refactor 55-heat-config related tasks  When 55-heat-config ran, it creates a json file for the output. We use jq to fetch the return code written in that file.  This patch aims to refactor the tasks which run this script and verification to avoid task duplication and also ensure that the file actually exists on the file system, with a retries/delay mechanism in order to avoid a race condition (see bug report).  
__label__objective Refactor tunnel_sync to handle race conditions  The problem statement is available in the bug description. Closes-Bug: #1426427 Closed-Bug: #1435852  
__label__refactoring Fix on multiparse request data * bug fixin * refactoring  
__label__objective Fix on multiparse request data * bug fixin * refactoring  
__label__refactoring Speakers/Moderators Refactoring  Bug Fixing  
__label__objective Speakers/Moderators Refactoring  Bug Fixing  
__label__quality api.cinder: refactor microversioning logic  There are sevral similar logics to handle microversioning in Cinder API wrapper. This commit refactors them and introduces _cinderclient_with_features() function.  The parent commit to fix bug 1810309 does not introduce this logic to make it easy to backport the fix.  
__label__objective api.cinder: refactor microversioning logic  There are sevral similar logics to handle microversioning in Cinder API wrapper. This commit refactors them and introduces _cinderclient_with_features() function.  The parent commit to fix bug 1810309 does not introduce this logic to make it easy to backport the fix.  
__label__objective api.cinder: refactor microversioning logic  There are sevral similar logics to handle microversioning in Cinder API wrapper. This commit refactors them and introduces _cinderclient_with_features() function.  The parent commit to fix bug 1810309 does not introduce this logic to make it easy to backport the fix.  
__label__objective [458884] Refactor validation  - This addresses a bug where Promenade doesn't detect some invalid   configurations during genesis script generation. - Refactor some validation checks for performance  
__label__quality [458884] Refactor validation  - This addresses a bug where Promenade doesn't detect some invalid   configurations during genesis script generation. - Refactor some validation checks for performance  
__label__quality dashboard refactor for Pike and Chef 13  - implemented foodcritic and cookstyle corrections - deprecated node.foo.bar method access for node['foo']['bar'] bracket access - added workaround for bug #1616265 - deprecated postgresql support  Implements blueprint modern-chef  
__label__objective dashboard refactor for Pike and Chef 13  - implemented foodcritic and cookstyle corrections - deprecated node.foo.bar method access for node['foo']['bar'] bracket access - added workaround for bug #1616265 - deprecated postgresql support  Implements blueprint modern-chef  
__label__integration dashboard refactor for Pike and Chef 13  - implemented foodcritic and cookstyle corrections - deprecated node.foo.bar method access for node['foo']['bar'] bracket access - added workaround for bug #1616265 - deprecated postgresql support  Implements blueprint modern-chef  
__label__refactoring Refactor repo processing code  Prepare the code for repo-based settings for code, reviews, bug tracker, etc.  
__label__objective Refactor repo processing code  Prepare the code for repo-based settings for code, reviews, bug tracker, etc.  
__label__quality Refactor OVSCookieBridge to always apply extension cookie  Instead of using a passthrough class that does not provide the intended behavior (see bug 1557620), this change implements a cookie bridge as a pathched copy of the underlying bridge: - the underlying bridge is copied - the copy is given a specific cookie - the base class of the copy is set to a dynamically created class   inheriting from the class of the underlying bridge and from   an OVSCookieBridge method  The two problems in the bug are addressed: - the extension cookie is now applied even for call to   methods other than add/delete/flows - the extension cookie is now applied in the case of the   native implementation  This is an alternative to 3d56cfff517820f57fdd601c5f5634a20b5e2c47.  
__label__objective Refactor OVSCookieBridge to always apply extension cookie  Instead of using a passthrough class that does not provide the intended behavior (see bug 1557620), this change implements a cookie bridge as a pathched copy of the underlying bridge: - the underlying bridge is copied - the copy is given a specific cookie - the base class of the copy is set to a dynamically created class   inheriting from the class of the underlying bridge and from   an OVSCookieBridge method  The two problems in the bug are addressed: - the extension cookie is now applied even for call to   methods other than add/delete/flows - the extension cookie is now applied in the case of the   native implementation  This is an alternative to 3d56cfff517820f57fdd601c5f5634a20b5e2c47.  
__label__objective Refactor OVSCookieBridge to always apply extension cookie  Instead of using a passthrough class that does not provide the intended behavior (see bug 1557620), this change implements a cookie bridge as a pathched copy of the underlying bridge: - the underlying bridge is copied - the copy is given a specific cookie - the base class of the copy is set to a dynamically created class   inheriting from the class of the underlying bridge and from   an OVSCookieBridge method  The two problems in the bug are addressed: - the extension cookie is now applied even for call to   methods other than add/delete/flows - the extension cookie is now applied in the case of the   native implementation  This is an alternative to 3d56cfff517820f57fdd601c5f5634a20b5e2c47.  
__label__quality WIP Refactor EPEL into a role  Fixes bug 1605228, where if the user installs epel-relase from the Centos7 default packages rather than from the latest rpm online packages the latest epel-release from the rpm installs on top of it but does not provide newer packages.  What this translates to is that packages like graphite-web don't exist and installation of things like elk fails.  This change adds a check to uninstall epel-release if it's already there right now it will uninstall even a valid version (so if you install elk and graphite back to back it will remove and reinstall epel. I'm looking for a way to identify the source of the epel package to prevent that)  Finally since the epel package was installed by half a dozen different playbooks all with copy/pasted versions of the same role I refacotred all the tasks that require epel to call the epel role to install it.  
__label__objective WIP Refactor EPEL into a role  Fixes bug 1605228, where if the user installs epel-relase from the Centos7 default packages rather than from the latest rpm online packages the latest epel-release from the rpm installs on top of it but does not provide newer packages.  What this translates to is that packages like graphite-web don't exist and installation of things like elk fails.  This change adds a check to uninstall epel-release if it's already there right now it will uninstall even a valid version (so if you install elk and graphite back to back it will remove and reinstall epel. I'm looking for a way to identify the source of the epel package to prevent that)  Finally since the epel package was installed by half a dozen different playbooks all with copy/pasted versions of the same role I refacotred all the tasks that require epel to call the epel role to install it.  
__label__objective WIP Refactor EPEL into a role  Fixes bug 1605228, where if the user installs epel-relase from the Centos7 default packages rather than from the latest rpm online packages the latest epel-release from the rpm installs on top of it but does not provide newer packages.  What this translates to is that packages like graphite-web don't exist and installation of things like elk fails.  This change adds a check to uninstall epel-release if it's already there right now it will uninstall even a valid version (so if you install elk and graphite back to back it will remove and reinstall epel. I'm looking for a way to identify the source of the epel package to prevent that)  Finally since the epel package was installed by half a dozen different playbooks all with copy/pasted versions of the same role I refacotred all the tasks that require epel to call the epel role to install it.  
__label__objective RPC refactoring  Fix for the bug where api is not able to send request to engine over RPC. Modified and added UTs wherever required.  
__label__testing RPC refactoring  Fix for the bug where api is not able to send request to engine over RPC. Modified and added UTs wherever required.  
__label__objective Refactor gnocchi transformer  Use of the new generic transformer class. Fixed a bug with image_id extraction from image_ref.  
__label__objective Refactor gnocchi transformer  Use of the new generic transformer class. Fixed a bug with image_id extraction from image_ref.  
__label__objective Refactor gnocchi transformer  Use of the new generic transformer class. Fixed a bug with image_id extraction from image_ref.  
__label__objective Refactor gnocchi transformer  Use of the new generic transformer class. Fixed a bug with image_id extraction from image_ref.  
__label__refactoring Refactor workflow controller and fix a bug in _fail_workflow()  
__label__objective Refactor workflow controller and fix a bug in _fail_workflow()  
__label__objective Refactor config get-manifest command  This commit addresses the bug that user is unable to see retrieved manifest name or names, also simplifies the internal logic and reorganizes unit tests.  
__label__testing Refactor config get-manifest command  This commit addresses the bug that user is unable to see retrieved manifest name or names, also simplifies the internal logic and reorganizes unit tests.  
__label__quality Refactor config get-manifest command  This commit addresses the bug that user is unable to see retrieved manifest name or names, also simplifies the internal logic and reorganizes unit tests.  
__label__objective Refactor validation of arguments to 'repeat' intrinsic function  Separate validation of the structure of the function call itself from validation of the arguments passed. The former remains in the initialisation method, while the latter moves to the validate() method. This is consistent with how other intrinsic functions are instantiated, and should hopefully lead to less confusion of the kind that resulted in bug 1553306.  
__label__quality Refactor validation of arguments to 'repeat' intrinsic function  Separate validation of the structure of the function call itself from validation of the arguments passed. The former remains in the initialisation method, while the latter moves to the validate() method. This is consistent with how other intrinsic functions are instantiated, and should hopefully lead to less confusion of the kind that resulted in bug 1553306.  
__label__objective Refactor validation of arguments to 'repeat' intrinsic function  Separate validation of the structure of the function call itself from validation of the arguments passed. The former remains in the initialisation method, while the latter moves to the validate() method. This is consistent with how other intrinsic functions are instantiated, and should hopefully lead to less confusion of the kind that resulted in bug 1553306.  
__label__objective Refactor security group set to use SDK  Refactored the 'os security group set' command to use the SDK when neutron is enabled, but continue to use the nova client when nova network is enabled.  This patch set also fixes a compute bug which ignores name and description when set to an empty value.  
__label__quality Refactor security group set to use SDK  Refactored the 'os security group set' command to use the SDK when neutron is enabled, but continue to use the nova client when nova network is enabled.  This patch set also fixes a compute bug which ignores name and description when set to an empty value.  
__label__objective Refactor security group set to use SDK  Refactored the 'os security group set' command to use the SDK when neutron is enabled, but continue to use the nova client when nova network is enabled.  This patch set also fixes a compute bug which ignores name and description when set to an empty value.  
__label__quality Refactored authenticate.py to remove atomic actions from loops when performing multiple repititions.  bug #1540545  
__label__objective Refactored authenticate.py to remove atomic actions from loops when performing multiple repititions.  bug #1540545  
__label__objective Opendaylight driver refactor to handle out of sync issues  This commits refactors the Opendaylight ML2 mechanism driver to handle race conditions and out of sync issues. It attempts to address these using an atomic thread synchronization model that tracks the sync, retry, success and failed states of Neutron objects sent to Opendaylight.  Partially fixes Bug # 1493551  
__label__quality Opendaylight driver refactor to handle out of sync issues  This commits refactors the Opendaylight ML2 mechanism driver to handle race conditions and out of sync issues. It attempts to address these using an atomic thread synchronization model that tracks the sync, retry, success and failed states of Neutron objects sent to Opendaylight.  Partially fixes Bug # 1493551  
__label__objective Opendaylight driver refactor to handle out of sync issues  This commits refactors the Opendaylight ML2 mechanism driver to handle race conditions and out of sync issues. It attempts to address these using an atomic thread synchronization model that tracks the sync, retry, success and failed states of Neutron objects sent to Opendaylight.  Partially fixes Bug # 1493551  
__label__quality Refactor the timeline directive.  Presently the timeline directive is a single gigantic directive containing all of the timeline code. Given the amount of code involved, this complicates maintenance and makes it excessively difficult to improve.  This refactors the single timeline directive into four separate collaborating directives: a controller, an overview, a viewport, and dstat charts. Each child directive is functionally separate from the others, but can communicate with other chart components via the controller. This separation should greatly improve future maintenance, and has already led to several (included) bug fixes.  
__label__objective Refactor the timeline directive.  Presently the timeline directive is a single gigantic directive containing all of the timeline code. Given the amount of code involved, this complicates maintenance and makes it excessively difficult to improve.  This refactors the single timeline directive into four separate collaborating directives: a controller, an overview, a viewport, and dstat charts. Each child directive is functionally separate from the others, but can communicate with other chart components via the controller. This separation should greatly improve future maintenance, and has already led to several (included) bug fixes.  
__label__objective Refactor the timeline directive.  Presently the timeline directive is a single gigantic directive containing all of the timeline code. Given the amount of code involved, this complicates maintenance and makes it excessively difficult to improve.  This refactors the single timeline directive into four separate collaborating directives: a controller, an overview, a viewport, and dstat charts. Each child directive is functionally separate from the others, but can communicate with other chart components via the controller. This separation should greatly improve future maintenance, and has already led to several (included) bug fixes.  
__label__quality Small refactor for site.yml  As the bug mentions this file is complex and has caused problems in the past. It will likely cause problems in the future.  
__label__objective Small refactor for site.yml  As the bug mentions this file is complex and has caused problems in the past. It will likely cause problems in the future.  
__label__objective [verify] refactor HtmlOutput  There is no reason to use OOP for one simple method. This patch replaces class HtmlOutput by method generate_report.  Also, it add improvement for skip reason: number of bug is replaced by link to it.  
__label__objective [verify] refactor HtmlOutput  There is no reason to use OOP for one simple method. This patch replaces class HtmlOutput by method generate_report.  Also, it add improvement for skip reason: number of bug is replaced by link to it.  
__label__quality Small refactor for site.yml  As the bug mentions this file is complex and has caused problems in the past. It will likely cause problems in the future.  
__label__objective Small refactor for site.yml  As the bug mentions this file is complex and has caused problems in the past. It will likely cause problems in the future.  
__label__objective Fixing bug introduced by manager refactor  
__label__quality Refactor event-alarm caching  This patch changes the format of alarm definitions cached in the event-alarm evaluator to dict. This reduces complex of the code to find and update the alarm entry in cache in the case of the alarm fired.  This also fixes the bug which will occured when it start evaluation in debug=True. Whith this bug, the evaluator cannot start evaluation due to failure of generating debug message.  
__label__objective Refactor event-alarm caching  This patch changes the format of alarm definitions cached in the event-alarm evaluator to dict. This reduces complex of the code to find and update the alarm entry in cache in the case of the alarm fired.  This also fixes the bug which will occured when it start evaluation in debug=True. Whith this bug, the evaluator cannot start evaluation due to failure of generating debug message.  
__label__objective Refactor event-alarm caching  This patch changes the format of alarm definitions cached in the event-alarm evaluator to dict. This reduces complex of the code to find and update the alarm entry in cache in the case of the alarm fired.  This also fixes the bug which will occured when it start evaluation in debug=True. Whith this bug, the evaluator cannot start evaluation due to failure of generating debug message.  
__label__quality Add missing params to "Security groups and rules"  This is a bug similar to https://bugs.launchpad.net/openstack-api-site/+bug/1480312, which has been confirmed and its patch has been merged.  "Request parameters" and "Response parameters" tables of "Security groups and rules" are missing "security_group(s)" (xsd:dict). Please see http://developer.openstack.org/api-ref-networking-v2-ext.html#security_groups .  I also fixed some parts where was written as "security_group_rules", but actually should be "security_group_rule".  I did some refactoring in common.ent as well in order to make it easier to maintain.  
__label__objective Add missing params to "Security groups and rules"  This is a bug similar to https://bugs.launchpad.net/openstack-api-site/+bug/1480312, which has been confirmed and its patch has been merged.  "Request parameters" and "Response parameters" tables of "Security groups and rules" are missing "security_group(s)" (xsd:dict). Please see http://developer.openstack.org/api-ref-networking-v2-ext.html#security_groups .  I also fixed some parts where was written as "security_group_rules", but actually should be "security_group_rule".  I did some refactoring in common.ent as well in order to make it easier to maintain.  
__label__objective Add missing params to "Security groups and rules"  This is a bug similar to https://bugs.launchpad.net/openstack-api-site/+bug/1480312, which has been confirmed and its patch has been merged.  "Request parameters" and "Response parameters" tables of "Security groups and rules" are missing "security_group(s)" (xsd:dict). Please see http://developer.openstack.org/api-ref-networking-v2-ext.html#security_groups .  I also fixed some parts where was written as "security_group_rules", but actually should be "security_group_rule".  I did some refactoring in common.ent as well in order to make it easier to maintain.  
__label__integration [MongoDB] Refactor indexes for meter and resources  Currently Ceilometer uses redundant indexes in MongoDB and in same time doesn't cover get_resources sorting by indexes. In this CR source field indexing is deleted and resource.project_id, resource.user_id indexes are combined to one. New compound index covers the get_resource sorting and its parts are used in queries by timestamp, project_id, user_id.  
__label__quality [MongoDB] Refactor indexes for meter and resources  Currently Ceilometer uses redundant indexes in MongoDB and in same time doesn't cover get_resources sorting by indexes. In this CR source field indexing is deleted and resource.project_id, resource.user_id indexes are combined to one. New compound index covers the get_resource sorting and its parts are used in queries by timestamp, project_id, user_id.  
__label__objective [MongoDB] Refactor indexes for meter and resources  Currently Ceilometer uses redundant indexes in MongoDB and in same time doesn't cover get_resources sorting by indexes. In this CR source field indexing is deleted and resource.project_id, resource.user_id indexes are combined to one. New compound index covers the get_resource sorting and its parts are used in queries by timestamp, project_id, user_id.  
__label__testing Refactor verify_list tests  Rework the verify_list testing to put more of the guts into the implementation instead of having a lot of common things passed in arguments.  Additionally, this adds an explicit pagination argument in calls to _list, which is one of the steps we need to take in properly completing the pagination calls per bug #1465756.  Partial-Bug: 1465756  
__label__objective Refactor verify_list tests  Rework the verify_list testing to put more of the guts into the implementation instead of having a lot of common things passed in arguments.  Additionally, this adds an explicit pagination argument in calls to _list, which is one of the steps we need to take in properly completing the pagination calls per bug #1465756.  Partial-Bug: 1465756  
__label__quality Refactor verify_list tests  Rework the verify_list testing to put more of the guts into the implementation instead of having a lot of common things passed in arguments.  Additionally, this adds an explicit pagination argument in calls to _list, which is one of the steps we need to take in properly completing the pagination calls per bug #1465756.  Partial-Bug: 1465756  
__label__objective Refactor verify_list tests  Rework the verify_list testing to put more of the guts into the implementation instead of having a lot of common things passed in arguments.  Additionally, this adds an explicit pagination argument in calls to _list, which is one of the steps we need to take in properly completing the pagination calls per bug #1465756.  Partial-Bug: 1465756  
__label__quality Refactor nova-net cidr validation in prep for bug fix  The network manager create_networks function is on the verge of the "too complex" pep8 check error, so this change refactors the cidr validation code out into a private function in preparation for fixing a bug.  
__label__objective Refactor nova-net cidr validation in prep for bug fix  The network manager create_networks function is on the verge of the "too complex" pep8 check error, so this change refactors the cidr validation code out into a private function in preparation for fixing a bug.  
__label__objective Refactor agent processing and filter alive  There is a bug in Nova that results in VM with unknown IPs. Slave agents for corresponding VMs are useless and must be ignored  
__label__objective Refactor agent processing and filter alive  There is a bug in Nova that results in VM with unknown IPs. Slave agents for corresponding VMs are useless and must be ignored  
__label__objective Fixing a bug in logging logic and small refactoring  * It used to log "Task 'taskName' [RUNNING -> RUNNING, result = 'result'].   Same state twice.  
__label__quality Fixing a bug in logging logic and small refactoring  * It used to log "Task 'taskName' [RUNNING -> RUNNING, result = 'result'].   Same state twice.  
__label__quality Refactoring for export functions in Target object  Currently, export functions such as create_export() are implemented in individual Target code, but most of them are same and these are common features in each target. This patch moves these methods to parent ISCSITarget class to commonalize and each Target simply inherit these methods from parent class. As a result of this change, LioAdm can inherit ISCSITarget class directly instead of inheriting TgtAdm class. This simplifies dependency of targets and improves maintainability.  By refactoring these methods, this patch also fixes following issues.  (a) Fix bug #1410566 After transitioning to the new driver and target model, iscsi_targets is not added to the table during create_export() phase. However, remove_export() in LIO Target is still reffering empty iscsi_targets table. This causes NotFound exception and remove_export() skips to do remove_iscsi_target(). As a result, iscsi target is not removed and the target continues to grab the volume(logical volume) as an in-use status. This patch fix the problem.  (b) Re-export a volume with CHAP Current Tgt Target recreate iscsi target without CHAP during ensure_export() even if the volume is exported with CHAP previously. This patch changes this bahaviour to recreate iscsi target using previous CHAP which is stored in volume file on state_path dir.  (c) Raise correct exception if deleting of iSCSI target is failed terminate_connection in LIO target raises ISCSITargetAttachFailed if deleting of iSCSI target is failed. This should be raised ISCSITargetDetachFailed.  (d) Delete _ensure_iscsi_targets() This methods is dead code in tgt.py after transitioning.  Closes-Bug: 1410566 
__label__objective Refactoring for export functions in Target object  Currently, export functions such as create_export() are implemented in individual Target code, but most of them are same and these are common features in each target. This patch moves these methods to parent ISCSITarget class to commonalize and each Target simply inherit these methods from parent class. As a result of this change, LioAdm can inherit ISCSITarget class directly instead of inheriting TgtAdm class. This simplifies dependency of targets and improves maintainability.  By refactoring these methods, this patch also fixes following issues.  (a) Fix bug #1410566 After transitioning to the new driver and target model, iscsi_targets is not added to the table during create_export() phase. However, remove_export() in LIO Target is still reffering empty iscsi_targets table. This causes NotFound exception and remove_export() skips to do remove_iscsi_target(). As a result, iscsi target is not removed and the target continues to grab the volume(logical volume) as an in-use status. This patch fix the problem.  (b) Re-export a volume with CHAP Current Tgt Target recreate iscsi target without CHAP during ensure_export() even if the volume is exported with CHAP previously. This patch changes this bahaviour to recreate iscsi target using previous CHAP which is stored in volume file on state_path dir.  (c) Raise correct exception if deleting of iSCSI target is failed terminate_connection in LIO target raises ISCSITargetAttachFailed if deleting of iSCSI target is failed. This should be raised ISCSITargetDetachFailed.  (d) Delete _ensure_iscsi_targets() This methods is dead code in tgt.py after transitioning.  Closes-Bug: 1410566 
__label__objective Refactoring for export functions in Target object  Currently, export functions such as create_export() are implemented in individual Target code, but most of them are same and these are common features in each target. This patch moves these methods to parent ISCSITarget class to commonalize and each Target simply inherit these methods from parent class. As a result of this change, LioAdm can inherit ISCSITarget class directly instead of inheriting TgtAdm class. This simplifies dependency of targets and improves maintainability.  By refactoring these methods, this patch also fixes following issues.  (a) Fix bug #1410566 After transitioning to the new driver and target model, iscsi_targets is not added to the table during create_export() phase. However, remove_export() in LIO Target is still reffering empty iscsi_targets table. This causes NotFound exception and remove_export() skips to do remove_iscsi_target(). As a result, iscsi target is not removed and the target continues to grab the volume(logical volume) as an in-use status. This patch fix the problem.  (b) Re-export a volume with CHAP Current Tgt Target recreate iscsi target without CHAP during ensure_export() even if the volume is exported with CHAP previously. This patch changes this bahaviour to recreate iscsi target using previous CHAP which is stored in volume file on state_path dir.  (c) Raise correct exception if deleting of iSCSI target is failed terminate_connection in LIO target raises ISCSITargetAttachFailed if deleting of iSCSI target is failed. This should be raised ISCSITargetDetachFailed.  (d) Delete _ensure_iscsi_targets() This methods is dead code in tgt.py after transitioning.  Closes-Bug: 1410566 
__label__objective Refactor code used to build tree into helpers  Split code up to simplify understanding and make use of helpers. fix minor bug in retreival of parent commits to pass to the read-tree call.  
__label__quality Refactor code used to build tree into helpers  Split code up to simplify understanding and make use of helpers. fix minor bug in retreival of parent commits to pass to the read-tree call.  
__label__objective Refactor code used to build tree into helpers  Split code up to simplify understanding and make use of helpers. fix minor bug in retreival of parent commits to pass to the read-tree call.  
__label__objective [WIP]: UTs refactor  - Easier update resource API; - Easier show resources API; - PRS rules on security groups verification framework; - Fixed bug 1397721  
__label__quality [WIP]: UTs refactor  - Easier update resource API; - Easier show resources API; - PRS rules on security groups verification framework; - Fixed bug 1397721  
__label__refactoring [WIP]: UTs refactor  - Easier update resource API; - Easier show resources API; - PRS rules on security groups verification framework; - Fixed bug 1397721  
__label__quality Refactor generic cleanup mechanism part 1  Current cleanup mechanism is awful. It's hardcoed, without repeat on failures, contains a lot of mistakes, in some places it is too fast (in case of deletion of VMs) in other to slow (like deletion of users). As well there is mix of cleanup mechanism and resource cleanup mechanism. To resolve these all issues this patch introcude a cleanup engine that resolves all issues above. It's resource based, so to add new resouce you should just a make subclass of base.Resource and probably override some of methods like (list, delete, is_deleted) and that's all. All complexity of managing: 0) waiting unit async deletion is finished 1) repeat on failure logic 2) greaceful failure handling 3) parallelization 4) plugin support Is hidden deep inside cleanup engine + bonus we are able to specify now single resource (without clenaping whole service)  PART 1: ------- * Add new generic cleanup engine * Fix bug in broker (queue can be empty because of multithreading access) * Add retry method in rally utils, allow as to repeat few times method on failures  bp benchmark-context-cleanup-refactor  
__label__objective Refactor generic cleanup mechanism part 1  Current cleanup mechanism is awful. It's hardcoed, without repeat on failures, contains a lot of mistakes, in some places it is too fast (in case of deletion of VMs) in other to slow (like deletion of users). As well there is mix of cleanup mechanism and resource cleanup mechanism. To resolve these all issues this patch introcude a cleanup engine that resolves all issues above. It's resource based, so to add new resouce you should just a make subclass of base.Resource and probably override some of methods like (list, delete, is_deleted) and that's all. All complexity of managing: 0) waiting unit async deletion is finished 1) repeat on failure logic 2) greaceful failure handling 3) parallelization 4) plugin support Is hidden deep inside cleanup engine + bonus we are able to specify now single resource (without clenaping whole service)  PART 1: ------- * Add new generic cleanup engine * Fix bug in broker (queue can be empty because of multithreading access) * Add retry method in rally utils, allow as to repeat few times method on failures  bp benchmark-context-cleanup-refactor  
__label__objective Refactor generic cleanup mechanism part 1  Current cleanup mechanism is awful. It's hardcoed, without repeat on failures, contains a lot of mistakes, in some places it is too fast (in case of deletion of VMs) in other to slow (like deletion of users). As well there is mix of cleanup mechanism and resource cleanup mechanism. To resolve these all issues this patch introcude a cleanup engine that resolves all issues above. It's resource based, so to add new resouce you should just a make subclass of base.Resource and probably override some of methods like (list, delete, is_deleted) and that's all. All complexity of managing: 0) waiting unit async deletion is finished 1) repeat on failure logic 2) greaceful failure handling 3) parallelization 4) plugin support Is hidden deep inside cleanup engine + bonus we are able to specify now single resource (without clenaping whole service)  PART 1: ------- * Add new generic cleanup engine * Fix bug in broker (queue can be empty because of multithreading access) * Add retry method in rally utils, allow as to repeat few times method on failures  bp benchmark-context-cleanup-refactor  
__label__objective Add scheduler unit tests to enable bug fixes and refactoring  Improves the coverage for DVR scheduling and will allow safer bug fixes and refactoring in follow-on patches.  
__label__testing Add scheduler unit tests to enable bug fixes and refactoring  Improves the coverage for DVR scheduling and will allow safer bug fixes and refactoring in follow-on patches.  
__label__objective Fix a bug in Mellanox plugin RPC caused by secgroup RPC refactoring  SecurityGroupsRpcCallback RPC refactoring patch (commit 2781fce238) moves get_port_from_device method from plugin RPC callback class to plugin layer, but Mellanox plugin RPC callback was forgot to update and as a result RPC calls from agents to Mellanox plugin fails.  
__label__objective Fix a bug in Mellanox plugin RPC caused by secgroup RPC refactoring  SecurityGroupsRpcCallback RPC refactoring patch (commit 2781fce238) moves get_port_from_device method from plugin RPC callback class to plugin layer, but Mellanox plugin RPC callback was forgot to update and as a result RPC calls from agents to Mellanox plugin fails.  
__label__testing test_autoscaling refactor suspend/resume stubbing  Rework to encapsulate the suspend/resume stubbing in functions and add a stub of the image validation, which is required because the properties get revalidated when we create the events associated with the state transition (ref bug #1324102).  With the current keystoneclient mocking this is not visible in the tests because the error creating the client to do the validation is obscured by the fact that the Event constructor tolerates a validation error and the error creating the client is just treated as an unexpected validation error by the CustomConstraint code.  Moving to a model where clients.keystone() is consistently mocked exposes the fact that we will try to connect to glance on suspend when the event is created if the validation is not correctly stubbed.  Partial-Bug: #1306294  
__label__quality test_autoscaling refactor suspend/resume stubbing  Rework to encapsulate the suspend/resume stubbing in functions and add a stub of the image validation, which is required because the properties get revalidated when we create the events associated with the state transition (ref bug #1324102).  With the current keystoneclient mocking this is not visible in the tests because the error creating the client to do the validation is obscured by the fact that the Event constructor tolerates a validation error and the error creating the client is just treated as an unexpected validation error by the CustomConstraint code.  Moving to a model where clients.keystone() is consistently mocked exposes the fact that we will try to connect to glance on suspend when the event is created if the validation is not correctly stubbed.  Partial-Bug: #1306294  
__label__objective test_autoscaling refactor suspend/resume stubbing  Rework to encapsulate the suspend/resume stubbing in functions and add a stub of the image validation, which is required because the properties get revalidated when we create the events associated with the state transition (ref bug #1324102).  With the current keystoneclient mocking this is not visible in the tests because the error creating the client to do the validation is obscured by the fact that the Event constructor tolerates a validation error and the error creating the client is just treated as an unexpected validation error by the CustomConstraint code.  Moving to a model where clients.keystone() is consistently mocked exposes the fact that we will try to connect to glance on suspend when the event is created if the validation is not correctly stubbed.  Partial-Bug: #1306294  
__label__objective test_autoscaling refactor suspend/resume stubbing  Rework to encapsulate the suspend/resume stubbing in functions and add a stub of the image validation, which is required because the properties get revalidated when we create the events associated with the state transition (ref bug #1324102).  With the current keystoneclient mocking this is not visible in the tests because the error creating the client to do the validation is obscured by the fact that the Event constructor tolerates a validation error and the error creating the client is just treated as an unexpected validation error by the CustomConstraint code.  Moving to a model where clients.keystone() is consistently mocked exposes the fact that we will try to connect to glance on suspend when the event is created if the validation is not correctly stubbed.  Partial-Bug: #1306294  
__label__objective Refactor RedfishVirtualMediaBoot  - Move staticmethods and classmethods to functions, since in py36 we have a bug when ussing unittest.mock [1] The only classmethod we are keeping is `_set_boot_device` since it's used by `DracRedfishVirtualMediaBoot`  [1] https://bugs.python.org/issue23078  
__label__objective Refactor RedfishVirtualMediaBoot  - Move staticmethods and classmethods to functions, since in py36 we have a bug when ussing unittest.mock [1] The only classmethod we are keeping is `_set_boot_device` since it's used by `DracRedfishVirtualMediaBoot`  [1] https://bugs.python.org/issue23078  
__label__refactoring Refactored review processing and tests  Part of bug 1317554  
__label__refactoring Refactoring of vote processing  Part of bug 1317554  
__label__refactoring Refactor logic around selinux bug 1204824  
__label__objective Refactor timestamp existence validation in V2 API  There was a bug in AlarmThresholdRule in v2.py, the timestamp_keys were defined with a missing comma: ['timestamp', 'start', 'start_timestamp' 'end', 'end_timestamp'].  The validation, if the timestamp field is used or not, was unclear in the current implementation. A new parameter, 'timestamp_is_valid', was added to the validation functions to show, if the timestamp is allowed to use or not in the validated query.  Fixes bug 1280975  (cherry picked from commit b1834e55fce08f1536c7d9392ae035b9583be8ed)  
__label__objective Refactor timestamp existence validation in V2 API  There was a bug in AlarmThresholdRule in v2.py, the timestamp_keys were defined with a missing comma: ['timestamp', 'start', 'start_timestamp' 'end', 'end_timestamp'].  The validation, if the timestamp field is used or not, was unclear in the current implementation. A new parameter, 'timestamp_is_valid', was added to the validation functions to show, if the timestamp is allowed to use or not in the validated query.  Fixes bug 1280975  (cherry picked from commit b1834e55fce08f1536c7d9392ae035b9583be8ed)  
__label__testing Refactor usage of custom_match tests  For some requests a check outside of custom_match was used, thus bug #1262534 was not completely closed.  This patch refactors part of the code to use custom_match as far as possible and also adds some more checks.  Closes-Bug: #1262534 
__label__objective Refactor usage of custom_match tests  For some requests a check outside of custom_match was used, thus bug #1262534 was not completely closed.  This patch refactors part of the code to use custom_match as far as possible and also adds some more checks.  Closes-Bug: #1262534 
__label__objective Refactor usage of custom_match tests  For some requests a check outside of custom_match was used, thus bug #1262534 was not completely closed.  This patch refactors part of the code to use custom_match as far as possible and also adds some more checks.  Closes-Bug: #1262534 
__label__quality Cleanup from business logic refactor  This patchset resolves a few minor nits including proper translation of a couple strings in exceptions, order of addCleanup in test_keystoneclient, a simple white-space change to make a line more readable, and adding a bug reference to a comment.  All of these changes are in response to comments on the deletion business logic refactor that moved business logic from the controllers to the *_api managers.  
__label__objective Cleanup from business logic refactor  This patchset resolves a few minor nits including proper translation of a couple strings in exceptions, order of addCleanup in test_keystoneclient, a simple white-space change to make a line more readable, and adding a bug reference to a comment.  All of these changes are in response to comments on the deletion business logic refactor that moved business logic from the controllers to the *_api managers.  
__label__objective Cleanup from business logic refactor  This patchset resolves a few minor nits including proper translation of a couple strings in exceptions, order of addCleanup in test_keystoneclient, a simple white-space change to make a line more readable, and adding a bug reference to a comment.  All of these changes are in response to comments on the deletion business logic refactor that moved business logic from the controllers to the *_api managers.  
__label__objective Record updater refactoring  Moved together code that updates records after default data changed and code that called during data pulling. Removed unnecessary code.  Part of bug 1260696  
__label__quality Record updater refactoring  Moved together code that updates records after default data changed and code that called during data pulling. Removed unnecessary code.  Part of bug 1260696  
__label__refactoring Record updater refactoring  Moved together code that updates records after default data changed and code that called during data pulling. Removed unnecessary code.  Part of bug 1260696  
__label__quality Refactor configuring of floating ips on a router.  This approach to configuring floating ips is stateless and idempotent. This allows it to handle corner cases, such as reusing a floating ip address with a different floating ip id in a way that is easier to understand.  The concept is to wipe the floating ips clean and rebuild them each time with the following optimizations.  To avoid bad performance in manipulating iptables, it is called in the context of a call to defer_apply_on.  To avoid a disruption in network flow a set difference is use to determine the set of addresses that no longer belong on the inteface rather than removing them all blindly.  Fixes: Bug #1209011  Conflicts:          neutron/tests/unit/test_l3_agent.py  
__label__objective Refactor configuring of floating ips on a router.  This approach to configuring floating ips is stateless and idempotent. This allows it to handle corner cases, such as reusing a floating ip address with a different floating ip id in a way that is easier to understand.  The concept is to wipe the floating ips clean and rebuild them each time with the following optimizations.  To avoid bad performance in manipulating iptables, it is called in the context of a call to defer_apply_on.  To avoid a disruption in network flow a set difference is use to determine the set of addresses that no longer belong on the inteface rather than removing them all blindly.  Fixes: Bug #1209011  Conflicts:          neutron/tests/unit/test_l3_agent.py  
__label__objective Refactor configuring of floating ips on a router.  This approach to configuring floating ips is stateless and idempotent. This allows it to handle corner cases, such as reusing a floating ip address with a different floating ip id in a way that is easier to understand.  The concept is to wipe the floating ips clean and rebuild them each time with the following optimizations.  To avoid bad performance in manipulating iptables, it is called in the context of a call to defer_apply_on.  To avoid a disruption in network flow a set difference is use to determine the set of addresses that no longer belong on the inteface rather than removing them all blindly.  Fixes: Bug #1209011  Conflicts:          neutron/tests/unit/test_l3_agent.py  
__label__quality Refactor configuring of floating ips on a router.  This approach to configuring floating ips is stateless and idempotent. This allows it to handle corner cases, such as reusing a floating ip address with a different floating ip id in a way that is easier to understand.  The concept is to wipe the floating ips clean and rebuild them each time with the following optimizations.  To avoid bad performance in manipulating iptables, it is called in the context of a call to defer_apply_on.  To avoid a disruption in network flow a set difference is use to determine the set of addresses that no longer belong on the inteface rather than removing them all blindly.  
__label__objective Refactor configuring of floating ips on a router.  This approach to configuring floating ips is stateless and idempotent. This allows it to handle corner cases, such as reusing a floating ip address with a different floating ip id in a way that is easier to understand.  The concept is to wipe the floating ips clean and rebuild them each time with the following optimizations.  To avoid bad performance in manipulating iptables, it is called in the context of a call to defer_apply_on.  To avoid a disruption in network flow a set difference is use to determine the set of addresses that no longer belong on the inteface rather than removing them all blindly.  
__label__objective Refactor configuring of floating ips on a router.  This approach to configuring floating ips is stateless and idempotent. This allows it to handle corner cases, such as reusing a floating ip address with a different floating ip id in a way that is easier to understand.  The concept is to wipe the floating ips clean and rebuild them each time with the following optimizations.  To avoid bad performance in manipulating iptables, it is called in the context of a call to defer_apply_on.  To avoid a disruption in network flow a set difference is use to determine the set of addresses that no longer belong on the inteface rather than removing them all blindly.  
__label__quality Refactor API error handling  Refactor the API error handling to ensure error messages are translated. Since wsme 0.5b6, the error message doesn't need to be converted to unicode, wsme handles it for us.  Related bug #1200518  
__label__objective Refactor API error handling  Refactor the API error handling to ensure error messages are translated. Since wsme 0.5b6, the error message doesn't need to be converted to unicode, wsme handles it for us.  Related bug #1200518  
__label__refactoring xenapi: refactor: move UpdateGlanceImage to common  During the review of https://review.openstack.org/41651 it was recommended to move UpdateGlanceImage to a common library. A bug was filed to deal with the refactors. This change fixes the first part.  Fixes bug 1220596  
__label__objective xenapi: refactor: move UpdateGlanceImage to common  During the review of https://review.openstack.org/41651 it was recommended to move UpdateGlanceImage to a common library. A bug was filed to deal with the refactors. This change fixes the first part.  Fixes bug 1220596  
__label__objective xenapi: refactor: move UpdateGlanceImage to common  During the review of https://review.openstack.org/41651 it was recommended to move UpdateGlanceImage to a common library. A bug was filed to deal with the refactors. This change fixes the first part.  Fixes bug 1220596  
__label__objective Colorize Neutron log output and refactor log setup code  Bug 1214616  This patch adds colors to on-screen Neutron log output in the same way nova, cinder, and heat engine do. To this aim, logging configuration instructions are moved into ./functions. The reason for this refactoring is that these instruction are the same for each project, with the only exception of the target configuration file.  
__label__objective Colorize Neutron log output and refactor log setup code  Bug 1214616  This patch adds colors to on-screen Neutron log output in the same way nova, cinder, and heat engine do. To this aim, logging configuration instructions are moved into ./functions. The reason for this refactoring is that these instruction are the same for each project, with the only exception of the target configuration file.  
__label__objective JSON API refactoring  * Introduced json decorator * Changed signatures of API URIs * Extract common js code into separate static file   * Move all renderers (chart, table, timeline)   * Move common functions  Resolves bug 1221185  
__label__integration JSON API refactoring  * Introduced json decorator * Changed signatures of API URIs * Extract common js code into separate static file   * Move all renderers (chart, table, timeline)   * Move common functions  Resolves bug 1221185  
__label__quality JSON API refactoring  * Introduced json decorator * Changed signatures of API URIs * Extract common js code into separate static file   * Move all renderers (chart, table, timeline)   * Move common functions  Resolves bug 1221185  
__label__quality Refactor BigSwitch error handling to use db rollbacks  This patch adjusts most of the logic handling the calls to the controller in the BigSwitch/floodlight plugin to make use of the db rollbacks from sqlalchemy for free on exceptions. This eliminates several complex try-except blocks and makes maintaining db<->controller consistency easier.  Fixes: bug #1215823 
__label__objective Refactor BigSwitch error handling to use db rollbacks  This patch adjusts most of the logic handling the calls to the controller in the BigSwitch/floodlight plugin to make use of the db rollbacks from sqlalchemy for free on exceptions. This eliminates several complex try-except blocks and makes maintaining db<->controller consistency easier.  Fixes: bug #1215823 
__label__testing Api V2 post sample refactoring  Refactoring of the post sample rest api to set the correct source in the publisher context. The content of the pipeline is now checked The admin role case is now tested  Fixes bug #1202689 Fixes bug #1204593  
__label__quality Api V2 post sample refactoring  Refactoring of the post sample rest api to set the correct source in the publisher context. The content of the pipeline is now checked The admin role case is now tested  Fixes bug #1202689 Fixes bug #1204593  
__label__objective Api V2 post sample refactoring  Refactoring of the post sample rest api to set the correct source in the publisher context. The content of the pipeline is now checked The admin role case is now tested  Fixes bug #1202689 Fixes bug #1204593  
__label__objective Revert "Refactor configuring of floating ips on a router."  This patch breaks gating job. Because nat rule for metadata will be only added on the router_add. Revert it for now.  Fixes bug 1211829 This reverts commit 9382ee659212285a203550cf60476dd146d27a29.  
__label__objective Revert "Refactor configuring of floating ips on a router."  This patch breaks gating job. Because nat rule for metadata will be only added on the router_add. Revert it for now.  Fixes bug 1211829 This reverts commit 9382ee659212285a203550cf60476dd146d27a29.  
__label__quality refactor/unify driver version strings  This patch updates each driver to provide the same mechanism for reporting the version of the driver.  It also includes fixing the reported driver version at get_volume_stats() time to be the version set in the driver.  When the manager starts the driver it now logs the driver's name and version in the log file.  fixes Bug #1212878  
__label__objective refactor/unify driver version strings  This patch updates each driver to provide the same mechanism for reporting the version of the driver.  It also includes fixing the reported driver version at get_volume_stats() time to be the version set in the driver.  When the manager starts the driver it now logs the driver's name and version in the log file.  fixes Bug #1212878  
__label__objective refactor/unify driver version strings  This patch updates each driver to provide the same mechanism for reporting the version of the driver.  It also includes fixing the reported driver version at get_volume_stats() time to be the version set in the driver.  When the manager starts the driver it now logs the driver's name and version in the log file.  fixes Bug #1212878  
__label__quality Refactor configuring of floating ips on a router.  This approach to configuring floating ips is stateless and idempotent. This allows it to handle corner cases, such as reusing a floating ip address with a different floating ip id in a way that is easier to understand.  The concept is to wipe the floating ips clean and rebuild them each time with the following optimizations.  To avoid bad performance in manipulating iptables, it is called in the context of a call to defer_apply_on.  To avoid a disruption in network flow a set difference is use to determine the set of addresses that no longer belong on the inteface rather than removing them all blindly.  
__label__objective Refactor configuring of floating ips on a router.  This approach to configuring floating ips is stateless and idempotent. This allows it to handle corner cases, such as reusing a floating ip address with a different floating ip id in a way that is easier to understand.  The concept is to wipe the floating ips clean and rebuild them each time with the following optimizations.  To avoid bad performance in manipulating iptables, it is called in the context of a call to defer_apply_on.  To avoid a disruption in network flow a set difference is use to determine the set of addresses that no longer belong on the inteface rather than removing them all blindly.  
__label__objective Refactor configuring of floating ips on a router.  This approach to configuring floating ips is stateless and idempotent. This allows it to handle corner cases, such as reusing a floating ip address with a different floating ip id in a way that is easier to understand.  The concept is to wipe the floating ips clean and rebuild them each time with the following optimizations.  To avoid bad performance in manipulating iptables, it is called in the context of a call to defer_apply_on.  To avoid a disruption in network flow a set difference is use to determine the set of addresses that no longer belong on the inteface rather than removing them all blindly.  
__label__refactoring Port policy from oslo and refactor heat policy  Fixes bug #1192551  
__label__objective Port policy from oslo and refactor heat policy  Fixes bug #1192551  
__label__quality refactor port binding codes  Bug #1195047  This patch: 1. removes the iteration in get_ports to call extend_dict_binding 2. uses a unified way for plugins to do this kind of stuff  ml2 will enhance the binding so that it can have different binding for port according to port's host. mlnx is also an exception due to the dynamic binding info.  
__label__objective refactor port binding codes  Bug #1195047  This patch: 1. removes the iteration in get_ports to call extend_dict_binding 2. uses a unified way for plugins to do this kind of stuff  ml2 will enhance the binding so that it can have different binding for port according to port's host. mlnx is also an exception due to the dynamic binding info.  
__label__objective refactor port binding codes  Bug #1195047  This patch: 1. removes the iteration in get_ports to call extend_dict_binding 2. uses a unified way for plugins to do this kind of stuff  ml2 will enhance the binding so that it can have different binding for port according to port's host. mlnx is also an exception due to the dynamic binding info.  
__label__quality Refactor SSHPool.get() with Pool.get()  In previous code of SSHPool.get(), we pasted the code from Pool.get() and check if a connection is active before return it.  However, it's much simpler and cleaner to just call the Pool.get() and then check the connection before return. With this,we can free from manually keeping up with code of Pool.get() in upstream package eventlet  as a side effect, this patch fixed bug #1194393 due to the bug in eventlet code before revision 1072(and also previous code in utils.py)  
__label__objective Refactor SSHPool.get() with Pool.get()  In previous code of SSHPool.get(), we pasted the code from Pool.get() and check if a connection is active before return it.  However, it's much simpler and cleaner to just call the Pool.get() and then check the connection before return. With this,we can free from manually keeping up with code of Pool.get() in upstream package eventlet  as a side effect, this patch fixed bug #1194393 due to the bug in eventlet code before revision 1072(and also previous code in utils.py)  
__label__objective Refactor SSHPool.get() with Pool.get()  In previous code of SSHPool.get(), we pasted the code from Pool.get() and check if a connection is active before return it.  However, it's much simpler and cleaner to just call the Pool.get() and then check the connection before return. With this,we can free from manually keeping up with code of Pool.get() in upstream package eventlet  as a side effect, this patch fixed bug #1194393 due to the bug in eventlet code before revision 1072(and also previous code in utils.py)  
__label__quality Refactoring url_for to remove admin parameter  Removed unused admin parameter that was unused and removed tests that were no longer necessary.  Added an option configuration setting SECONDARY_ENDPOINT_TYPE that will be attempted if the OPENSTACK_ENDPOINT_TYPE does not exist in the service catalog for the desired service.  The primary use case for this fix is in cloud configurations where Keystone does not return all endpoint types for each service, and only does so based on the user's privilege level.  Example use case would be set OPENSTACK_ENDPOINT_TYPE to 'adminURL' and set SECONDARY_ENDPOINT_TYPE to 'publicURL'.  If adminURL is not available to the user, then they get the publicURL back.  If SECONDARY_ENDPOINT_TYPE is not set in the settings, then the current behavior is maintained.  Fixes: bug #1186379  
__label__objective Refactoring url_for to remove admin parameter  Removed unused admin parameter that was unused and removed tests that were no longer necessary.  Added an option configuration setting SECONDARY_ENDPOINT_TYPE that will be attempted if the OPENSTACK_ENDPOINT_TYPE does not exist in the service catalog for the desired service.  The primary use case for this fix is in cloud configurations where Keystone does not return all endpoint types for each service, and only does so based on the user's privilege level.  Example use case would be set OPENSTACK_ENDPOINT_TYPE to 'adminURL' and set SECONDARY_ENDPOINT_TYPE to 'publicURL'.  If adminURL is not available to the user, then they get the publicURL back.  If SECONDARY_ENDPOINT_TYPE is not set in the settings, then the current behavior is maintained.  Fixes: bug #1186379  
__label__objective Refactoring url_for to remove admin parameter  Removed unused admin parameter that was unused and removed tests that were no longer necessary.  Added an option configuration setting SECONDARY_ENDPOINT_TYPE that will be attempted if the OPENSTACK_ENDPOINT_TYPE does not exist in the service catalog for the desired service.  The primary use case for this fix is in cloud configurations where Keystone does not return all endpoint types for each service, and only does so based on the user's privilege level.  Example use case would be set OPENSTACK_ENDPOINT_TYPE to 'adminURL' and set SECONDARY_ENDPOINT_TYPE to 'publicURL'.  If adminURL is not available to the user, then they get the publicURL back.  If SECONDARY_ENDPOINT_TYPE is not set in the settings, then the current behavior is maintained.  Fixes: bug #1186379  
__label__objective Refactoring url_for to remove admin parameter  Removed unused admin parameter that was unused and removed tests that were no longer necessary.  Added an option configuration setting SECONDARY_ENDPOINT_TYPE that will be attempted if the OPENSTACK_ENDPOINT_TYPE does not exist in the service catalog for the desired service.  The primary use case for this fix is in cloud configurations where Keystone does not return all endpoint types for each service, and only does so based on the user's privilege level.  Example use case would be set OPENSTACK_ENDPOINT_TYPE to 'adminURL' and set SECONDARY_ENDPOINT_TYPE to 'publicURL'.  If adminURL is not available to the user, then they get the publicURL back.  If SECONDARY_ENDPOINT_TYPE is not set in the settings, then the current behavior is maintained.  Fixes: bug #1186379  
__label__quality Refactor reschedule in exception handling of volume manager  In some cases, exception is caught in volume manager but the recode cannot be retrieved by sys.exc_info(). This patch attempts to refactor some part of exception handling in create_volume(), as well as the reschedule_and_reraise() funtion, so that above corner case is handled.  Also fixed a bug in unittest which didn't provide correct argument to db API but previously this exception has been wrongly consumed by volume manager's exception handling.  Partially fix bug: 1197648  
__label__objective Refactor reschedule in exception handling of volume manager  In some cases, exception is caught in volume manager but the recode cannot be retrieved by sys.exc_info(). This patch attempts to refactor some part of exception handling in create_volume(), as well as the reschedule_and_reraise() funtion, so that above corner case is handled.  Also fixed a bug in unittest which didn't provide correct argument to db API but previously this exception has been wrongly consumed by volume manager's exception handling.  Partially fix bug: 1197648  
__label__objective Refactor reschedule in exception handling of volume manager  In some cases, exception is caught in volume manager but the recode cannot be retrieved by sys.exc_info(). This patch attempts to refactor some part of exception handling in create_volume(), as well as the reschedule_and_reraise() funtion, so that above corner case is handled.  Also fixed a bug in unittest which didn't provide correct argument to db API but previously this exception has been wrongly consumed by volume manager's exception handling.  Partially fix bug: 1197648  
__label__quality Refactored active/passive section of HA guide  As part of the restructuring of the HA guide to include active/active, the original active/passive page files are now renamed to be prefaced with "ap-" to distinguish them from the active/active pages, prefaced with "aa-". The main ha-guide.txt file has also been edited to reflect this change.  bug 1196096 blueprint improve-high-availability-support  
__label__objective Refactored active/passive section of HA guide  As part of the restructuring of the HA guide to include active/active, the original active/passive page files are now renamed to be prefaced with "ap-" to distinguish them from the active/active pages, prefaced with "aa-". The main ha-guide.txt file has also been edited to reflect this change.  bug 1196096 blueprint improve-high-availability-support  
__label__objective Refactored active/passive section of HA guide  As part of the restructuring of the HA guide to include active/active, the original active/passive page files are now renamed to be prefaced with "ap-" to distinguish them from the active/active pages, prefaced with "aa-". The main ha-guide.txt file has also been edited to reflect this change.  bug 1196096 blueprint improve-high-availability-support  
__label__refactoring Refactor KombuStubs fixture.  Fixes bug 1192924.  
__label__objective Refactor KombuStubs fixture.  Fixes bug 1192924.  
__label__refactoring Refactors get_instance_security_groups to only use instance_uuid  Fixes Bug 1160078  
__label__objective Refactors get_instance_security_groups to only use instance_uuid  Fixes Bug 1160078  
__label__quality Refactor db_base_plugin_v2 and to remove code duplication  fixes bug 1104379  Introduce CommonDbMixin which includes utility methods to manipulate model queries.  
__label__objective Refactor db_base_plugin_v2 and to remove code duplication  fixes bug 1104379  Introduce CommonDbMixin which includes utility methods to manipulate model queries.  
__label__quality refactor test_engine_service.py  refactor tests based on stackServiceTestBase to be more like the other tests, ie clear mocking, validation, and just inherit from HeatTestCase rather than inheriting lots of stuff from a base class, which isn't needed for all the tests  Fixes bug #1180375  
__label__testing refactor test_engine_service.py  refactor tests based on stackServiceTestBase to be more like the other tests, ie clear mocking, validation, and just inherit from HeatTestCase rather than inheriting lots of stuff from a base class, which isn't needed for all the tests  Fixes bug #1180375  
__label__objective refactor test_engine_service.py  refactor tests based on stackServiceTestBase to be more like the other tests, ie clear mocking, validation, and just inherit from HeatTestCase rather than inheriting lots of stuff from a base class, which isn't needed for all the tests  Fixes bug #1180375  
__label__objective refactor test_engine_service.py  refactor tests based on stackServiceTestBase to be more like the other tests, ie clear mocking, validation, and just inherit from HeatTestCase rather than inheriting lots of stuff from a base class, which isn't needed for all the tests  Fixes bug #1180375  
__label__quality Refactor nova.volume.cinder.API to reduce roundtrips with Cinder  Make cinder.API methods accept volume_id instead of the whole volume object. This will remove redundant roundtrip to get the volume before passing it to other methods as in fact they only need the id.  Fixes bug 1172297  
__label__objective Refactor nova.volume.cinder.API to reduce roundtrips with Cinder  Make cinder.API methods accept volume_id instead of the whole volume object. This will remove redundant roundtrip to get the volume before passing it to other methods as in fact they only need the id.  Fixes bug 1172297  
__label__objective Refactor nova.volume.cinder.API to reduce roundtrips with Cinder  Make cinder.API methods accept volume_id instead of the whole volume object. This will remove redundant roundtrip to get the volume before passing it to other methods as in fact they only need the id.  Fixes bug 1172297  
__label__refactoring a minor refactor in wsgi.py  a minor refactor to move the code up in the file as suggested by termie and henry regarding the review comments in https://review.openstack.org/#/c/26487/  Fix bug 1166697  
__label__objective a minor refactor in wsgi.py  a minor refactor to move the code up in the file as suggested by termie and henry regarding the review comments in https://review.openstack.org/#/c/26487/  Fix bug 1166697  
__label__objective Refactor the quotas tests  Refactoring as part of bug 1157950 to limit the amount of copy-pasting required when adding a new quota  
__label__testing Refactor the quotas tests  Refactoring as part of bug 1157950 to limit the amount of copy-pasting required when adding a new quota  
__label__quality Refactor the quotas tests  Refactoring as part of bug 1157950 to limit the amount of copy-pasting required when adding a new quota  
__label__integration Refactor db.service_destroy and db.service_update methods  Remove session parameter from db.service_get method  Optimize db.service_destroy: Was: 1 request with join to get service with compute_node 1 request to delete service 1(0) to delete compute_node Now: 1 request (without join) to delete service 1 request to delete compute_node  Optimize db.service_update: Remove unused join.  Fixes bug 1157442  blueprint db-session-cleanup  
__label__quality Refactor db.service_destroy and db.service_update methods  Remove session parameter from db.service_get method  Optimize db.service_destroy: Was: 1 request with join to get service with compute_node 1 request to delete service 1(0) to delete compute_node Now: 1 request (without join) to delete service 1 request to delete compute_node  Optimize db.service_update: Remove unused join.  Fixes bug 1157442  blueprint db-session-cleanup  
__label__objective Refactor db.service_destroy and db.service_update methods  Remove session parameter from db.service_get method  Optimize db.service_destroy: Was: 1 request with join to get service with compute_node 1 request to delete service 1(0) to delete compute_node Now: 1 request (without join) to delete service 1 request to delete compute_node  Optimize db.service_update: Remove unused join.  Fixes bug 1157442  blueprint db-session-cleanup  
__label__quality Resize/Migrate refactoring fixes  This patch will fix the construction of an scp command to be joined on spaces. Also adds a parameter in driver.finish_migration to _create_lpar_instance(), some refactoring that needed to be done in order to launch the instance on the destination host. This patch fixes Bug #1153599.  Bug #1153599 
__label__objective Resize/Migrate refactoring fixes  This patch will fix the construction of an scp command to be joined on spaces. Also adds a parameter in driver.finish_migration to _create_lpar_instance(), some refactoring that needed to be done in order to launch the instance on the destination host. This patch fixes Bug #1153599.  Bug #1153599 
__label__objective Resize/Migrate refactoring fixes  This patch will fix the construction of an scp command to be joined on spaces. Also adds a parameter in driver.finish_migration to _create_lpar_instance(), some refactoring that needed to be done in order to launch the instance on the destination host. This patch fixes Bug #1153599.  Bug #1153599 
__label__quality Refactor db tests to ensure that notdb driver is used.  Resolves bug 1076023 by refactoring to ensure that the notdb driver is used for these tests.  
__label__objective Refactor db tests to ensure that notdb driver is used.  Resolves bug 1076023 by refactoring to ensure that the notdb driver is used for these tests.  
__label__quality Refactor compute manager _get_instances_by_driver  Make the method more efficient by only querying nova-conductor once. Also limit fallback instance query to host only. This is in preparation for fixing bug 1129519.  
__label__objective Refactor compute manager _get_instances_by_driver  Make the method more efficient by only querying nova-conductor once. Also limit fallback instance query to host only. This is in preparation for fixing bug 1129519.  
__label__objective Refactor compute manager _get_instances_by_driver  Make the method more efficient by only querying nova-conductor once. Also limit fallback instance query to host only. This is in preparation for fixing bug 1129519.  
__label__quality refactor LoadBalancerPluginDbTestCase setUp()  fixes bug: 1129417  This fixes the bug by changing LoadBalancerPluginDbTestCase to inherit from test_db_plugin.QuantumDbPluginV2TestCase.  This allows for the plugin to access context managers for core resources.  Additionally, this change adds subresource and service_plugin support to QuantumDbPluginV2TestCase.  
__label__objective refactor LoadBalancerPluginDbTestCase setUp()  fixes bug: 1129417  This fixes the bug by changing LoadBalancerPluginDbTestCase to inherit from test_db_plugin.QuantumDbPluginV2TestCase.  This allows for the plugin to access context managers for core resources.  Additionally, this change adds subresource and service_plugin support to QuantumDbPluginV2TestCase.  
__label__objective refactor LoadBalancerPluginDbTestCase setUp()  fixes bug: 1129417  This fixes the bug by changing LoadBalancerPluginDbTestCase to inherit from test_db_plugin.QuantumDbPluginV2TestCase.  This allows for the plugin to access context managers for core resources.  Additionally, this change adds subresource and service_plugin support to QuantumDbPluginV2TestCase.  
__label__quality Refactor nwfilter parameters  * libvirt < 1.0.1 does not allow dynamically updating filter   parameters inside an interface block of theinstance XML. To   address this we move the nwfilter paramters from the instance   XML to the per-instance base nwfilter.  Relates to bug #1124722  
__label__objective Refactor nwfilter parameters  * libvirt < 1.0.1 does not allow dynamically updating filter   parameters inside an interface block of theinstance XML. To   address this we move the nwfilter paramters from the instance   XML to the per-instance base nwfilter.  Relates to bug #1124722  
__label__objective Refactor nwfilter parameters  * libvirt < 1.0.1 does not allow dynamically updating filter   parameters inside an interface block of theinstance XML. To   address this we move the nwfilter paramters from the instance   XML to the per-instance base nwfilter.  Relates to bug #1124722  
__label__testing refactored data upgrade tests in test_migrations  The one off testing in test_migrations was starting to get obtuse enough that it was possible for bugs to slip through (which they did already). Create a more general framework for testing data transitions at any db migration.  Hook the walk_versions code so as we are about to upgrade to a migration point, attempt to run a _prerun_### function, then follow it up with a _check_### function afterwards. Create some utility functions to make doing things in these _prerun and _check functions pretty concise.  This makes these checks db independent, and has it so they'll run however we are running the walk_versions.  In doing so, this uncovered a bug in the 147 migration, which is fixed inline. There is no retroactive fix, as 147 was destructive to data, so would have nuked anyone that hit it already.  Partially implements blueprint migration-testing-with-data  
__label__objective refactored data upgrade tests in test_migrations  The one off testing in test_migrations was starting to get obtuse enough that it was possible for bugs to slip through (which they did already). Create a more general framework for testing data transitions at any db migration.  Hook the walk_versions code so as we are about to upgrade to a migration point, attempt to run a _prerun_### function, then follow it up with a _check_### function afterwards. Create some utility functions to make doing things in these _prerun and _check functions pretty concise.  This makes these checks db independent, and has it so they'll run however we are running the walk_versions.  In doing so, this uncovered a bug in the 147 migration, which is fixed inline. There is no retroactive fix, as 147 was destructive to data, so would have nuked anyone that hit it already.  Partially implements blueprint migration-testing-with-data  
__label__quality refactored data upgrade tests in test_migrations  The one off testing in test_migrations was starting to get obtuse enough that it was possible for bugs to slip through (which they did already). Create a more general framework for testing data transitions at any db migration.  Hook the walk_versions code so as we are about to upgrade to a migration point, attempt to run a _prerun_### function, then follow it up with a _check_### function afterwards. Create some utility functions to make doing things in these _prerun and _check functions pretty concise.  This makes these checks db independent, and has it so they'll run however we are running the walk_versions.  In doing so, this uncovered a bug in the 147 migration, which is fixed inline. There is no retroactive fix, as 147 was destructive to data, so would have nuked anyone that hit it already.  Partially implements blueprint migration-testing-with-data  
__label__objective refactored data upgrade tests in test_migrations  The one off testing in test_migrations was starting to get obtuse enough that it was possible for bugs to slip through (which they did already). Create a more general framework for testing data transitions at any db migration.  Hook the walk_versions code so as we are about to upgrade to a migration point, attempt to run a _prerun_### function, then follow it up with a _check_### function afterwards. Create some utility functions to make doing things in these _prerun and _check functions pretty concise.  This makes these checks db independent, and has it so they'll run however we are running the walk_versions.  In doing so, this uncovered a bug in the 147 migration, which is fixed inline. There is no retroactive fix, as 147 was destructive to data, so would have nuked anyone that hit it already.  Partially implements blueprint migration-testing-with-data  
__label__objective refactored data upgrade tests in test_migrations  The one off testing in test_migrations was starting to get obtuse enough that it was possible for bugs to slip through (which they did already). Create a more general framework for testing data transitions at any db migration.  Hook the walk_versions code so as we are about to upgrade to a migration point, attempt to run a _prerun_### function, then follow it up with a _check_### function afterwards. Create some utility functions to make doing things in these _prerun and _check functions pretty concise.  This makes these checks db independent, and has it so they'll run however we are running the walk_versions.  In doing so, this uncovered a bug in the 147 migration, which is fixed inline. There is no retroactive fix, as 147 was destructive to data, so would have nuked anyone that hit it already.  Partially implements blueprint migration-testing-with-data  
__label__quality lib/quantum: rafactor quantum plugins and third party  As quantum plugin support is coming like floodlight, nvp and nec, it's worth while to refactor quantum plugin logic so that each plugin can be modified/enhanced without intervening other quantum plugin. And new plugin support can be added easily (hopefully) without modifying core logic.  And refactored rpc backend configuration logic at the same time with a minor bug fix.  
__label__objective lib/quantum: rafactor quantum plugins and third party  As quantum plugin support is coming like floodlight, nvp and nec, it's worth while to refactor quantum plugin logic so that each plugin can be modified/enhanced without intervening other quantum plugin. And new plugin support can be added easily (hopefully) without modifying core logic.  And refactored rpc backend configuration logic at the same time with a minor bug fix.  
__label__objective lib/quantum: rafactor quantum plugins and third party  As quantum plugin support is coming like floodlight, nvp and nec, it's worth while to refactor quantum plugin logic so that each plugin can be modified/enhanced without intervening other quantum plugin. And new plugin support can be added easily (hopefully) without modifying core logic.  And refactored rpc backend configuration logic at the same time with a minor bug fix.  
__label__objective Refactor nova.conf docs so they also appear in install guide.  Fixes bug https://bugs.launchpad.net/openstack-manuals/+bug/1043935  Cherry-picked from https://review.openstack.org/17293  This is an old commit that never got backported into folsom.  
__label__quality Refactor nova.conf docs so they also appear in install guide.  Fixes bug https://bugs.launchpad.net/openstack-manuals/+bug/1043935  Cherry-picked from https://review.openstack.org/17293  This is an old commit that never got backported into folsom.  
__label__objective Refactor nova.conf docs so they also appear in install guide.  Fixes bug https://bugs.launchpad.net/openstack-manuals/+bug/1043935  Cherry-picked from https://review.openstack.org/17293  This is an old commit that never got backported into folsom.  
__label__quality Refactor rpc backend configuration logic  This commit also changes the following: - Fixes Nova QPID module path - Fixes a bug Cinder ZeroMQ RPC points to nova module - Adds ZeroMQ setting for Heat RPC  This work is based on the work by Isaku Yamahata <yamahata@valinux.co.jp> in https://review.openstack.org/#/c/19074/.  
__label__objective Refactor rpc backend configuration logic  This commit also changes the following: - Fixes Nova QPID module path - Fixes a bug Cinder ZeroMQ RPC points to nova module - Adds ZeroMQ setting for Heat RPC  This work is based on the work by Isaku Yamahata <yamahata@valinux.co.jp> in https://review.openstack.org/#/c/19074/.  
__label__objective Refactor rpc backend configuration logic  This commit also changes the following: - Fixes Nova QPID module path - Fixes a bug Cinder ZeroMQ RPC points to nova module - Adds ZeroMQ setting for Heat RPC  This work is based on the work by Isaku Yamahata <yamahata@valinux.co.jp> in https://review.openstack.org/#/c/19074/.  
__label__objective refactor QuotaV2 import to match to other exts  fixes bug 1096486  The previous code used a special extension loading mechanism to selectively load the Quota model is the plugin matched and object path. This was intended to load models required by plugins, but this loading actually occurred after the db schema was created, so the model was not always loaded.  This fix refactors the code to make the QuotaV2 ext behave similarly to the other extensions ensuring the models are loaded prior to database schema creation.  
__label__integration refactor QuotaV2 import to match to other exts  fixes bug 1096486  The previous code used a special extension loading mechanism to selectively load the Quota model is the plugin matched and object path. This was intended to load models required by plugins, but this loading actually occurred after the db schema was created, so the model was not always loaded.  This fix refactors the code to make the QuotaV2 ext behave similarly to the other extensions ensuring the models are loaded prior to database schema creation.  
__label__objective refactor QuotaV2 import to match to other exts  fixes bug 1096486  The previous code used a special extension loading mechanism to selectively load the Quota model is the plugin matched and object path. This was intended to load models required by plugins, but this loading actually occurred after the db schema was created, so the model was not always loaded.  This fix refactors the code to make the QuotaV2 ext behave similarly to the other extensions ensuring the models are loaded prior to database schema creation.  
__label__quality Refactor periodic tasks.  This review allows periodic tasks to be enabled or disabled in the decorator, as well as by specifying an interval which is negative.  The spacing between runs of a periodic task is now specified in seconds, with zero meaning the default spacing which is currently 60 seconds.  I also remove the periodic_interval flag to services, as the interval between runs is now dynamic based on the number of seconds that a periodic task wants to wait for its next run. For callers who want to twiddle the sleep period (for example unit tests), there is a create() argument periodic_interval_max which lets the period periodic_tasks() specifies be overridden. This is not exposed as a flag because I cannot see a use case for that. It is needed for unit testing however.  DocImpact. Resolves bug 939087.  
__label__objective Refactor periodic tasks.  This review allows periodic tasks to be enabled or disabled in the decorator, as well as by specifying an interval which is negative.  The spacing between runs of a periodic task is now specified in seconds, with zero meaning the default spacing which is currently 60 seconds.  I also remove the periodic_interval flag to services, as the interval between runs is now dynamic based on the number of seconds that a periodic task wants to wait for its next run. For callers who want to twiddle the sleep period (for example unit tests), there is a create() argument periodic_interval_max which lets the period periodic_tasks() specifies be overridden. This is not exposed as a flag because I cannot see a use case for that. It is needed for unit testing however.  DocImpact. Resolves bug 939087.  
__label__testing Refactor periodic tasks.  This review allows periodic tasks to be enabled or disabled in the decorator, as well as by specifying an interval which is negative.  The spacing between runs of a periodic task is now specified in seconds, with zero meaning the default spacing which is currently 60 seconds.  I also remove the periodic_interval flag to services, as the interval between runs is now dynamic based on the number of seconds that a periodic task wants to wait for its next run. For callers who want to twiddle the sleep period (for example unit tests), there is a create() argument periodic_interval_max which lets the period periodic_tasks() specifies be overridden. This is not exposed as a flag because I cannot see a use case for that. It is needed for unit testing however.  DocImpact. Resolves bug 939087.  
__label__objective Refactor periodic tasks.  This review allows periodic tasks to be enabled or disabled in the decorator, as well as by specifying an interval which is negative.  The spacing between runs of a periodic task is now specified in seconds, with zero meaning the default spacing which is currently 60 seconds.  I also remove the periodic_interval flag to services, as the interval between runs is now dynamic based on the number of seconds that a periodic task wants to wait for its next run. For callers who want to twiddle the sleep period (for example unit tests), there is a create() argument periodic_interval_max which lets the period periodic_tasks() specifies be overridden. This is not exposed as a flag because I cannot see a use case for that. It is needed for unit testing however.  DocImpact. Resolves bug 939087.  
__label__objective Refactor nova.conf docs so they also appear in install guide.  Fixes bug https://bugs.launchpad.net/openstack-manuals/+bug/1043935  
__label__quality Refactor nova.conf docs so they also appear in install guide.  Fixes bug https://bugs.launchpad.net/openstack-manuals/+bug/1043935  
__label__objective Refactor nova.conf docs so they also appear in install guide.  Fixes bug https://bugs.launchpad.net/openstack-manuals/+bug/1043935  
__label__testing Refactor resources listing testcase for test_db_plugin.py  Fixes bug 1083502 Add common function '_test_list_resources' for resource listing.  
__label__objective Refactor resources listing testcase for test_db_plugin.py  Fixes bug 1083502 Add common function '_test_list_resources' for resource listing.  
__label__objective xenapi: Refactor snapshots during resize  Currently, we use VM.snapshot for resize, which fails if we have a volume attached to the VM, which does not support snapshots. This change uses VDI.snapshot instead, for all VDIs that are not attached by nova.  Also needed for xenapi: detaching and reattaching volumes during migrations and reverting of migrations.  Fixes Bug #1028092  
__label__objective xenapi: Refactor snapshots during resize  Currently, we use VM.snapshot for resize, which fails if we have a volume attached to the VM, which does not support snapshots. This change uses VDI.snapshot instead, for all VDIs that are not attached by nova.  Also needed for xenapi: detaching and reattaching volumes during migrations and reverting of migrations.  Fixes Bug #1028092  
__label__objective xenapi: Refactor snapshots during resize  Currently, we use VM.snapshot for resize, which fails if we have a volume attached to the VM, which does not support snapshots. This change uses VDI.snapshot instead, for all VDIs that are not attached by nova.  Fixes Bug #1028092  
__label__objective xenapi: Refactor snapshots during resize  Currently, we use VM.snapshot for resize, which fails if we have a volume attached to the VM, which does not support snapshots. This change uses VDI.snapshot instead, for all VDIs that are not attached by nova.  Fixes Bug #1028092  
__label__quality Refactor status_timeout() methods in tempest.test   * Factor timing loop out of status_timeout() methods to new method    call_until_true() to allow for reuse.  * In support of bug 1043980  
__label__testing Refactor status_timeout() methods in tempest.test   * Factor timing loop out of status_timeout() methods to new method    call_until_true() to allow for reuse.  * In support of bug 1043980  
__label__objective Refactor status_timeout() methods in tempest.test   * Factor timing loop out of status_timeout() methods to new method    call_until_true() to allow for reuse.  * In support of bug 1043980  
__label__quality Refactor libvirt config classes for representing CPU models/features  The previously added (but not used) LibvirtConfigCPUTest class was too inflexible. It did not distinguish between parts of the XML schema which applied to both capabilities & domain XML, vs those which only applied to the domain XML. By representing features as a plain string it did not allow for setting attributes on feature flags like policy.  This change replaces the single LibvirtConfigCPUTest class with 4 new classes:   - LibvirtConfigCPUFeature - base class for defining CPU features  - LibvirtConfigCPU - base class for defining CPU models  - LibvirtConfigGuestCPUFeature - extension for setting the guest    specific feature policy  - LibvirtConfigGuestCPU - extension for setting the guest specific    match policy, and allowing use of host CPU model passthrough  Fixes: bug #1003373 Implements: blueprint libvirt-xml-cpu-model 
__label__objective Refactor libvirt config classes for representing CPU models/features  The previously added (but not used) LibvirtConfigCPUTest class was too inflexible. It did not distinguish between parts of the XML schema which applied to both capabilities & domain XML, vs those which only applied to the domain XML. By representing features as a plain string it did not allow for setting attributes on feature flags like policy.  This change replaces the single LibvirtConfigCPUTest class with 4 new classes:   - LibvirtConfigCPUFeature - base class for defining CPU features  - LibvirtConfigCPU - base class for defining CPU models  - LibvirtConfigGuestCPUFeature - extension for setting the guest    specific feature policy  - LibvirtConfigGuestCPU - extension for setting the guest specific    match policy, and allowing use of host CPU model passthrough  Fixes: bug #1003373 Implements: blueprint libvirt-xml-cpu-model 
__label__objective Refactor libvirt config classes for representing CPU models/features  The previously added (but not used) LibvirtConfigCPUTest class was too inflexible. It did not distinguish between parts of the XML schema which applied to both capabilities & domain XML, vs those which only applied to the domain XML. By representing features as a plain string it did not allow for setting attributes on feature flags like policy.  This change replaces the single LibvirtConfigCPUTest class with 4 new classes:   - LibvirtConfigCPUFeature - base class for defining CPU features  - LibvirtConfigCPU - base class for defining CPU models  - LibvirtConfigGuestCPUFeature - extension for setting the guest    specific feature policy  - LibvirtConfigGuestCPU - extension for setting the guest specific    match policy, and allowing use of host CPU model passthrough  Fixes: bug #1003373 Implements: blueprint libvirt-xml-cpu-model 
__label__objective Refactor vm_vdi_cleaner.py connection use  cleanup_instance() would fail because of using old get_connection(). This refactors everything to use XenAPIDriver().  Fixes bug 1017282  
__label__quality Refactor vm_vdi_cleaner.py connection use  cleanup_instance() would fail because of using old get_connection(). This refactors everything to use XenAPIDriver().  Fixes bug 1017282  
__label__objective Refactor vm_vdi_cleaner.py connection use  cleanup_instance() would fail because of using old get_connection(). This refactors everything to use XenAPIDriver().  Fixes bug 1017282  
__label__quality Clean up and refactor of identity docs.  Bug #972370  
__label__objective Clean up and refactor of identity docs.  Bug #972370  
__label__objective refactoring code, check connection in Listener. refer to Bug #943031  
__label__testing Refactor glance id<->internal id conversion for s3   * Moves nova.image.s3.S3ImageService functions for converting    between glance ('image_uuid') and internal (db) ids to ec2utils:         get_image_id => ec2utils.glance_id_to_id        get_image_uuid => ec2utils.id_to_glance_id   * Refactors ec2utils.glance_id_to_id to create a new S3Image    object associating a glance id to an internal id if such a    mapping does not already exist.  Previously, only calls to    nova.api.ec2.cloud.CloudController.describe_images would    add new mappings, but now any attempt to convert a glance id    to an internal id will succeed, resolving bug 948286.   * Adds 2 convenience methods to ec2utils, as per bcwaldon:         ec2_id_to_glance_id        glance_id_to_ec2_id   * Since this is a strict refactor and only streamlines existing    well-tested functionality, this change includes no new tests.  
__label__objective Refactor glance id<->internal id conversion for s3   * Moves nova.image.s3.S3ImageService functions for converting    between glance ('image_uuid') and internal (db) ids to ec2utils:         get_image_id => ec2utils.glance_id_to_id        get_image_uuid => ec2utils.id_to_glance_id   * Refactors ec2utils.glance_id_to_id to create a new S3Image    object associating a glance id to an internal id if such a    mapping does not already exist.  Previously, only calls to    nova.api.ec2.cloud.CloudController.describe_images would    add new mappings, but now any attempt to convert a glance id    to an internal id will succeed, resolving bug 948286.   * Adds 2 convenience methods to ec2utils, as per bcwaldon:         ec2_id_to_glance_id        glance_id_to_ec2_id   * Since this is a strict refactor and only streamlines existing    well-tested functionality, this change includes no new tests.  
__label__quality Refactor glance id<->internal id conversion for s3   * Moves nova.image.s3.S3ImageService functions for converting    between glance ('image_uuid') and internal (db) ids to ec2utils:         get_image_id => ec2utils.glance_id_to_id        get_image_uuid => ec2utils.id_to_glance_id   * Refactors ec2utils.glance_id_to_id to create a new S3Image    object associating a glance id to an internal id if such a    mapping does not already exist.  Previously, only calls to    nova.api.ec2.cloud.CloudController.describe_images would    add new mappings, but now any attempt to convert a glance id    to an internal id will succeed, resolving bug 948286.   * Adds 2 convenience methods to ec2utils, as per bcwaldon:         ec2_id_to_glance_id        glance_id_to_ec2_id   * Since this is a strict refactor and only streamlines existing    well-tested functionality, this change includes no new tests.  
__label__integration Refactor glance id<->internal id conversion for s3   * Moves nova.image.s3.S3ImageService functions for converting    between glance ('image_uuid') and internal (db) ids to ec2utils:         get_image_id => ec2utils.glance_id_to_id        get_image_uuid => ec2utils.id_to_glance_id   * Refactors ec2utils.glance_id_to_id to create a new S3Image    object associating a glance id to an internal id if such a    mapping does not already exist.  Previously, only calls to    nova.api.ec2.cloud.CloudController.describe_images would    add new mappings, but now any attempt to convert a glance id    to an internal id will succeed, resolving bug 948286.   * Adds 2 convenience methods to ec2utils, as per bcwaldon:         ec2_id_to_glance_id        glance_id_to_ec2_id   * Since this is a strict refactor and only streamlines existing    well-tested functionality, this change includes no new tests.  
__label__objective Refactor glance id<->internal id conversion for s3   * Moves nova.image.s3.S3ImageService functions for converting    between glance ('image_uuid') and internal (db) ids to ec2utils:         get_image_id => ec2utils.glance_id_to_id        get_image_uuid => ec2utils.id_to_glance_id   * Refactors ec2utils.glance_id_to_id to create a new S3Image    object associating a glance id to an internal id if such a    mapping does not already exist.  Previously, only calls to    nova.api.ec2.cloud.CloudController.describe_images would    add new mappings, but now any attempt to convert a glance id    to an internal id will succeed, resolving bug 948286.   * Adds 2 convenience methods to ec2utils, as per bcwaldon:         ec2_id_to_glance_id        glance_id_to_ec2_id   * Since this is a strict refactor and only streamlines existing    well-tested functionality, this change includes no new tests.  
__label__objective Refactorize JS codes for action button check to reduce duplication  Fix the delete instance link action to be allowed on ajax context   * fixes bug 944853  
__label__quality Refactorize JS codes for action button check to reduce duplication  Fix the delete instance link action to be allowed on ajax context   * fixes bug 944853  
__label__quality Refactors handling of detach volume   * removes unnecessary flags in detach_volume call  * stops double detach reported in bug 887402  
__label__objective Refactors handling of detach volume   * removes unnecessary flags in detach_volume call  * stops double detach reported in bug 887402  
__label__refactoring Refactoring master to match stable/diablo fix for bug 891710  This is not a bug fix (and contains no functional changes), as the bug found in stable/diablo was already fixed in master.  
__label__objective Refactoring master to match stable/diablo fix for bug 891710  This is not a bug fix (and contains no functional changes), as the bug found in stable/diablo was already fixed in master.  
__label__refactoring Refactor auth_token.py to only call out to Keystone once.  Fixes bug 890881.  
__label__objective Refactor auth_token.py to only call out to Keystone once.  Fixes bug 890881.  
__label__quality Refactoring/cleanup around our exception handling  Fixes LP Bug #820643 - import_class() does not report original exception.  * Makes ALL exceptions now use base exception class * Removes unused exception classes from Nova * Removes unused code in glance.common.utils * Adds unit tests for bool_from_string and import_class  
__label__testing Refactoring/cleanup around our exception handling  Fixes LP Bug #820643 - import_class() does not report original exception.  * Makes ALL exceptions now use base exception class * Removes unused exception classes from Nova * Removes unused code in glance.common.utils * Adds unit tests for bool_from_string and import_class  
__label__objective Refactoring/cleanup around our exception handling  Fixes LP Bug #820643 - import_class() does not report original exception.  * Makes ALL exceptions now use base exception class * Removes unused exception classes from Nova * Removes unused code in glance.common.utils * Adds unit tests for bool_from_string and import_class  
__label__integration Refactor dashboard api  In order to get a consistent REST api, a few minor changes need to be made. The first of them is having the dashboard (home) endpoint at '/'.  
__label__integration Agent DB Refactor  For variant neutron agents, they share the same database model to store basic information, configurations, as well as dynamic workload data. Neutron-server depends on it to apply correct operations such as producing API response, scheduling, and HA. Also, how to maintain, transport those data is a performance factor to neutron. We believe the db model needs a refactor, base on some thinkings of the two scenarios.  First, currently there is no attribute to identify agent logical status, such as initializing, ready, data sync, or error. Once agent is connected to neutron-server, only admin state and liveness is checked on server side. That means neutron-server may apply operations on agent blindly.  Second, agents send heartbeat message to transport those data. However, carrying/parsing static data and writing them to db everytime is inefficient. We'd like to see static and dynamic data is well decoupled in agent db model. Then agent only needs to send static data once, and subsequent heartbeats only carry dynamic data.  
__label__quality Agent DB Refactor  For variant neutron agents, they share the same database model to store basic information, configurations, as well as dynamic workload data. Neutron-server depends on it to apply correct operations such as producing API response, scheduling, and HA. Also, how to maintain, transport those data is a performance factor to neutron. We believe the db model needs a refactor, base on some thinkings of the two scenarios.  First, currently there is no attribute to identify agent logical status, such as initializing, ready, data sync, or error. Once agent is connected to neutron-server, only admin state and liveness is checked on server side. That means neutron-server may apply operations on agent blindly.  Second, agents send heartbeat message to transport those data. However, carrying/parsing static data and writing them to db everytime is inefficient. We'd like to see static and dynamic data is well decoupled in agent db model. Then agent only needs to send static data once, and subsequent heartbeats only carry dynamic data.  
__label__objective Agent DB Refactor  For variant neutron agents, they share the same database model to store basic information, configurations, as well as dynamic workload data. Neutron-server depends on it to apply correct operations such as producing API response, scheduling, and HA. Also, how to maintain, transport those data is a performance factor to neutron. We believe the db model needs a refactor, base on some thinkings of the two scenarios.  First, currently there is no attribute to identify agent logical status, such as initializing, ready, data sync, or error. Once agent is connected to neutron-server, only admin state and liveness is checked on server side. That means neutron-server may apply operations on agent blindly.  Second, agents send heartbeat message to transport those data. However, carrying/parsing static data and writing them to db everytime is inefficient. We'd like to see static and dynamic data is well decoupled in agent db model. Then agent only needs to send static data once, and subsequent heartbeats only carry dynamic data.  
__label__integration Refactor subunit2sql dbapi  
__label__integration Refactor image's code to support both versions  This patch is part of the blueprint use-glance-v2-api  `nova.image.glance` module has been removed in favor of a more robust `nova.image.api` implementation. This implementation uses, for now, quite a few functions from the old module. The only reason for this is to keep backwards compatibility and also make the change more granular - follow-up patches will clean some of those functions up.  In the process of making this new API more stable some issues were found in glanceclient - some of these issues were already fixed and others are on its way to be fixed - and also in the implementation itself that required extra work/refactor.  Here's a list of some notable changes:  - The image API constructor now takes just a `cfg.ConfigOpts` object   where it'll take all the required info from.  - The download method has now been split into 2 different methods. The   first one is still called `download` and it's a 1:1 mapping to   glanceclient's download call. The second one, instead, is called   `download_to` and it allows consumers of this api to download the data   *to* a specific location. This method *always* returns `None`   regardless of its input and it relies on the already mentioned   `download` method to get the data.  - `show` and `detail` have been renamed to `get` and `get_all`   respectevly. This is to have a better mapping with glanceclient's api.  - The 'retry' logic now relies on the `retrying` module. See all the   decorated methods in `nova.image.api.API`  - The default api version is now v2  - URL's passed in `api_servers` are expected to be versioned. If not, a   warning will be logged and the default version will be used.  Code that remains to clean up:  - _convert_* functions should go away. There shouldn't be any need for   nova to translate what's returned from Glance.  - _extract_attributes should go away. This was mainly caused by an   inconsistency in glanceclient's returned objects. This is being   "fixed".  Implementation flaws to clean up:  - Many drivers make assumptions on Glance's URLs. This shouldn't be done   or permitted. Glanceclient is the one responsible for building those   urls, whereas the virt drivers should just care about the image_id.  - While I understand why `UpdateGlanceImage` exists, I believe it   shouldn't. This is *just* used by xenapi and I believe it should be   fixed there.  - xenapi makes way more assumption than other drivers when it comes to   Glance URI's, uploads and downloads. The code in `....plugins.glance`   has its own implementation for uploads and downloads through custom   http calls to Glance's API. I really don't understand why this code   exists but I think it should be cleaned up, asap.  - Some drivers are using a global `IMAGE_API` object. This shouldn't be   bad since `image.api.API` is stateless - .... I think .... :P - but   it'd be better not to rely on those global instances.  This patch implements most of this blueprint, as it does remove the glance module and the biggest refactor is done. However, I'm not marking the blueprint as implemented since I'd like to get some minor cleanups in before we consider it done.  Partially-Implements: blueprint use-glance-v2-api  
__label__objective Refactor image's code to support both versions  This patch is part of the blueprint use-glance-v2-api  `nova.image.glance` module has been removed in favor of a more robust `nova.image.api` implementation. This implementation uses, for now, quite a few functions from the old module. The only reason for this is to keep backwards compatibility and also make the change more granular - follow-up patches will clean some of those functions up.  In the process of making this new API more stable some issues were found in glanceclient - some of these issues were already fixed and others are on its way to be fixed - and also in the implementation itself that required extra work/refactor.  Here's a list of some notable changes:  - The image API constructor now takes just a `cfg.ConfigOpts` object   where it'll take all the required info from.  - The download method has now been split into 2 different methods. The   first one is still called `download` and it's a 1:1 mapping to   glanceclient's download call. The second one, instead, is called   `download_to` and it allows consumers of this api to download the data   *to* a specific location. This method *always* returns `None`   regardless of its input and it relies on the already mentioned   `download` method to get the data.  - `show` and `detail` have been renamed to `get` and `get_all`   respectevly. This is to have a better mapping with glanceclient's api.  - The 'retry' logic now relies on the `retrying` module. See all the   decorated methods in `nova.image.api.API`  - The default api version is now v2  - URL's passed in `api_servers` are expected to be versioned. If not, a   warning will be logged and the default version will be used.  Code that remains to clean up:  - _convert_* functions should go away. There shouldn't be any need for   nova to translate what's returned from Glance.  - _extract_attributes should go away. This was mainly caused by an   inconsistency in glanceclient's returned objects. This is being   "fixed".  Implementation flaws to clean up:  - Many drivers make assumptions on Glance's URLs. This shouldn't be done   or permitted. Glanceclient is the one responsible for building those   urls, whereas the virt drivers should just care about the image_id.  - While I understand why `UpdateGlanceImage` exists, I believe it   shouldn't. This is *just* used by xenapi and I believe it should be   fixed there.  - xenapi makes way more assumption than other drivers when it comes to   Glance URI's, uploads and downloads. The code in `....plugins.glance`   has its own implementation for uploads and downloads through custom   http calls to Glance's API. I really don't understand why this code   exists but I think it should be cleaned up, asap.  - Some drivers are using a global `IMAGE_API` object. This shouldn't be   bad since `image.api.API` is stateless - .... I think .... :P - but   it'd be better not to rely on those global instances.  This patch implements most of this blueprint, as it does remove the glance module and the biggest refactor is done. However, I'm not marking the blueprint as implemented since I'd like to get some minor cleanups in before we consider it done.  Partially-Implements: blueprint use-glance-v2-api  
__label__integration Refactor allocate_for_instance  Split allocate_for_instance into logical function groups, make better use of the neutron API by coalescing multiple calls into one where supported and support asynchronous operations where appropriate.  
__label__objective Refactor allocate_for_instance  Split allocate_for_instance into logical function groups, make better use of the neutron API by coalescing multiple calls into one where supported and support asynchronous operations where appropriate.  
__label__integration Refactor of the Neutron network adapter  Refactor the network API-neutron adapter to improve neutron API usage, reduce complexity of critical, frequently used methods and align with current data practices in nova.  
__label__quality Refactor of the Neutron network adapter  Refactor the network API-neutron adapter to improve neutron API usage, reduce complexity of critical, frequently used methods and align with current data practices in nova.  
__label__integration Refactoring initialize connection api to use taskflow  Refactor initialize connection workflow using taskflow and split that workflow for volume-manager into separate tasks. Create tasks which perform the individual required actions to accomplish the desried outcome.  The volume-manager workflow composed of following tasks: - Verify driver initialization and validates Connector. - Exports the volume and returns the updated volume reference (remove   export on failure) - Allow connection to connector and returns connection info. - Add QOS specs to connection info and returns updated connection info.  
__label__objective Refactoring initialize connection api to use taskflow  Refactor initialize connection workflow using taskflow and split that workflow for volume-manager into separate tasks. Create tasks which perform the individual required actions to accomplish the desried outcome.  The volume-manager workflow composed of following tasks: - Verify driver initialization and validates Connector. - Exports the volume and returns the updated volume reference (remove   export on failure) - Allow connection to connector and returns connection info. - Add QOS specs to connection info and returns updated connection info.  
__label__integration Refactoring attach volume api to use taskflow  Refactor attach volume workflow using taskflow and split that workflow for volume-manager into separate tasks. Create tasks which perform the individual required actions to accomplish the desired outcome.  The volume-manager workflow composed of following tasks: - Extracts volume reference from database. - Validates volume status and availability. - Updates volume status and its metadata. - Verify driver initialization. - Updates volume status to attached. - Notifies about volume actions.  
__label__objective Refactoring attach volume api to use taskflow  Refactor attach volume workflow using taskflow and split that workflow for volume-manager into separate tasks. Create tasks which perform the individual required actions to accomplish the desired outcome.  The volume-manager workflow composed of following tasks: - Extracts volume reference from database. - Validates volume status and availability. - Updates volume status and its metadata. - Verify driver initialization. - Updates volume status to attached. - Notifies about volume actions.  
__label__quality QoS agent extension and driver refactoring  This patch add the following: 1. Move code to be handle by the Qos Driver abstrct class to avoid code duplication. 2. chace the poclies to reduce pull RPC calls to server. 3. support delete per rule_type or delete all rules.  Partially-Implements: quantum-qos-api  
__label__objective QoS agent extension and driver refactoring  This patch add the following: 1. Move code to be handle by the Qos Driver abstrct class to avoid code duplication. 2. chace the poclies to reduce pull RPC calls to server. 3. support delete per rule_type or delete all rules.  Partially-Implements: quantum-qos-api  
__label__integration API jsonschema validation refactoring  - request, response schemas mapping added - validate_schema decorator implemented - validate_schema added into content_json decorator - tests on api schema validation added - common json types for node added - Node and NodeCollection shcemas added - schema validation added into base handlers GET, POST, PUT, DELETE methods - Node nailgun object uses jsonschema from prototcol  
__label__objective API jsonschema validation refactoring  - request, response schemas mapping added - validate_schema decorator implemented - validate_schema added into content_json decorator - tests on api schema validation added - common json types for node added - Node and NodeCollection shcemas added - schema validation added into base handlers GET, POST, PUT, DELETE methods - Node nailgun object uses jsonschema from prototcol  
__label__integration Complete refactor to glance-store's API  
__label__integration WIP Alternate Refactoring for Pluggable IPAM  This provides an alternate approach to the refactoring needed for pluggable IPAM. In [1], the proposed approach does not require changes to any plugins, only to the base class. The approach in this patch requires changes to the plugin subclasses in order to utilize pluggable IPAM; unchanged plugins will continue to use the builtin IPAM.  The advantage of this patch is that the IPAM driver calls are done prior to the start of the management layer's transaction. This means that there is no open transaction during any external API calls.  This is very much a WIP, it is only intended to demonstrate the alternate approach. Some notes:    * Only the create_port method is refactored    * Much of the validation (such as _test_fixed_ips_for_port) is      deferred to the driver layer.    * There is no error handling    * I haven't even looked to see if it will handle IPv6, auto-      addressed ports, or router ports.    * I borrowed the ipam/__init__.py changes from [1].    * It is only very lightly tested: allocations for fixed IPs      via the neutron CLI are working in the single-subnet case,      as well as allocations when only a network ID is specified.    * Since none of the subnet calls are refactored, you have to      manual setup the database entries for them for the driver      to know what to do.    * IPAllocations are still stored, as that is the foreign key      relationships defined by the Port object for its IPs.    * The new driver is used for the actual allocations. This is      done prior to the start of the transaction in the ML2      create_port call.    * Obviously the final routines would appear in the DB plugin      not the ML2 plugin so they can be used by other plugins.  [1] https://review.openstack.org/153236  
__label__testing WIP Alternate Refactoring for Pluggable IPAM  This provides an alternate approach to the refactoring needed for pluggable IPAM. In [1], the proposed approach does not require changes to any plugins, only to the base class. The approach in this patch requires changes to the plugin subclasses in order to utilize pluggable IPAM; unchanged plugins will continue to use the builtin IPAM.  The advantage of this patch is that the IPAM driver calls are done prior to the start of the management layer's transaction. This means that there is no open transaction during any external API calls.  This is very much a WIP, it is only intended to demonstrate the alternate approach. Some notes:    * Only the create_port method is refactored    * Much of the validation (such as _test_fixed_ips_for_port) is      deferred to the driver layer.    * There is no error handling    * I haven't even looked to see if it will handle IPv6, auto-      addressed ports, or router ports.    * I borrowed the ipam/__init__.py changes from [1].    * It is only very lightly tested: allocations for fixed IPs      via the neutron CLI are working in the single-subnet case,      as well as allocations when only a network ID is specified.    * Since none of the subnet calls are refactored, you have to      manual setup the database entries for them for the driver      to know what to do.    * IPAllocations are still stored, as that is the foreign key      relationships defined by the Port object for its IPs.    * The new driver is used for the actual allocations. This is      done prior to the start of the transaction in the ML2      create_port call.    * Obviously the final routines would appear in the DB plugin      not the ML2 plugin so they can be used by other plugins.  [1] https://review.openstack.org/153236  
__label__quality WIP Alternate Refactoring for Pluggable IPAM  This provides an alternate approach to the refactoring needed for pluggable IPAM. In [1], the proposed approach does not require changes to any plugins, only to the base class. The approach in this patch requires changes to the plugin subclasses in order to utilize pluggable IPAM; unchanged plugins will continue to use the builtin IPAM.  The advantage of this patch is that the IPAM driver calls are done prior to the start of the management layer's transaction. This means that there is no open transaction during any external API calls.  This is very much a WIP, it is only intended to demonstrate the alternate approach. Some notes:    * Only the create_port method is refactored    * Much of the validation (such as _test_fixed_ips_for_port) is      deferred to the driver layer.    * There is no error handling    * I haven't even looked to see if it will handle IPv6, auto-      addressed ports, or router ports.    * I borrowed the ipam/__init__.py changes from [1].    * It is only very lightly tested: allocations for fixed IPs      via the neutron CLI are working in the single-subnet case,      as well as allocations when only a network ID is specified.    * Since none of the subnet calls are refactored, you have to      manual setup the database entries for them for the driver      to know what to do.    * IPAllocations are still stored, as that is the foreign key      relationships defined by the Port object for its IPs.    * The new driver is used for the actual allocations. This is      done prior to the start of the transaction in the ML2      create_port call.    * Obviously the final routines would appear in the DB plugin      not the ML2 plugin so they can be used by other plugins.  [1] https://review.openstack.org/153236  
__label__objective WIP Alternate Refactoring for Pluggable IPAM  This provides an alternate approach to the refactoring needed for pluggable IPAM. In [1], the proposed approach does not require changes to any plugins, only to the base class. The approach in this patch requires changes to the plugin subclasses in order to utilize pluggable IPAM; unchanged plugins will continue to use the builtin IPAM.  The advantage of this patch is that the IPAM driver calls are done prior to the start of the management layer's transaction. This means that there is no open transaction during any external API calls.  This is very much a WIP, it is only intended to demonstrate the alternate approach. Some notes:    * Only the create_port method is refactored    * Much of the validation (such as _test_fixed_ips_for_port) is      deferred to the driver layer.    * There is no error handling    * I haven't even looked to see if it will handle IPv6, auto-      addressed ports, or router ports.    * I borrowed the ipam/__init__.py changes from [1].    * It is only very lightly tested: allocations for fixed IPs      via the neutron CLI are working in the single-subnet case,      as well as allocations when only a network ID is specified.    * Since none of the subnet calls are refactored, you have to      manual setup the database entries for them for the driver      to know what to do.    * IPAllocations are still stored, as that is the foreign key      relationships defined by the Port object for its IPs.    * The new driver is used for the actual allocations. This is      done prior to the start of the transaction in the ML2      create_port call.    * Obviously the final routines would appear in the DB plugin      not the ML2 plugin so they can be used by other plugins.  [1] https://review.openstack.org/153236  
__label__integration WIP: refactor the PUT method into separate classes  For now there's only the ReplicatedObjectController class, similar to the changes in feature/ec branch.  The Base class containes all public API handling, while ReplicatedObjectController only handles data transfer to object server.  
__label__objective WIP: refactor the PUT method into separate classes  For now there's only the ReplicatedObjectController class, similar to the changes in feature/ec branch.  The Base class containes all public API handling, while ReplicatedObjectController only handles data transfer to object server.  
__label__integration Refactor _action_create_image of API  Based on current design, instance with volume backed should not have a image ref, so the code at nova/api/openstack/compute/servers.py#L1065-L1072 is not reasonable anymore. This patch will remove the 'if' check.  Closes-Bug: #1435596  
__label__objective Refactor _action_create_image of API  Based on current design, instance with volume backed should not have a image ref, so the code at nova/api/openstack/compute/servers.py#L1065-L1072 is not reasonable anymore. This patch will remove the 'if' check.  Closes-Bug: #1435596  
__label__integration V2 API Refactoring  The V2 API are really monolithic and difficult to maintain.  This patch separates the various controller code in separte files simplifying the overall structure and making the code more readable.  Moreover, this should simplify the integration/substitution of API that now can be clearly stated in the v2 file injecting a controller from a new source.  
__label__quality V2 API Refactoring  The V2 API are really monolithic and difficult to maintain.  This patch separates the various controller code in separte files simplifying the overall structure and making the code more readable.  Moreover, this should simplify the integration/substitution of API that now can be clearly stated in the v2 file injecting a controller from a new source.  
__label__integration Refactor _format_instances in api/ec2/cloudy.py  Abstract _get_format_instances function from _format_instances, which all the DB calls now will be in _get_format_instances, and _format_instances will simply format input instances. This also a prepare work to implement bp v3-api-policy which will add policy check in ec2 api layer.  
__label__objective Refactor _format_instances in api/ec2/cloudy.py  Abstract _get_format_instances function from _format_instances, which all the DB calls now will be in _get_format_instances, and _format_instances will simply format input instances. This also a prepare work to implement bp v3-api-policy which will add policy check in ec2 api layer.  
__label__integration Refactor worker shell code  1. Refactored ���unittest��� and ���build��� code so that each API just focuses on the behavior defined by the method name.  2. Added a new ���launch��� API, which does the unittest->build workflow.  3. Make the worker API signature cleaner by adding test_info and build_info dicts.  
__label__objective Refactor worker shell code  1. Refactored ���unittest��� and ���build��� code so that each API just focuses on the behavior defined by the method name.  2. Added a new ���launch��� API, which does the unittest->build workflow.  3. Make the worker API signature cleaner by adding test_info and build_info dicts.  
__label__integration Refactor images layer to prep for adding Glance V2 support  This refactoring patch lays the initial groundwork for Glance V2 API support by moving the GlanceClientWrapper and some associated functions and configuration into a new package which will later contain drivers for Glance V1 and V2.  
__label__objective Refactor images layer to prep for adding Glance V2 support  This refactoring patch lays the initial groundwork for Glance V2 API support by moving the GlanceClientWrapper and some associated functions and configuration into a new package which will later contain drivers for Glance V1 and V2.  
__label__integration Refactor calls to cinderclient()  The blueprint log-request-id-mappings will require adding logging to calls being made to other OpenStack services. We will need to log the request ID that will be returned from cinder. The current set of API functions are each calling cinderclient() individually. Rather than litter the code with dozens of logging lines, this refactor moves the cinderclient() call out of the API functions. The logging will be done at that point.  
__label__objective Refactor calls to cinderclient()  The blueprint log-request-id-mappings will require adding logging to calls being made to other OpenStack services. We will need to log the request ID that will be returned from cinder. The current set of API functions are each calling cinderclient() individually. Rather than litter the code with dozens of logging lines, this refactor moves the cinderclient() call out of the API functions. The logging will be done at that point.  
__label__integration Refactor LDAP API  The fake LDAP API must emulate the python-ldap API as much as possible otherwise much of the LDAP testing is invalid. The python-ldap API only accepts utf-8 encoded strings. However, the fake LDAP API accepts any Python type therefore properly handling type conversion into and out of the LDAP API is not exercised by the fake LDAP API during testing. Currently type conversion is done inside the LdapWrapper which calls the python-ldap API, this means unicode issues only appear when testing with a live LDAP server.  LdapWrapper and FakeLdap logically are two different providers of the same API, as such they should behave identically. Which LDAP API is used at run time a configurable option.  We need a mechanism by which we can substitute an LDAP API and then wrap the calls to that API with type conversions. Type conversion wrapping replaces the Python types used in Keystone with the types needed for the LDAP API, calls the LDAP API, and then type converts the results back from LDAP to those used by Keystone.  This patch establishes an LDAP API interface (LDAPHandler), modifies fake LDAP to support it, replaces LdapWrapper with the interface (invoking python-ldap) and adds another LDAPHandler instance which will be the common location for type conversions prior to calling the configured LDAP interface. See the LDAPHandler class definition for details).  This patch is exclusively a refactoring patch anticipating a subsequent patch to properly handle unicode values. There is no significant change in functionality with this patch, it is just refactoring to more cleanly seperate API boundaries. A few tests which exercised unicode were disabled in this patch because they will not work until the next patch which adds back in correct unicode handling. The idea here is to separate out the refactoring needed to support unicode from the actual unicode changes, this should make reviewing easier.  Partial-Bug: 1172106 
__label__objective Refactor LDAP API  The fake LDAP API must emulate the python-ldap API as much as possible otherwise much of the LDAP testing is invalid. The python-ldap API only accepts utf-8 encoded strings. However, the fake LDAP API accepts any Python type therefore properly handling type conversion into and out of the LDAP API is not exercised by the fake LDAP API during testing. Currently type conversion is done inside the LdapWrapper which calls the python-ldap API, this means unicode issues only appear when testing with a live LDAP server.  LdapWrapper and FakeLdap logically are two different providers of the same API, as such they should behave identically. Which LDAP API is used at run time a configurable option.  We need a mechanism by which we can substitute an LDAP API and then wrap the calls to that API with type conversions. Type conversion wrapping replaces the Python types used in Keystone with the types needed for the LDAP API, calls the LDAP API, and then type converts the results back from LDAP to those used by Keystone.  This patch establishes an LDAP API interface (LDAPHandler), modifies fake LDAP to support it, replaces LdapWrapper with the interface (invoking python-ldap) and adds another LDAPHandler instance which will be the common location for type conversions prior to calling the configured LDAP interface. See the LDAPHandler class definition for details).  This patch is exclusively a refactoring patch anticipating a subsequent patch to properly handle unicode values. There is no significant change in functionality with this patch, it is just refactoring to more cleanly seperate API boundaries. A few tests which exercised unicode were disabled in this patch because they will not work until the next patch which adds back in correct unicode handling. The idea here is to separate out the refactoring needed to support unicode from the actual unicode changes, this should make reviewing easier.  Partial-Bug: 1172106 
__label__integration WIP - for Juno - VMWare: spawn refactor - get_image_properties  One of many, this is a refactor of the get_image_properties inner methods. This is only the first step in many.  get_image_properties distills OpenStack Nova image properties into a set of values that the vmwareapi drivers use to make calls against the vSphere SOAP API.  Introduces a datastructure for holding this distilled image information and additional tests to cover the method.  All validation checks for certain properties were only occuring inside the inner method get_image_properties so constants related to disk types and linked_clone values are moved to be near by the newly extracted get_image_properties method.  Several tests had to be refactored to account for changes to the fake.py framework that needed to be made to match the new structures in vmops.py  partial blueprint vmware-spawn-refactor  
__label__testing WIP - for Juno - VMWare: spawn refactor - get_image_properties  One of many, this is a refactor of the get_image_properties inner methods. This is only the first step in many.  get_image_properties distills OpenStack Nova image properties into a set of values that the vmwareapi drivers use to make calls against the vSphere SOAP API.  Introduces a datastructure for holding this distilled image information and additional tests to cover the method.  All validation checks for certain properties were only occuring inside the inner method get_image_properties so constants related to disk types and linked_clone values are moved to be near by the newly extracted get_image_properties method.  Several tests had to be refactored to account for changes to the fake.py framework that needed to be made to match the new structures in vmops.py  partial blueprint vmware-spawn-refactor  
__label__integration Refactor network_get_associated_fixed_ips() for sanity  The network_get_associated_fixed_ips() db api method returns a dict of randomness that is neither a model, nor a mapping to one. In order to replace this method with an object call, we need to make it do something a little more helpful.  This patch simply refactors it to return the same data, but in model form that we can reasonably turn into an object in a later patch.  Related to blueprint nova-network-objects  Related-bug: 1290568 
__label__objective Refactor network_get_associated_fixed_ips() for sanity  The network_get_associated_fixed_ips() db api method returns a dict of randomness that is neither a model, nor a mapping to one. In order to replace this method with an object call, we need to make it do something a little more helpful.  This patch simply refactors it to return the same data, but in model form that we can reasonably turn into an object in a later patch.  Related to blueprint nova-network-objects  Related-bug: 1290568 
__label__objective Refactor type of operation and sensor in assembly/component.  this patch replaces the type of the 'operations' and 'sensors attributes in assembly and component. Instead of common_types.Uri, it is [common_types.Link]  Operation and Sensor are both API resources and should be considered as any of the other resources.  the name of both attributes have also been updated, from operations_uri to operation_links to match the other attributes  Note : The wiki page should also be updated to match the new attribute names.  
__label__integration Refactor ips api log message format for debugging  This patch refactor ips api error log message format, Adds server id to log message.  
__label__quality VMware: Refactor vim_util to reuse existing util method  The following methods make similar api calls using retrievePropertiesEx and hence can be consolidated to avoid code repetition :  1. get_object_properties --> retrievePropertiesEx() 2. get_objects --> retrievePropertiesEx() 3. get_properties_for_collection_of_objects -->        retrievePropertiesEx()  This has been refactored as follows in this patch :- get_object_properties/get_objects --->  get_properties_for_collection_of_object --> retrievePropertiesEx()  Closes-bug: #1240847  
__label__objective VMware: Refactor vim_util to reuse existing util method  The following methods make similar api calls using retrievePropertiesEx and hence can be consolidated to avoid code repetition :  1. get_object_properties --> retrievePropertiesEx() 2. get_objects --> retrievePropertiesEx() 3. get_properties_for_collection_of_objects -->        retrievePropertiesEx()  This has been refactored as follows in this patch :- get_object_properties/get_objects --->  get_properties_for_collection_of_object --> retrievePropertiesEx()  Closes-bug: #1240847  
__label__integration VMware: Refactor vim_util to reuse existing util method  The following methods make similar api calls using retrievePropertiesEx and hence can be consolidated to avoid code repetition :  1. get_object_properties --> retrievePropertiesEx() 2. get_objects --> retrievePropertiesEx() 3. get_properties_for_collection_of_objects -->        retrievePropertiesEx()  This has been refactored as follows in this patch :- get_object_properties/get_objects --->  get_properties_for_collection_of_object --> retrievePropertiesEx()  Closes-bug: #1240847  
__label__integration Refactor file reading to a reader context manager  Ahead of the DiskFile refactoring work for a defined (yet internal) API (see https://review.openstack.org/30051), refactor DiskFile to create a DiskReader class (akin to the DiskWriter class) which will allow us to encapsulate file reading implementation details.  Also:  * Refactor DiskWriter to reference threadpool via disk_file field  * Misc exception syntax use of "as"  
__label__quality Refactor file reading to a reader context manager  Ahead of the DiskFile refactoring work for a defined (yet internal) API (see https://review.openstack.org/30051), refactor DiskFile to create a DiskReader class (akin to the DiskWriter class) which will allow us to encapsulate file reading implementation details.  Also:  * Refactor DiskWriter to reference threadpool via disk_file field  * Misc exception syntax use of "as"  
__label__objective Refactor file reading to a reader context manager  Ahead of the DiskFile refactoring work for a defined (yet internal) API (see https://review.openstack.org/30051), refactor DiskFile to create a DiskReader class (akin to the DiskWriter class) which will allow us to encapsulate file reading implementation details.  Also:  * Refactor DiskWriter to reference threadpool via disk_file field  * Misc exception syntax use of "as"  
__label__quality Refactor test_update_* from test_servers.py in current API tests and v3.  - Cleanup from copy-paste code. - Move all test_update to separate class.  blueprint api-compute-servers-tests  
__label__objective Refactor test_update_* from test_servers.py in current API tests and v3.  - Cleanup from copy-paste code. - Move all test_update to separate class.  blueprint api-compute-servers-tests  
__label__integration Blockstorage behaviors refactor and versioning * Implemented exception-raising behaviors for volumes_api. * Removed blockstorage provider. * Added volume and snapshot statuses model. * Refactored response models. * Versioned volumes_api as v1 * Cleaned up rax auth extensions * Fixed VolumeTypeList model * Added default_volume_type config property  
__label__objective Blockstorage behaviors refactor and versioning * Implemented exception-raising behaviors for volumes_api. * Removed blockstorage provider. * Added volume and snapshot statuses model. * Refactored response models. * Versioned volumes_api as v1 * Cleaned up rax auth extensions * Fixed VolumeTypeList model * Added default_volume_type config property  
__label__integration Refactor RPC API into quantum.api.rpc directory  In addition, change update_lease_expiration from cast to call so that it will not RPC flood server.  
__label__integration Refactor get_encoded_zip in cloudpipe.pipelib   * add generate_vpn_files in cert.rpcapi  * use cert.rpcapi rather than calling crypto directly  * change some file modes while generating zip file  
__label__objective Refactor get_encoded_zip in cloudpipe.pipelib   * add generate_vpn_files in cert.rpcapi  * use cert.rpcapi rather than calling crypto directly  * change some file modes while generating zip file  
__label__objective refactor: extract class XenAPISessionBase  Related to blueprint xenapi-volume-drivers  As xenapi access will be required in cinder, this change extracts low-level xenapi session management (pooling) to a base class, that could be moved to nova-common later.  
__label__integration Scheduler API clean up and refactor  Unlike Nova scheduler, which has to consider serving compute and volume scheduling, Cinder scheduler only serves volume scheduling, so there's no need to keep generic interface 'schedule'.  Instead, 'schedule_create_volume' is added (if missing) to manager/driver class and chance/simple scheduler driver implementation.  Also this patch changes the interface between API service and scheduler to allow more information about volume is passed to scheduler for advanced scheduling.  
__label__objective Scheduler API clean up and refactor  Unlike Nova scheduler, which has to consider serving compute and volume scheduling, Cinder scheduler only serves volume scheduling, so there's no need to keep generic interface 'schedule'.  Instead, 'schedule_create_volume' is added (if missing) to manager/driver class and chance/simple scheduler driver implementation.  Also this patch changes the interface between API service and scheduler to allow more information about volume is passed to scheduler for advanced scheduling.  
__label__quality Refactor for wsgi controllers  This patch adds a base controller class, and move some common methods into the base class.  Blueprint: v2-api 
__label__objective Refactor for wsgi controllers  This patch adds a base controller class, and move some common methods into the base class.  Blueprint: v2-api 
__label__integration Refactor network ip availability api, add 'available_ips' filed  The 'available_ips' is represented the number of assignable ip address in a network.  Currently, the network ip availability api only provide 'total_ips' and 'used_ips'. In some case, we can't accurately figure out the rest of ip address only according to the two value. For example, the subnet has no 'ip_allocation_pools' or the 'ip_allocation_pools' was updated after allocated some ips.  Closes-Bug: #1843211 
__label__objective Refactor network ip availability api, add 'available_ips' filed  The 'available_ips' is represented the number of assignable ip address in a network.  Currently, the network ip availability api only provide 'total_ips' and 'used_ips'. In some case, we can't accurately figure out the rest of ip address only according to the two value. For example, the subnet has no 'ip_allocation_pools' or the 'ip_allocation_pools' was updated after allocated some ips.  Closes-Bug: #1843211 
__label__objective Prepare glance-api to be refactored  Part of the effort in Idbf1250b1cdf69fb101c206183f16be70532626c - we need this patch to avoid resource duplication in Puppet catalog.  This is temporary and the code will be cleaned up later.  
__label__integration Allow policy file to not exist  Now that policy rules can be registered in code there is a desire to run projects without a policy file. However oslo.policy assumed a policy file would exist and would raise an error if it could not be found. This was fixed by https://review.openstack.org/#/c/341732/  These changes make Enforcer logic more simple. And Enforcer can be extendend or improved without adding more flags. Everything related to file was moved to FileRulesCache class. It is easy to read code or debug. This refactoring shouldn't break anything in projects because Enforcer API was not changed.  
__label__objective Allow policy file to not exist  Now that policy rules can be registered in code there is a desire to run projects without a policy file. However oslo.policy assumed a policy file would exist and would raise an error if it could not be found. This was fixed by https://review.openstack.org/#/c/341732/  These changes make Enforcer logic more simple. And Enforcer can be extendend or improved without adding more flags. Everything related to file was moved to FileRulesCache class. It is easy to read code or debug. This refactoring shouldn't break anything in projects because Enforcer API was not changed.  
__label__quality Refactor freezer-api jobs  We can remove some duplicate code and stop using legacy nodesets.  
__label__objective Refactor freezer-api jobs  We can remove some duplicate code and stop using legacy nodesets.  
__label__integration WIP: Staging refactor  This change is to address old technical debt by refactoring the staging used related to Interoperable Image Import to utilize locations mechanisms to track the user staging data through the process.  Handling of "staging_host" location metadata as preparation for Distributed Image Import tht needs to track the host where user image data is being staged to avoid the shared filesystem between service nodes.  Hiding the "staging_host" from API user and never selecting staging loction as direct_url provided by the API.  To be addressed beofre merging: Removing or refactoring tests skipped as "Irrelevant?", likely so due to the code they were testing been removed from said modules. Fixing tests skipped as "BROKEN, needs eyes" that are broken relying the code they were testing being in the module and mocking the rest. Additional API testing for the insecure deprecated locations API around how the locations are being presented.  
__label__testing WIP: Staging refactor  This change is to address old technical debt by refactoring the staging used related to Interoperable Image Import to utilize locations mechanisms to track the user staging data through the process.  Handling of "staging_host" location metadata as preparation for Distributed Image Import tht needs to track the host where user image data is being staged to avoid the shared filesystem between service nodes.  Hiding the "staging_host" from API user and never selecting staging loction as direct_url provided by the API.  To be addressed beofre merging: Removing or refactoring tests skipped as "Irrelevant?", likely so due to the code they were testing been removed from said modules. Fixing tests skipped as "BROKEN, needs eyes" that are broken relying the code they were testing being in the module and mocking the rest. Additional API testing for the insecure deprecated locations API around how the locations are being presented.  
__label__objective WIP: Staging refactor  This change is to address old technical debt by refactoring the staging used related to Interoperable Image Import to utilize locations mechanisms to track the user staging data through the process.  Handling of "staging_host" location metadata as preparation for Distributed Image Import tht needs to track the host where user image data is being staged to avoid the shared filesystem between service nodes.  Hiding the "staging_host" from API user and never selecting staging loction as direct_url provided by the API.  To be addressed beofre merging: Removing or refactoring tests skipped as "Irrelevant?", likely so due to the code they were testing been removed from said modules. Fixing tests skipped as "BROKEN, needs eyes" that are broken relying the code they were testing being in the module and mocking the rest. Additional API testing for the insecure deprecated locations API around how the locations are being presented.  
__label__quality [WIP] Refactor drivers  * Split drivers into NotificationDriver and ReportDriver * Clean-up driver API to avoid code duplicates  
__label__objective [WIP] Refactor drivers  * Split drivers into NotificationDriver and ReportDriver * Clean-up driver API to avoid code duplicates  
__label__integration API calls and error handling refactoring  This change refactors API services to use Fetch instead of when+reqwest combination, Improves error handling of API requests and makes actions which do API calls lighter  
__label__objective API calls and error handling refactoring  This change refactors API services to use Fetch instead of when+reqwest combination, Improves error handling of API requests and makes actions which do API calls lighter  
__label__quality Refactor load_balancer client api methods (DRY)  
__label__objective Refactor load_balancer client api methods (DRY)  
__label__integration Move the get_host_for_server function to utilites  The functionality which retrieves the OS-EXT-SRV-ATTR:host attribute of servers using the admin API was implemented in multiple places in the API and the scenario environments as well.  I moved the get_host_for_server fuction to tempest.common.compute and refactored the tests to use the new, generalized function.  
__label__objective Move the get_host_for_server function to utilites  The functionality which retrieves the OS-EXT-SRV-ATTR:host attribute of servers using the admin API was implemented in multiple places in the API and the scenario environments as well.  I moved the get_host_for_server fuction to tempest.common.compute and refactored the tests to use the new, generalized function.  
__label__objective [WIP] Refactor DB consistent (part 2)  Partially-Implements: blueprint refactor-nb-api 
__label__integration [PoC] Refactor configdrive into a new field  Add a new column configdrive. Add a new field to node object and make it compatiable. Add an example to show how to keep RPC compatiable(only for test) Bump api to 1.17 to show node.configdrive field  This is a perfect example to show how Ironic live upgrade works  A short introduction about how to upgrade M to latest code online: Node A with M release API + M release conductor Node B with M release conductor 1. Apply framework patch + configdrive patch to Node A 2. ironic-dbsync upgrade 3. set [upgrade_levels]/lowest_version_services to mitaka on Node A 4. restart API on Node A 5. restart Conductor on Node A 6. Apply two patches on Node B 7. set [upgrade_levels]/lowest_version_services to mitaka on Node B 8. restart Conductor on Node B 9. unset [unpgrade_levels]/lowest_version_services on Node A/B 10. restart API on Node A 11. restart conductor on Node A 12. restart conductor on Node B  
__label__objective [PoC] Refactor configdrive into a new field  Add a new column configdrive. Add a new field to node object and make it compatiable. Add an example to show how to keep RPC compatiable(only for test) Bump api to 1.17 to show node.configdrive field  This is a perfect example to show how Ironic live upgrade works  A short introduction about how to upgrade M to latest code online: Node A with M release API + M release conductor Node B with M release conductor 1. Apply framework patch + configdrive patch to Node A 2. ironic-dbsync upgrade 3. set [upgrade_levels]/lowest_version_services to mitaka on Node A 4. restart API on Node A 5. restart Conductor on Node A 6. Apply two patches on Node B 7. set [upgrade_levels]/lowest_version_services to mitaka on Node B 8. restart Conductor on Node B 9. unset [unpgrade_levels]/lowest_version_services on Node A/B 10. restart API on Node A 11. restart conductor on Node A 12. restart conductor on Node B  
__label__objective refactory query user_id code for quota-sets  do not need to use urlparse and consistent to other API code.  
__label__objective [WIP] Refactor lrouter northbound API methods  
__label__integration [WIP] Refactor lports northbound API methods  
__label__integration [WIP] Refactor floatingip northbound API methods  
__label__integration [WIP] Refactor publisher northbound API methods  
__label__integration [WIP] Refactor secgroup northbound API methods  
__label__integration [WIP] Refactor lswitch northbound API methods  
__label__integration [WIP] Refactor qos policy northbound API methods  
__label__integration Refactor the report API to use custom WSME objects  
__label__integration [WIP] Refactor senlin lock  Add new API to get lock  
__label__integration Refactor the report API to use custom WSME objects  
__label__integration [WIP] Refactor secgroup northbound API methods  
__label__integration Refactor update cell in users table  1. only update the changed cell instead of whole user data 2. there is no project column in table so it will never be updated    remove 'project' to unnecessary api call.    ref: https://github.com/openstack/horizon/blob/master/         openstack_dashboard/api/keystone.py#L420 3. {cell_name: new_cell_value or None} to avoid set  email to empty string    ref: https://bugs.launchpad.net/horizon/+bug/1265805  
__label__objective Refactor update cell in users table  1. only update the changed cell instead of whole user data 2. there is no project column in table so it will never be updated    remove 'project' to unnecessary api call.    ref: https://github.com/openstack/horizon/blob/master/         openstack_dashboard/api/keystone.py#L420 3. {cell_name: new_cell_value or None} to avoid set  email to empty string    ref: https://bugs.launchpad.net/horizon/+bug/1265805  
__label__integration Refactor get_object in object/db/api  Given that OVO work is under progress and is kind of blocked by missing support for sqlalchemy queries like first() or one()etc via helper method. This patch will refactor get_object in order to support one(), one_or_none() queries by passing method name as argument to get object.  This patch is needed OVO patches under progress which I linked below. [1]. https://review.openstack.org/#/c/334695/ [2]. https://review.openstack.org/#/c/338625/  
__label__objective Refactor get_object in object/db/api  Given that OVO work is under progress and is kind of blocked by missing support for sqlalchemy queries like first() or one()etc via helper method. This patch will refactor get_object in order to support one(), one_or_none() queries by passing method name as argument to get object.  This patch is needed OVO patches under progress which I linked below. [1]. https://review.openstack.org/#/c/334695/ [2]. https://review.openstack.org/#/c/338625/  
__label__integration refactor image function tests  following the pattern established in commit 09b783ad3e5051564bf6321feace3b65739febbf, create a common module that sets the API version we plan to use for the tests.  
__label__objective refactor image function tests  following the pattern established in commit 09b783ad3e5051564bf6321feace3b65739febbf, create a common module that sets the API version we plan to use for the tests.  
__label__objective Revert "Refactor RPC client"  This reverts commit 82602ae36941f6f54803fb52bfe72d4f8922de4a.  This refactor breaks the RPClient API  Closes-bug: #1584889  Conflicts: oslo_messaging/rpc/client.py  
__label__quality WIP : Servicegroup foundational refactoring for Control Plane  At present, there are various interfaces through which services data can be manipulated - admin interface(nova-manage), extensions (contrib/services.py), servicegroup API layer. Having different interfaces to manipulate the source of truth can lead to severe data inconsistency for something as useful as stored in nova.services. The proposal is to follow a common path, while interacting with services data, for all the three interfaces mentioned above. This common path will go through the servicegroup layer, who's primary purpose is to manage and check for service liveliness. Doing so will help to overcome the tight coupling between nova and services database and also have a consistent view of services data, service liveliness, etc.  
__label__integration WIP : Servicegroup foundational refactoring for Control Plane  At present, there are various interfaces through which services data can be manipulated - admin interface(nova-manage), extensions (contrib/services.py), servicegroup API layer. Having different interfaces to manipulate the source of truth can lead to severe data inconsistency for something as useful as stored in nova.services. The proposal is to follow a common path, while interacting with services data, for all the three interfaces mentioned above. This common path will go through the servicegroup layer, who's primary purpose is to manage and check for service liveliness. Doing so will help to overcome the tight coupling between nova and services database and also have a consistent view of services data, service liveliness, etc.  
__label__objective WIP : Servicegroup foundational refactoring for Control Plane  At present, there are various interfaces through which services data can be manipulated - admin interface(nova-manage), extensions (contrib/services.py), servicegroup API layer. Having different interfaces to manipulate the source of truth can lead to severe data inconsistency for something as useful as stored in nova.services. The proposal is to follow a common path, while interacting with services data, for all the three interfaces mentioned above. This common path will go through the servicegroup layer, who's primary purpose is to manage and check for service liveliness. Doing so will help to overcome the tight coupling between nova and services database and also have a consistent view of services data, service liveliness, etc.  
__label__quality WIP : Servicegroup Foundational Refactoring  At present, there are various interfaces through which services data can  be manipulated - admin interface(nova-manage), extensions (contrib/services.py), etc. Every interface relies on the servicegroup layer API is_up() to get details about service live-ness. The proposal is keep service data in nova database nova.services table and fetch the live-ness information from the configured servicegroup(SG) driver. Liveness will be a combination of service live-ness and RPC live-ness, where the later will be computed based on information in nova.services.  
__label__objective WIP : Servicegroup Foundational Refactoring  At present, there are various interfaces through which services data can  be manipulated - admin interface(nova-manage), extensions (contrib/services.py), etc. Every interface relies on the servicegroup layer API is_up() to get details about service live-ness. The proposal is keep service data in nova database nova.services table and fetch the live-ness information from the configured servicegroup(SG) driver. Liveness will be a combination of service live-ness and RPC live-ness, where the later will be computed based on information in nova.services.  
__label__integration Refactor network topology graph as an Angular directive  Separate network topology graph into reusable part and network-specific part. Reusable part which is implemented as <topology-graph> directive  * takes care of initial rendering according to the data provided in   '=data' attribute; * re-renders its contents each time '=data' changes on scope; * provides one-level grouping via using convex hulls and 'contains'   array on each node that contains sub-nodes; * exposes an API via controller which is used for customizing reusable   graph - i.e., specific node glyphs, sizes, affinities, callbacks   etc.  All the specific network code is placed into network topology controller, including:  * initial data transformations, i.e. marking different nodes with   different types (server/network/ext-network/router) which works in   conjunction with <config-topology-node> directive provided for graph   customization; * all the legacy code related to pop-ups creation and behavior (copied   from networktopology.js as is: what worked there still works here,   what was broken still is broken).  Most significant changes to the original curvature topology graph code:  * simplified data containers (no usage of function constructors,   'type' key on a an object for type-checking). * refactored group collapse & expand logic: more intensive use of   d3.js data joins, all the node hidden in a collapsed group are moved   to a separate $hiddenNodes array, and put back to $nodes once the   group is expanded - with d3.js handling re-rendering of this stuff   for us in a $drawGraph method. The same applies to redrawing the   links of hidden nodes. * refactored type-dispatched rendering of nodes in $drawGraph to make   them use type-specific attributes (in situation when specific types   and stylings are not known in advance) - by using   d3.selection.filter function.  This commit is just a first step in angularizing the topology graph. I merely claim that the current refactoring didn't break a lot of things, i.e. the things that worked before in network topology still work :). Among other features/fixes that are yet to be done are:  * add tests and documentation * ensure that the proposed level of directive abstraction works for at   least 2 more consumers (e.g., Workbook graph for Mistral Workbook   Builder, HOT Template graph for Hot Builder, possible stack topology   for an existing Heat stack).  Implements: blueprint curvature-network-topology 
__label__testing Refactor network topology graph as an Angular directive  Separate network topology graph into reusable part and network-specific part. Reusable part which is implemented as <topology-graph> directive  * takes care of initial rendering according to the data provided in   '=data' attribute; * re-renders its contents each time '=data' changes on scope; * provides one-level grouping via using convex hulls and 'contains'   array on each node that contains sub-nodes; * exposes an API via controller which is used for customizing reusable   graph - i.e., specific node glyphs, sizes, affinities, callbacks   etc.  All the specific network code is placed into network topology controller, including:  * initial data transformations, i.e. marking different nodes with   different types (server/network/ext-network/router) which works in   conjunction with <config-topology-node> directive provided for graph   customization; * all the legacy code related to pop-ups creation and behavior (copied   from networktopology.js as is: what worked there still works here,   what was broken still is broken).  Most significant changes to the original curvature topology graph code:  * simplified data containers (no usage of function constructors,   'type' key on a an object for type-checking). * refactored group collapse & expand logic: more intensive use of   d3.js data joins, all the node hidden in a collapsed group are moved   to a separate $hiddenNodes array, and put back to $nodes once the   group is expanded - with d3.js handling re-rendering of this stuff   for us in a $drawGraph method. The same applies to redrawing the   links of hidden nodes. * refactored type-dispatched rendering of nodes in $drawGraph to make   them use type-specific attributes (in situation when specific types   and stylings are not known in advance) - by using   d3.selection.filter function.  This commit is just a first step in angularizing the topology graph. I merely claim that the current refactoring didn't break a lot of things, i.e. the things that worked before in network topology still work :). Among other features/fixes that are yet to be done are:  * add tests and documentation * ensure that the proposed level of directive abstraction works for at   least 2 more consumers (e.g., Workbook graph for Mistral Workbook   Builder, HOT Template graph for Hot Builder, possible stack topology   for an existing Heat stack).  Implements: blueprint curvature-network-topology 
__label__quality Refactor network topology graph as an Angular directive  Separate network topology graph into reusable part and network-specific part. Reusable part which is implemented as <topology-graph> directive  * takes care of initial rendering according to the data provided in   '=data' attribute; * re-renders its contents each time '=data' changes on scope; * provides one-level grouping via using convex hulls and 'contains'   array on each node that contains sub-nodes; * exposes an API via controller which is used for customizing reusable   graph - i.e., specific node glyphs, sizes, affinities, callbacks   etc.  All the specific network code is placed into network topology controller, including:  * initial data transformations, i.e. marking different nodes with   different types (server/network/ext-network/router) which works in   conjunction with <config-topology-node> directive provided for graph   customization; * all the legacy code related to pop-ups creation and behavior (copied   from networktopology.js as is: what worked there still works here,   what was broken still is broken).  Most significant changes to the original curvature topology graph code:  * simplified data containers (no usage of function constructors,   'type' key on a an object for type-checking). * refactored group collapse & expand logic: more intensive use of   d3.js data joins, all the node hidden in a collapsed group are moved   to a separate $hiddenNodes array, and put back to $nodes once the   group is expanded - with d3.js handling re-rendering of this stuff   for us in a $drawGraph method. The same applies to redrawing the   links of hidden nodes. * refactored type-dispatched rendering of nodes in $drawGraph to make   them use type-specific attributes (in situation when specific types   and stylings are not known in advance) - by using   d3.selection.filter function.  This commit is just a first step in angularizing the topology graph. I merely claim that the current refactoring didn't break a lot of things, i.e. the things that worked before in network topology still work :). Among other features/fixes that are yet to be done are:  * add tests and documentation * ensure that the proposed level of directive abstraction works for at   least 2 more consumers (e.g., Workbook graph for Mistral Workbook   Builder, HOT Template graph for Hot Builder, possible stack topology   for an existing Heat stack).  Implements: blueprint curvature-network-topology 
__label__quality Refactor network topology graph as an Angular directive  Separate network topology graph into reusable part and network-specific part. Reusable part which is implemented as <topology-graph> directive  * takes care of initial rendering according to the data provided in   '=data' attribute; * re-renders its contents each time '=data' changes on scope; * provides one-level grouping via using convex hulls and 'contains'   array on each node that contains sub-nodes; * exposes an API via controller which is used for customizing reusable   graph - i.e., specific node glyphs, sizes, affinities, callbacks   etc.  All the specific network code is placed into network topology controller, including:  * initial data transformations, i.e. marking different nodes with   different types (server/network/ext-network/router) which works in   conjunction with <config-topology-node> directive provided for graph   customization; * all the legacy code related to pop-ups creation and behavior (copied   from networktopology.js as is: what worked there still works here,   what was broken still is broken).  Most significant changes to the original curvature topology graph code:  * simplified data containers (no usage of function constructors,   'type' key on a an object for type-checking). * refactored group collapse & expand logic: more intensive use of   d3.js data joins, all the node hidden in a collapsed group are moved   to a separate $hiddenNodes array, and put back to $nodes once the   group is expanded - with d3.js handling re-rendering of this stuff   for us in a $drawGraph method. The same applies to redrawing the   links of hidden nodes. * refactored type-dispatched rendering of nodes in $drawGraph to make   them use type-specific attributes (in situation when specific types   and stylings are not known in advance) - by using   d3.selection.filter function.  This commit is just a first step in angularizing the topology graph. I merely claim that the current refactoring didn't break a lot of things, i.e. the things that worked before in network topology still work :). Among other features/fixes that are yet to be done are:  * add tests and documentation * ensure that the proposed level of directive abstraction works for at   least 2 more consumers (e.g., Workbook graph for Mistral Workbook   Builder, HOT Template graph for Hot Builder, possible stack topology   for an existing Heat stack).  Implements: blueprint curvature-network-topology 
__label__objective Refactor network topology graph as an Angular directive  Separate network topology graph into reusable part and network-specific part. Reusable part which is implemented as <topology-graph> directive  * takes care of initial rendering according to the data provided in   '=data' attribute; * re-renders its contents each time '=data' changes on scope; * provides one-level grouping via using convex hulls and 'contains'   array on each node that contains sub-nodes; * exposes an API via controller which is used for customizing reusable   graph - i.e., specific node glyphs, sizes, affinities, callbacks   etc.  All the specific network code is placed into network topology controller, including:  * initial data transformations, i.e. marking different nodes with   different types (server/network/ext-network/router) which works in   conjunction with <config-topology-node> directive provided for graph   customization; * all the legacy code related to pop-ups creation and behavior (copied   from networktopology.js as is: what worked there still works here,   what was broken still is broken).  Most significant changes to the original curvature topology graph code:  * simplified data containers (no usage of function constructors,   'type' key on a an object for type-checking). * refactored group collapse & expand logic: more intensive use of   d3.js data joins, all the node hidden in a collapsed group are moved   to a separate $hiddenNodes array, and put back to $nodes once the   group is expanded - with d3.js handling re-rendering of this stuff   for us in a $drawGraph method. The same applies to redrawing the   links of hidden nodes. * refactored type-dispatched rendering of nodes in $drawGraph to make   them use type-specific attributes (in situation when specific types   and stylings are not known in advance) - by using   d3.selection.filter function.  This commit is just a first step in angularizing the topology graph. I merely claim that the current refactoring didn't break a lot of things, i.e. the things that worked before in network topology still work :). Among other features/fixes that are yet to be done are:  * add tests and documentation * ensure that the proposed level of directive abstraction works for at   least 2 more consumers (e.g., Workbook graph for Mistral Workbook   Builder, HOT Template graph for Hot Builder, possible stack topology   for an existing Heat stack).  Implements: blueprint curvature-network-topology 
__label__integration [WIP] Refactor Resource to better serve Proxy  Through a series of attempts we haven't been able to sufficiently solve the issue of what were called "path_args" in the past, somewhat of a relic of the time before we had the Proxy layer. "path_args" made a lot of sense when there was only the Resource and the usage was almost entirely through the classmethods on it, back when command-line example scripts were the primary example of usage.  As things have grown in the year-plus since that time, we have bolted a great higher-level interface on a lower-level interface that was stuck in an older use-case. It was most recently a problem when we had resource.prop types that accepeted Resource types, which both there and elsewhere meant it became significantly harder, if not impossible, to have nested Resources. An example of this is how ServerInterface is a resource that depends on Server.  This approach strips Resource down to a public API of only create, get, update, delete, head, find, and list methods. Resource subclasses are still constructed in the same manner, though the naming of what were "props" is now slightly different, but more clear. Additionally, through that change comes a more clear user experience for URI parameters, aka, "path_args". This also paves the way for more clarity on query parameters which work in much the same way, although they haven't been fully explored.  As the changing of this class has pretty far reaching effects, it will exist temporarily in the "resource2" module. The first change will be to introduce the module itself in standalone, and then we will change each service independent of the others. Subsequent changes should not be too disruptive, mostly in the form of renaming things like resource.prop to resource.Body, and the like.  There is a fairly major side effects of the implementation of this class that is behaviorally different from the initial Resource implementation. Previously, any-and-all data sent into a Resource initializer would be tracked internally on the Resource instance and then sent to the server *even if it did not correspond to a resource.prop on the class*. Ultimately this would have become a problem as servers are becoming more strict about what they receive, but this implementation makes no allowance for so-called loose data to be entered. If there is no component attribute for an argument to be sent to the server, or one received from the server, it will not exist as an attribute of the Resource. Currently said data is just dropped entirely, but it could be logged, or perhaps a strict/loose mode could be engaged to warn or otherwise fail when unexpected data is entered. Ultimately, this behavior had to happen. In the near term it may mean that the SDK doesn't work exactly as it had in previous versions, but that will just mean updating Resource definitions to match what is truly expected or given by the server.  
__label__objective [WIP] Refactor Resource to better serve Proxy  Through a series of attempts we haven't been able to sufficiently solve the issue of what were called "path_args" in the past, somewhat of a relic of the time before we had the Proxy layer. "path_args" made a lot of sense when there was only the Resource and the usage was almost entirely through the classmethods on it, back when command-line example scripts were the primary example of usage.  As things have grown in the year-plus since that time, we have bolted a great higher-level interface on a lower-level interface that was stuck in an older use-case. It was most recently a problem when we had resource.prop types that accepeted Resource types, which both there and elsewhere meant it became significantly harder, if not impossible, to have nested Resources. An example of this is how ServerInterface is a resource that depends on Server.  This approach strips Resource down to a public API of only create, get, update, delete, head, find, and list methods. Resource subclasses are still constructed in the same manner, though the naming of what were "props" is now slightly different, but more clear. Additionally, through that change comes a more clear user experience for URI parameters, aka, "path_args". This also paves the way for more clarity on query parameters which work in much the same way, although they haven't been fully explored.  As the changing of this class has pretty far reaching effects, it will exist temporarily in the "resource2" module. The first change will be to introduce the module itself in standalone, and then we will change each service independent of the others. Subsequent changes should not be too disruptive, mostly in the form of renaming things like resource.prop to resource.Body, and the like.  There is a fairly major side effects of the implementation of this class that is behaviorally different from the initial Resource implementation. Previously, any-and-all data sent into a Resource initializer would be tracked internally on the Resource instance and then sent to the server *even if it did not correspond to a resource.prop on the class*. Ultimately this would have become a problem as servers are becoming more strict about what they receive, but this implementation makes no allowance for so-called loose data to be entered. If there is no component attribute for an argument to be sent to the server, or one received from the server, it will not exist as an attribute of the Resource. Currently said data is just dropped entirely, but it could be logged, or perhaps a strict/loose mode could be engaged to warn or otherwise fail when unexpected data is entered. Ultimately, this behavior had to happen. In the near term it may mean that the SDK doesn't work exactly as it had in previous versions, but that will just mean updating Resource definitions to match what is truly expected or given by the server.  
__label__integration Complete refactor to glance-store's API  blueprint refactor-glance-store  
__label__integration HyperV: Refactor livemigr, avoiding getting disk paths remotely  During live migration, if passthrough disks are attached to instances, we need to create a planned VM, setting the right disk paths according to the destination host so that the volumes will still be accessible after the instance is migrated.  At the moment, we retrieve the disk paths remotely via WMI. Due to the fact that some WMI API methods are broken, for the FC implementation we had to use the hbaapi.dll functions directly, using ctypes.  As this can't work remotely, this patch slightly changes the live migration workflow. The planned VM is created during the pre-livemigration step on the destination host, updating the virtual disk resources.  
__label__objective HyperV: Refactor livemigr, avoiding getting disk paths remotely  During live migration, if passthrough disks are attached to instances, we need to create a planned VM, setting the right disk paths according to the destination host so that the volumes will still be accessible after the instance is migrated.  At the moment, we retrieve the disk paths remotely via WMI. Due to the fact that some WMI API methods are broken, for the FC implementation we had to use the hbaapi.dll functions directly, using ctypes.  As this can't work remotely, this patch slightly changes the live migration workflow. The planned VM is created during the pre-livemigration step on the destination host, updating the virtual disk resources.  
__label__integration Refactor format_stack_output in engine api  Unify format of resulting dict in format_stack_output: currently if we don't resolve_data, output_value key isn't added to resulting dict, what can occurres KeyError. This patch unify format of dict with or without resolving data. Also, refactor format_stack_outputs - if we don't want resolve data, method returns list of dicts without output_value key.  implements bp api-call-output  
__label__objective Refactor format_stack_output in engine api  Unify format of resulting dict in format_stack_output: currently if we don't resolve_data, output_value key isn't added to resulting dict, what can occurres KeyError. This patch unify format of dict with or without resolving data. Also, refactor format_stack_outputs - if we don't want resolve data, method returns list of dicts without output_value key.  implements bp api-call-output  
__label__integration Hyper-V: refactors utilsfactory  The Hyper-V API can change from a version to another (e.g. new features), requiring a new Utils class to be added for specific versions.  Refactors utilsfactory module. In this way, a new utils class can be added without adding a new parameter when retrieving the suitable class for windows version.  
__label__objective Hyper-V: refactors utilsfactory  The Hyper-V API can change from a version to another (e.g. new features), requiring a new Utils class to be added for specific versions.  Refactors utilsfactory module. In this way, a new utils class can be added without adding a new parameter when retrieving the suitable class for windows version.  
__label__integration ceph: refactor mgr-restful-plugin state machine  Replace mgr-restful-plugin service monitoring based on state machine with explicit transitions with a function that goes through the following steps: - wait for Ceph cluster to become available - configure and start ceph-mgr - configure and enable restful plugin - send periodic requests to REST API  Procedure to recover from errors: restart ceph-mgr, update certificates, run again through configuration steps, wait for Ceph cluster.  mgr-restful-plugin components:  1. init script: parse command line parameters, start service    monitoring if not already running, request status via    control socket, stop service monitoring.  2. service monitoring: create process running ceph-mgr    confguration steps, report status based on current    rest api availability and init/recovery procedure,    stop ceph-mgr and helper process  3. monitoring helper: successively run commands to configure    and start ceph-mgr and restful plugin, send periodic requests    to ceph REST API, update service monitoring with current    failure status (no response from REST API or ceph-mgr    restarts).  
__label__objective ceph: refactor mgr-restful-plugin state machine  Replace mgr-restful-plugin service monitoring based on state machine with explicit transitions with a function that goes through the following steps: - wait for Ceph cluster to become available - configure and start ceph-mgr - configure and enable restful plugin - send periodic requests to REST API  Procedure to recover from errors: restart ceph-mgr, update certificates, run again through configuration steps, wait for Ceph cluster.  mgr-restful-plugin components:  1. init script: parse command line parameters, start service    monitoring if not already running, request status via    control socket, stop service monitoring.  2. service monitoring: create process running ceph-mgr    confguration steps, report status based on current    rest api availability and init/recovery procedure,    stop ceph-mgr and helper process  3. monitoring helper: successively run commands to configure    and start ceph-mgr and restful plugin, send periodic requests    to ceph REST API, update service monitoring with current    failure status (no response from REST API or ceph-mgr    restarts).  
__label__integration Refactor HostAPI.service_update  Change If32bca070185937ef83f689b7163d965a89ec10a is going to reflect a compute service's disabled status with the COMPUTE_STATUS_DISABLED trait in placement. This change does some prep work so that a common method in the HostAPI (service_update) can be used to abstract that for pre-2.53 and post-2.53 service update APIs.  In the pre-2.53 case, the Service is retrieved using the host and binary which requires looking up the HostMapping. In the post-2.53 case, we already have the Service object and just need to save the changes.  Part of blueprint pre-filter-disabled-computes  
__label__objective Refactor HostAPI.service_update  Change If32bca070185937ef83f689b7163d965a89ec10a is going to reflect a compute service's disabled status with the COMPUTE_STATUS_DISABLED trait in placement. This change does some prep work so that a common method in the HostAPI (service_update) can be used to abstract that for pre-2.53 and post-2.53 service update APIs.  In the pre-2.53 case, the Service is retrieved using the host and binary which requires looking up the HostMapping. In the post-2.53 case, we already have the Service object and just need to save the changes.  Part of blueprint pre-filter-disabled-computes  
__label__quality Refactor the code of API controller/view  Extract view out of controllers: ContainerAction, ContainerActionEvent, and Service. This makes improve the modularity and consistency of the code.  
__label__objective Refactor the code of API controller/view  Extract view out of controllers: ContainerAction, ContainerActionEvent, and Service. This makes improve the modularity and consistency of the code.  
__label__objective stx-docs refactoring for new doc structure  Changes included updating the StarlingX docs landing page to conform to a new list of available documents as follows:   * StarlingX Introduction  * Deployment Guides  * Installation Guides  * Developer resources  * Operation Guides  * Project Specifications  * REST API Reference  * Release Notes  * Contribute  So-called "dead-end" links have an explanation of content coming.  Any destination associated with an existing story ID have the link to the story for reference.  The existence of a "current" and "latest" Developer Guides resulted in the top-level list of doc resources including both the "Developer Guides" and "Developer Resources" bullets.  Ideally, the Developer Guides would be included as part of the "Developer Resources" area.  For "latest" they are.  However, for "current" I left them alone since the 2018.10 release is out there.  This organization can settle out as more releases launch.  Finally, I did not focus on the writing aspect for this PR. That part can be cleaned up going forward.  
__label__integration Refactor tiller commands to handle methods  This is a refactor to any methods in the api and cli to move tiller operations to a separate handler function to make them uniform with the rest of the code  
__label__objective Refactor tiller commands to handle methods  This is a refactor to any methods in the api and cli to move tiller operations to a separate handler function to make them uniform with the rest of the code  
__label__integration Refactoring RbacUtils part 2 api tests  The override_role function no longer needs test_obj parameter. Also removing self.rbac_utils variable.  Story: 2002604 Task: 22223  
__label__objective Refactoring RbacUtils part 2 api tests  The override_role function no longer needs test_obj parameter. Also removing self.rbac_utils variable.  Story: 2002604 Task: 22223  
__label__integration Refactor out Ceilometer V2 API related code  As of Queens the Ceilometer V2 API has been removed.  Storage driver related code in monasca-ceilometer can thus be removed.  Backport some refactoring that came up in creating https://review.openstack.org/#/c/562400/ Realized some class names could be clearer and fit better with Ceilometer.  Update test-requirements.txt with Rocky release of python-monascaclient.  Also include more license info.  Specify py35 instead of py34 in tox.ini (gates already using py35).  Include updates to devstack configuration to keep up with master ceilometer.  These include adding values for the [monasca] section in ceilometer.conf and refreshing setup.cfg as well as updating how the connection url to Monasca API is configured.  Also include some testing notes in devstack/README.md  (cherry picked from commit 8b0fb6d0485d1e446a2a4672286c8254e2a9aef9)  
__label__objective Refactor out Ceilometer V2 API related code  As of Queens the Ceilometer V2 API has been removed.  Storage driver related code in monasca-ceilometer can thus be removed.  Backport some refactoring that came up in creating https://review.openstack.org/#/c/562400/ Realized some class names could be clearer and fit better with Ceilometer.  Update test-requirements.txt with Rocky release of python-monascaclient.  Also include more license info.  Specify py35 instead of py34 in tox.ini (gates already using py35).  Include updates to devstack configuration to keep up with master ceilometer.  These include adding values for the [monasca] section in ceilometer.conf and refreshing setup.cfg as well as updating how the connection url to Monasca API is configured.  Also include some testing notes in devstack/README.md  (cherry picked from commit 8b0fb6d0485d1e446a2a4672286c8254e2a9aef9)  
__label__integration [WIP] Refactor API server  This change accomplishes 2 primary things: 1. It generalizes work to enable the EventRateLimit admission plugin. 2. It restructures the anchor so that during an upgrade an "old" anchor    does not try to coordinate the injection of "new" data from    configmaps/secrets.  It also includes these ancillary changes: * Clean up apiserver argument specification in the chart. * De-duplicate and realign apiserver arguments in bootstrapping templates.  It has the side effects of: * Adding a new field, ".apiserver.arguments" to the Genesis config,   which will be the preferred way to configure bootstrapping apiservers   going forward (in lieu of command_prefix).  
__label__objective [WIP] Refactor API server  This change accomplishes 2 primary things: 1. It generalizes work to enable the EventRateLimit admission plugin. 2. It restructures the anchor so that during an upgrade an "old" anchor    does not try to coordinate the injection of "new" data from    configmaps/secrets.  It also includes these ancillary changes: * Clean up apiserver argument specification in the chart. * De-duplicate and realign apiserver arguments in bootstrapping templates.  It has the side effects of: * Adding a new field, ".apiserver.arguments" to the Genesis config,   which will be the preferred way to configure bootstrapping apiservers   going forward (in lieu of command_prefix).  
__label__integration Refactor tag support  align different services to comply the same `tag` standard: https://specs.openstack.org/openstack/api-wg/guidelines/tags.html Currently not all services support tags, but we can prepare SDK for  that. There are some changes/issues to know: - image.add_tag and image.remove_tag return the image entity - server.query_params for tags are renamed to be compliant with rest of  services (the ones from network are reused) - cinder does support only setting of the tags, but not getting (API  limitation)  As of now the only services with tagging API available: - compute.server - network.{net, subnet, ip, port, qos_policy, router, sg, sg_rule,  subnet_pool, trunk} - image.image  
__label__objective Refactor tag support  align different services to comply the same `tag` standard: https://specs.openstack.org/openstack/api-wg/guidelines/tags.html Currently not all services support tags, but we can prepare SDK for  that. There are some changes/issues to know: - image.add_tag and image.remove_tag return the image entity - server.query_params for tags are renamed to be compliant with rest of  services (the ones from network are reused) - cinder does support only setting of the tags, but not getting (API  limitation)  As of now the only services with tagging API available: - compute.server - network.{net, subnet, ip, port, qos_policy, router, sg, sg_rule,  subnet_pool, trunk} - image.image  
__label__integration Refactor flask domain config resources  The domain config flask resource classes all call the same config_api with the same arguements that are provided if present.  This change removes the original duplication that was present to handle this, instead replacing it with subclasses for each API route to be handled with flask.  
__label__objective Refactor flask domain config resources  The domain config flask resource classes all call the same config_api with the same arguements that are provided if present.  This change removes the original duplication that was present to handle this, instead replacing it with subclasses for each API route to be handled with flask.  
__label__integration [WIP]Refactor sql driver api  sqlalchemy api implementing is too complex, the patch try to simpfy it  
__label__quality [WIP]Refactor sql driver api  sqlalchemy api implementing is too complex, the patch try to simpfy it  
__label__integration Refactor app response for api request '/api/keystone/svc-catalog'  Add filtration for service catalog. Now all endpoints that are not public will not be seen.  
__label__objective Refactor app response for api request '/api/keystone/svc-catalog'  Add filtration for service catalog. Now all endpoints that are not public will not be seen.  
__label__integration Refactor API code for checking microversions  Copy-paste, copy-paste everywhere! This change reduces the number of places where essentially the same checks were applied in the API code.  
__label__objective Refactor API code for checking microversions  Copy-paste, copy-paste everywhere! This change reduces the number of places where essentially the same checks were applied in the API code.  
__label__integration Refactor validations retrieval for performance  The goal of this commit is to reduce the average time spent retrieving validations from Deckhand. Currently, wait times when committing configdocs can be significant due to unnecessary API calls. This change reduces the number of API calls during this process by utilizing the `/revisions/{{revision_id}}/validations/detail` endpoint exposed by Deckhand. During testing, this introduced a 71% decrease in cumulative time for committing configdocs. Note, this commit does not introduce usage of the official Deckhand client, which will be addressed in a future change.  
__label__objective Refactor validations retrieval for performance  The goal of this commit is to reduce the average time spent retrieving validations from Deckhand. Currently, wait times when committing configdocs can be significant due to unnecessary API calls. This change reduces the number of API calls during this process by utilizing the `/revisions/{{revision_id}}/validations/detail` endpoint exposed by Deckhand. During testing, this introduced a 71% decrease in cumulative time for committing configdocs. Note, this commit does not introduce usage of the official Deckhand client, which will be addressed in a future change.  
__label__integration Refactor out Ceilometer V2 API related code  As of Queens the Ceilometer V2 API has been removed.  Storage driver related code in monasca-ceilometer can thus be removed.  Backport some refactoring that came up in creating https://review.openstack.org/#/c/562400/ Realized some class names could be clearer and fit better with Ceilometer.  Update test-requirements.txt with Rocky release of python-monascaclient.  Also include more license info.  Specify py35 instead of py34 in tox.ini (gates already using py35).  
__label__objective Refactor out Ceilometer V2 API related code  As of Queens the Ceilometer V2 API has been removed.  Storage driver related code in monasca-ceilometer can thus be removed.  Backport some refactoring that came up in creating https://review.openstack.org/#/c/562400/ Realized some class names could be clearer and fit better with Ceilometer.  Update test-requirements.txt with Rocky release of python-monascaclient.  Also include more license info.  Specify py35 instead of py34 in tox.ini (gates already using py35).  
__label__integration Refactor murano Installation Guide  1.remove the duplicate install murano api and engine 2.add install from source code  
__label__quality Refactor murano Installation Guide  1.remove the duplicate install murano api and engine 2.add install from source code  
__label__integration [WIP] Refactor watcher API for Action Plan Start  Currently the REST API to start action plan in watcher is which is same as for update action plan.  PATCH /v1/action_plans  https://docs.openstack.org/watcher/latest/api/v1.html  we need to make it easy to understand  POST /v1/action_plans/action the action should be start in above case.  
__label__integration Refactor token cache invalidation callbacks  There are several cases where we need to invalidate the token cache. Notifications are used to do this and the token provider API uses callbacks to subscribe to those notifications. This commit makes them all use a single callback function instead of each defining their own just to do the same thing. A subsequent patch will refactor the term "persistence" from the notification names used across keystone.  
__label__objective Refactor token cache invalidation callbacks  There are several cases where we need to invalidate the token cache. Notifications are used to do this and the token provider API uses callbacks to subscribe to those notifications. This commit makes them all use a single callback function instead of each defining their own just to do the same thing. A subsequent patch will refactor the term "persistence" from the notification names used across keystone.  
__label__integration Refactor the create port form to workflow  The neutron API allows the users to specify security group(s) when creating a port [1], but at the moment the Horizon can only modify the security group of a port by 'Edit Port' row action.  As with edit port workflow, refactoring the creation of port form to workflow is to support the creation of ports as well as the assignment of security groups. Since the change may be more, this patch only contains reconstruct the form, support the security groups will be submitted in another patch.  [1] https://developer.openstack.org/api-ref/network/v2/index.html#create-port  
__label__objective Refactor the create port form to workflow  The neutron API allows the users to specify security group(s) when creating a port [1], but at the moment the Horizon can only modify the security group of a port by 'Edit Port' row action.  As with edit port workflow, refactoring the creation of port form to workflow is to support the creation of ports as well as the assignment of security groups. Since the change may be more, this patch only contains reconstruct the form, support the security groups will be submitted in another patch.  [1] https://developer.openstack.org/api-ref/network/v2/index.html#create-port  
__label__integration prefactor: Pass s3api Config to S3Requests  That way we don't have to plumb in some half-dozen options one-by-one.  
__label__integration WIP: Refactor API tests with fixtures  
__label__testing WIP: Refactor API tests with fixtures  
__label__integration Refactor Ironic and Ironic Inspector services  Turn Ironic and Ironic Inspector API services functions into thunks so the store and dispatch is easily passed, this allows to use auth selectors for service url and auth token id  
__label__objective Refactor Ironic and Ironic Inspector services  Turn Ironic and Ironic Inspector API services functions into thunks so the store and dispatch is easily passed, this allows to use auth selectors for service url and auth token id  
__label__integration Refactor the code about container force delete in api  In [1], we split two method about delete to disallow non-admin user to force delete containers. It creates a lot of duplicated code, which will be a burden for further work. This patch will try to refactor it.  [1] https://review.openstack.org/#/c/498767/  
__label__objective Refactor the code about container force delete in api  In [1], we split two method about delete to disallow non-admin user to force delete containers. It creates a lot of duplicated code, which will be a burden for further work. This patch will try to refactor it.  [1] https://review.openstack.org/#/c/498767/  
__label__integration Refactoring of functional.regression.test_bug_1702454  Removed direct post api call Added _evacuate_server helper  
__label__objective Refactoring of functional.regression.test_bug_1702454  Removed direct post api call Added _evacuate_server helper  
__label__integration Add spec-lite for scrubber refactor  This was discussed at the PTG as part of the session on removing the Images API v1: https://etherpad.openstack.org/p/glance-queens-ptg-remove-v1-API  
__label__objective Add spec-lite for scrubber refactor  This was discussed at the PTG as part of the session on removing the Images API v1: https://etherpad.openstack.org/p/glance-queens-ptg-remove-v1-API  
__label__integration NSXv3: Refactor LBaaS L7 based on API change  NSXv3 backend made a few API changes, and introduced a new param match_type to map l7 rule compare_type. This patch refactors l7 code for these changes in backend.  
__label__objective NSXv3: Refactor LBaaS L7 based on API change  NSXv3 backend made a few API changes, and introduced a new param match_type to map l7 rule compare_type. This patch refactors l7 code for these changes in backend.  
__label__integration NSXv3: Refactor LBaaS L7 based on API change  NSXv3 backend made a few API changes, and introduced a new param match_type to map l7 rule compare_type. This patch refactors l7 code for these changes in backend.  
__label__objective NSXv3: Refactor LBaaS L7 based on API change  NSXv3 backend made a few API changes, and introduced a new param match_type to map l7 rule compare_type. This patch refactors l7 code for these changes in backend.  
__label__integration Update and refactor zunclient  I do two things on this patch: [1] update params in zunclient [2] refactor params in zunclient by usingi memoized_with_request  python-zunclient v1 api refactor client and remove or rename parameters: removed zun_url by using endpoint_override instead input_auth_token was renamed to auth_token and zun-ui was using the old params, listing images and containers on horizon will raise error like: MissingRequiredOptions: Auth plugin requires parameters which were not given: auth_url  
__label__objective Update and refactor zunclient  I do two things on this patch: [1] update params in zunclient [2] refactor params in zunclient by usingi memoized_with_request  python-zunclient v1 api refactor client and remove or rename parameters: removed zun_url by using endpoint_override instead input_auth_token was renamed to auth_token and zun-ui was using the old params, listing images and containers on horizon will raise error like: MissingRequiredOptions: Auth plugin requires parameters which were not given: auth_url  
__label__integration Refactor requests usage in owners script  In an effort to be more consistent about encoding parameters for GET requests made in the script which generates electoral rolls and some event invite lists, centralize calls to the requests module. This has the added benefit of encapsulating retry logic for potential reuse in later additions to the script.  Also generalize the query_gerrit() function to flexibly handle both Gerrit REST API which return neutered JSON and Gerrit Gitweb queries for retrieving YAML with its own special character encoding challenges.  Further extract out the JSON decoder error handling so it can be reused for other APIs than Gerrit's in future feature additions.  
__label__objective Refactor requests usage in owners script  In an effort to be more consistent about encoding parameters for GET requests made in the script which generates electoral rolls and some event invite lists, centralize calls to the requests module. This has the added benefit of encapsulating retry logic for potential reuse in later additions to the script.  Also generalize the query_gerrit() function to flexibly handle both Gerrit REST API which return neutered JSON and Gerrit Gitweb queries for retrieving YAML with its own special character encoding challenges.  Further extract out the JSON decoder error handling so it can be reused for other APIs than Gerrit's in future feature additions.  
__label__integration Update api references according to refactor result  
__label__objective Update api references according to refactor result  
__label__integration Refactor iDRAC is ready functionality  Web Services Management (WS-Management and WS-Man) requests/commands can fail or return invalid results when issued to an Integrated Dell Remote Access Controller (iDRAC) whose Lifecycle Controller remote service is not "ready". Specifically, this applies to the WS-Man Enumerate and Invoke operations.  A Dell technical white paper [0], "Lifecycle Controller Integration -- Best Practices Guide", states that for Lifecycle Controller firmware 1.5.0 and later "The Lifecycle Controller remote service must be in a 'ready' state before running any other WSMAN commands." That applies to almost all of the workflows and use cases documented by that paper and those supported by the openstack/python-dracclient project. That document describes how to determine the readiness of the Lifecycle Controller remote service. A project commit [1] implements that.  This refactors that patch in preparation for changing the internal implementation of the project's APIs so that they follow that best practice. The implementation of is_idrac_ready() and wait_until_idrac_is_ready() have been relocated further down the call stack, to the iDRAC specialization of the WS-Man client defined by class dracclient.client.WSManClient. Those methods continue to be available through the API provided by class dracclient.client.Client.  Changes have not been made to the project's APIs nor to any functional behavior.  [0] http://en.community.dell.com/techcenter/extras/m/white_papers/20442332 [1] https://github.com/openstack/python-dracclient/commit/39253bb272a7d4cfcc161c19708b8c6949a21240  
__label__objective Refactor iDRAC is ready functionality  Web Services Management (WS-Management and WS-Man) requests/commands can fail or return invalid results when issued to an Integrated Dell Remote Access Controller (iDRAC) whose Lifecycle Controller remote service is not "ready". Specifically, this applies to the WS-Man Enumerate and Invoke operations.  A Dell technical white paper [0], "Lifecycle Controller Integration -- Best Practices Guide", states that for Lifecycle Controller firmware 1.5.0 and later "The Lifecycle Controller remote service must be in a 'ready' state before running any other WSMAN commands." That applies to almost all of the workflows and use cases documented by that paper and those supported by the openstack/python-dracclient project. That document describes how to determine the readiness of the Lifecycle Controller remote service. A project commit [1] implements that.  This refactors that patch in preparation for changing the internal implementation of the project's APIs so that they follow that best practice. The implementation of is_idrac_ready() and wait_until_idrac_is_ready() have been relocated further down the call stack, to the iDRAC specialization of the WS-Man client defined by class dracclient.client.WSManClient. Those methods continue to be available through the API provided by class dracclient.client.Client.  Changes have not been made to the project's APIs nor to any functional behavior.  [0] http://en.community.dell.com/techcenter/extras/m/white_papers/20442332 [1] https://github.com/openstack/python-dracclient/commit/39253bb272a7d4cfcc161c19708b8c6949a21240  
__label__integration Refactor nova migration config into client & target profiles  The nova migration config has always been applied by the base::nova profile. It assumed that libvirtd/nova-compute and are all running on the same host. Where this config didn't apply (e.g a nova api host) it was disabled by a flag.  This approach is not compatible with containers. Hieradata for all containers are combined so per-host flags no longer work, and we can no longer assume libvirtd and nova-compute run in the same context.  This change refactors the profiles out of the base nova profile and into a client profile and a target profile that can be included where appropriate.  
__label__objective Refactor nova migration config into client & target profiles  The nova migration config has always been applied by the base::nova profile. It assumed that libvirtd/nova-compute and are all running on the same host. Where this config didn't apply (e.g a nova api host) it was disabled by a flag.  This approach is not compatible with containers. Hieradata for all containers are combined so per-host flags no longer work, and we can no longer assume libvirtd and nova-compute run in the same context.  This change refactors the profiles out of the base nova profile and into a client profile and a target profile that can be included where appropriate.  
__label__integration NSX|v3 refactor trunk driver to use nsxlib api  
__label__integration WIP: refactoring methods in db models  * This is a preparation for optimizing API layer. We need to   get rid of redundant data coversions like "db model -> dict ->   REST resource". We can do directly "db model -> REST resource".  
__label__objective WIP: refactoring methods in db models  * This is a preparation for optimizing API layer. We need to   get rid of redundant data coversions like "db model -> dict ->   REST resource". We can do directly "db model -> REST resource".  
__label__integration WIP: Refactor the network_info field in API layer  
__label__integration ITRI DISCO cinder volume driver  This commit is the refactored version of DISCO volume driver of ITRI.  We change the SOAP API to REST API. It adds also two different classes:  * Class for the different calls using REST API * Class for attach/detach a DISCO volume  It also includes the unit tests.  DocImpact Implements: blueprint refactor-disco-volume-driver  
__label__objective ITRI DISCO cinder volume driver  This commit is the refactored version of DISCO volume driver of ITRI.  We change the SOAP API to REST API. It adds also two different classes:  * Class for the different calls using REST API * Class for attach/detach a DISCO volume  It also includes the unit tests.  DocImpact Implements: blueprint refactor-disco-volume-driver  
__label__integration Refactor: remove _items() in nova/api/openstack/compute/attach_interfaces.py  removing _items() as this method is called only once and also to ensure policy checks happen in the API methods.  blueprint policy-docs  
__label__objective Refactor: remove _items() in nova/api/openstack/compute/attach_interfaces.py  removing _items() as this method is called only once and also to ensure policy checks happen in the API methods.  blueprint policy-docs  
__label__integration Refactoring XJobAPI methods  1. What is the problem? All the methods of XJobAPI is sharing common functionality which can be simplify it.  2. What is the solution for the problem? Refactoring those methods as much as possible  3. What the features need to be implemented to the Tricircle to    realize the solution? None  TrivialFix  
__label__objective Refactoring XJobAPI methods  1. What is the problem? All the methods of XJobAPI is sharing common functionality which can be simplify it.  2. What is the solution for the problem? Refactoring those methods as much as possible  3. What the features need to be implemented to the Tricircle to    realize the solution? None  TrivialFix  
__label__integration Refactor cell loading in compute/api  This merely pulls out the loading of the global cells cache into a helper function that can be used by later patches that will also depend on this. Since it's the same code, existing tests exercise this path just like they did before it was moved.  This was moved out of another patch to re-order some dependencies.  Related to blueprint cells-aware-api 
__label__objective Refactor cell loading in compute/api  This merely pulls out the loading of the global cells cache into a helper function that can be used by later patches that will also depend on this. Since it's the same code, existing tests exercise this path just like they did before it was moved.  This was moved out of another patch to re-order some dependencies.  Related to blueprint cells-aware-api 
__label__integration [17/xx] Refactor DB consistent  Partially-Implements: blueprint refactor-nb-api 
__label__integration [WIP] Refactor chassis northbound API methods  
__label__objective [WIP] Refactor chassis northbound API methods  
__label__integration Refactor port-status-update NB API  1. Rename table portstats to n_listener, which means neutron listener 2. Make the port-status API consistent with other APIs 3. Add timestamp to n_listener table  
__label__objective Refactor port-status-update NB API  1. Rename table portstats to n_listener, which means neutron listener 2. Make the port-status API consistent with other APIs 3. Add timestamp to n_listener table  
__label__integration Refactoring of artifact db api  
__label__integration Refactor device_profile retrieve in ARQ post API  Remove device_profile object None check as db has raised ResourceNotFound exception.  
__label__objective Refactor device_profile retrieve in ARQ post API  Remove device_profile object None check as db has raised ResourceNotFound exception.  
__label__quality Refactor Manila share-instance-export-locations API  This patch makes share-instance-export-locations API more readable and maintainable.  
__label__integration Refactor Manila share-instance-export-locations API  This patch makes share-instance-export-locations API more readable and maintainable.  
__label__objective Refactor Manila share-instance-export-locations API  This patch makes share-instance-export-locations API more readable and maintainable.  
__label__integration refactor: move down ``dev_number`` in xenapi  This patch resolves the TODO marked by John Garbutt. Refactored xenapi.volumeops by moving ``dev_number`` var from ``attach_volume`` to ``_attach_volume_to_vm`` method.  
__label__quality Refactor Manila share-access API  This patch makes share-access API be more readable and maintainable.  
__label__integration Refactor Manila share-access API  This patch makes share-access API be more readable and maintainable.  
__label__objective Refactor Manila share-access API  This patch makes share-access API be more readable and maintainable.  
__label__quality Refactor Manila share-export-location API  This patch make share-export-location be readable and maintainable.  
__label__integration Refactor Manila share-export-location API  This patch make share-export-location be readable and maintainable.  
__label__objective Refactor Manila share-export-location API  This patch make share-export-location be readable and maintainable.  
__label__integration WIP. Refactor v2 and v3 APIs support  Now v2 API uses code from v3. It's confusing and logically incorrect. This patch makes v3 API as an extended version of v2.  
__label__objective WIP. Refactor v2 and v3 APIs support  Now v2 API uses code from v3. It's confusing and logically incorrect. This patch makes v3 API as an extended version of v2.  
__label__integration Refactor network APIs  1. Move network related codes into its own dir 2. Initialize network API to interact with neutron  
__label__objective Refactor network APIs  1. Move network related codes into its own dir 2. Initialize network API to interact with neutron  
__label__quality [api-ref] Refactor Malina availability-zones API  This patch makes availability-zones API be more readable and maintainable.  
__label__integration [api-ref] Refactor Malina availability-zones API  This patch makes availability-zones API be more readable and maintainable.  
__label__objective [api-ref] Refactor Malina availability-zones API  This patch makes availability-zones API be more readable and maintainable.  
__label__integration Ceilometer-api / Gnocchi-api WSGI refactor  - now using wsgi apps for both apis - bumped gnocchi package version due to python-openssl bugs  
__label__objective Ceilometer-api / Gnocchi-api WSGI refactor  - now using wsgi apps for both apis - bumped gnocchi package version due to python-openssl bugs  
__label__objective Refactor api test_common to use ddt library  
__label__integration refactor existing implementation into a class  As part of the re-implementation work using dulwich I want to create a Scanner class, to replace some of the module-level functions in the scanner module now. This patch moves existing code around into something like what I would expect that API to look like, without changing the implementation details.  The class API is still subject to change in the future, but this should make it a little easier to review those implementation changes.  
__label__objective refactor existing implementation into a class  As part of the re-implementation work using dulwich I want to create a Scanner class, to replace some of the module-level functions in the scanner module now. This patch moves existing code around into something like what I would expect that API to look like, without changing the implementation details.  The class API is still subject to change in the future, but this should make it a little easier to review those implementation changes.  
__label__quality [api-ref] Refactor Manila scheduler stats API  This patch makes the scheduler stats API codes to be more readable and maintainable.  
__label__integration [api-ref] Refactor Manila scheduler stats API  This patch makes the scheduler stats API codes to be more readable and maintainable.  
__label__objective [api-ref] Refactor Manila scheduler stats API  This patch makes the scheduler stats API codes to be more readable and maintainable.  
__label__quality [api-ref] Refactor Manila snapshot API  This patch makes the Manila snapshot API to be more readable and maintainable.  
__label__integration [api-ref] Refactor Manila snapshot API  This patch makes the Manila snapshot API to be more readable and maintainable.  
__label__objective [api-ref] Refactor Manila snapshot API  This patch makes the Manila snapshot API to be more readable and maintainable.  
__label__integration Refactor two nearly useless secgroup tests  There are two tests that masquerade as "compute api tests" to validate some instance security group associations. However, those are just there because it's a convenient place to create instances with a full complement of things. They depend on behaviors we're about to move, and are also slated to be irrelevant when we remove nova-network. In the meantime, move them closer to the other tests for the bits they are exercising to get them out of the way of the following patch.  
__label__objective Refactor two nearly useless secgroup tests  There are two tests that masquerade as "compute api tests" to validate some instance security group associations. However, those are just there because it's a convenient place to create instances with a full complement of things. They depend on behaviors we're about to move, and are also slated to be irrelevant when we remove nova-network. In the meantime, move them closer to the other tests for the bits they are exercising to get them out of the way of the following patch.  
__label__quality refactor parameter validation  This change makes parameter validation more robust by eliminating custom validation functions and using neutron-lib facilities instead. Also it minimizes usage of neutron.api imports.  
__label__objective refactor parameter validation  This change makes parameter validation more robust by eliminating custom validation functions and using neutron-lib facilities instead. Also it minimizes usage of neutron.api imports.  
__label__integration Refactor extra_spec  use PATCH for extra spec actions, api ref will be updated soon.  
__label__quality Refactor Ceilometer resource API  This patch refactors Ceilometer resource API to make it be readable and maintainable.  
__label__integration Refactor Ceilometer resource API  This patch refactors Ceilometer resource API to make it be readable and maintainable.  
__label__objective Refactor Ceilometer resource API  This patch refactors Ceilometer resource API to make it be readable and maintainable.  
__label__integration Refactor redis driver and fix the db interface  1. Redis driver brings a new db api: process_ha, it is called in api-nb module but it is not abstracted in db api layer.  2. Change some private method name in redis driver.  3. Remove check_connection in redis driver as it is not used.  
__label__objective Refactor redis driver and fix the db interface  1. Redis driver brings a new db api: process_ha, it is called in api-nb module but it is not abstracted in db api layer.  2. Change some private method name in redis driver.  3. Remove check_connection in redis driver as it is not used.  
__label__integration Refactor REST API support to remove boilerplate  This change removes the following boilerplate:  * Most filter setup, along with output to a JSON response, is now   captured in the new craton.api.v1.base.filtered_context decorator.  * Provides standard exception to HTTP status code mapping using the   new craton.api.v1.base.http_codes decorator.  There are additional opportunities for boilerplate removal, especially in scenarios where we have multiple ways of looking up a specific cell or region; but this boilerplate is not addressed in this fix.  In addition, this change now returns 204 upon DELETE in the API; and some minor PEP 8 cleanups.  
__label__objective Refactor REST API support to remove boilerplate  This change removes the following boilerplate:  * Most filter setup, along with output to a JSON response, is now   captured in the new craton.api.v1.base.filtered_context decorator.  * Provides standard exception to HTTP status code mapping using the   new craton.api.v1.base.http_codes decorator.  There are additional opportunities for boilerplate removal, especially in scenarios where we have multiple ways of looking up a specific cell or region; but this boilerplate is not addressed in this fix.  In addition, this change now returns 204 upon DELETE in the API; and some minor PEP 8 cleanups.  
__label__integration Refactor OvsdbSwitchApi  Current OvsdbSwitchApi provides ovs command sometimes, and outputs result directly sometimes. It makes it hard to use. Also, OvsdbSwitchApi uses neutron framework to execute ovs command sometimes, and uses idlutils directly sometimes. Using idlutils directly will not reconnect ovsdb, if timeout.  This patch does following things: 1) Create a dedicated ovsdb api, which is a sub class of OvsdbIdl from neutron 2) Make OvsdbSwitchApi execute ovs command, and remove explicit execute() call from consumers 3) Remove directly using idlutils in OvsdbSwitchApi 4) Remove obselete methods in OvsdbSwitchApi 5) Remove duplicated command class, which already have defination in neutron  
__label__objective Refactor OvsdbSwitchApi  Current OvsdbSwitchApi provides ovs command sometimes, and outputs result directly sometimes. It makes it hard to use. Also, OvsdbSwitchApi uses neutron framework to execute ovs command sometimes, and uses idlutils directly sometimes. Using idlutils directly will not reconnect ovsdb, if timeout.  This patch does following things: 1) Create a dedicated ovsdb api, which is a sub class of OvsdbIdl from neutron 2) Make OvsdbSwitchApi execute ovs command, and remove explicit execute() call from consumers 3) Remove directly using idlutils in OvsdbSwitchApi 4) Remove obselete methods in OvsdbSwitchApi 5) Remove duplicated command class, which already have defination in neutron  
__label__quality [api-ref] Refactor Manila security service API  This patch make security service api reference to be more readable and maintainable.  
__label__integration [api-ref] Refactor Manila security service API  This patch make security service api reference to be more readable and maintainable.  
__label__objective [api-ref] Refactor Manila security service API  This patch make security service api reference to be more readable and maintainable.  
__label__quality Refactor Manila quota set API  This patch refactors Manila quota set API to make it be readable and maintainable.  
__label__integration Refactor Manila quota set API  This patch refactors Manila quota set API to make it be readable and maintainable.  
__label__objective Refactor Manila quota set API  This patch refactors Manila quota set API to make it be readable and maintainable.  
__label__quality [api-ref] Refactor limits and services API  This patch refactors limits and services API to make it clear to understand and maintain.  
__label__integration [api-ref] Refactor limits and services API  This patch refactors limits and services API to make it clear to understand and maintain.  
__label__objective [api-ref] Refactor limits and services API  This patch refactors limits and services API to make it clear to understand and maintain.  
__label__quality [api-ref] Refactor manila extension API  This patch refactors manila extension API to make it clear to understand and maintain.  
__label__integration [api-ref] Refactor manila extension API  This patch refactors manila extension API to make it clear to understand and maintain.  
__label__objective [api-ref] Refactor manila extension API  This patch refactors manila extension API to make it clear to understand and maintain.  
__label__integration Refactor Keystone admin-tenant API v2  This patch modifies parameters names in admin-tenant.inc  
__label__integration Refactor Keystone admin-endpoint API  This patch moves content of admin-endpoints_parameters.yaml to parameters.yaml and modifies some parameters names.  
__label__objective Refactor Keystone admin-endpoint API  This patch moves content of admin-endpoints_parameters.yaml to parameters.yaml and modifies some parameters names.  
__label__quality Refactor Ceilometer event API  This patch refactors Ceilometer event API to make it be maintainable and readable.  
__label__integration Refactor Ceilometer event API  This patch refactors Ceilometer event API to make it be maintainable and readable.  
__label__objective Refactor Ceilometer event API  This patch refactors Ceilometer event API to make it be maintainable and readable.  
__label__quality Refactor Ceilometer alarm API  This patch refactors Ceilometer alarm API to make it be maintainable and readable.  
__label__integration Refactor Ceilometer alarm API  This patch refactors Ceilometer alarm API to make it be maintainable and readable.  
__label__objective Refactor Ceilometer alarm API  This patch refactors Ceilometer alarm API to make it be maintainable and readable.  
__label__integration Refactor for floating IP updating checks  1. Will not fill the API fip updating dict with tenant_id and id anymore, floatingip_db will be passed around functions. We need to make the `fip` dict come from the API as it orginal is.  2. Refactor some redundant log messages for fip's port tenant_id check and IP version check.  
__label__objective Refactor for floating IP updating checks  1. Will not fill the API fip updating dict with tenant_id and id anymore, floatingip_db will be passed around functions. We need to make the `fip` dict come from the API as it orginal is.  2. Refactor some redundant log messages for fip's port tenant_id check and IP version check.  
__label__integration DB: Refactor networking-mlnx db  This patch to the following: 1. removes unused db api 2. change the sdn_journal.data to text 3. add MONITORING state sdn_journal.state 4. add api to get all rows with monitroing state  
__label__objective DB: Refactor networking-mlnx db  This patch to the following: 1. removes unused db api 2. change the sdn_journal.data to text 3. add MONITORING state sdn_journal.state 4. add api to get all rows with monitroing state  
__label__integration Refactor API version negotiation code  Makes sure heartbeats can send versions higher than one required for tokens while also making sure we never send a version we don't know.  Also makes code easier to understand.  
__label__quality Refactor API version negotiation code  Makes sure heartbeats can send versions higher than one required for tokens while also making sure we never send a version we don't know.  Also makes code easier to understand.  
__label__objective Refactor API version negotiation code  Makes sure heartbeats can send versions higher than one required for tokens while also making sure we never send a version we don't know.  Also makes code easier to understand.  
__label__integration Refactoring k8s models    1. Unfortunately, not all methods allows 'namespace' parameter.   2. Some resources had wrong api calls.   3. Some resources had wrong parameters.    In this review 'namespace' parameter was moved into each resource   class it needed.  
__label__objective Refactoring k8s models    1. Unfortunately, not all methods allows 'namespace' parameter.   2. Some resources had wrong api calls.   3. Some resources had wrong parameters.    In this review 'namespace' parameter was moved into each resource   class it needed.  
__label__integration Refactor glance_store's public API  
__label__integration Refactor the rpc callback version discovery mechanism  The previous version depended on the AgentDbMixin to be loaded by any plugin, and also introduced an __init__ on the mixin which was problematic: mixins are expected to be classes which add methods to another class, but to implement no constructor. One of the plugins had one of the elements of MRO not calling to super().__init__ and hence not triggering this __init__ method.  This change requires the plugins using the rpc callback mechanism to provide the AgentDbMixin which is used to refresh cache of known resource consumers (agents) and versions on demand, this way we make it more clear that the rpc_callback api is currently designed to be used with agents only, despite of its extensibility to other areas.  
__label__objective Refactor the rpc callback version discovery mechanism  The previous version depended on the AgentDbMixin to be loaded by any plugin, and also introduced an __init__ on the mixin which was problematic: mixins are expected to be classes which add methods to another class, but to implement no constructor. One of the plugins had one of the elements of MRO not calling to super().__init__ and hence not triggering this __init__ method.  This change requires the plugins using the rpc callback mechanism to provide the AgentDbMixin which is used to refresh cache of known resource consumers (agents) and versions on demand, this way we make it more clear that the rpc_callback api is currently designed to be used with agents only, despite of its extensibility to other areas.  
__label__integration Refactor audit api tests into their own file  These tests can be refactored futher to not involve the middleware at all.  
__label__objective Refactor audit api tests into their own file  These tests can be refactored futher to not involve the middleware at all.  
__label__integration Refactor create_event onto the api object.  There are a number of methods on the api object that already handle request specifics. Move the create_event method over to the api so that it can be tested independantly of the middleware.  
__label__objective Refactor create_event onto the api object.  There are a number of methods on the api object that already handle request specifics. Move the create_event method over to the api so that it can be tested independantly of the middleware.  
__label__integration Refactor API params tuples to sets  SUPPORTED_PARAMS, LIST_PARAMS and ORDER_VALUES are used only to check whether some value is inside of them.  This patchset makes them sets instead of tuples.  
__label__objective Refactor API params tuples to sets  SUPPORTED_PARAMS, LIST_PARAMS and ORDER_VALUES are used only to check whether some value is inside of them.  This patchset makes them sets instead of tuples.  
__label__integration NSX-v QoS - fix refactor integration to use the correct api  Commit b3ca00f7a603d3f1763c7a031baf476b85f790bc used the wrong api to get the Qos policy rules  
__label__integration Further refactor of Glare API urls  This patch makes addressing to urls within file more convenient  
__label__objective Further refactor of Glare API urls  This patch makes addressing to urls within file more convenient  
__label__integration Refactor storage-init command  Use internal API to get a reference to the storage backend and remove the need to use stevedore.  
__label__objective Refactor storage-init command  Use internal API to get a reference to the storage backend and remove the need to use stevedore.  
__label__integration Refactor writer command  Make use of the internal storage API to remove the need of manual stevedore loading.  
__label__objective Refactor writer command  Make use of the internal storage API to remove the need of manual stevedore loading.  
__label__integration Refactor scenario tests to facilitate multi-group  The scenario tests need to have the group classes broken up to allow interleaving of the different parts of the tests so that the gate can finish in a reasonable amount of time.  The runners, however, need to be the same for each main group, thus allowing state to be preserved between groups of the same feature.  The creation of runners was refactored to allow for this.  The module tests were also modified to use the new paradym, which allowed the removal of the global varaibles in the runner.  Dependencies on tests.api were also removed.  
__label__testing Refactor scenario tests to facilitate multi-group  The scenario tests need to have the group classes broken up to allow interleaving of the different parts of the tests so that the gate can finish in a reasonable amount of time.  The runners, however, need to be the same for each main group, thus allowing state to be preserved between groups of the same feature.  The creation of runners was refactored to allow for this.  The module tests were also modified to use the new paradym, which allowed the removal of the global varaibles in the runner.  Dependencies on tests.api were also removed.  
__label__integration Convergence: Refactor worker  Refactor the worker service; move the check resource code to its own class and keep the convergence worker API clean.  This refactor will help us contain the convergence logic in a separate class file instead of in RCP API. In future, the RPC API will only have the new API added to it.  
__label__objective Convergence: Refactor worker  Refactor the worker service; move the check resource code to its own class and keep the convergence worker API clean.  This refactor will help us contain the convergence logic in a separate class file instead of in RCP API. In future, the RPC API will only have the new API added to it.  
__label__integration Refactor for create_floatingip call  The current implementation for create_floatingip results in the L3 API being called twice. The first pass causes additional attributes to be populated, which are used in the second call. This patch converts this to a single call, which gets the parameters needed and continues, rather than call itself recursively.  
__label__objective Refactor for create_floatingip call  The current implementation for create_floatingip results in the L3 API being called twice. The first pass causes additional attributes to be populated, which are used in the second call. This patch converts this to a single call, which gets the parameters needed and continues, rather than call itself recursively.  
__label__integration Refactored Watcher API service  This patchset introduces the use of oslo.service to run the Watcher API service.  
__label__integration Refactor Database layer  Misc changes which include below improvements:  1. Using oslo.db to get a clean db API layer 2. Using alembic to support db migration 3. Fix all the PEP 8 issues for new code 4. A new API /health which is also used to verify the new DB API  
__label__objective Refactor Database layer  Misc changes which include below improvements:  1. Using oslo.db to get a clean db API layer 2. Using alembic to support db migration 3. Fix all the PEP 8 issues for new code 4. A new API /health which is also used to verify the new DB API  
__label__integration Refactor for create_floatingip call  The current implementation for create_floatingip results in the L3 API being called twice. The first pass causes additional attributes to be populated, which are used in the second call. This patch converts this to a single call, which gets the parameters needed and continues, rather than call itself recursively.  
__label__objective Refactor for create_floatingip call  The current implementation for create_floatingip results in the L3 API being called twice. The first pass causes additional attributes to be populated, which are used in the second call. This patch converts this to a single call, which gets the parameters needed and continues, rather than call itself recursively.  
__label__integration Refactor for create_floatingip call  The current implementation for create_floatingip results in the L3 API being called twice. The first pass causes additional attributes to be populated, which are used in the second call. This patch converts this to a single call, which gets the parameters needed and continues, rather than call itself recursively.  
__label__objective Refactor for create_floatingip call  The current implementation for create_floatingip results in the L3 API being called twice. The first pass causes additional attributes to be populated, which are used in the second call. This patch converts this to a single call, which gets the parameters needed and continues, rather than call itself recursively.  
__label__integration HyperV: Refactor livemigr, avoiding getting disk paths remotely  During live migration, if passthrough disks are attached to instances, we need to create a planned VM, setting the right disk paths according to the destination host so that the volumes will still be accessible after the instance is migrated.  At the moment, we retrieve the disk paths remotely via WMI. Due to the fact that some WMI API methods are broken, for the FC implementation we had to use the hbaapi.dll functions directly, using ctypes.  As this can't work remotely, this patch slightly changes the live migration workflow. The planned VM is created during the pre-livemigration step on the destination host, updating the virtual disk resources.  Co-Authored-By: Alin Balutoiu <abalutoiu@cloudbasesolutions.com>  Partially-implements: blueprint hyperv-fibre-channel Depends-On: I29bbca19f274c1f6f092a16c2585fd33ff78c971 
__label__objective HyperV: Refactor livemigr, avoiding getting disk paths remotely  During live migration, if passthrough disks are attached to instances, we need to create a planned VM, setting the right disk paths according to the destination host so that the volumes will still be accessible after the instance is migrated.  At the moment, we retrieve the disk paths remotely via WMI. Due to the fact that some WMI API methods are broken, for the FC implementation we had to use the hbaapi.dll functions directly, using ctypes.  As this can't work remotely, this patch slightly changes the live migration workflow. The planned VM is created during the pre-livemigration step on the destination host, updating the virtual disk resources.  Co-Authored-By: Alin Balutoiu <abalutoiu@cloudbasesolutions.com>  Partially-implements: blueprint hyperv-fibre-channel Depends-On: I29bbca19f274c1f6f092a16c2585fd33ff78c971 
__label__integration Refactor urls to Glare API  This commit gathers in dictionary all the hardcoded urls in file.  
__label__integration Refactor Distil API to support new endpoints  
__label__integration Refactor for create_floatingip call  The current implementation for create_floatingip results in the L3 API being called twice. The first pass causes additional attributes to be populated, which are used in the second call. This patch converts this to a single call, which gets the parameters needed and continues, rather than call itself recursively.  
__label__objective Refactor for create_floatingip call  The current implementation for create_floatingip results in the L3 API being called twice. The first pass causes additional attributes to be populated, which are used in the second call. This patch converts this to a single call, which gets the parameters needed and continues, rather than call itself recursively.  
__label__integration add refactor-sahara.service.api spec  The HTTP API calls that sahara receives are processed by the ``sahara.api`` package, the functions of this module then call upon the ``sahara.service.api`` and ``sahara.service.edp.api`` modules to perform processing before being passed to the conductor. To help accomodate future API changes, these modules should be refactored to create a more unified package for future implementors.  Partial-Implements: bp v2-api-experimental-impl 
__label__objective add refactor-sahara.service.api spec  The HTTP API calls that sahara receives are processed by the ``sahara.api`` package, the functions of this module then call upon the ``sahara.service.api`` and ``sahara.service.edp.api`` modules to perform processing before being passed to the conductor. To help accomodate future API changes, these modules should be refactored to create a more unified package for future implementors.  Partial-Implements: bp v2-api-experimental-impl 
__label__integration [WIP] Refactor Resource to better serve Proxy  Through a series of attempts we haven't been able to sufficiently solve the issue of what were called "path_args" in the past, somewhat of a relic of the time before we had the Proxy layer. "path_args" made a lot of sense back when there was only the Resource layer, when the SDK's usage was almost entirely through the classmethods on Resource, back when command-line example scripts were all we had to go on.  As things have grown in the year-plus since that time, we have bolted a great higher-level interface on a lower-level interface that was stuck in an older use-case. It was most recently a problem when we had resource.prop types that accepeted Resource types, which both there and elsewhere meant it became significantly harder - if not impossible - to have nested Resources. An example of this is how ServerInterface is a Resource that depends on Server.  This new approach strips Resource down to a public API of only create, get, update, delete, head, find, and list methods. Resource subclasses are still constructed in the same manner, though the naming of what were "props" is now slightly different, but more clear. Additionally, through that change comes a more clear user experience for URI parameters, formerly known as, "path_args". The changes here pave the way for more clarity on query parameters, although they haven't been fully explored.  As the changing of this class has pretty far reaching effects, it will exist temporarily in the "resource2" module. The first change will be to introduce the module itself as a standalone, and then we will change each service independent of the others. Subsequent changes should not be too disruptive, mostly in the form of renaming things like resource.prop to resource.Body, and the like.  There is a fairly major side effect of the implementation of this class that is behaviorally different from the initial Resource implementation. Previously, any-and-all data sent into a Resource initializer would be tracked internally on the Resource instance and then sent to the server *even if it did not correspond to a resource.prop on the class*. Ultimately this would have become a problem as servers are becoming more strict about what they receive, but this implementation makes no allowance for so-called loose data to be entered. If there is no component attribute for an argument to be sent to the server, or one received from the server, it will not exist as an attribute of the Resource. Currently, said data is just dropped entirely, but it could be logged or perhaps a strict/loose mode could be engaged to warn or otherwise fail when unexpected data is entered. Ultimately, this behavior had to happen. In the near term it may mean that the SDK doesn't work exactly as it had in previous versions, but that will just mean updating Resource definitions to match what is truly expected or given by the server.  A relatively major change that comes from this refactoring is a deconstruction of the unit tests that previously existed. While resource.prop now lives on as resource2._BaseComponent, the unit tests were started over from scratch as they were too tightly coupled to the Resource class rather than being tested as an independent unit. All of the code that is being refactored as a part of this change is now being tested as independent of any other code as is possible.  
__label__testing [WIP] Refactor Resource to better serve Proxy  Through a series of attempts we haven't been able to sufficiently solve the issue of what were called "path_args" in the past, somewhat of a relic of the time before we had the Proxy layer. "path_args" made a lot of sense back when there was only the Resource layer, when the SDK's usage was almost entirely through the classmethods on Resource, back when command-line example scripts were all we had to go on.  As things have grown in the year-plus since that time, we have bolted a great higher-level interface on a lower-level interface that was stuck in an older use-case. It was most recently a problem when we had resource.prop types that accepeted Resource types, which both there and elsewhere meant it became significantly harder - if not impossible - to have nested Resources. An example of this is how ServerInterface is a Resource that depends on Server.  This new approach strips Resource down to a public API of only create, get, update, delete, head, find, and list methods. Resource subclasses are still constructed in the same manner, though the naming of what were "props" is now slightly different, but more clear. Additionally, through that change comes a more clear user experience for URI parameters, formerly known as, "path_args". The changes here pave the way for more clarity on query parameters, although they haven't been fully explored.  As the changing of this class has pretty far reaching effects, it will exist temporarily in the "resource2" module. The first change will be to introduce the module itself as a standalone, and then we will change each service independent of the others. Subsequent changes should not be too disruptive, mostly in the form of renaming things like resource.prop to resource.Body, and the like.  There is a fairly major side effect of the implementation of this class that is behaviorally different from the initial Resource implementation. Previously, any-and-all data sent into a Resource initializer would be tracked internally on the Resource instance and then sent to the server *even if it did not correspond to a resource.prop on the class*. Ultimately this would have become a problem as servers are becoming more strict about what they receive, but this implementation makes no allowance for so-called loose data to be entered. If there is no component attribute for an argument to be sent to the server, or one received from the server, it will not exist as an attribute of the Resource. Currently, said data is just dropped entirely, but it could be logged or perhaps a strict/loose mode could be engaged to warn or otherwise fail when unexpected data is entered. Ultimately, this behavior had to happen. In the near term it may mean that the SDK doesn't work exactly as it had in previous versions, but that will just mean updating Resource definitions to match what is truly expected or given by the server.  A relatively major change that comes from this refactoring is a deconstruction of the unit tests that previously existed. While resource.prop now lives on as resource2._BaseComponent, the unit tests were started over from scratch as they were too tightly coupled to the Resource class rather than being tested as an independent unit. All of the code that is being refactored as a part of this change is now being tested as independent of any other code as is possible.  
__label__quality [WIP] Refactor Resource to better serve Proxy  Through a series of attempts we haven't been able to sufficiently solve the issue of what were called "path_args" in the past, somewhat of a relic of the time before we had the Proxy layer. "path_args" made a lot of sense back when there was only the Resource layer, when the SDK's usage was almost entirely through the classmethods on Resource, back when command-line example scripts were all we had to go on.  As things have grown in the year-plus since that time, we have bolted a great higher-level interface on a lower-level interface that was stuck in an older use-case. It was most recently a problem when we had resource.prop types that accepeted Resource types, which both there and elsewhere meant it became significantly harder - if not impossible - to have nested Resources. An example of this is how ServerInterface is a Resource that depends on Server.  This new approach strips Resource down to a public API of only create, get, update, delete, head, find, and list methods. Resource subclasses are still constructed in the same manner, though the naming of what were "props" is now slightly different, but more clear. Additionally, through that change comes a more clear user experience for URI parameters, formerly known as, "path_args". The changes here pave the way for more clarity on query parameters, although they haven't been fully explored.  As the changing of this class has pretty far reaching effects, it will exist temporarily in the "resource2" module. The first change will be to introduce the module itself as a standalone, and then we will change each service independent of the others. Subsequent changes should not be too disruptive, mostly in the form of renaming things like resource.prop to resource.Body, and the like.  There is a fairly major side effect of the implementation of this class that is behaviorally different from the initial Resource implementation. Previously, any-and-all data sent into a Resource initializer would be tracked internally on the Resource instance and then sent to the server *even if it did not correspond to a resource.prop on the class*. Ultimately this would have become a problem as servers are becoming more strict about what they receive, but this implementation makes no allowance for so-called loose data to be entered. If there is no component attribute for an argument to be sent to the server, or one received from the server, it will not exist as an attribute of the Resource. Currently, said data is just dropped entirely, but it could be logged or perhaps a strict/loose mode could be engaged to warn or otherwise fail when unexpected data is entered. Ultimately, this behavior had to happen. In the near term it may mean that the SDK doesn't work exactly as it had in previous versions, but that will just mean updating Resource definitions to match what is truly expected or given by the server.  A relatively major change that comes from this refactoring is a deconstruction of the unit tests that previously existed. While resource.prop now lives on as resource2._BaseComponent, the unit tests were started over from scratch as they were too tightly coupled to the Resource class rather than being tested as an independent unit. All of the code that is being refactored as a part of this change is now being tested as independent of any other code as is possible.  
__label__objective [WIP] Refactor Resource to better serve Proxy  Through a series of attempts we haven't been able to sufficiently solve the issue of what were called "path_args" in the past, somewhat of a relic of the time before we had the Proxy layer. "path_args" made a lot of sense back when there was only the Resource layer, when the SDK's usage was almost entirely through the classmethods on Resource, back when command-line example scripts were all we had to go on.  As things have grown in the year-plus since that time, we have bolted a great higher-level interface on a lower-level interface that was stuck in an older use-case. It was most recently a problem when we had resource.prop types that accepeted Resource types, which both there and elsewhere meant it became significantly harder - if not impossible - to have nested Resources. An example of this is how ServerInterface is a Resource that depends on Server.  This new approach strips Resource down to a public API of only create, get, update, delete, head, find, and list methods. Resource subclasses are still constructed in the same manner, though the naming of what were "props" is now slightly different, but more clear. Additionally, through that change comes a more clear user experience for URI parameters, formerly known as, "path_args". The changes here pave the way for more clarity on query parameters, although they haven't been fully explored.  As the changing of this class has pretty far reaching effects, it will exist temporarily in the "resource2" module. The first change will be to introduce the module itself as a standalone, and then we will change each service independent of the others. Subsequent changes should not be too disruptive, mostly in the form of renaming things like resource.prop to resource.Body, and the like.  There is a fairly major side effect of the implementation of this class that is behaviorally different from the initial Resource implementation. Previously, any-and-all data sent into a Resource initializer would be tracked internally on the Resource instance and then sent to the server *even if it did not correspond to a resource.prop on the class*. Ultimately this would have become a problem as servers are becoming more strict about what they receive, but this implementation makes no allowance for so-called loose data to be entered. If there is no component attribute for an argument to be sent to the server, or one received from the server, it will not exist as an attribute of the Resource. Currently, said data is just dropped entirely, but it could be logged or perhaps a strict/loose mode could be engaged to warn or otherwise fail when unexpected data is entered. Ultimately, this behavior had to happen. In the near term it may mean that the SDK doesn't work exactly as it had in previous versions, but that will just mean updating Resource definitions to match what is truly expected or given by the server.  A relatively major change that comes from this refactoring is a deconstruction of the unit tests that previously existed. While resource.prop now lives on as resource2._BaseComponent, the unit tests were started over from scratch as they were too tightly coupled to the Resource class rather than being tested as an independent unit. All of the code that is being refactored as a part of this change is now being tested as independent of any other code as is possible.  
__label__integration Refactor API version range support  This patch refactors the API version check so that the min/max versions are defined only for OpenStack APIs. Previously, these definitions are placed in a global scope which is incorrect.  partial-bp: api-microversioning 
__label__objective Refactor API version range support  This patch refactors the API version check so that the min/max versions are defined only for OpenStack APIs. Previously, these definitions are placed in a global scope which is incorrect.  partial-bp: api-microversioning 
__label__integration HyperV: Refactor livemigr, avoiding getting disk paths remotely  During live migration, if passthrough disks are attached to instances, we need to create a planned VM, setting the right disk paths according to the destination host so that the volumes will still be accessible after the instance is migrated.  At the moment, we retrieve the disk paths remotely via WMI. Due to the fact that some WMI API methods are broken, for the FC implementation we had to use the hbaapi.dll functions directly, using ctypes.  As this can't work remotely, this patch slightly changes the live migration workflow. The planned VM is created during the pre-livemigration step on the destination host, updating the virtual disk resources.  Co-Authored-By: Alin Balutoiu <abalutoiu@cloudbasesolutions.com>  Partially-implements: blueprint hyperv-fibre-channel Depends-On: I29bbca19f274c1f6f092a16c2585fd33ff78c971 
__label__objective HyperV: Refactor livemigr, avoiding getting disk paths remotely  During live migration, if passthrough disks are attached to instances, we need to create a planned VM, setting the right disk paths according to the destination host so that the volumes will still be accessible after the instance is migrated.  At the moment, we retrieve the disk paths remotely via WMI. Due to the fact that some WMI API methods are broken, for the FC implementation we had to use the hbaapi.dll functions directly, using ctypes.  As this can't work remotely, this patch slightly changes the live migration workflow. The planned VM is created during the pre-livemigration step on the destination host, updating the virtual disk resources.  Co-Authored-By: Alin Balutoiu <abalutoiu@cloudbasesolutions.com>  Partially-implements: blueprint hyperv-fibre-channel Depends-On: I29bbca19f274c1f6f092a16c2585fd33ff78c971 
__label__integration Fixing URL of index variable and refactoring   This patch fixes the problem related to the URL of the server  profile template, that was not the same as used in REST API of  OneView. Also, some refactoring in the client.py module,  methods *by_uuid, that could be simplified.  
__label__objective Fixing URL of index variable and refactoring   This patch fixes the problem related to the URL of the server  profile template, that was not the same as used in REST API of  OneView. Also, some refactoring in the client.py module,  methods *by_uuid, that could be simplified.  
__label__integration Refactor cluster create  This patch refactors the cluster create api to use the action crate method.  
__label__integration Major refactoring of how OS clients are created and managed  * Single universal ClientManager class was dropped in favor of    of individual in-context methods to create OS clients without    ClientManager restrictions. * Environment class was renamed to ExecutionSession to avoid    common confusion with io.murano.Environment * execution_session_local module was introduced to simplify    keep of per-execution session (per-deployment) data. This    is similar to thread-locals with the difference that there can    be many threads in single session. * All OS-clients related code was migrated to keystone client    sessions and API v3 (except for GLARE and Mistral that doesn't    support sessions). This increases performance and solves    authentication problems that could be caused by token expiration    even with trusts enabled. * [DEFAULT]/home_region setting was introduced instead of    [murano]/region_for_services to configure what region    should be used by the clients by default (where Murano API    resides). All client factories respect this setting.  
__label__quality Major refactoring of how OS clients are created and managed  * Single universal ClientManager class was dropped in favor of    of individual in-context methods to create OS clients without    ClientManager restrictions. * Environment class was renamed to ExecutionSession to avoid    common confusion with io.murano.Environment * execution_session_local module was introduced to simplify    keep of per-execution session (per-deployment) data. This    is similar to thread-locals with the difference that there can    be many threads in single session. * All OS-clients related code was migrated to keystone client    sessions and API v3 (except for GLARE and Mistral that doesn't    support sessions). This increases performance and solves    authentication problems that could be caused by token expiration    even with trusts enabled. * [DEFAULT]/home_region setting was introduced instead of    [murano]/region_for_services to configure what region    should be used by the clients by default (where Murano API    resides). All client factories respect this setting.  
__label__quality Refactor controllers in API layer  We have quite some duplicated logics in the resource controllers at API layer. This patch abstracts the duplicated code into a base class.  
__label__objective Refactor controllers in API layer  We have quite some duplicated logics in the resource controllers at API layer. This patch abstracts the duplicated code into a base class.  
__label__integration Refactor puppet-mistral  The module was written in a way that was not consistent with other Puppet OpenStack modules, the interface was very different.  This patch: * add db.pp * update logging.pp with usual parameters * drop useless parameters in keystone/auth.pp * cleanup params.pp * drop services.pp, which is useless * Update unit tests * Add coordination support in init.pp * Some alignment issues * Add more doc in README * Stop including ::mistral in all classes * Include mistral::policy in mistral::api  This is a non-backward compatible change, but since the module has no release and no stable branch, also very new, this is not something we need to care at this stage. People using this module at this stage will have to update their manifests otherwise their Puppet catalog will fail.  
__label__quality Refactor puppet-mistral  The module was written in a way that was not consistent with other Puppet OpenStack modules, the interface was very different.  This patch: * add db.pp * update logging.pp with usual parameters * drop useless parameters in keystone/auth.pp * cleanup params.pp * drop services.pp, which is useless * Update unit tests * Add coordination support in init.pp * Some alignment issues * Add more doc in README * Stop including ::mistral in all classes * Include mistral::policy in mistral::api  This is a non-backward compatible change, but since the module has no release and no stable branch, also very new, this is not something we need to care at this stage. People using this module at this stage will have to update their manifests otherwise their Puppet catalog will fail.  
__label__integration Refactored existing tempest API tests  We must set up Tempest for Watcher (http://docs.openstack.org/developer/tempest/configuration.html) to run integration tests inside devstack environment.  This patchset is a refactoring of the stale Tempest tests to now use the latest Tempest coding standards (like using plugins and credentials factory).  
__label__testing Refactored existing tempest API tests  We must set up Tempest for Watcher (http://docs.openstack.org/developer/tempest/configuration.html) to run integration tests inside devstack environment.  This patchset is a refactoring of the stale Tempest tests to now use the latest Tempest coding standards (like using plugins and credentials factory).  
__label__integration Refactor modules used by senlin-api  This patch moves wsgi into api module, merge JSON serializers and deserializers into the same module for easier maintenance.  
__label__quality Refactor modules used by senlin-api  This patch moves wsgi into api module, merge JSON serializers and deserializers into the same module for easier maintenance.  
__label__integration Refactor objects into a magic registry  This adds a register hook to the objects base class that allows us to late-import objects classes into ironic.objects. This is useful to allow object classes to depend on other objects.  For example, this will allow us to do the Port.node_uuid munging that we currently do in the API layer, in the objects layer instead.  This is completely taken from Nova, much thanks to comstud and dansmith and whoever else worked on that.  
__label__objective Refactor objects into a magic registry  This adds a register hook to the objects base class that allows us to late-import objects classes into ironic.objects. This is useful to allow object classes to depend on other objects.  For example, this will allow us to do the Port.node_uuid munging that we currently do in the API layer, in the objects layer instead.  This is completely taken from Nova, much thanks to comstud and dansmith and whoever else worked on that.  
__label__integration Refactoring and removing duplicate code of "base.Manager" heirs without changing the API  This commit does refactoring regarding the base.Manager and the specific managers that inherit from it (Chassis, Node, Port and Driver).  The specific managers had a lot of duplicate code in methods like: get, create and vendor_passthru, they were literally equal, what does not make sense once we already had the base.Manager inheritance to avoid this type of problem.  This change moves the duplicate code to the parent (base.Manager) and make the specific managers simpler by making the base.Manager more useful regarding code reuse for these methods.  
__label__quality Refactoring and removing duplicate code of "base.Manager" heirs without changing the API  This commit does refactoring regarding the base.Manager and the specific managers that inherit from it (Chassis, Node, Port and Driver).  The specific managers had a lot of duplicate code in methods like: get, create and vendor_passthru, they were literally equal, what does not make sense once we already had the base.Manager inheritance to avoid this type of problem.  This change moves the duplicate code to the parent (base.Manager) and make the specific managers simpler by making the base.Manager more useful regarding code reuse for these methods.  
__label__integration Hyper-V: refactors utilsfactory  The Hyper-V API can change from a version to another (e.g. new features), requiring a new Utils class to be added for specific versions.  Refactors utilsfactory module. In this way, a new utils class can be added without adding a new parameter when retrieving the suitable class for windows version.  
__label__objective Hyper-V: refactors utilsfactory  The Hyper-V API can change from a version to another (e.g. new features), requiring a new Utils class to be added for specific versions.  Refactors utilsfactory module. In this way, a new utils class can be added without adding a new parameter when retrieving the suitable class for windows version.  
__label__quality Servicegroup foundational refactoring for Control Plane  At present, there are various interfaces through which services data can be manipulated - admin interface(nova-manage), extensions (contrib/services.py), servicegroup API layer. Having different interfaces to manipulate the source of truth can lead to severe data inconsistency for something as useful as stored in nova.services. The proposal is to follow a common path, while interacting with services data, for all the three interfaces mentioned above. This common path will go through the servicegroup layer, who's primary purpose is to manage and check for service liveliness. Doing so will help to overcome the tight coupling between nova and services database and also have a consistent view of services data, service liveliness, etc.  
__label__objective Servicegroup foundational refactoring for Control Plane  At present, there are various interfaces through which services data can be manipulated - admin interface(nova-manage), extensions (contrib/services.py), servicegroup API layer. Having different interfaces to manipulate the source of truth can lead to severe data inconsistency for something as useful as stored in nova.services. The proposal is to follow a common path, while interacting with services data, for all the three interfaces mentioned above. This common path will go through the servicegroup layer, who's primary purpose is to manage and check for service liveliness. Doing so will help to overcome the tight coupling between nova and services database and also have a consistent view of services data, service liveliness, etc.  
__label__objective Revert "Refactoring and removing duplicate code of "base.Manager" heirs"  This reverts commit 46b279bb36b2647bf04097fe271586fca76f5ed0.  The patch being reverted has broken the API compatibility. Until a fix for this issue has been created, the patch should be reverted.  
__label__integration Refactor authorize() method in wsgi.py  Almost every API method written in Manila performs a policy check against relevant policies in etc/policy.json. A method - authorize() was introduced in manila/api/openstack/wsgi.py in commit e4428f5e6c324a674c76f81340e1c94a956b4c6c to perform these policy checks.  This patch refactors the authorize() method as a decorator for consistency and easy usage in APIs that choose to implement the policy check prior to any core logic.  Prior unit tests are modified for the APIs impacted through this change.  
__label__objective Refactor authorize() method in wsgi.py  Almost every API method written in Manila performs a policy check against relevant policies in etc/policy.json. A method - authorize() was introduced in manila/api/openstack/wsgi.py in commit e4428f5e6c324a674c76f81340e1c94a956b4c6c to perform these policy checks.  This patch refactors the authorize() method as a decorator for consistency and easy usage in APIs that choose to implement the policy check prior to any core logic.  Prior unit tests are modified for the APIs impacted through this change.  
__label__integration Refactor project api and ui make it generic  As part of providing a mechanism to let users group dashboard information by other run metadata keys (project, voting, etc.), a few changes were needed both on the ui and api.  On the api, the changes consist on making the endpoint accept any run metadata key, and not only projects. On the ui, the changes consist on renaming and adapting ProjectController to become GroupController: a generic controller that is going to handle this top-level grouping.  
__label__objective Refactor project api and ui make it generic  As part of providing a mechanism to let users group dashboard information by other run metadata keys (project, voting, etc.), a few changes were needed both on the ui and api.  On the api, the changes consist on making the endpoint accept any run metadata key, and not only projects. On the ui, the changes consist on renaming and adapting ProjectController to become GroupController: a generic controller that is going to handle this top-level grouping.  
__label__integration Refactor Evoque API  
__label__integration Code refactor for monasca-api resources  - refactored variables - pulled method calls into variable to boost readability  
__label__quality Code refactor for monasca-api resources  - refactored variables - pulled method calls into variable to boost readability  
__label__integration refactor NSX v3 UTs  this patch contains a major refactor of the nsx v3 tests which have nsx rest api calls in their execution stack. in particular it removes the global module level patching that's current done as this type of global patching has intermittent failures when testr runs tests in parallel. these failures become more prevalent when the psec code + tests are added. thus this patch is needed for the psec drop I have.  NB: as noted in the code, most of the module level patching / mocking magic can go away once we move the current functional logic to a rest resource model.  
__label__testing refactor NSX v3 UTs  this patch contains a major refactor of the nsx v3 tests which have nsx rest api calls in their execution stack. in particular it removes the global module level patching that's current done as this type of global patching has intermittent failures when testr runs tests in parallel. these failures become more prevalent when the psec code + tests are added. thus this patch is needed for the psec drop I have.  NB: as noted in the code, most of the module level patching / mocking magic can go away once we move the current functional logic to a rest resource model.  
__label__integration Refactor placement::api  This patch refactors placement::api class with generic_service class to make service/package management more simple.  Note that it also fixes incorrect stop of httpd service on non-Debian system.  Conflicts:         manifests/api.pp  Backport note: This backports doesn't include deprecation part because we shouldn't deprecate parameteres in stable branches.  
__label__objective Refactor placement::api  This patch refactors placement::api class with generic_service class to make service/package management more simple.  Note that it also fixes incorrect stop of httpd service on non-Debian system.  Conflicts:         manifests/api.pp  Backport note: This backports doesn't include deprecation part because we shouldn't deprecate parameteres in stable branches.  
__label__integration QoS agent extension and driver refactoring  Cache QoS policies to reduce resource pull RPC calls to server.  Support delete per rule_type or delete all rules.  Moved some code common to all drivers into base qos driver abstract class.  Partially-Implements: quantum-qos-api 
__label__objective QoS agent extension and driver refactoring  Cache QoS policies to reduce resource pull RPC calls to server.  Support delete per rule_type or delete all rules.  Moved some code common to all drivers into base qos driver abstract class.  Partially-Implements: quantum-qos-api 
__label__integration Qos SR-IOV: Refactor extension delete to get mac and pci slot  This patch pair the mac and pci_slot for a device (VF) instead of searching the pci_slot when calling extension delete. It is also change the port_id to be mac before pass it to the agent extension. This is required because mac is the key identifer for the VF port and on extention port delete api will allow to remove it from the know_port list of the qos_extension.  
__label__objective Qos SR-IOV: Refactor extension delete to get mac and pci slot  This patch pair the mac and pci_slot for a device (VF) instead of searching the pci_slot when calling extension delete. It is also change the port_id to be mac before pass it to the agent extension. This is required because mac is the key identifer for the VF port and on extention port delete api will allow to remove it from the know_port list of the qos_extension.  
__label__integration Hyper-V: refactors utilsfactory  The Hyper-V API can change from a version to another (e.g. new features), requiring a new Utils class to be added for specific versions.  Refactors utilsfactory module. In this way, a new utils class can be added without adding a new parameter when retrieving the suitable class for windows version.  
__label__objective Hyper-V: refactors utilsfactory  The Hyper-V API can change from a version to another (e.g. new features), requiring a new Utils class to be added for specific versions.  Refactors utilsfactory module. In this way, a new utils class can be added without adding a new parameter when retrieving the suitable class for windows version.  
__label__integration Refactor pluggable DB module  Replace the applicative API with a simple to implement API for key/value DB's. Use NB API layer to do the key and value parsing into values and implement the various objects used in the applications.  
__label__objective Refactor pluggable DB module  Replace the applicative API with a simple to implement API for key/value DB's. Use NB API layer to do the key and value parsing into values and implement the various objects used in the applications.  
__label__integration Refactoring error handling in Refstack API  All exited refstack excetions should be transformed to valid HTTPError with descriptive messages  Closes-Bug: #1485715 
__label__objective Refactoring error handling in Refstack API  All exited refstack excetions should be transformed to valid HTTPError with descriptive messages  Closes-Bug: #1485715 
__label__integration WIP: Refactor notify logic into backends  The idea here is, like many things, the time and frequency of sending NOTIFYs is not the same for every backend. So we let the backends decide when to send their NOTIFYs. Ideally this makes the Pool Manager code simpler and the backend code easier to understand, and avoids sending some unnecessary NOTIFYs.  This requires a change to MiniDNS' rpcapi to make notify_zone_changed and get_serial_number take a host and port, instead of a nameserver object.  
__label__objective WIP: Refactor notify logic into backends  The idea here is, like many things, the time and frequency of sending NOTIFYs is not the same for every backend. So we let the backends decide when to send their NOTIFYs. Ideally this makes the Pool Manager code simpler and the backend code easier to understand, and avoids sending some unnecessary NOTIFYs.  This requires a change to MiniDNS' rpcapi to make notify_zone_changed and get_serial_number take a host and port, instead of a nameserver object.  
__label__integration Refactor api tests (_update_alarm)  This patch fixs a input of the helper function '_update_alarm()' which used to require alarm data as it's input although it just referred 'alarm_id'.  This patch also delete unecessary '_get_alarm()'.  
__label__quality Refactor api tests (_update_alarm)  This patch fixs a input of the helper function '_update_alarm()' which used to require alarm data as it's input although it just referred 'alarm_id'.  This patch also delete unecessary '_get_alarm()'.  
__label__testing Refactor api tests (_update_alarm)  This patch fixs a input of the helper function '_update_alarm()' which used to require alarm data as it's input although it just referred 'alarm_id'.  This patch also delete unecessary '_get_alarm()'.  
__label__integration Contexts interface refactoring  * Added methods to retrieve context keys, check data/function    presence, delete data/function * Recursion was eliminated * collect_functions() was moved to the base class and uses inheritors    get_functions() API * Bugs in MultiContext were fixed * Unit tests were added  
__label__objective Contexts interface refactoring  * Added methods to retrieve context keys, check data/function    presence, delete data/function * Recursion was eliminated * collect_functions() was moved to the base class and uses inheritors    get_functions() API * Bugs in MultiContext were fixed * Unit tests were added  
__label__integration Refactor api tests for alarm history  This patch fixs a input of the helper function '_get_alarm_history()' which used to get alarm data although it just referred 'alarm_id'.  This patch also delete unecessary '_get_alarm()'.  
__label__objective Refactor api tests for alarm history  This patch fixs a input of the helper function '_get_alarm_history()' which used to get alarm data although it just referred 'alarm_id'.  This patch also delete unecessary '_get_alarm()'.  
__label__integration Refactor and update test_instances and test_volumes_api  Deduplicate code in test_instances.py and test_volumes_api.py. Update test_attach_volume method. Add method wait_for_volume_status to base.py. Add method get_volume_property to base.py  
__label__quality Refactor and update test_instances and test_volumes_api  Deduplicate code in test_instances.py and test_volumes_api.py. Update test_attach_volume method. Add method wait_for_volume_status to base.py. Add method get_volume_property to base.py  
__label__integration Refactoring api interface on freezer_ui  Refactoring freezer key in endpoint discovery Add new class to handle nested values from API  
__label__integration Refactoring logging and translations on freezer_api  Refactoring logging to use oslo.log to have standard OpenStack logging. Refactoring log messages to enable i18n translations. Refactoring Exception messages to enable i18n translations.  New requirement oslo.log.  
__label__objective Refactoring logging and translations on freezer_api  Refactoring logging to use oslo.log to have standard OpenStack logging. Refactoring log messages to enable i18n translations. Refactoring Exception messages to enable i18n translations.  New requirement oslo.log.  
__label__integration Refactor api imports to OpenStack Hacking compliant  http://docs.openstack.org/developer/hacking/  
__label__integration Refactored meta collector API  Global improvement of the API. Added support for policy engine. Added new policy rights to manage the collector mappings. Updated documentation. Added contrib script to do simple API tests.  
__label__quality Refactored meta collector API  Global improvement of the API. Added support for policy engine. Added new policy rights to manage the collector mappings. Updated documentation. Added contrib script to do simple API tests.  
__label__objective Refactored meta collector API  Global improvement of the API. Added support for policy engine. Added new policy rights to manage the collector mappings. Updated documentation. Added contrib script to do simple API tests.  
__label__integration Refactor test_servers to use instance objects  This does a major refactor of code in test_servers to use instance objects and generally mock things at the compute/api layer instead of all the way down in the database layer.  It removes a few tests and conditions that were just testing DB semantics from the highest levels.  This will be needed when we drop the flavor compatibility code from the instance object, as these tests were mocking out the DB layer with old-style instance structures.  
__label__objective Refactor test_servers to use instance objects  This does a major refactor of code in test_servers to use instance objects and generally mock things at the compute/api layer instead of all the way down in the database layer.  It removes a few tests and conditions that were just testing DB semantics from the highest levels.  This will be needed when we drop the flavor compatibility code from the instance object, as these tests were mocking out the DB layer with old-style instance structures.  
__label__integration WIP: Refactoring out common client api methods  Added the following method to handle the requests sent to NSX:     - create_resource     - update_resource     - get_resource     - delete_resource  
__label__integration Complete refactoring of Glance image-members v2 API implementation.  The refactoring is motivated by multiple issues in the current code: - Exceptions thrown by image lookup as well as member lookup are handled in the same try-except block and handled as if it was only the image lookup that failed. - Does not take into account that in v2, trying to do any operation on a public image members should throw 403 Forbidden error. As a result, the current response messages for operations on a public image show an "Unauthorized" error message even for admin rather than the more accurate "Public images do not have any members" error message. - The show() method returns 404 when 403 is appropriate due to the way it does exception handling.  
__label__objective Complete refactoring of Glance image-members v2 API implementation.  The refactoring is motivated by multiple issues in the current code: - Exceptions thrown by image lookup as well as member lookup are handled in the same try-except block and handled as if it was only the image lookup that failed. - Does not take into account that in v2, trying to do any operation on a public image members should throw 403 Forbidden error. As a result, the current response messages for operations on a public image show an "Unauthorized" error message even for admin rather than the more accurate "Public images do not have any members" error message. - The show() method returns 404 when 403 is appropriate due to the way it does exception handling.  
__label__integration Servicegroup foundational refactoring for Control Plane  At present, there are various interfaces through which services data can be manipulated - admin interface(nova-manage), extensions (contrib/services.py), servicegroup API layer. Having different interfaces to manipulate the source of truth can lead to severe data inconsistency for something as useful as stored in nova.services. The proposal is to follow a common path, while interacting with services data, for all the three interfaces mentioned above. This common path will go through the servicegroup layer, who's primary purpose is the manage and check for service liveliness. Doing so will help to overcome the tight coupling between nova and services database and also have a consistent view of services data, service liveliness, etc.  
__label__objective Servicegroup foundational refactoring for Control Plane  At present, there are various interfaces through which services data can be manipulated - admin interface(nova-manage), extensions (contrib/services.py), servicegroup API layer. Having different interfaces to manipulate the source of truth can lead to severe data inconsistency for something as useful as stored in nova.services. The proposal is to follow a common path, while interacting with services data, for all the three interfaces mentioned above. This common path will go through the servicegroup layer, who's primary purpose is the manage and check for service liveliness. Doing so will help to overcome the tight coupling between nova and services database and also have a consistent view of services data, service liveliness, etc.  
__label__integration Volumes API refactor   * Added v1/2 common models   * Added v1/2 common client   * Bugfix in datasets   * Added dataset tagging on create  
__label__integration Refactor API create_volume flow  This commit refactors the code to be more compliant with DRY rule. I've also changed some comments to be more readable and correct.  
__label__quality Refactor API create_volume flow  This commit refactors the code to be more compliant with DRY rule. I've also changed some comments to be more readable and correct.  
__label__integration Refactor node's and driver's vendor passthru to a common place  This patch is refactoring the node's and driver's vendor passthru in the API to a common place (utils.py). Historically this code was duplicated because each endpoint supported different things (driver's vendor passhtru endpoing being always synchrounous and node's being always asyncronous), since now both endpoints supports the same features and the code is almost the same it makes sense to have it in a common place, so changing once will affect both.  Related-Blueprint: ipxe-dynamic-config 
__label__objective Refactor node's and driver's vendor passthru to a common place  This patch is refactoring the node's and driver's vendor passthru in the API to a common place (utils.py). Historically this code was duplicated because each endpoint supported different things (driver's vendor passhtru endpoing being always synchrounous and node's being always asyncronous), since now both endpoints supports the same features and the code is almost the same it makes sense to have it in a common place, so changing once will affect both.  Related-Blueprint: ipxe-dynamic-config 
__label__integration (WIP)Refactor show_port() in neutron api  Refactor show_port() in neutron api code, in order to reduce the duplicated exception handling.  
__label__quality (WIP)Refactor show_port() in neutron api  Refactor show_port() in neutron api code, in order to reduce the duplicated exception handling.  
__label__integration Refactor internal API of update subnet routes  Refactor internal API of update subnet routes. 1 Prepare code to easy add vpn routes processing 2 Prevent updating routes for explicitly associated subnets in case of default VPC route table reassociation. 3 Make sequence of API parameters more natural.  
__label__objective Refactor internal API of update subnet routes  Refactor internal API of update subnet routes. 1 Prepare code to easy add vpn routes processing 2 Prevent updating routes for explicitly associated subnets in case of default VPC route table reassociation. 3 Make sequence of API parameters more natural.  
__label__integration Refactored Surveil API Client  
__label__integration Refactor placement::api  This patch refactors placement::api class with generic_service class to make service/package management more simple.  Note that it also fixes incorrect stop of httpd service on non-Debian system.  
__label__integration Refactor placement::api  This patch refactors placement::api class with generic_service class to make service/package management more simple.  Note that it also fixes incorrect stop of httpd service on non-Debian system.  
__label__integration Refactor db operstaions for terracotta  Add db adstraction api for db operstaions and using sqlalchemy to implement ORM.  
__label__integration Refactor api service  
__label__integration Refactoring of security-groups operation  Mostly eliminates nsx-api calls within a database transactions  
__label__integration Refactor Tasks to work as a Subcontroller  Tasks are always attached to Stories so it makes sense to have list of stories available through /stories/<story_id>/tasks endpoint. However current web-ui treats Tasks as a first-level API resource so they should be also available at /tasks  
__label__objective Refactor Tasks to work as a Subcontroller  Tasks are always attached to Stories so it makes sense to have list of stories available through /stories/<story_id>/tasks endpoint. However current web-ui treats Tasks as a first-level API resource so they should be also available at /tasks  
__label__integration Refactor: make Fernet token creation/validation API agnostic  A lot of the Fernet token create / validate logic ended up in the v3 token provider methods, but there's nothing really API-specific about it, so it should be moved somewhere such that it's available for use by the v2 token provider code, which will just utilize a subset of the available functionality (no domain scoped tokens, etc).  As a result of this change, everything about the implementation details of Fernet tokens end up in the token_formatters module.  
__label__objective Refactor: make Fernet token creation/validation API agnostic  A lot of the Fernet token create / validate logic ended up in the v3 token provider methods, but there's nothing really API-specific about it, so it should be moved somewhere such that it's available for use by the v2 token provider code, which will just utilize a subset of the available functionality (no domain scoped tokens, etc).  As a result of this change, everything about the implementation details of Fernet tokens end up in the token_formatters module.  
__label__integration Refactor: remove Fernet formatter's dep on trust_api / v3 token helper  This removes the token formatter's dependency on both trust_api and the v3 token data helper, leaving token formatters with nothing to deal with other than primitive data. The responsibility of managing token_data objects is left entirely to the core token provider.  
__label__objective Refactor: remove Fernet formatter's dep on trust_api / v3 token helper  This removes the token formatter's dependency on both trust_api and the v3 token data helper, leaving token formatters with nothing to deal with other than primitive data. The responsibility of managing token_data objects is left entirely to the core token provider.  
__label__integration Refactor task output: DB API methods for action executions  * DB API methods for action executions * Field "definition_name" in ActionExecution * Minor refactoring  
__label__integration VPNaaS: device driver and agent refactoring part 1  This is part of a multi-commit refactoring of the VPN agent to remove dependency on the L3 agent.  Currently, the reference implementation of the VPN device driver must use the L3 agent to obtain the router_info needed to complete actions, such as adding and deleting NAT rules.  To break this dependency, the plan is to save the router_info, when create_router() is called, so that the device driver can then directly access the router, without going through the L3 agent (and VPNService).  For the first step of the refactoring, this commit will pass the router_info object to the device driver's create_router() call, instead of just the router ID. Because this affects an internal API for all device drivers, it is presented as a separate commit.  
__label__objective VPNaaS: device driver and agent refactoring part 1  This is part of a multi-commit refactoring of the VPN agent to remove dependency on the L3 agent.  Currently, the reference implementation of the VPN device driver must use the L3 agent to obtain the router_info needed to complete actions, such as adding and deleting NAT rules.  To break this dependency, the plan is to save the router_info, when create_router() is called, so that the device driver can then directly access the router, without going through the L3 agent (and VPNService).  For the first step of the refactoring, this commit will pass the router_info object to the device driver's create_router() call, instead of just the router ID. Because this affects an internal API for all device drivers, it is presented as a separate commit.  
__label__integration Refactor the ProcessMonitor API  Refactor the ProcessMonitor API to reduce coupling to ProcessManager, and stop replicating the whole API and behavior of ProcessManager.  We introduced an abstract MonitoredProcess class to reduce coupling, and allow other kinds of external processes to be monitored too.  Partially Implements: blueprint agent-child-processes-status Co-Authored-By: Mike Kolesnik <mkolesni@redhat.com>  
__label__quality Refactor the ProcessMonitor API  Refactor the ProcessMonitor API to reduce coupling to ProcessManager, and stop replicating the whole API and behavior of ProcessManager.  We introduced an abstract MonitoredProcess class to reduce coupling, and allow other kinds of external processes to be monitored too.  Partially Implements: blueprint agent-child-processes-status Co-Authored-By: Mike Kolesnik <mkolesni@redhat.com>  
__label__integration OSWL utils infrastructure was refactored  Description of collected resources and their attributes expanded to cover different versions of api for OS components. Corresponding statistics.utils functions updated to support new format. Unit tests updated and expanded.  
__label__testing OSWL utils infrastructure was refactored  Description of collected resources and their attributes expanded to cover different versions of api for OS components. Corresponding statistics.utils functions updated to support new format. Unit tests updated and expanded.  
__label__integration Refactoring task output: full redesign of DB models  * Created a Execution hierarcy mapped on a single table:   - ActionExecution   - WorkflowExecution   - TaskExecution * Created necessary associations within Execution hierarchy * Created necessary methods for Execution objects on DB API * Created Definition hierarchy mapped on separate tables:   - WorkbookDefinition   - WorkflowDefinition   - ActionDefinition * Renamed attributes   - 'wf_name' -> 'workflow_name'   - 'wf_spec' -> 'spec' * Fixed all unit tests  TODO: * Complete renaming throughout the code * Thorough testing of the new DB model * Further refactoring of workflow engine  WIP  
__label__objective Refactoring task output: full redesign of DB models  * Created a Execution hierarcy mapped on a single table:   - ActionExecution   - WorkflowExecution   - TaskExecution * Created necessary associations within Execution hierarchy * Created necessary methods for Execution objects on DB API * Created Definition hierarchy mapped on separate tables:   - WorkbookDefinition   - WorkflowDefinition   - ActionDefinition * Renamed attributes   - 'wf_name' -> 'workflow_name'   - 'wf_spec' -> 'spec' * Fixed all unit tests  TODO: * Complete renaming throughout the code * Thorough testing of the new DB model * Further refactoring of workflow engine  WIP  
__label__integration Add refactor neutron RESTful API  Refactor the resource mapping driver with the neutron RESTful APIs.  
__label__integration Refactor REST API tests for common code patterns  Move common patterns out into a helper class and refactor tests to use that base helper.  
__label__testing Refactor REST API tests for common code patterns  Move common patterns out into a helper class and refactor tests to use that base helper.  
__label__integration Manila NetApp cDOT driver refactoring  The Manila cDOT driver is a single file exceeding 1200 lines.  It contains multiple things (driver code, protocol helpers, ZAPI invocation code, options) that should be split apart to allow for easier maintenance and readability and add the potential for code sharing when we reintroduce a 7-mode driver, add a single-SVM cDOT driver, etc.  We recently refactored NetApp's DOT Cinder drivers into a 4-layer structure (interface, library, client, API) that separates concerns and achieves the goals set forth above.  This commit satisfies a plan to do the same thing in Manila.  The implementation steps are:  1. Update directory structure to match that of the Cinder NetApp drivers 2. Create driver interface shim 3. Move driver code to library (with base & C-mode classes, to allow for    7-mode code sharing later) 4. Move protocol helpers to separate files (already organized by base &    C-mode classes) 5. Split out ZAPI code to client layer (with base & C-mode classes, to    allow for 7-mode code sharing later) 6. Implement NetApp driver factory as in Cinder 7. Implement common NetApp options file as in Cinder 8. Implement cDOT API call optimizations 9. Update all unit tests as needed  Note that this patch appears to treble the total number of code lines. This is due to the addition of many more unit tests plus a large amount of fake controller API data to feed the API client tests.  Implements: blueprint netapp-manila-cdot-driver-refactoring Closes-Bug: #1410317 Partial-Bug: #1396953 Closes-Bug: #1370965 Closes-Bug: #1418690 Closes-Bug: #1418696  
__label__quality Manila NetApp cDOT driver refactoring  The Manila cDOT driver is a single file exceeding 1200 lines.  It contains multiple things (driver code, protocol helpers, ZAPI invocation code, options) that should be split apart to allow for easier maintenance and readability and add the potential for code sharing when we reintroduce a 7-mode driver, add a single-SVM cDOT driver, etc.  We recently refactored NetApp's DOT Cinder drivers into a 4-layer structure (interface, library, client, API) that separates concerns and achieves the goals set forth above.  This commit satisfies a plan to do the same thing in Manila.  The implementation steps are:  1. Update directory structure to match that of the Cinder NetApp drivers 2. Create driver interface shim 3. Move driver code to library (with base & C-mode classes, to allow for    7-mode code sharing later) 4. Move protocol helpers to separate files (already organized by base &    C-mode classes) 5. Split out ZAPI code to client layer (with base & C-mode classes, to    allow for 7-mode code sharing later) 6. Implement NetApp driver factory as in Cinder 7. Implement common NetApp options file as in Cinder 8. Implement cDOT API call optimizations 9. Update all unit tests as needed  Note that this patch appears to treble the total number of code lines. This is due to the addition of many more unit tests plus a large amount of fake controller API data to feed the API client tests.  Implements: blueprint netapp-manila-cdot-driver-refactoring Closes-Bug: #1410317 Partial-Bug: #1396953 Closes-Bug: #1370965 Closes-Bug: #1418690 Closes-Bug: #1418696  
__label__testing Manila NetApp cDOT driver refactoring  The Manila cDOT driver is a single file exceeding 1200 lines.  It contains multiple things (driver code, protocol helpers, ZAPI invocation code, options) that should be split apart to allow for easier maintenance and readability and add the potential for code sharing when we reintroduce a 7-mode driver, add a single-SVM cDOT driver, etc.  We recently refactored NetApp's DOT Cinder drivers into a 4-layer structure (interface, library, client, API) that separates concerns and achieves the goals set forth above.  This commit satisfies a plan to do the same thing in Manila.  The implementation steps are:  1. Update directory structure to match that of the Cinder NetApp drivers 2. Create driver interface shim 3. Move driver code to library (with base & C-mode classes, to allow for    7-mode code sharing later) 4. Move protocol helpers to separate files (already organized by base &    C-mode classes) 5. Split out ZAPI code to client layer (with base & C-mode classes, to    allow for 7-mode code sharing later) 6. Implement NetApp driver factory as in Cinder 7. Implement common NetApp options file as in Cinder 8. Implement cDOT API call optimizations 9. Update all unit tests as needed  Note that this patch appears to treble the total number of code lines. This is due to the addition of many more unit tests plus a large amount of fake controller API data to feed the API client tests.  Implements: blueprint netapp-manila-cdot-driver-refactoring Closes-Bug: #1410317 Partial-Bug: #1396953 Closes-Bug: #1370965 Closes-Bug: #1418690 Closes-Bug: #1418696  
__label__objective Manila NetApp cDOT driver refactoring  The Manila cDOT driver is a single file exceeding 1200 lines.  It contains multiple things (driver code, protocol helpers, ZAPI invocation code, options) that should be split apart to allow for easier maintenance and readability and add the potential for code sharing when we reintroduce a 7-mode driver, add a single-SVM cDOT driver, etc.  We recently refactored NetApp's DOT Cinder drivers into a 4-layer structure (interface, library, client, API) that separates concerns and achieves the goals set forth above.  This commit satisfies a plan to do the same thing in Manila.  The implementation steps are:  1. Update directory structure to match that of the Cinder NetApp drivers 2. Create driver interface shim 3. Move driver code to library (with base & C-mode classes, to allow for    7-mode code sharing later) 4. Move protocol helpers to separate files (already organized by base &    C-mode classes) 5. Split out ZAPI code to client layer (with base & C-mode classes, to    allow for 7-mode code sharing later) 6. Implement NetApp driver factory as in Cinder 7. Implement common NetApp options file as in Cinder 8. Implement cDOT API call optimizations 9. Update all unit tests as needed  Note that this patch appears to treble the total number of code lines. This is due to the addition of many more unit tests plus a large amount of fake controller API data to feed the API client tests.  Implements: blueprint netapp-manila-cdot-driver-refactoring Closes-Bug: #1410317 Partial-Bug: #1396953 Closes-Bug: #1370965 Closes-Bug: #1418690 Closes-Bug: #1418696  
__label__integration (WIP) Monitoring API URLs refactoring  /monitoring/projects/{project_id} for table detailes in specified project.  
__label__integration [WIP] Refactor rally.api  * Move API methods to classes, make them @staticmethod * Move rally-manage stuff to rally.api  TODO: restructure unit tests  
__label__objective [WIP] Refactor rally.api  * Move API methods to classes, make them @staticmethod * Move rally-manage stuff to rally.api  TODO: restructure unit tests  
__label__integration Refactor db api tests  The tests are now located in separate files under tests.api package. The base class in now a separate file also.  
__label__testing Refactor db api tests  The tests are now located in separate files under tests.api package. The base class in now a separate file also.  
__label__integration XenAPI: Refactor message strings to remove locals  This commit is a small refactor to the XenAPI glance plugin removing the use of locals() to improve the readability.  
__label__objective XenAPI: Refactor message strings to remove locals  This commit is a small refactor to the XenAPI glance plugin removing the use of locals() to improve the readability.  
__label__integration Fix rate limiting after API url refactoring  The tenant_id used to be the second element in the url, now it is the third element. Rate limiting middleware was not updated accordingly.  
__label__objective Fix rate limiting after API url refactoring  The tenant_id used to be the second element in the url, now it is the third element. Rate limiting middleware was not updated accordingly.  
__label__integration Slighty refactoring for the cross api spec  An API package has been created in common to store the API base class, request and response classes, API validation and schemas.  The processing of the requests and responses will be added in a follow up patch.  
__label__objective Slighty refactoring for the cross api spec  An API package has been created in common to store the API base class, request and response classes, API validation and schemas.  The processing of the requests and responses will be added in a follow up patch.  
__label__integration API to DB Object Refactoring  This change incorporates object abstraction for DB objects as used in the Ironic and Nova openstack projects.  As part of the refactoring, a new module "cue/objects" has been created.  This module provides generalized access to DB objects.  As part of this patch, The API has also been updated to access DB objects through the "cue/objects" module.  * updating affected tests.  
__label__objective API to DB Object Refactoring  This change incorporates object abstraction for DB objects as used in the Ironic and Nova openstack projects.  As part of the refactoring, a new module "cue/objects" has been created.  This module provides generalized access to DB objects.  As part of this patch, The API has also been updated to access DB objects through the "cue/objects" module.  * updating affected tests.  
__label__quality Fixes doc according to API refactoring  
__label__integration Refactor API tests for v2  - Separated v1 and v2 api tests for workbooks and executions; - Added more tests scenarios; - Optimize methods realization for v2 tests.  
__label__objective Refactor API tests for v2  - Separated v1 and v2 api tests for workbooks and executions; - Added more tests scenarios; - Optimize methods realization for v2 tests.  
__label__integration refactor switch machines api  change to show all switch machines  
__label__integration Refactoring of contrib.test_networks tests  Some simple refactoring of contrib.test_networks tests in order to make it easier to share unittests between v2 and the v2.1 API in a following changeset  Partially implements blueprint v2-on-v3-api  
__label__objective Refactoring of contrib.test_networks tests  Some simple refactoring of contrib.test_networks tests in order to make it easier to share unittests between v2 and the v2.1 API in a following changeset  Partially implements blueprint v2-on-v3-api  
__label__integration Refactor cinder volume v2 API changes  The handling of name and description for v2 API is duplicated for handle_create and handle_update methods. This patch defines a new method which handles the differences in parameter names thereby avoiding duplication and keeping the changes restricted to this method to the extent possible.  
__label__quality Refactor cinder volume v2 API changes  The handling of name and description for v2 API is duplicated for handle_create and handle_update methods. This patch defines a new method which handles the differences in parameter names thereby avoiding duplication and keeping the changes restricted to this method to the extent possible.  
__label__integration API level refactoring  
__label__integration Relayouting examples and refactoring OpenStack examples for v2  
__label__objective Relayouting examples and refactoring OpenStack examples for v2  
__label__integration Refactoring to reduce noise in log files  Currently lot of unnecessary log lines are generated during API invocation and image transfer. This patch makes log printing statement changes to reduce noise in log files.  
__label__objective Refactoring to reduce noise in log files  Currently lot of unnecessary log lines are generated during API invocation and image transfer. This patch makes log printing statement changes to reduce noise in log files.  
__label__integration Refactor plugin setup helpers out of test.base  Helper methods for plugin and notification setup were previously defined on neutron.tests.base.BaseTestCase.  The imports required to support these helpers were preventing the api tests from consuming tempest due to configuration conflicts that resulted between neutron and tempest.  This change moves the helpers to a new module in tests/unit so that BaseTestCase can be safely used across all types of tests.  Implements: blueprint neutron-testing-refactor  
__label__objective Refactor plugin setup helpers out of test.base  Helper methods for plugin and notification setup were previously defined on neutron.tests.base.BaseTestCase.  The imports required to support these helpers were preventing the api tests from consuming tempest due to configuration conflicts that resulted between neutron and tempest.  This change moves the helpers to a new module in tests/unit so that BaseTestCase can be safely used across all types of tests.  Implements: blueprint neutron-testing-refactor  
__label__integration Refactor the servers API to use NetworkRequest  This makes the servers API v2 and v3 use the NetworkRequest object during the construction of the requested_networks list.  
__label__objective Refactor the servers API to use NetworkRequest  This makes the servers API v2 and v3 use the NetworkRequest object during the construction of the requested_networks list.  
__label__integration Refactor role list subcommand for identity v3 api  Currently parts of user list and group list command are actually functioning as role listing, which is quite counter intuitive and misleading.  This refactor change move role related logic to a single place of role list command. It now allows role grants listing for user/group + domain/project combinations.  If no user or group specified, it will list all roles in the system, which is the default behaviour.  
__label__objective Refactor role list subcommand for identity v3 api  Currently parts of user list and group list command are actually functioning as role listing, which is quite counter intuitive and misleading.  This refactor change move role related logic to a single place of role list command. It now allows role grants listing for user/group + domain/project combinations.  If no user or group specified, it will list all roles in the system, which is the default behaviour.  
__label__quality Refactor role list subcommand for identity v3 api  Currently parts of user list and group list command are actually functioning as role listing, which is quite counter intuitive and misleading.  This refactor change move role related logic to a single place of role list command. It now allows role grants listing for user/group + domain/project combinations.  If no user or group specified, it will list all roles in the system, which is the default behaviour.  
__label__integration Adding intial compute service client. Adding support for listing and getting flavor information Added unit tests for the new compute service client Refactoring the StorageServiceClinetContext to be a generic ServiceClientContext Created a base class for service clients in order to maximize code reuse.  Partially implements blueprint support-compute-api 
__label__objective Adding intial compute service client. Adding support for listing and getting flavor information Added unit tests for the new compute service client Refactoring the StorageServiceClinetContext to be a generic ServiceClientContext Created a base class for service clients in order to maximize code reuse.  Partially implements blueprint support-compute-api 
__label__testing Adding intial compute service client. Adding support for listing and getting flavor information Added unit tests for the new compute service client Refactoring the StorageServiceClinetContext to be a generic ServiceClientContext Created a base class for service clients in order to maximize code reuse.  Partially implements blueprint support-compute-api 
__label__objective Adding intial compute service client. Adding support for listing and getting flavor information Added unit tests for the new compute service client Refactoring the StorageServiceClinetContext to be a generic ServiceClientContext Created a base class for service clients in order to maximize code reuse.  Partially implements blueprint support-compute-api 
__label__integration Refactor Packages and AppCatalog pagination  Move function for getting list of Application packages to a separate module - muranodashboard.api.packages, so both Packages and AppCatalog views can reuse it. That `package_list()` function obtains packages generator with a call to `muranoclient.packages.filter()` and paginate the results, adding `has_more_data` flag (as it is done for Glance, see http://tinyurl.com/lkbnsed).  Also move muranoclient-specific functions from muranodashboard.environments.api to muranodashboard.api.base module.  Implements: blueprint app-catalog-pagination 
__label__objective Refactor Packages and AppCatalog pagination  Move function for getting list of Application packages to a separate module - muranodashboard.api.packages, so both Packages and AppCatalog views can reuse it. That `package_list()` function obtains packages generator with a call to `muranoclient.packages.filter()` and paginate the results, adding `has_more_data` flag (as it is done for Glance, see http://tinyurl.com/lkbnsed).  Also move muranoclient-specific functions from muranodashboard.environments.api to muranodashboard.api.base module.  Implements: blueprint app-catalog-pagination 
__label__integration refactor sql backend to improve write speed  - drop sourceassoc table as its data is not accessible via api - drop resource table since data can be retreive from sample table  
__label__objective refactor sql backend to improve write speed  - drop sourceassoc table as its data is not accessible via api - drop resource table since data can be retreive from sample table  
__label__integration Refactor boolean conversion into a separate function  A method to convert API parameters to boolean values will be useful for parsing the show_deleted API parameter, so create a separate function named extract_bool.  blueprint stack-list-soft-deleted  
__label__quality Refactor boolean conversion into a separate function  A method to convert API parameters to boolean values will be useful for parsing the show_deleted API parameter, so create a separate function named extract_bool.  blueprint stack-list-soft-deleted  
__label__integration orchestration api refactor access to stack outputs  Refactor test_server_cfn_init access to stack outputs so it uses a new wrapper which gets the stack and returns the requested output.  This provides a useful function which can be used in other tests which parse the stack output.  Since we no longer need to get the stack in test_server_cfn_init, remove the gets and duplicate checks for CREATE_COMPLETE.  
__label__objective orchestration api refactor access to stack outputs  Refactor test_server_cfn_init access to stack outputs so it uses a new wrapper which gets the stack and returns the requested output.  This provides a useful function which can be used in other tests which parse the stack output.  Since we no longer need to get the stack in test_server_cfn_init, remove the gets and duplicate checks for CREATE_COMPLETE.  
__label__integration Propose: VMware spawn refactor  A structured refactor of the vmwareapi spawn method to improve maintainability of the vmware driver.  Goal: break up spawn method into reusable components  Phase 1: break out the API call steps in Spawn into smaller tested components Phase 2: rewrite spawn to use the smaller components  related to blueprint vmware-spawn-refactor  
__label__quality Propose: VMware spawn refactor  A structured refactor of the vmwareapi spawn method to improve maintainability of the vmware driver.  Goal: break up spawn method into reusable components  Phase 1: break out the API call steps in Spawn into smaller tested components Phase 2: rewrite spawn to use the smaller components  related to blueprint vmware-spawn-refactor  
__label__objective Propose: VMware spawn refactor  A structured refactor of the vmwareapi spawn method to improve maintainability of the vmware driver.  Goal: break up spawn method into reusable components  Phase 1: break out the API call steps in Spawn into smaller tested components Phase 2: rewrite spawn to use the smaller components  related to blueprint vmware-spawn-refactor  
__label__testing Propose: VMware spawn refactor  A structured refactor of the vmwareapi spawn method to improve maintainability of the vmware driver.  Goal: break up spawn method into reusable components  Phase 1: break out the API call steps in Spawn into smaller tested components Phase 2: rewrite spawn to use the smaller components  related to blueprint vmware-spawn-refactor  
__label__integration Refactor Network API  Base network API class to have all the methods that can be implemented by specific network api's.   * Move common logic and decorators to network/base_api.py  * Base class base_api.NetworkAPI with current methods from    nova & neutron, that will raise NotImplementedError()  * Refactor some tests with mock  When this get merged, every review adding new methods to neutron or nova network, must have the same methods added to the base NetworkAPI.  Implements: bp refactor-network-api  
__label__objective Refactor Network API  Base network API class to have all the methods that can be implemented by specific network api's.   * Move common logic and decorators to network/base_api.py  * Base class base_api.NetworkAPI with current methods from    nova & neutron, that will raise NotImplementedError()  * Refactor some tests with mock  When this get merged, every review adding new methods to neutron or nova network, must have the same methods added to the base NetworkAPI.  Implements: bp refactor-network-api  
__label__integration Refactor the DB implementation of Capabilities API  Replace the update of DEFAULT_CAPABILITIES into the __init__ function in the Connection class of base.py instead of the Connection class of each DB driver.  The AVAILABLE_CAPABILITIES dict was divided into two case of MongoDB and DB2 drivers, the common capabilities are listed in pymongo_base.py in COMMON_AVAILABLE_CAPABILTIES, which is updated with the capabilities dict of the two affected DB drivers using pymongo.  
__label__objective Refactor the DB implementation of Capabilities API  Replace the update of DEFAULT_CAPABILITIES into the __init__ function in the Connection class of base.py instead of the Connection class of each DB driver.  The AVAILABLE_CAPABILITIES dict was divided into two case of MongoDB and DB2 drivers, the common capabilities are listed in pymongo_base.py in COMMON_AVAILABLE_CAPABILTIES, which is updated with the capabilities dict of the two affected DB drivers using pymongo.  
__label__integration Refactor the local engine to use an in process executor  This is work in progress. Review is submitted for feedbacks. Refactored launch script to start the API and executor on the same process so the transport for a oslo.messaging fake driver can be shared.  A transport attribute is added to the abstract engine as a class attribute to reference the transport object.  
__label__integration Refactor Network API  To have a common API network base with all required methods so neutron / nova network api can inherit from.  bp refactor-network-api  
__label__integration Refactor LDAP API  The fake LDAP API must emulate the python-ldap API as much as possible otherwise much of the LDAP testing is invalid. The python-ldap API only accepts utf-8 encoded strings. However, the fake LDAP API accepts any Python type therefore properly handling type conversion into and out of the LDAP API is not exercised by the fake LDAP API during testing. Currently type conversion is done inside the LdapWrapper which calls the python-ldap API, this means unicode issues only appear when testing with a live LDAP server.  LdapWrapper and FakeLdap logically are two different providers of the same API, as such they should behave identically. Which LDAP API is used at run time a configurable option.  We need a mechanism by which we can substitute an LDAP API and then wrap the calls to that API with type conversions. Type conversion wrapping replaces the Python types used in Keystone with the types needed for the LDAP API, calls the LDAP API, and then type converts the results back from LDAP to those used by Keystone.  This patch establishes an LDAP API interface (LDAPHandler), modifies fake LDAP to support it, replaces LdapWrapper with the interface (invoking python-ldap) and adds another LDAPHandler instance which will be the common location for type conversions prior to calling the configured LDAP interface. See the LDAPHandler class definition for details).  This patch is exclusively a refactoring patch anticipating a subsequent patch to properly handle unicode values. There is no significant change in functionality with this patch, it is just refactoring to more cleanly seperate API boundaries. A few tests which exercised unicode were disabled in this patch because they will not work until the next patch which adds back in correct unicode handling. The idea here is to separate out the refactoring needed to support unicode from the actual unicode changes, this should make reviewing easier.  
__label__objective Refactor LDAP API  The fake LDAP API must emulate the python-ldap API as much as possible otherwise much of the LDAP testing is invalid. The python-ldap API only accepts utf-8 encoded strings. However, the fake LDAP API accepts any Python type therefore properly handling type conversion into and out of the LDAP API is not exercised by the fake LDAP API during testing. Currently type conversion is done inside the LdapWrapper which calls the python-ldap API, this means unicode issues only appear when testing with a live LDAP server.  LdapWrapper and FakeLdap logically are two different providers of the same API, as such they should behave identically. Which LDAP API is used at run time a configurable option.  We need a mechanism by which we can substitute an LDAP API and then wrap the calls to that API with type conversions. Type conversion wrapping replaces the Python types used in Keystone with the types needed for the LDAP API, calls the LDAP API, and then type converts the results back from LDAP to those used by Keystone.  This patch establishes an LDAP API interface (LDAPHandler), modifies fake LDAP to support it, replaces LdapWrapper with the interface (invoking python-ldap) and adds another LDAPHandler instance which will be the common location for type conversions prior to calling the configured LDAP interface. See the LDAPHandler class definition for details).  This patch is exclusively a refactoring patch anticipating a subsequent patch to properly handle unicode values. There is no significant change in functionality with this patch, it is just refactoring to more cleanly seperate API boundaries. A few tests which exercised unicode were disabled in this patch because they will not work until the next patch which adds back in correct unicode handling. The idea here is to separate out the refactoring needed to support unicode from the actual unicode changes, this should make reviewing easier.  
__label__integration DB api refactoring  This change does not create anything new.  The db api file was growing too large, so now it is a module with separate files corresponding to each db model.  
__label__objective DB api refactoring  This change does not create anything new.  The db api file was growing too large, so now it is a module with separate files corresponding to each db model.  
__label__integration Refactor api configuration script  
__label__integration Refactor xenapi/host.py to new call_xenapi pattern  Update all calls to call_xenapi to the new calling pattern.  This code calls out to the "host" object that this change adding into the collection of session objects.  An expensive call to host.get_record has been changed to the cheaper call of get_uuid.  
__label__quality Refactor xenapi/host.py to new call_xenapi pattern  Update all calls to call_xenapi to the new calling pattern.  This code calls out to the "host" object that this change adding into the collection of session objects.  An expensive call to host.get_record has been changed to the cheaper call of get_uuid.  
__label__integration Added task object and API handlers refactored  
__label__objective Added task object and API handlers refactored  
__label__integration Refactor pool.py to remove calls to call_xenapi  In addition adding the Pool XenAPI object that is needed by pool.py  
__label__objective Refactor pool.py to remove calls to call_xenapi  In addition adding the Pool XenAPI object that is needed by pool.py  
__label__integration Adding update_metadata API to metadata service  Refactored routing logic in metadata/base.py. Added an API to metadata service to update metdata of an instance.  
__label__objective Adding update_metadata API to metadata service  Refactored routing logic in metadata/base.py. Added an API to metadata service to update metdata of an instance.  
__label__integration Rename/refactoring of NVP api client to NSX  Partial-implements blueprint nicira-plugin-renaming  
__label__integration Refactor REST API to work on top of DB API  Refactored REST API for Stories and Projects to work on top of DB API layer. REST API is no longer "infected" by SQLA objects. REST and DB layers now communicate with dictionaries.  Details: * Moved wsme model to corresponding controller files * Added func tests for '/stories' and '/projects' * Got rid of magic code (SQLA->wsme, wsme->SQLA)  
__label__objective Refactor REST API to work on top of DB API  Refactored REST API for Stories and Projects to work on top of DB API layer. REST API is no longer "infected" by SQLA objects. REST and DB layers now communicate with dictionaries.  Details: * Moved wsme model to corresponding controller files * Added func tests for '/stories' and '/projects' * Got rid of magic code (SQLA->wsme, wsme->SQLA)  
__label__integration Refactored api unit tests for DRY  Reduced repetition of mock.patch calls  
__label__quality Refactored api unit tests for DRY  Reduced repetition of mock.patch calls  
__label__integration Refactor tests.unit.utils:FakeDB.reset  glance.tests.unit.utils:FakeDB uses glance.db.simple.api which has already implemented reset() functionality, the redundant code in FakeDB should be removed.  
__label__objective Refactor tests.unit.utils:FakeDB.reset  glance.tests.unit.utils:FakeDB uses glance.db.simple.api which has already implemented reset() functionality, the redundant code in FakeDB should be removed.  
__label__integration Refactor time conversion helper function for objects in db api  Refactor the code to use common time conversion code for objects. Strip timezone info out from datetimes, which is no need for database.  This is a part of: blueprint make-instance-action-use-objects  
__label__objective Refactor time conversion helper function for objects in db api  Refactor the code to use common time conversion code for objects. Strip timezone info out from datetimes, which is no need for database.  This is a part of: blueprint make-instance-action-use-objects  
__label__integration Refactor /node/<uuid>/state  * Ironic now have a periodic task that checks the current power state of the nodes[1] and keep the db updated, so the API does not need to call rpcapi.get_node_power_state every time someone GET /nodes/<uuid>/state we can just rely on the db for it.  * The API will now return all the states in one request, before it was needed two requests to to get all the currents and targets (GET /node/<uuid>/state/power and /node/<uuid>/state/provision)  * Rename /node/<uuid>/state to /node/<uuid>/states (plural) since it returns information about both states (power and provision)  [1] https://review.openstack.org/#/c/56530/  
__label__objective Refactor /node/<uuid>/state  * Ironic now have a periodic task that checks the current power state of the nodes[1] and keep the db updated, so the API does not need to call rpcapi.get_node_power_state every time someone GET /nodes/<uuid>/state we can just rely on the db for it.  * The API will now return all the states in one request, before it was needed two requests to to get all the currents and targets (GET /node/<uuid>/state/power and /node/<uuid>/state/provision)  * Rename /node/<uuid>/state to /node/<uuid>/states (plural) since it returns information about both states (power and provision)  [1] https://review.openstack.org/#/c/56530/  
__label__integration Image API v2.0 Image Model, Client and Tests - Refactoring .  Refactors image model:  - added Images class  - corrected the key name - change 'member_id' to 'member' in '_obj_to_json' method  Refactors image client:  - fixed serialization and deserialization issues in 'list_images()' method  Refactors member(s) tests:  - fixed string to date object conversion issues.  
__label__objective Image API v2.0 Image Model, Client and Tests - Refactoring .  Refactors image model:  - added Images class  - corrected the key name - change 'member_id' to 'member' in '_obj_to_json' method  Refactors image client:  - fixed serialization and deserialization issues in 'list_images()' method  Refactors member(s) tests:  - fixed string to date object conversion issues.  
__label__integration Refactor the cached api calls into @cached_property  We have a lot of repeating code in the tuskar_ui.api that deals with caching the api calls from properties. I made a @cached_property decorator that handles that all in one place instead.  
__label__quality Refactor the cached api calls into @cached_property  We have a lot of repeating code in the tuskar_ui.api that deals with caching the api calls from properties. I made a @cached_property decorator that handles that all in one place instead.  
__label__integration Manager API class removed and rpc fake impl used now for integration testing  
__label__integration Scrubber refactoring  * Adding lock protection to prevent race condition between glance-api and glance-scrubber service. * Adding multiple locations image support.  Implement bp: glance-scrubber-refactoring  
__label__objective Scrubber refactoring  * Adding lock protection to prevent race condition between glance-api and glance-scrubber service. * Adding multiple locations image support.  Implement bp: glance-scrubber-refactoring  
__label__integration Refactor plugin API methods  * Supported method now must respond to an enumeration * Modified encrypt/generate_data_encryption_key to use supports * Refactor a bunch of confusing kek_meta_tenant, kek_metadata, * kek_meta_dto things * Modify plugins to support new method signatures in abstract base class * Unit tests for more error conditions  
__label__objective Refactor plugin API methods  * Supported method now must respond to an enumeration * Modified encrypt/generate_data_encryption_key to use supports * Refactor a bunch of confusing kek_meta_tenant, kek_metadata, * kek_meta_dto things * Modify plugins to support new method signatures in abstract base class * Unit tests for more error conditions  
__label__integration Refactor integrated tests to support V2 and V3 API testing Part 2  This changeset moves the APISampleTestBase class out into its own file so the V3 versions of the tests can cleanly import it separate from the V2 code.  Partially implements v3-api-unittests Partially implements v3-api-specification  
__label__testing Refactor integrated tests to support V2 and V3 API testing Part 2  This changeset moves the APISampleTestBase class out into its own file so the V3 versions of the tests can cleanly import it separate from the V2 code.  Partially implements v3-api-unittests Partially implements v3-api-specification  
__label__integration Refactor v2 arq api  
__label__integration Tests module refactoring  Target API for tests is Conudctor Manager now.  
__label__testing Tests module refactoring  Target API for tests is Conudctor Manager now.  
__label__integration Refactor EC2 API error handling code.  Implements blueprint ec2-error-codes  Redundant logging code was united in new __init__.py:ec2_error_ex() helper function and all standard EC2 error responses are now uniformly logged on DEBUG log level because they are just responses to invalid client requests, not nova errors.  Unexpected client/server errors are logged on ERROR/CRITICAL level and their exception name is used as error code - no more useless UnknownError. Error descriptions are supressed for unexpected server errors as they might contain sensitive information. New unit tests are provided.  The code for consturcting EC2 error response which was duplicated in __init__.py:ec2_error and faults.py:Fault was moved to faults.py:ec2_error_response.  __init__.py:exception_to_ec2code helper function now always returns exception name as an EC2 error code since there are no exceptions with ec2_code attribute yet. These will be added in the follwing patch as required by referenced blueprint.  This code cleanup serves as a base for future fix of current terrible EC2 error behavior.  
__label__quality Refactor EC2 API error handling code.  Implements blueprint ec2-error-codes  Redundant logging code was united in new __init__.py:ec2_error_ex() helper function and all standard EC2 error responses are now uniformly logged on DEBUG log level because they are just responses to invalid client requests, not nova errors.  Unexpected client/server errors are logged on ERROR/CRITICAL level and their exception name is used as error code - no more useless UnknownError. Error descriptions are supressed for unexpected server errors as they might contain sensitive information. New unit tests are provided.  The code for consturcting EC2 error response which was duplicated in __init__.py:ec2_error and faults.py:Fault was moved to faults.py:ec2_error_response.  __init__.py:exception_to_ec2code helper function now always returns exception name as an EC2 error code since there are no exceptions with ec2_code attribute yet. These will be added in the follwing patch as required by referenced blueprint.  This code cleanup serves as a base for future fix of current terrible EC2 error behavior.  
__label__integration Service Type Framework refactoring  implements blueprint service-type-framework-cleanup  * Defines Db logic and API for ServiceProvider - read-only entity that admins provide in configuration. * ServiceType entity which maps to ServiceOfferings in new terms is removed for now. * Routed service insertion mixin is updated with new namings.  Not adding migration since service types were not used in grizzly.  
__label__objective Service Type Framework refactoring  implements blueprint service-type-framework-cleanup  * Defines Db logic and API for ServiceProvider - read-only entity that admins provide in configuration. * ServiceType entity which maps to ServiceOfferings in new terms is removed for now. * Routed service insertion mixin is updated with new namings.  Not adding migration since service types were not used in grizzly.  
__label__integration Refactored API V2 tests to use testscenarios  Related to blueprint db-tests-with-scenarios  
__label__testing Refactored API V2 tests to use testscenarios  Related to blueprint db-tests-with-scenarios  
__label__integration Refactored API V1 tests to use testscenarios  Related to blueprint db-tests-with-scenarios  
__label__testing Refactored API V1 tests to use testscenarios  Related to blueprint db-tests-with-scenarios  
__label__testing Refactor compute_api reboot tests to be unit-y  This follows previous efforts to unittest-ify the reboot tests for compute_api. This makes the cells testing much cleaner, and will massively simplify testing with objects.  Related to blueprint compute-api-objects  
__label__integration * Implemented exception-raising behaviors for volumes_api. * Removed blockstorage provider. * Added volume and snapshot statuses model. * Refactored response models. * Versioned volumes_api as v1, added stub for v2 * Cleaned up auth  
__label__testing * Implemented exception-raising behaviors for volumes_api. * Removed blockstorage provider. * Added volume and snapshot statuses model. * Refactored response models. * Versioned volumes_api as v1, added stub for v2 * Cleaned up auth  
__label__integration Refactor server password metadata to avoid direct db usage  This refactors the set_password() method in the server_password API extension to merely format the metadata and return it, leaving the job of updating the database to the caller. In the API extension case, the update can be done immediately against the database as before. In the case of the xenapi virt driver making the call, virtapi can be used to update the instance's system_metadata, thereby avoiding a direct database access by the compute manager.  Related to blueprint no-db-compute  
__label__objective Refactor server password metadata to avoid direct db usage  This refactors the set_password() method in the server_password API extension to merely format the metadata and return it, leaving the job of updating the database to the caller. In the API extension case, the update can be done immediately against the database as before. In the case of the xenapi virt driver making the call, virtapi can be used to update the instance's system_metadata, thereby avoiding a direct database access by the compute manager.  Related to blueprint no-db-compute  
__label__integration Refactoring/cleanup of compute api  Refactor host check and remove unused conf imports.  
__label__objective Refactoring/cleanup of compute api  Refactor host check and remove unused conf imports.  
__label__integration Nova Hyper-V driver refactoring  Blueprint: bp/bp/hyper-v-testing-serialization-improvements  This patchset contains a major refactoring of the Hyper-V driver.  The main reason for this refactoring is to provide proper component abstraction and decoupling, thus replacing almost entirely the remaining pre-Essex code previously available. This leads to a considerable semplification of the testing framework, which is now entirely based on stubs and mocks (mox), without any serialized stub / mock.  From an architectural perspective, the main driver class delegates operations to "ops" classes (e.g. VMOps, VolumeOps, etc) which contain the main logic and delegate OS specific actions to "utils" classes (e.g. VMUtils, LiveMigrationUtils, etc) where the WMI and Win32 API OS specific code resides.  Additional attention has been put also into a better PEP8 code formatting, including compliance with not mandatory checks like E121 through E128.  
__label__quality Nova Hyper-V driver refactoring  Blueprint: bp/bp/hyper-v-testing-serialization-improvements  This patchset contains a major refactoring of the Hyper-V driver.  The main reason for this refactoring is to provide proper component abstraction and decoupling, thus replacing almost entirely the remaining pre-Essex code previously available. This leads to a considerable semplification of the testing framework, which is now entirely based on stubs and mocks (mox), without any serialized stub / mock.  From an architectural perspective, the main driver class delegates operations to "ops" classes (e.g. VMOps, VolumeOps, etc) which contain the main logic and delegate OS specific actions to "utils" classes (e.g. VMUtils, LiveMigrationUtils, etc) where the WMI and Win32 API OS specific code resides.  Additional attention has been put also into a better PEP8 code formatting, including compliance with not mandatory checks like E121 through E128.  
__label__integration Refactor: extract method: to_driver_registry  Related to blueprint xenapi-volume-drivers  Extract method to create driver registries, so that it could be re-used in xenapi for a similar purpose.  
__label__objective Refactor: extract method: to_driver_registry  Related to blueprint xenapi-volume-drivers  Extract method to create driver registries, so that it could be re-used in xenapi for a similar purpose.  
__label__integration Refactor EC2 keypairs exception  According to the following document:  http://docs.amazonwebservices.com/AWSEC2/latest/APIReference/api-error-codes.html  The EC2 API sends specific error codes when keypair listing or keypair generation fails, specifically the error codes are  InvalidKeyPair.Duplicate - duplicate keypair InvalidKeyPair.Format - keypair format invalid InvalidKeyPair.NotFound - keypair not found ResourceLimitExceeded - keypair quota exceeded  Refactored create_key_pair and describe_key_pair so that it throws the correct EC2 error codes according to the public EC2 API specs.  Also removed some duplicate exceptions as well.  
__label__testing Refactor EC2 keypairs exception  According to the following document:  http://docs.amazonwebservices.com/AWSEC2/latest/APIReference/api-error-codes.html  The EC2 API sends specific error codes when keypair listing or keypair generation fails, specifically the error codes are  InvalidKeyPair.Duplicate - duplicate keypair InvalidKeyPair.Format - keypair format invalid InvalidKeyPair.NotFound - keypair not found ResourceLimitExceeded - keypair quota exceeded  Refactored create_key_pair and describe_key_pair so that it throws the correct EC2 error codes according to the public EC2 API specs.  Also removed some duplicate exceptions as well.  
__label__integration Refactor work with TaskLog in sqlalchemy.api  Add _task_log_get_query() private method It is used to remove from task_log_get() and task_log_get_all() session. parametr and save performance.  task_log_get() method Remove session parameter from public method.  task_log_get_all() method Remove session parameter from public method.  task_log_begin_task() Remove session parameter from public method. Remove unused return value.  task_log_end_task() Remove session parameter from public method. Use 1 db request instead of 2. Remove unused return value.  blueprint db-session-cleanup  
__label__objective Refactor work with TaskLog in sqlalchemy.api  Add _task_log_get_query() private method It is used to remove from task_log_get() and task_log_get_all() session. parametr and save performance.  task_log_get() method Remove session parameter from public method.  task_log_get_all() method Remove session parameter from public method.  task_log_begin_task() Remove session parameter from public method. Remove unused return value.  task_log_end_task() Remove session parameter from public method. Use 1 db request instead of 2. Remove unused return value.  blueprint db-session-cleanup  
__label__integration Refactor where store drivers are initialized  The call to create_stores was happening in the v1 and v2 API controllers. This moves that call and the verification that the default_store exists into the necessary binaries.  
__label__objective Refactor where store drivers are initialized  The call to create_stores was happening in the v1 and v2 API controllers. This moves that call and the verification that the default_store exists into the necessary binaries.  
__label__integration Refactor unit tests for ReST API  This makes it easier to add tests for different controllers.  
__label__testing Refactor unit tests for ReST API  This makes it easier to add tests for different controllers.  
__label__integration Refactor scheduling filters  This breaks out the module/class loading from scheduling filters, as it will be used by scheduling weights as well as cell scheduling.  This creates a base plugin loading class.  nova-api extension loading could also benefit from this code.  Base filter code is also moved into nova/filters.py where cells scheduling can use it.  
__label__objective Refactor scheduling filters  This breaks out the module/class loading from scheduling filters, as it will be used by scheduling weights as well as cell scheduling.  This creates a base plugin loading class.  nova-api extension loading could also benefit from this code.  Base filter code is also moved into nova/filters.py where cells scheduling can use it.  
__label__integration Scheduler API clean up and refactor  Unlike Nova scheduler, which has to consider serving compute and volume scheduling, Cinder scheduler only serves volume scheduling, so there's no need to keep generic interface 'schedule'. Instead, 'schedule_create_volume' is added (if missing) to manager/driver class and chance/simple scheduler driver implementation.  Also this patch changes the interface between API service and scheduler to allow more information about volume is passed to scheduler for advanced scheduling.  
__label__objective Scheduler API clean up and refactor  Unlike Nova scheduler, which has to consider serving compute and volume scheduling, Cinder scheduler only serves volume scheduling, so there's no need to keep generic interface 'schedule'. Instead, 'schedule_create_volume' is added (if missing) to manager/driver class and chance/simple scheduler driver implementation.  Also this patch changes the interface between API service and scheduler to allow more information about volume is passed to scheduler for advanced scheduling.  
__label__integration Simple refactor of some db api tests.  A few tests were using context.elevated instead of just passing the correct project id to the instance_create function.  
__label__testing Simple refactor of some db api tests.  A few tests were using context.elevated instead of just passing the correct project id to the instance_create function.  
__label__integration Refactor instance_usage_audit. Add audit tasklog.  The instance usage audit cronjob that generates periodic compute.instance.exists notifications is not particularly scalable. It is run on one server and takes longer as the number of instances grows.  This change moves the generation of those events to a periodic task in the compute manager. It also adds an api extention that can be used by administrators to check for errors generating these events.  
__label__objective Refactor instance_usage_audit. Add audit tasklog.  The instance usage audit cronjob that generates periodic compute.instance.exists notifications is not particularly scalable. It is run on one server and takes longer as the number of instances grows.  This change moves the generation of those events to a periodic task in the compute manager. It also adds an api extention that can be used by administrators to check for errors generating these events.  
__label__integration refactor xenapi/connection => xenapi/driver  Part of bp:virt-driver-cleanup  Make the xenapi driver consistent in naming as a driver instead of a connection.  
__label__quality refactor xenapi/connection => xenapi/driver  Part of bp:virt-driver-cleanup  Make the xenapi driver consistent in naming as a driver instead of a connection.  
__label__integration refactor vmwareapi_conn => vmwareapi/driver  Part of bp:virt-driver-cleanup  Make the vmwareapi driver consistent in naming as a driver instead of a connection.  Get all the vmware driver parts into the same directory  
__label__quality refactor vmwareapi_conn => vmwareapi/driver  Part of bp:virt-driver-cleanup  Make the vmwareapi driver consistent in naming as a driver instead of a connection.  Get all the vmware driver parts into the same directory  
__label__integration Refactor nova.rpc config handling.  This patch does a couple of things:  1) Remove the dependency of nova.rpc on nova.flags.  This is a step toward decoupling nova.rpc from the rest of nova so that it can be moved to openstack-common.  2) Refactor nova.rpc so that a configuration object is passed around as needed instead of depending on nova.flags.FLAGS.  This was done by avoiding changing the nova.rpc API as much as possible so that existing usage of nova.rpc would not have to be touched.  So, instead, a config object gets registered, cached, and then passed into the rpc implementations as needed.  Getting rid of this global config reference in nova.rpc will require changing the public API and I wanted to avoid doing that until there was a better reason than this.  
__label__quality Refactor nova.rpc config handling.  This patch does a couple of things:  1) Remove the dependency of nova.rpc on nova.flags.  This is a step toward decoupling nova.rpc from the rest of nova so that it can be moved to openstack-common.  2) Refactor nova.rpc so that a configuration object is passed around as needed instead of depending on nova.flags.FLAGS.  This was done by avoiding changing the nova.rpc API as much as possible so that existing usage of nova.rpc would not have to be touched.  So, instead, a config object gets registered, cached, and then passed into the rpc implementations as needed.  Getting rid of this global config reference in nova.rpc will require changing the public API and I wanted to avoid doing that until there was a better reason than this.  
__label__integration Refactor compute api messaging calls to compute manager  API's calls to compute manager all use instance_uuid now.  That allows us to refactor _cast_compute_message and make everything use it.  This removes an extra DB call in a lot of cases where we already had the instance object, but then passed an instance_uuid into _cast_compute_message with no host, where it would look the object up again.  
__label__objective Refactor compute api messaging calls to compute manager  API's calls to compute manager all use instance_uuid now.  That allows us to refactor _cast_compute_message and make everything use it.  This removes an extra DB call in a lot of cases where we already had the instance object, but then passed an instance_uuid into _cast_compute_message with no host, where it would look the object up again.  
__label__integration Refactor a few things inside the xenapi unit tests.  There were a couple of places where basically the same code was being used to create a simulated VDI record -- these have been brought together into _make_fake_vdi.  fake_fetch_image was stubbing out parse_xmlrpc_value, which looks like it was a workaround for the fact that the task result wasn't being populated properly.  I've fixed the latter, and removed the former.  This moved the JSON handling into xenapi.fake.  There were a couple of implementations of host_call_plugin, which contained a lot of duplicated code.  In particular, they both made a simulated VDI record, even when the plugin function being called didn't require that. I have brought the two implementations together into fake.SessionBase, with overrides in the subclasses for those things that are specific to a given test.  I have also made the baseclass strict about flagging unsimulated plugin calls, and added explicit handling for agent.version, and a couple of methods from glance and migration.  
__label__objective Refactor a few things inside the xenapi unit tests.  There were a couple of places where basically the same code was being used to create a simulated VDI record -- these have been brought together into _make_fake_vdi.  fake_fetch_image was stubbing out parse_xmlrpc_value, which looks like it was a workaround for the fact that the task result wasn't being populated properly.  I've fixed the latter, and removed the former.  This moved the JSON handling into xenapi.fake.  There were a couple of implementations of host_call_plugin, which contained a lot of duplicated code.  In particular, they both made a simulated VDI record, even when the plugin function being called didn't require that. I have brought the two implementations together into fake.SessionBase, with overrides in the subclasses for those things that are specific to a given test.  I have also made the baseclass strict about flagging unsimulated plugin calls, and added explicit handling for agent.version, and a couple of methods from glance and migration.  
__label__testing Refactor a few things inside the xenapi unit tests.  There were a couple of places where basically the same code was being used to create a simulated VDI record -- these have been brought together into _make_fake_vdi.  fake_fetch_image was stubbing out parse_xmlrpc_value, which looks like it was a workaround for the fact that the task result wasn't being populated properly.  I've fixed the latter, and removed the former.  This moved the JSON handling into xenapi.fake.  There were a couple of implementations of host_call_plugin, which contained a lot of duplicated code.  In particular, they both made a simulated VDI record, even when the plugin function being called didn't require that. I have brought the two implementations together into fake.SessionBase, with overrides in the subclasses for those things that are specific to a given test.  I have also made the baseclass strict about flagging unsimulated plugin calls, and added explicit handling for agent.version, and a couple of methods from glance and migration.  
__label__quality Refactor a few things inside the xenapi unit tests.  There were a couple of places where basically the same code was being used to create a simulated VDI record -- these have been brought together into _make_fake_vdi.  fake_fetch_image was stubbing out parse_xmlrpc_value, which looks like it was a workaround for the fact that the task result wasn't being populated properly.  I've fixed the latter, and removed the former.  This moved the JSON handling into xenapi.fake.  There were a couple of implementations of host_call_plugin, which contained a lot of duplicated code.  In particular, they both made a simulated VDI record, even when the plugin function being called didn't require that. I have brought the two implementations together into fake.SessionBase, with overrides in the subclasses for those things that are specific to a given test.  I have also made the baseclass strict about flagging unsimulated plugin calls, and added explicit handling for agent.version, and a couple of methods from glance and migration.  
__label__objective Refactor metadata code out of ec2/cloud.py  part 2 of blueprint separate-metadata-api  
__label__integration Refactored version attributes  - Promoted the api version status from 'alpha' to 'beta' - Adopted openstack release names in lieu of arbitrary version #'s  
__label__objective Refactored version attributes  - Promoted the api version status from 'alpha' to 'beta' - Adopted openstack release names in lieu of arbitrary version #'s  
__label__integration Refactoring of extensions  This is a refactoring of API extensions.  Changes include better use of Python idioms and improved support for loading extensions.  
__label__integration Refactored version attributes  - Promoted the api version status from 'alpha' to 'beta' - Adopted openstack release names in lieu of arbitrary version #'s  
__label__integration Refactoring image and server metadata api tests  
__label__testing Refactoring image and server metadata api tests  
__label__integration Refactoring registry api controllers  Break up images and members controllers in the registry api and restructure it to be more like the glance api. This is in preparation for the future split.  
__label__objective Refactoring registry api controllers  Break up images and members controllers in the registry api and restructure it to be more like the glance api. This is in preparation for the future split.  
__label__integration Refactor Service VIPs redis and ovn_dbs  With this change a Heat resource is no longer used to create an undercloud neutron API port resource for the redis and ovn_dbs service virtual IPs. Instead an external deploy task at step 0 in the individual service template uses the "tripleo_service_vip" ansible module to mange a neutron API port resource for each service.  The interfaces to control the IP address and service network (RedisVirtualFixedIPs, OVNDBsVirtualFixedIPs and ServiceNetMap) remains the same.  NOTE: If the neutron service is not available the       tripleo_service_vip ansible module will "echo"       the IP provided in %service%VirtualFixedIPs.  Related: blueprint network-data-v2-ports Depends-On: https://review.opendev.org/777257 
__label__objective Refactor Service VIPs redis and ovn_dbs  With this change a Heat resource is no longer used to create an undercloud neutron API port resource for the redis and ovn_dbs service virtual IPs. Instead an external deploy task at step 0 in the individual service template uses the "tripleo_service_vip" ansible module to mange a neutron API port resource for each service.  The interfaces to control the IP address and service network (RedisVirtualFixedIPs, OVNDBsVirtualFixedIPs and ServiceNetMap) remains the same.  NOTE: If the neutron service is not available the       tripleo_service_vip ansible module will "echo"       the IP provided in %service%VirtualFixedIPs.  Related: blueprint network-data-v2-ports Depends-On: https://review.opendev.org/777257 
__label__integration Refresh and refactor README  Refresh and streamline the README.  Remove scenario involving separation of Cinder components as I cannot locate charms cinder-api and cinder-volume. Add cinder-ceph charm to the Ceph scenario.  I am unsure about the relation involving: cinder:image-service glance:image-service  Add Bugs section  
__label__quality Refresh and refactor README  Refresh and streamline the README.  Remove scenario involving separation of Cinder components as I cannot locate charms cinder-api and cinder-volume. Add cinder-ceph charm to the Ceph scenario.  I am unsure about the relation involving: cinder:image-service glance:image-service  Add Bugs section  
__label__integration Refactor Ansible sysinv data collection  Refactor the sysinv data collection so it uses the new sysinv-db-data API instead of scraping CLI command output.  Story: 2006590 Task: 36892 Depends-On: https://review.opendev.org/693213/ Signed-off-by: Kristine Bujold <kristine.bujold@windriver.com> 
__label__objective Refactor Ansible sysinv data collection  Refactor the sysinv data collection so it uses the new sysinv-db-data API instead of scraping CLI command output.  Story: 2006590 Task: 36892 Depends-On: https://review.opendev.org/693213/ Signed-off-by: Kristine Bujold <kristine.bujold@windriver.com> 
__label__integration Remove internal DB dependencies and refactoring  This change performs some refactoring:  - remove internal DB dpenedency (eswitch_db, device_db)   removing libvirt dependency altoghether  - Introduce EmbSwitch object to manage port operations on an   embedded switch  - Introduce EswitchManager object to manage muliple embeddes   switches.  - spearate infiniband specific functionality and move it to   utils module.  - eswitchd API was modified to use PCI address as port identifier   to reduce mac address dependency.  
__label__objective Remove internal DB dependencies and refactoring  This change performs some refactoring:  - remove internal DB dpenedency (eswitch_db, device_db)   removing libvirt dependency altoghether  - Introduce EmbSwitch object to manage port operations on an   embedded switch  - Introduce EswitchManager object to manage muliple embeddes   switches.  - spearate infiniband specific functionality and move it to   utils module.  - eswitchd API was modified to use PCI address as port identifier   to reduce mac address dependency.  
__label__integration Refactor Interface API unit tests  The interface API unit tests are refactored to use the BaseHostTestCase Class.  Story: 2004515 Task: 37248  
__label__testing Refactor Interface API unit tests  The interface API unit tests are refactored to use the BaseHostTestCase Class.  Story: 2004515 Task: 37248  
__label__integration Refactor ComputeManager.remove_volume_connection  This change does two things:  First is a simple refactor to allow passing a BDM to _remove_volume_connection. The interface on the public remove_volume_connection cannot be easily changed since it's an RPC API call.  Second, the new private method gains a delete_attachment kwarg which will tell the method whether or not to delete a v3-style attachment, i.e. bdm.attachment_id is not None.  This is prep work for an upcoming change that is going to call the new private method locally rather than over RPC.  
__label__objective Refactor ComputeManager.remove_volume_connection  This change does two things:  First is a simple refactor to allow passing a BDM to _remove_volume_connection. The interface on the public remove_volume_connection cannot be easily changed since it's an RPC API call.  Second, the new private method gains a delete_attachment kwarg which will tell the method whether or not to delete a v3-style attachment, i.e. bdm.attachment_id is not None.  This is prep work for an upcoming change that is going to call the new private method locally rather than over RPC.  
__label__integration Refactor API utilities into api_utils.py  This collects up utils that are only used in the API code, and moves them from cinder/utils.py to here, for better code organization.  
__label__quality Refactor API utilities into api_utils.py  This collects up utils that are only used in the API code, and moves them from cinder/utils.py to here, for better code organization.  
__label__quality Refactoring exceptions  Merge of exception, remove unused exceptions, make more humanreadable view.  
__label__quality Refactor plan creation out of app-create  The work of collecting and verifying planfile contents is causing the app-create code to bloat. This is one approach to reducing that complexity.  
__label__objective Refactor plan creation out of app-create  The work of collecting and verifying planfile contents is causing the app-create code to bloat. This is one approach to reducing that complexity.  
__label__quality Refactor config opts, deriving from common base (WIP)  Start to shift the functionality of the config opts class into a base class that allows for other implementations of config opts that can provide there own implementations of the base abstract methods (perhaps providing a '_do_get' that fetchs from a remote source, or from a dictionary, or from elsewhere).  This is a first step at decoupling oslo.config from being so tied to CLI and config file parsing, extraction... so that in the future more flexible and alternative sources can easily co-exist.  
__label__objective Refactor config opts, deriving from common base (WIP)  Start to shift the functionality of the config opts class into a base class that allows for other implementations of config opts that can provide there own implementations of the base abstract methods (perhaps providing a '_do_get' that fetchs from a remote source, or from a dictionary, or from elsewhere).  This is a first step at decoupling oslo.config from being so tied to CLI and config file parsing, extraction... so that in the future more flexible and alternative sources can easily co-exist.  
__label__quality Refactor code in nova-setup recipe           This is a work in progress.  I figured the refactor          request was to make the code more readable.           This first patch includes a small refactor of a set of          options added to the nova-manage network-create command.          If this is the direction the community wants me to go,          I will continue.  
__label__quality Refactor DeploymentSerializer slightly  "DRY" set_primary_controller so that it can be reused in a couple  of other changes sets  Make set_deployment_pirorities readable by replacing "prior" with  "priority" since prior means previous and leads to confusion reading  the code  
__label__objective Refactor DeploymentSerializer slightly  "DRY" set_primary_controller so that it can be reused in a couple  of other changes sets  Make set_deployment_pirorities readable by replacing "prior" with  "priority" since prior means previous and leads to confusion reading  the code  
__label__quality Refactoring structure of rally/verification  Removing verifiers directory to make the code more readable and to reduce unnecessary complexity  
__label__objective Refactoring structure of rally/verification  Removing verifiers directory to make the code more readable and to reduce unnecessary complexity  
__label__quality Revert "refactor of hideci for readability and modularity"  This reverts commit f160dcf90c2850b1bf04948253d006c01e34c15b.  This does not work with the new change screen.  
__label__objective Revert "refactor of hideci for readability and modularity"  This reverts commit f160dcf90c2850b1bf04948253d006c01e34c15b.  This does not work with the new change screen.  
__label__quality Refactor downgrade_assignment_table for complexity  The downgrade_assignment_table was the most "complex" in keystone. It was refactored to move the embedded functions out. This allows max-complexity to be reduced.  
__label__objective Refactor downgrade_assignment_table for complexity  The downgrade_assignment_table was the most "complex" in keystone. It was refactored to move the embedded functions out. This allows max-complexity to be reduced.  
__label__quality Refactor _authenticate_token for complexity  The _authenticate_token method was the most "complex" in keystone. It was refactored to extract a complex piece of the method (checking any trust info) into a new method. This allows the max-complexity to be reduced.  
__label__objective Refactor _authenticate_token for complexity  The _authenticate_token method was the most "complex" in keystone. It was refactored to extract a complex piece of the method (checking any trust info) into a new method. This allows the max-complexity to be reduced.  
__label__quality Refactor assignment expansion related functions  Separated the assignment expansion related code into functions in order to improve readability. The functionality has not changed whatsoever.  
__label__objective Refactor assignment expansion related functions  Separated the assignment expansion related code into functions in order to improve readability. The functionality has not changed whatsoever.  
__label__quality WIP Refactor l2_pop code in linuxbridge  A previous refactor introduced a namedtupled for sending ip and mac address information for a port instead of a regular tuple.  This commit will take advantage of that to break the position dependence of the code in linuxbridge which uses that information for maintainability.  It will also add a little bit of readability to the code.  
__label__objective WIP Refactor l2_pop code in linuxbridge  A previous refactor introduced a namedtupled for sending ip and mac address information for a port instead of a regular tuple.  This commit will take advantage of that to break the position dependence of the code in linuxbridge which uses that information for maintainability.  It will also add a little bit of readability to the code.  
__label__quality Trove instance model refactoring  For better trove pluggability we need to have a modular, low coupled code. This commit goal is decoupling instance model code.  The main made changes: 1) Using single model for trove instance and different views (not model per view) 2) Separating Manager(Controller in MVC terms) code level (model only return and save state, business logic was moved to manager) 3) Instance model interface refactoring and optimization (if you want to get state or save state you need only request corresponding method or attribute, all ather logic for loading and saving, caching attribute is hidden on Model level) 4) Adaptation trove code and tests to new model  
__label__objective Trove instance model refactoring  For better trove pluggability we need to have a modular, low coupled code. This commit goal is decoupling instance model code.  The main made changes: 1) Using single model for trove instance and different views (not model per view) 2) Separating Manager(Controller in MVC terms) code level (model only return and save state, business logic was moved to manager) 3) Instance model interface refactoring and optimization (if you want to get state or save state you need only request corresponding method or attribute, all ather logic for loading and saving, caching attribute is hidden on Model level) 4) Adaptation trove code and tests to new model  
__label__quality Refactor keyring store logic  Simplify the token processing code a little. This is an attempt to reduce the complexity of the following Auth Token review by removing logic changes from it.  
__label__objective Refactor keyring store logic  Simplify the token processing code a little. This is an attempt to reduce the complexity of the following Auth Token review by removing logic changes from it.  
__label__quality Refactor run-mirror to make it readable  First stab at refactoring to unspaghetti things.  
__label__quality Refactor static path code  The static path code is refactored to improve readability, and will be used in subsequent patches adding support for baremetal VNIC types.  
__label__quality genpwd: Refactor to reduce cyclomatic complexity  Before refactoring:  radon cc -s kolla_ansible/cmd/genpwd.py  kolla_ansible/cmd/genpwd.py     F 57:0 genpwd - C (13)     F 39:0 generate_RSA - A (1)     F 94:0 main - A (1)  After refactoring:  radon cc -s kolla_ansible/cmd/genpwd.py  kolla_ansible/cmd/genpwd.py     F 149:0 genpwd - A (3)     M 54:4 SecretGenerator.get_by_key_name - A (3)     C 67:0 SecretGeneratorRegular - A (3)     C 77:0 SecretGeneratorRsa - A (3)     M 102:4 SecretGeneratorRsa.skip - A (3)     C 41:0 SecretGenerator - A (2)     M 70:4 SecretGeneratorRegular.generate - A (2)     C 110:0 SecretGeneratorHmac - A (2)     C 124:0 SecretGeneratorUuid - A (2)     C 140:0 SecretGeneratorFernet - A (2)     F 158:0 genpwd_file - A (1)     F 168:0 main - A (1)     M 43:4 SecretGenerator.keys - A (1)     M 47:4 SecretGenerator.generate - A (1)     M 51:4 SecretGenerator.skip - A (1)     M 85:4 SecretGeneratorRsa.generate - A (1)     M 116:4 SecretGeneratorHmac.generate - A (1)     M 136:4 SecretGeneratorUuid.generate - A (1)     M 145:4 SecretGeneratorFernet.generate - A (1)  Calculated using radon==3.0.1  
__label__quality genpwd: Refactor to reduce cyclomatic complexity  Before refactoring:  radon cc -s kolla_ansible/cmd/genpwd.py  kolla_ansible/cmd/genpwd.py     F 57:0 genpwd - C (13)     F 39:0 generate_RSA - A (1)     F 94:0 main - A (1)  After refactoring:  radon cc -s kolla_ansible/cmd/genpwd.py  kolla_ansible/cmd/genpwd.py     F 138:0 get_schema_for_key - A (4)     F 57:0 rsa_skip - A (3)     F 146:0 genpwd - A (3)     F 65:0 regular_password_generate - A (2)     F 39:0 rsa_generate - A (1)     F 72:0 hmac_generate - A (1)     F 80:0 password_not_empty - A (1)     F 153:0 genpwd_file - A (1)     F 163:0 main - A (1)  Calculated using radon==3.0.1  
__label__quality In progress -- Refactor of loci upload  TODO: - Verify zuul change id name - Add new playbook - Reuse infra roles  Maybe too complex, so I will compare this with the standard approach.  
__label__objective Refactor vip resource creation for iface'less use  Pacemaker VIP resources are able to automatically detect and configure correct iface and netmask parameters based on local configuration of the unit.  Switch to using hash based naming in VIP resources and drop configuration of nic and cidr_netmask params.  The hash is based on the first 7 chars of an sha1 hash of the VIP which is deterministic and still readable (base of gits short hash default).  This supports deployment in container based environments where interface -> subnet connectivity may not be consistent between container instances within an application.  NOTE: this change is somewhat bumpy as the original iface named VIP resource will be stopped and deleted prior to the creation of the new short hash named VIP resource.  Closes-Bug: 1727824  
__label__integration Refactor vip resource creation for iface'less use  Pacemaker VIP resources are able to automatically detect and configure correct iface and netmask parameters based on local configuration of the unit.  Switch to using hash based naming in VIP resources and drop configuration of nic and cidr_netmask params.  The hash is based on the first 7 chars of an sha1 hash of the VIP which is deterministic and still readable (base of gits short hash default).  This supports deployment in container based environments where interface -> subnet connectivity may not be consistent between container instances within an application.  NOTE: this change is somewhat bumpy as the original iface named VIP resource will be stopped and deleted prior to the creation of the new short hash named VIP resource.  Closes-Bug: 1727824  
__label__objective Refactor vip resource creation for iface'less use  Pacemaker VIP resources are able to automatically detect and configure correct iface and netmask parameters based on local configuration of the unit.  Switch to using hash based naming in VIP resources and drop configuration of nic and cidr_netmask params.  The hash is based on the first 7 chars of an sha1 hash of the VIP which is deterministic and still readable (base of gits short hash default).  This supports deployment in container based environments where interface -> subnet connectivity may not be consistent between container instances within an application.  NOTE: this change is somewhat bumpy as the original iface named VIP resource will be stopped and deleted prior to the creation of the new short hash named VIP resource.  Closes-Bug: 1727824  
__label__quality Refactor err reporting of incorrect YAML structure  This improves the error reporting of incorrect structure of the YAML -- when the missing indent is detected. It adds the information about the file name with problematic structure.  Code which is extracting the expected single item from a collection has been extracted to `get_the_only_one_subitem` function to increase the readability.  Added tests for missing indent exception.  
__label__objective Refactor err reporting of incorrect YAML structure  This improves the error reporting of incorrect structure of the YAML -- when the missing indent is detected. It adds the information about the file name with problematic structure.  Code which is extracting the expected single item from a collection has been extracted to `get_the_only_one_subitem` function to increase the readability.  Added tests for missing indent exception.  
__label__quality Trivial refactor in instance_plugin.py  This patch refactors instance['reservation_id'] to just reservation_id for code readability.  
__label__quality Refactor of _clone_image_volume  This patch makes _clone_image_volume more readable, and plus negative case for it.  Note that, the change doesn't have any functional change on the original method.  trivial_fix  
__label__quality Refactor futurist calls  After futurist calls were introduced, the code became difficult to understand. For example, local variables are used something like global. To keep the code easier to understand, the usage of local variables should be more scoped.  This commit introduces a wrapper function for futurist.ThreadPoolExecutor and converts inline functions into normal methods. I believe it improves the code readability a lot.  
__label__objective Refactor futurist calls  After futurist calls were introduced, the code became difficult to understand. For example, local variables are used something like global. To keep the code easier to understand, the usage of local variables should be more scoped.  This commit introduces a wrapper function for futurist.ThreadPoolExecutor and converts inline functions into normal methods. I believe it improves the code readability a lot.  
__label__quality Refactor quota modules  Split and encapsulate quota and quota_utils modules for better readability.  quota_driver option no longer requires full path to module. If option is set to cinder.quota.DriverName it's changed to cinder.quota.driver.DriverName during engine initialization.  
__label__objective Refactor quota modules  Split and encapsulate quota and quota_utils modules for better readability.  quota_driver option no longer requires full path to module. If option is set to cinder.quota.DriverName it's changed to cinder.quota.driver.DriverName during engine initialization.  
__label__quality Refactor and commented 'config_tree_to_digraph' and 'create_graph'  These methods are complex and were not commented in an appropriate way.  
__label__objective Refactor and commented 'config_tree_to_digraph' and 'create_graph'  These methods are complex and were not commented in an appropriate way.  
__label__quality refactor some fip methods for df  1. The update/delete_floatingip code looks a bit complex in df_local_controller, we could do some optimize work;  2. Change some methods to inner methods for dnat app;  3. Adjust corresponding UT code.  
__label__objective refactor some fip methods for df  1. The update/delete_floatingip code looks a bit complex in df_local_controller, we could do some optimize work;  2. Change some methods to inner methods for dnat app;  3. Adjust corresponding UT code.  
__label__quality [api-ref] Refactor share migration documentation  This patch make share migration documentation be more readable and maintainable.  
__label__quality [api-ref] Refactor share migration documentation  This patch make share migration documentation be more readable and maintainable.  
__label__quality [api-ref] Refactor share metadata documentation  This patch make share metadata documentation be more readable and maintainable.  
__label__quality [api-ref] Refactor share metadata documentation  This patch make share metadata documentation be more readable and maintainable.  
__label__quality Refactor netlink-conntrack  This patch makes the netlink-conntrack driver be more readable and maintainable.  
__label__quality Refactor: block-device handling (partitioning)  Block device handling can be somewhat complex - especially when taking things like md, lvm or encryption into account.  This patch implements minimal and compatible partitioning handling.  
__label__objective Refactor: block-device handling (partitioning)  Block device handling can be somewhat complex - especially when taking things like md, lvm or encryption into account.  This patch implements minimal and compatible partitioning handling.  
__label__quality Refactor: block-device handling (image creation)  Block device handling can be somewhat complex - especially when taking things like md, lvm or encryption into account.  This patch refactors the creation of the local loop images.  
__label__objective Refactor: block-device handling (image creation)  Block device handling can be somewhat complex - especially when taking things like md, lvm or encryption into account.  This patch refactors the creation of the local loop images.  
__label__quality crypto - Refactor server side copy as middleware  Rewrite server side copy and 'object post as copy' feature as middleware to simplify the PUT method in the object controller code. COPY is no longer a verb implemented as public method in Proxy application.  The server side copy middleware is inserted to the left of dlo, slo and versioned_writes middlewares in the proxy server pipeline. As a result, dlo and slo copy_hooks are no longer required. SLO manifests are now validated when copied so when copying a manifest to another account the referenced segments must be readable in that account for the manifest copy to succeed (previously this validation was not made, meaning the manifest was copied but could be unusable if the segments were not readable).  With this change, there should be no change in functionality or existing behavior. This is asserted with (almost) no changes required to existing functional tests.  Some notes (for operators): * Middleware required to be auto-inserted before slo and dlo and   versioned_writes * Turning off server side copy is not configurable. * object_post_as_copy is no longer a configurable option of proxy server   but of this middleware. However, for smooth upgrade, config option set   in proxy server app is also read.  DocImpact: Introducing server side copy as middleware  
__label__objective crypto - Refactor server side copy as middleware  Rewrite server side copy and 'object post as copy' feature as middleware to simplify the PUT method in the object controller code. COPY is no longer a verb implemented as public method in Proxy application.  The server side copy middleware is inserted to the left of dlo, slo and versioned_writes middlewares in the proxy server pipeline. As a result, dlo and slo copy_hooks are no longer required. SLO manifests are now validated when copied so when copying a manifest to another account the referenced segments must be readable in that account for the manifest copy to succeed (previously this validation was not made, meaning the manifest was copied but could be unusable if the segments were not readable).  With this change, there should be no change in functionality or existing behavior. This is asserted with (almost) no changes required to existing functional tests.  Some notes (for operators): * Middleware required to be auto-inserted before slo and dlo and   versioned_writes * Turning off server side copy is not configurable. * object_post_as_copy is no longer a configurable option of proxy server   but of this middleware. However, for smooth upgrade, config option set   in proxy server app is also read.  DocImpact: Introducing server side copy as middleware  
__label__testing crypto - Refactor server side copy as middleware  Rewrite server side copy and 'object post as copy' feature as middleware to simplify the PUT method in the object controller code. COPY is no longer a verb implemented as public method in Proxy application.  The server side copy middleware is inserted to the left of dlo, slo and versioned_writes middlewares in the proxy server pipeline. As a result, dlo and slo copy_hooks are no longer required. SLO manifests are now validated when copied so when copying a manifest to another account the referenced segments must be readable in that account for the manifest copy to succeed (previously this validation was not made, meaning the manifest was copied but could be unusable if the segments were not readable).  With this change, there should be no change in functionality or existing behavior. This is asserted with (almost) no changes required to existing functional tests.  Some notes (for operators): * Middleware required to be auto-inserted before slo and dlo and   versioned_writes * Turning off server side copy is not configurable. * object_post_as_copy is no longer a configurable option of proxy server   but of this middleware. However, for smooth upgrade, config option set   in proxy server app is also read.  DocImpact: Introducing server side copy as middleware  
__label__quality Refactor trigger controller  The post method of trigger controller is currently a bit complex. Breaks down the code into conceptually meaningful sub-methods and thus simplifies it.  
__label__objective Refactor trigger controller  The post method of trigger controller is currently a bit complex. Breaks down the code into conceptually meaningful sub-methods and thus simplifies it.  
__label__quality small refactoring  make the code cleaner and more readable  
__label__quality Refactor _get_trees_matching_all()  _get_trees_matching_all() is used to get allocation candidates, but it is difficult to read using specific indexes like p[0]. This patch makes it more readable adding a new helper class, `RPCandidateList`, which have several explanatory functions.  This is also a preparation for adding crisp debug logs coming in a following patch.  
__label__objective Refactor _get_trees_matching_all()  _get_trees_matching_all() is used to get allocation candidates, but it is difficult to read using specific indexes like p[0]. This patch makes it more readable adding a new helper class, `RPCandidateList`, which have several explanatory functions.  This is also a preparation for adding crisp debug logs coming in a following patch.  
__label__quality web: refactor build page using a container  This change updates the build page component to use a container for build information rendering. This enable decoupling the network logic from the actual rendering.  
__label__objective web: refactor build page using a container  This change updates the build page component to use a container for build information rendering. This enable decoupling the network logic from the actual rendering.  
__label__quality libvirt: Refactor handling of PCIe root ports  Add a separate method, _guest_needs_pcie(), to check for the prerequsites for adding PCIe root port entries.  And simplify the monster 'if' conditional into multiple readable ones.  While at it, add a TODO note about an assumption (which can become invalid in the future) we're making about machine types.  
__label__objective libvirt: Refactor handling of PCIe root ports  Add a separate method, _guest_needs_pcie(), to check for the prerequsites for adding PCIe root port entries.  And simplify the monster 'if' conditional into multiple readable ones.  While at it, add a TODO note about an assumption (which can become invalid in the future) we're making about machine types.  
__label__objective libvirt: Refactor handling of PCIe root ports  Add a separate method, _guest_needs_pcie(), to check for the prerequsites for adding PCIe root port entries.  And simplify the monster 'if' conditional into multiple readable ones.  While at it, add a TODO note about an assumption (which can become invalid in the future) we're making about machine types.  
__label__quality Refactor image uploader class structure  - Static methods are now class methods - secure_registries and insecure_registries are now class attributes,   so don't need to be passed as arguments for class methods - The abstract class ImageUploader is gone, it wasn't adding value   since all implementations extend BaseImageUploader - The upload_image static method is now an instance method, and its   only argument is an UploadTask object - Values calculated in source_target_names are now calculated when the   UploadTask is created  The result should be more maintainable and understandable. It should now be easier to pass more values to upload_image without requiring disruptive changes.  
__label__objective Refactor image uploader class structure  - Static methods are now class methods - secure_registries and insecure_registries are now class attributes,   so don't need to be passed as arguments for class methods - The abstract class ImageUploader is gone, it wasn't adding value   since all implementations extend BaseImageUploader - The upload_image static method is now an instance method, and its   only argument is an UploadTask object - Values calculated in source_target_names are now calculated when the   UploadTask is created  The result should be more maintainable and understandable. It should now be easier to pass more values to upload_image without requiring disruptive changes.  
__label__quality max-complexity=>16: refactor GET /a_c qs parsing  Before this patch, the project's max-complexity of 17 was perpetrated by RequestGroup.dict_from_request, the request querystring parsing method used for GET /allocation_candidates. This refactor-only patch splits that method into smaller chunks, the most complex of which now comes in at 8.  There is no functional change, hence no deltas to tests.  
__label__objective max-complexity=>16: refactor GET /a_c qs parsing  Before this patch, the project's max-complexity of 17 was perpetrated by RequestGroup.dict_from_request, the request querystring parsing method used for GET /allocation_candidates. This refactor-only patch splits that method into smaller chunks, the most complex of which now comes in at 8.  There is no functional change, hence no deltas to tests.  
__label__quality ci-skip: Refactor to improve readability  
__label__quality Upgrades: Refactor playbooks to set facts  To not to redefine variable multiple times in each service we run check only once and we set fact. To increase readability of generated playbook we add block per strep in services.  
__label__objective Upgrades: Refactor playbooks to set facts  To not to redefine variable multiple times in each service we run check only once and we set fact. To increase readability of generated playbook we add block per strep in services.  
__label__quality ant: Refactor code to improve readability  
__label__quality (refactor) Refactor Ansible for standard-container  This patchset moves role tasks into 1 main.yaml file that will use a conditional variable to determine which task to play during the playbook call. Reduces the number of files and readability.  
__label__objective (refactor) Refactor Ansible for standard-container  This patchset moves role tasks into 1 main.yaml file that will use a conditional variable to determine which task to play during the playbook call. Reduces the number of files and readability.  
__label__quality Refactor the policies to policy  A group can only have 1 policy associated it, but now we have ONE to MANY model in group model, this patch change it to ONE to ONE Model.  We also adapt create method to new model, and raise a SaveException when we pass the policies to save method, because now we don't support to update a policy of the group.  Related to blueprint complex-anti-affinity-policies  
__label__integration Refactor the policies to policy  A group can only have 1 policy associated it, but now we have ONE to MANY model in group model, this patch change it to ONE to ONE Model.  We also adapt create method to new model, and raise a SaveException when we pass the policies to save method, because now we don't support to update a policy of the group.  Related to blueprint complex-anti-affinity-policies  
__label__objective Refactor the policies to policy  A group can only have 1 policy associated it, but now we have ONE to MANY model in group model, this patch change it to ONE to ONE Model.  We also adapt create method to new model, and raise a SaveException when we pass the policies to save method, because now we don't support to update a policy of the group.  Related to blueprint complex-anti-affinity-policies  
__label__quality Upgrades: Refactor playbooks to set facts  To not to redefine variable multiple times in each service we run check only once and we set fact. To increase readability of generated playbook we add block per strep in services.  
__label__objective Upgrades: Refactor playbooks to set facts  To not to redefine variable multiple times in each service we run check only once and we set fact. To increase readability of generated playbook we add block per strep in services.  
__label__quality RFC,WIP: refactor(keystone): reduce keystoneauth usage complexity  This patch set refactors and fixes the use of the keystoneauth to load the session from cfg.CONF. This removes the unnecessary wrapping of utility function into a class, but it also removes hand selection of fields (but not other fields) to form the keystoneauth object.  Lastly, the need to read envvar should be handled only in the CLI and should be accounted for by the CLI framework, not the server utility function, as this method was only invoked once in the documentation handler and nowhere else in the code base.  
__label__objective RFC,WIP: refactor(keystone): reduce keystoneauth usage complexity  This patch set refactors and fixes the use of the keystoneauth to load the session from cfg.CONF. This removes the unnecessary wrapping of utility function into a class, but it also removes hand selection of fields (but not other fields) to form the keystoneauth object.  Lastly, the need to read envvar should be handled only in the CLI and should be accounted for by the CLI framework, not the server utility function, as this method was only invoked once in the documentation handler and nowhere else in the code base.  
__label__quality WIP: Refactor WSGI apps and utils to limit imports  The file nova/api/openstack/__init__.py had imported a lot of modules, notably nova.utils. This means that any code which runs within that package, notably the placement service, imports all those modules, even if it is not going to use them. This results in scripts/binaries that are heavier than they need to be and in some cases including modules, like eventlet, that it would feel safe to not have in the stack.  Unfortunately we cannot sinply rename nova/api/openstack/__init__.py to another name because it contains FaultWrapper and FaultWrapper is referred to, by package path, from the paste.ini file and that file is out there in config land, and something we prefer not to change. Therefore alternate methods of cleaning up were explored and this has led to some useful changes:  Fault wrapper is the only consumer of walk_class_hierarchy so there is no reason for it it to be in nova.utils.  nova.wsgi contains a mismash of WSGI middleware and applications, which need only a small number of imports, and Server classes which are more complex and not required by the WSGI wares.  Therefore nova.wsgi was split into nova.wsgi and nova.api.wsgi. The name choices may not be ideal, but they were chosen to limit the cascades of changes that are needed across code and tests.  TODO: This is currently passing unit tests locally, but not pep8 and I haven't even tried the full functional suite yet. Also need to investigate what a placement service will load now. This will have had some impact, but probably not as much as desired, yet.  
__label__objective WIP: Refactor WSGI apps and utils to limit imports  The file nova/api/openstack/__init__.py had imported a lot of modules, notably nova.utils. This means that any code which runs within that package, notably the placement service, imports all those modules, even if it is not going to use them. This results in scripts/binaries that are heavier than they need to be and in some cases including modules, like eventlet, that it would feel safe to not have in the stack.  Unfortunately we cannot sinply rename nova/api/openstack/__init__.py to another name because it contains FaultWrapper and FaultWrapper is referred to, by package path, from the paste.ini file and that file is out there in config land, and something we prefer not to change. Therefore alternate methods of cleaning up were explored and this has led to some useful changes:  Fault wrapper is the only consumer of walk_class_hierarchy so there is no reason for it it to be in nova.utils.  nova.wsgi contains a mismash of WSGI middleware and applications, which need only a small number of imports, and Server classes which are more complex and not required by the WSGI wares.  Therefore nova.wsgi was split into nova.wsgi and nova.api.wsgi. The name choices may not be ideal, but they were chosen to limit the cascades of changes that are needed across code and tests.  TODO: This is currently passing unit tests locally, but not pep8 and I haven't even tried the full functional suite yet. Also need to investigate what a placement service will load now. This will have had some impact, but probably not as much as desired, yet.  
__label__testing WIP: Refactor WSGI apps and utils to limit imports  The file nova/api/openstack/__init__.py had imported a lot of modules, notably nova.utils. This means that any code which runs within that package, notably the placement service, imports all those modules, even if it is not going to use them. This results in scripts/binaries that are heavier than they need to be and in some cases including modules, like eventlet, that it would feel safe to not have in the stack.  Unfortunately we cannot sinply rename nova/api/openstack/__init__.py to another name because it contains FaultWrapper and FaultWrapper is referred to, by package path, from the paste.ini file and that file is out there in config land, and something we prefer not to change. Therefore alternate methods of cleaning up were explored and this has led to some useful changes:  Fault wrapper is the only consumer of walk_class_hierarchy so there is no reason for it it to be in nova.utils.  nova.wsgi contains a mismash of WSGI middleware and applications, which need only a small number of imports, and Server classes which are more complex and not required by the WSGI wares.  Therefore nova.wsgi was split into nova.wsgi and nova.api.wsgi. The name choices may not be ideal, but they were chosen to limit the cascades of changes that are needed across code and tests.  TODO: This is currently passing unit tests locally, but not pep8 and I haven't even tried the full functional suite yet. Also need to investigate what a placement service will load now. This will have had some impact, but probably not as much as desired, yet.  
__label__quality begin refactor AllocCandidates._get_by_filters()  The AllocationCandidates._get_by_filters() method is a long, complex mega-method. We want to detangle it and make the code in it understandable and readable. The first step in this refactoring involves renaming a few poorly-named variables, adding more code comments, and breaking out the SQL for the most common code path (where no providers share resources with other providers) into a separate module-level function.  
__label__objective begin refactor AllocCandidates._get_by_filters()  The AllocationCandidates._get_by_filters() method is a long, complex mega-method. We want to detangle it and make the code in it understandable and readable. The first step in this refactoring involves renaming a few poorly-named variables, adding more code comments, and breaking out the SQL for the most common code path (where no providers share resources with other providers) into a separate module-level function.  
__label__quality Refactor the format_validate_parameter fuction to reduce complexity  Adding a if condition to format_validate_parameter function, is failing the pep validation, because of complexity is going beyond the 20 limit. Separating the constraints from the base makes it, simpler.  
__label__objective Refactor the format_validate_parameter fuction to reduce complexity  Adding a if condition to format_validate_parameter function, is failing the pep validation, because of complexity is going beyond the 20 limit. Separating the constraints from the base makes it, simpler.  
__label__objective Refactor cellv2 host discovery logic to avoid races  The compute service list is polled until all expected hosts are reported or a timeout occurs (600s).  Adds a cellv2_discovery flag to puppet services. Used to generate a list of hosts that should have cellv2 host mappings.  Adds a canonical fqdn and that should match the fqdn reported by a host.  Adds the ability to upload a config script for docker config instead of using complex bash on-liners.  Closes-bug: 1720821 
__label__objective Refactor cellv2 host discovery logic to avoid races  The compute service list is polled until all expected hosts are reported or a timeout occurs (600s).  Adds a cellv2_discovery flag to puppet services. Used to generate a list of hosts that should have cellv2 host mappings.  Adds a canonical fqdn and that should match the fqdn reported by a host.  Adds the ability to upload a config script for docker config instead of using complex bash on-liners.  Closes-bug: 1720821 
__label__objective Refactor cellv2 host discovery logic to avoid races  The compute service list is polled until all expected hosts are reported or a timeout occurs (600s).  Adds a cellv2_discovery flag to puppet services. Used to generate a list of hosts that should have cellv2 host mappings.  Adds a canonical fqdn and that should match the fqdn reported by a host.  Adds the ability to upload a config script for docker config instead of using complex bash on-liners.  Closes-bug: 1720821 
__label__quality Refactor init_instance:resume_guests_state  In the init instance, the resume_guests_state part was too complex with our related patch and necessary refactor this to any new method. The related patch attached in comment  
__label__objective Refactor init_instance:resume_guests_state  In the init instance, the resume_guests_state part was too complex with our related patch and necessary refactor this to any new method. The related patch attached in comment  
__label__quality Refactor FloatingIP add_dependencies() method  This method is approaching the complexity limits in the pep8 gate, so refactor it to allow us to continue making changes.  
__label__objective Refactor FloatingIP add_dependencies() method  This method is approaching the complexity limits in the pep8 gate, so refactor it to allow us to continue making changes.  
__label__quality Refactor the create endpoint code, easing readability  
__label__quality [Trivial] docstrings, typos, minor refactoring  As I was reading code trying to understand how PCI devices are handled, I fixed some typos, added some docstrings, and did some minor refactoring for readability/maintainability.  
__label__quality [Trivial] docstrings, typos, minor refactoring  As I was reading code trying to understand how PCI devices are handled, I fixed some typos, added some docstrings, and did some minor refactoring for readability/maintainability.  
__label__objective [Trivial] docstrings, typos, minor refactoring  As I was reading code trying to understand how PCI devices are handled, I fixed some typos, added some docstrings, and did some minor refactoring for readability/maintainability.  
__label__quality Refactor valet_plugins  Part of support nested stacks and updates story  To add nested stack support to Valet, make up for missing Heat resource Orchestration IDs in nested resources by generating a subset of Heat stack lifecycle scheduler hints for each resource in advance, store them as opaque metadata in Valet, then leverage the metadata at Nova scheduling time. Make additional accommodations in anticipation of complexities brought about by adding support for stack updates.  To add a minimally viable amount of Heat `stack-update` support to Valet, significantly restrict the number of update use cases using a set of acceptance criteria. Skip holistic placement at `stack-update` time in favor of Valet's existing re-plan mechanism, placing or replacing resources one at a time, albeit still in consideration of other resources in the same stack hierarchy.  
__label__objective Refactor valet_plugins  Part of support nested stacks and updates story  To add nested stack support to Valet, make up for missing Heat resource Orchestration IDs in nested resources by generating a subset of Heat stack lifecycle scheduler hints for each resource in advance, store them as opaque metadata in Valet, then leverage the metadata at Nova scheduling time. Make additional accommodations in anticipation of complexities brought about by adding support for stack updates.  To add a minimally viable amount of Heat `stack-update` support to Valet, significantly restrict the number of update use cases using a set of acceptance criteria. Skip holistic placement at `stack-update` time in favor of Valet's existing re-plan mechanism, placing or replacing resources one at a time, albeit still in consideration of other resources in the same stack hierarchy.  
__label__objective Refactor valet_plugins  Part of support nested stacks and updates story  To add nested stack support to Valet, make up for missing Heat resource Orchestration IDs in nested resources by generating a subset of Heat stack lifecycle scheduler hints for each resource in advance, store them as opaque metadata in Valet, then leverage the metadata at Nova scheduling time. Make additional accommodations in anticipation of complexities brought about by adding support for stack updates.  To add a minimally viable amount of Heat `stack-update` support to Valet, significantly restrict the number of update use cases using a set of acceptance criteria. Skip holistic placement at `stack-update` time in favor of Valet's existing re-plan mechanism, placing or replacing resources one at a time, albeit still in consideration of other resources in the same stack hierarchy.  
__label__quality Refactor Optimizer and Resource Manager  Part of Support Nested Stacks and Updates story  To add nested stack support to Valet, make up for missing Heat resource Orchestration IDs in nested resources by generating a subset of Heat stack lifecycle scheduler hints for each resource in advance, store them as opaque metadata in Valet, then leverage the metadata at Nova scheduling time. Make additional accommodations in anticipation of complexities brought about by adding support for stack updates.  
__label__objective Refactor Optimizer and Resource Manager  Part of Support Nested Stacks and Updates story  To add nested stack support to Valet, make up for missing Heat resource Orchestration IDs in nested resources by generating a subset of Heat stack lifecycle scheduler hints for each resource in advance, store them as opaque metadata in Valet, then leverage the metadata at Nova scheduling time. Make additional accommodations in anticipation of complexities brought about by adding support for stack updates.  
__label__objective Refactor Optimizer and Resource Manager  Part of Support Nested Stacks and Updates story  To add nested stack support to Valet, make up for missing Heat resource Orchestration IDs in nested resources by generating a subset of Heat stack lifecycle scheduler hints for each resource in advance, store them as opaque metadata in Valet, then leverage the metadata at Nova scheduling time. Make additional accommodations in anticipation of complexities brought about by adding support for stack updates.  
__label__quality Refactor codes to reduce the complexity  Refactor the codes of networks calculation to reduce the complexity.  
__label__quality Refactor ethercalc-specific code out of db  Move ethercalc-related code out of the DB module, before we start making it a lot more complex.  
__label__integration Refactor ethercalc-specific code out of db  Move ethercalc-related code out of the DB module, before we start making it a lot more complex.  
__label__objective Refactor ethercalc-specific code out of db  Move ethercalc-related code out of the DB module, before we start making it a lot more complex.  
__label__quality Refactor BasePortController  Move the LocalLinkConnection object into a separate external LocalLinkConnectionMgr class. I believe replacing the inline object with an external class makes the controller code more readable and maintainable.  
__label__objective Refactor BasePortController  Move the LocalLinkConnection object into a separate external LocalLinkConnectionMgr class. I believe replacing the inline object with an external class makes the controller code more readable and maintainable.  
__label__quality Refactor policy parser init so that validate service is in helper  Refactor the rbac_policy_parser __init__ function so that service validation is done in its own helper to make the code more readable.  
__label__objective Refactor policy parser init so that validate service is in helper  Refactor the rbac_policy_parser __init__ function so that service validation is done in its own helper to make the code more readable.  
__label__quality Refactor of charm.py -> charm/*.py and tests  The charm.py file had got too big and complex for efficient maintenance.  This refactor tries to break down the charm.py file into logical parts (core, classes, defaults, utils) and also provide tests for those parts.  
__label__testing Refactor of charm.py -> charm/*.py and tests  The charm.py file had got too big and complex for efficient maintenance.  This refactor tries to break down the charm.py file into logical parts (core, classes, defaults, utils) and also provide tests for those parts.  
__label__objective Refactor of charm.py -> charm/*.py and tests  The charm.py file had got too big and complex for efficient maintenance.  This refactor tries to break down the charm.py file into logical parts (core, classes, defaults, utils) and also provide tests for those parts.  
__label__objective Refactor install-guide: update node enrollment  * Document how to choose a driver and figure out its properties   separately from the main flow for simplicity. * Rewrite the documentation to recommend using "enroll" state, as it's   our feature, and it's more complex to use anyway. * Add documentation on changing hardware interfaces. * Use bash coloring for command examples. * Various small fixes.  Related-Bug: #1524745 
__label__quality Refactor install-guide: update node enrollment  * Document how to choose a driver and figure out its properties   separately from the main flow for simplicity. * Rewrite the documentation to recommend using "enroll" state, as it's   our feature, and it's more complex to use anyway. * Add documentation on changing hardware interfaces. * Use bash coloring for command examples. * Various small fixes.  Related-Bug: #1524745 
__label__objective Refactor install-guide: update node enrollment  * Document how to choose a driver and figure out its properties   separately from the main flow for simplicity. * Rewrite the documentation to recommend using "enroll" state, as it's   our feature, and it's more complex to use anyway. * Add documentation on changing hardware interfaces. * Use bash coloring for command examples. * Various small fixes.  Related-Bug: #1524745 
__label__quality Refactor VDU server profile  This patch refactors the VDU server profile to kill PEP8 errors and reduce network validation complexities (it has reached 23).  
__label__objective Refactor VDU server profile  This patch refactors the VDU server profile to kill PEP8 errors and reduce network validation complexities (it has reached 23).  
__label__quality [Devref] Refactor attach/detach v2 devref  Refactor attach/detach v2 devref to make it more readable.  
__label__quality [Docs] Refactor galera ops page  A few readability issues should be fixed now.  
__label__quality Refactor of getting qemu-img version  Calling qemu-img --version will get version of qemu-img directly, this patch will make code more readable and simple.  TrivialFix  
__label__objective Refactor of getting qemu-img version  Calling qemu-img --version will get version of qemu-img directly, this patch will make code more readable and simple.  TrivialFix  
__label__quality [api-ref] Refactor share network documentation  This patch makes share network documentation be more readable and maintainable.  
__label__quality [api-ref] Refactor share network documentation  This patch makes share network documentation be more readable and maintainable.  
__label__quality Small refactor of dnat app  Since the floating IP must not be in local controller when the local port is first added, there is no need to assocaite floatingip at add_local_port.  There is aslo other changes to make code more readable.  
__label__objective Small refactor of dnat app  Since the floating IP must not be in local controller when the local port is first added, there is no need to assocaite floatingip at add_local_port.  There is aslo other changes to make code more readable.  
__label__quality Refactor: block-device handling (local loop)  Block device handling can be somewhat complex - especially when taking things like md, lvm or encryption into account.  This patch factors out the creation and deletion of the local loop image device handling into a python library.  The main propose of this patch is to implement the needed infrastructure.  Based on this, more advanced functions can be added. Example: (advanced) partitioning, LVM, handling different boot scenarios (BIOS, UEFI, ...), possibility of handling multiple images (local loop image, iSCSI, physical hard disk, ...), handling of different filesystems for different partitions / LVs.  
__label__objective Refactor: block-device handling (local loop)  Block device handling can be somewhat complex - especially when taking things like md, lvm or encryption into account.  This patch factors out the creation and deletion of the local loop image device handling into a python library.  The main propose of this patch is to implement the needed infrastructure.  Based on this, more advanced functions can be added. Example: (advanced) partitioning, LVM, handling different boot scenarios (BIOS, UEFI, ...), possibility of handling multiple images (local loop image, iSCSI, physical hard disk, ...), handling of different filesystems for different partitions / LVs.  
__label__objective Refactor: block-device handling (local loop)  Block device handling can be somewhat complex - especially when taking things like md, lvm or encryption into account.  This patch factors out the creation and deletion of the local loop image device handling into a python library.  The main propose of this patch is to implement the needed infrastructure.  Based on this, more advanced functions can be added. Example: (advanced) partitioning, LVM, handling different boot scenarios (BIOS, UEFI, ...), possibility of handling multiple images (local loop image, iSCSI, physical hard disk, ...), handling of different filesystems for different partitions / LVs.  
__label__quality Minor encrypt/decrypt unittest refactor  Move encrypt/decrypt functions out of DBAPICryptParamsPropsTest._test_db_encrypt_decrypt(). This makes it less complex in the eyes of pep8, which will benefit a future commit.  
__label__objective Minor encrypt/decrypt unittest refactor  Move encrypt/decrypt functions out of DBAPICryptParamsPropsTest._test_db_encrypt_decrypt(). This makes it less complex in the eyes of pep8, which will benefit a future commit.  
__label__testing Minor encrypt/decrypt unittest refactor  Move encrypt/decrypt functions out of DBAPICryptParamsPropsTest._test_db_encrypt_decrypt(). This makes it less complex in the eyes of pep8, which will benefit a future commit.  
__label__quality Refactored filter_changes in fuelclient_audit  Improved code readability  
__label__quality Refactor events into own class  The eventing model needs to be updated to handle delayed events (and in future needs more logic to handle resumes on target during LPM).  There is going to be additional complexity in events.  This change set moves it out into its own class so as not to keep growing the already long driver.py file.  
__label__objective Refactor events into own class  The eventing model needs to be updated to handle delayed events (and in future needs more logic to handle resumes on target during LPM).  There is going to be additional complexity in events.  This change set moves it out into its own class so as not to keep growing the already long driver.py file.  
__label__objective Refactor events into own class  The eventing model needs to be updated to handle delayed events (and in future needs more logic to handle resumes on target during LPM).  There is going to be additional complexity in events.  This change set moves it out into its own class so as not to keep growing the already long driver.py file.  
__label__quality Refactor events into own class  The eventing model needs to be updated to handle delayed events (and in future needs more logic to handle resumes on target during LPM).  There is going to be additional complexity in events.  This change set moves it out into its own class so as not to keep growing the already long driver.py file.  
__label__objective Refactor events into own class  The eventing model needs to be updated to handle delayed events (and in future needs more logic to handle resumes on target during LPM).  There is going to be additional complexity in events.  This change set moves it out into its own class so as not to keep growing the already long driver.py file.  
__label__objective Refactor events into own class  The eventing model needs to be updated to handle delayed events (and in future needs more logic to handle resumes on target during LPM).  There is going to be additional complexity in events.  This change set moves it out into its own class so as not to keep growing the already long driver.py file.  
__label__quality Refactor _test_build_pxe_config_options tests  This auxiliary method to set up mocks correctly is becoming more complex than the thing it tests.  This patch splits it in two auxiliary mock setup methods, for pxe and ipxe cases respectively.  
__label__testing Refactor _test_build_pxe_config_options tests  This auxiliary method to set up mocks correctly is becoming more complex than the thing it tests.  This patch splits it in two auxiliary mock setup methods, for pxe and ipxe cases respectively.  
__label__objective Refactor _test_build_pxe_config_options tests  This auxiliary method to set up mocks correctly is becoming more complex than the thing it tests.  This patch splits it in two auxiliary mock setup methods, for pxe and ipxe cases respectively.  
__label__quality VMware: Refactor the image transfer  The image transfer is unnecessary complicated and buggy. When transferring streamOptimized images we have to update the progress of the NFC lease to prevent timeouts. This patch replaces the complex usage of blocking queues and threads with a simple read+write loop. It has the same performance and the code is much cleaner. The NFC lease is updated with the loopingcall utility.  Closes-Bug: #1546454 Closes-Bug: #1278690 Related-Bug: #1495429 
__label__objective VMware: Refactor the image transfer  The image transfer is unnecessary complicated and buggy. When transferring streamOptimized images we have to update the progress of the NFC lease to prevent timeouts. This patch replaces the complex usage of blocking queues and threads with a simple read+write loop. It has the same performance and the code is much cleaner. The NFC lease is updated with the loopingcall utility.  Closes-Bug: #1546454 Closes-Bug: #1278690 Related-Bug: #1495429 
__label__quality Refactor side-effect functions  Refactor these functions to make them much more readable.  Not intended to have any functional change.  
__label__quality Refactor the image transfer  The image transfer is unnecessary complicated and buggy. This patch replaces the complex usage of blocking queues and threads with a simple read+write loop. It has the same performance and the code is much cleaner. The NFC lease is updated with the loopingcall utility.  
__label__objective Refactor the image transfer  The image transfer is unnecessary complicated and buggy. This patch replaces the complex usage of blocking queues and threads with a simple read+write loop. It has the same performance and the code is much cleaner. The NFC lease is updated with the loopingcall utility.  
__label__quality Small refactor root device loop matching logic  When matching the root device hints passed to Ironic and the devices present in the disk, the logic to the "size" attribute was different was outside the main loop. This patch refactors that uses the same loop for matching the size attribute, improving a little the readability.  
__label__objective Small refactor root device loop matching logic  When matching the root device hints passed to Ironic and the devices present in the disk, the logic to the "size" attribute was different was outside the main loop. This patch refactors that uses the same loop for matching the size attribute, improving a little the readability.  
__label__quality Refactor heat driver create() handler  It helps to improve the readability and maintanence easier.  
__label__quality refactor sg/sgr event handing and add code coverage  This patch just renames some methods and stylictic things to improve readability. It also adds code coverage.  
__label__testing refactor sg/sgr event handing and add code coverage  This patch just renames some methods and stylictic things to improve readability. It also adds code coverage.  
__label__objective refactor sg/sgr event handing and add code coverage  This patch just renames some methods and stylictic things to improve readability. It also adds code coverage.  
__label__quality Refactor resource update funtation to reduce complexity  
__label__quality Refactor keystone tenant fetcher  Refactor keystone tenant fetcher so that make it more robust and readable.  
__label__quality Refactor trigger controller  The post method of trigger controller is currently a bit complex. Breaks down the code into conceptually meaningful sub-methods and thus simplifies it.  
__label__objective Refactor trigger controller  The post method of trigger controller is currently a bit complex. Breaks down the code into conceptually meaningful sub-methods and thus simplifies it.  
__label__quality small refactoring  extract methods to make it more readable  Implements: blueprint vitrage-cli 
__label__quality Refactor parsing metadata to a common function  Currently the metadata is parsed using dict(v.split('=', 1) for v in metadata) and was used in several places, it could be better if we refactor it to a common function. It will make it more readable and easier to use in the future.  
__label__objective Refactor parsing metadata to a common function  Currently the metadata is parsed using dict(v.split('=', 1) for v in metadata) and was used in several places, it could be better if we refactor it to a common function. It will make it more readable and easier to use in the future.  
__label__quality Refactor status and admin state translation code to improve readability  In some of the dashboard 'views.py' files, there is code that enables the detail status and, when applicable, admin state labels to be translated.  The current coding style of these sections is hard to read.  Any and all sections of code that use this style should be refactored to enhance the code readability.  This change proposes one possible method of refactoring this code.  
__label__objective Refactor status and admin state translation code to improve readability  In some of the dashboard 'views.py' files, there is code that enables the detail status and, when applicable, admin state labels to be translated.  The current coding style of these sections is hard to read.  Any and all sections of code that use this style should be refactored to enhance the code readability.  This change proposes one possible method of refactoring this code.  
__label__quality Refactoring task detailed command  The output is classified into multiple inner methods.   - _print_iterations_data   - _print_task_info   - _print_scenario_args   - _print_summrized_result   - _print_ssrs_result   - _print_hints  Related: blueprint showing-summarized-result-in-system-readable 
__label__quality Refactor _extract_driver_info() to reduce complexity.  Split _extract_driver_info() into several tiny methods to reduce complexity. Or it will be too complex while some new drivers are added later.  
__label__objective Refactor _extract_driver_info() to reduce complexity.  Split _extract_driver_info() into several tiny methods to reduce complexity. Or it will be too complex while some new drivers are added later.  
__label__quality Refactor MagnumException to reduce complexity  Reduce cyclomatic complexity of MagnumException to below 10. Remove exception handling and optimise the logging when the kwargs does not match the message.  
__label__objective Refactor MagnumException to reduce complexity  Reduce cyclomatic complexity of MagnumException to below 10. Remove exception handling and optimise the logging when the kwargs does not match the message.  
__label__quality Refactor config setup to reduce complexity  The cyclomatic complexity of the setup method was greater than 10 and reducing this complexity allows for easier understanding of the method.  
__label__objective Refactor config setup to reduce complexity  The cyclomatic complexity of the setup method was greater than 10 and reducing this complexity allows for easier understanding of the method.  
__label__quality Refactor periodic task sync_bay_status  The cyclomatic complexity of sync_bay_status was greater than 10 and very hard to comprehend. This patch reduces the complexity and makes the task more open to refactoring and maintence.  Partial-Bug: #1501331 
__label__objective Refactor periodic task sync_bay_status  The cyclomatic complexity of sync_bay_status was greater than 10 and very hard to comprehend. This patch reduces the complexity and makes the task more open to refactoring and maintence.  Partial-Bug: #1501331 
__label__quality Refactoring exceptions  Merge of exception, remove unused exceptions, make more humanreadable view.  
__label__objective Refactoring exceptions  Merge of exception, remove unused exceptions, make more humanreadable view.  
__label__quality Refactor some minor issues to improve code readability  Working on another patch, i notice some issues of code coherence, difficult readability and unnecessary code on some classes.  This change refactors some code issues like if's statements out of cohesion, unnecessary conditions, unnecessary "continue" statements, and extracts method of very large methods like node.NodesController.patch(), which is a little bit complex to understand.  
__label__objective Refactor some minor issues to improve code readability  Working on another patch, i notice some issues of code coherence, difficult readability and unnecessary code on some classes.  This change refactors some code issues like if's statements out of cohesion, unnecessary conditions, unnecessary "continue" statements, and extracts method of very large methods like node.NodesController.patch(), which is a little bit complex to understand.  
__label__quality solve pep8 is too complex problem  function update_task is too complex in this fix and require small refactorings.  
__label__quality Refactoring cinder create_volume_backup scenario  It improves code readability and gets cinder volume backups scenarios standardized.  
__label__objective Refactoring cinder create_volume_backup scenario  It improves code readability and gets cinder volume backups scenarios standardized.  
__label__quality XenAPI: Refactor rotate_xen_guest_logs to avoid races  Moving console logs to a temporary file is a clear race when Nova tries to access a file it might not be there.  We need to keep the readable file in place at all times.  Atomic operations like mv are fine as if the file was opened before the mv operation Linux will keep the contents available until the file is closed by Nova's plugin.  
__label__objective XenAPI: Refactor rotate_xen_guest_logs to avoid races  Moving console logs to a temporary file is a clear race when Nova tries to access a file it might not be there.  We need to keep the readable file in place at all times.  Atomic operations like mv are fine as if the file was opened before the mv operation Linux will keep the contents available until the file is closed by Nova's plugin.  
__label__integration XenAPI: Refactor rotate_xen_guest_logs to avoid races  Moving console logs to a temporary file is a clear race when Nova tries to access a file it might not be there.  We need to keep the readable file in place at all times.  Atomic operations like mv are fine as if the file was opened before the mv operation Linux will keep the contents available until the file is closed by Nova's plugin.  
__label__quality dib.sh: minor switch case refactor  Check for ${os} using a switch case, so it is - more readable - easier to expand later  
__label__objective dib.sh: minor switch case refactor  Check for ${os} using a switch case, so it is - more readable - easier to expand later  
__label__quality Do refactor for deepsix.inpubrep()  Merge the duplicate code in deepsix.inpubrep(), and make the logic more readable.  
__label__objective Do refactor for deepsix.inpubrep()  Merge the duplicate code in deepsix.inpubrep(), and make the logic more readable.  
__label__quality Revocation engine refactoring  Rewritten RevokeTree.is_revoked method to be more readable and use less dynamic objects. Recursion is used.  
__label__objective Revocation engine refactoring  Rewritten RevokeTree.is_revoked method to be more readable and use less dynamic objects. Recursion is used.  
__label__quality Refactoring heat deployer's multi-port checking code  The code which checks whether all the ports of the DU are active was coupled with the code that ran the check for du_attempts number of time. This coupling was incorrect. If the du_attempts was less than the number of ports, we would have ended up not checking all the ports.  This patch fixes this situation. We decouple the checking of the ports from trying the check du_attempts times. We also maintain a list of successful_ports so that in each du_attempt we only check those ports which have not yet been successfully reachable.  
__label__objective Refactoring heat deployer's multi-port checking code  The code which checks whether all the ports of the DU are active was coupled with the code that ran the check for du_attempts number of time. This coupling was incorrect. If the du_attempts was less than the number of ports, we would have ended up not checking all the ports.  This patch fixes this situation. We decouple the checking of the ports from trying the check du_attempts times. We also maintain a list of successful_ports so that in each du_attempt we only check those ports which have not yet been successfully reachable.  
__label__quality Refactored/optimized reporting code  I went through and cleaned up all the code in result_store. The focus was on removing redundancy, cleaning things up, and making the code more readable/maintainable. I think it's in pretty good shape now.  
__label__objective Refactored/optimized reporting code  I went through and cleaned up all the code in result_store. The focus was on removing redundancy, cleaning things up, and making the code more readable/maintainable. I think it's in pretty good shape now.  
__label__quality Refactor secrets functional tests for readability  Updates to secrets functional tests to make them more readable and understandable.  Updated function names to make them more meaningful.  
__label__testing Refactor secrets functional tests for readability  Updates to secrets functional tests to make them more readable and understandable.  Updated function names to make them more meaningful.  
__label__objective Refactor secrets functional tests for readability  Updates to secrets functional tests to make them more readable and understandable.  Updated function names to make them more meaningful.  
__label__objective Refactor: don't require token formatters to understand "token_data"  The calling module already has to understand how token_data is composed, so there's no reason for the token formatters to work with such complex data. This patch ensures that token formatters only see primitive strings (of datetimes, audit IDs, and trust IDs), which they're free to encode however they wish.  
__label__objective Refactor: don't require token formatters to understand "token_data"  The calling module already has to understand how token_data is composed, so there's no reason for the token formatters to work with such complex data. This patch ensures that token formatters only see primitive strings (of datetimes, audit IDs, and trust IDs), which they're free to encode however they wish.  
__label__quality Slight refactor of policy engine builtin functionality  Move some complex functionality into its own function.  
__label__quality Refactor Pinger class  This change refactors Pinger class by: * removing testcase attribute in order to reduce coupling between   testcases and Pinger instances, * defining client namespace in Pinger.__init__ instead of assert_*   methods because it's required by daughter change.  
__label__testing Refactor Pinger class  This change refactors Pinger class by: * removing testcase attribute in order to reduce coupling between   testcases and Pinger instances, * defining client namespace in Pinger.__init__ instead of assert_*   methods because it's required by daughter change.  
__label__objective Refactor Pinger class  This change refactors Pinger class by: * removing testcase attribute in order to reduce coupling between   testcases and Pinger instances, * defining client namespace in Pinger.__init__ instead of assert_*   methods because it's required by daughter change.  
__label__quality Refactor segments of the periodic worker  Perform some cleanups on the periodic worker type to make it easier to later change (and have parallelism if we want).  - Deprecates providing a tombstone via __init__ since that   will restrict future enhancements we can make. - Builds the immediates and the to be scheduled lists in a   single static _prepare() function to aid in   understandability (and hopefully also reduces   complexity).  
__label__objective Refactor segments of the periodic worker  Perform some cleanups on the periodic worker type to make it easier to later change (and have parallelism if we want).  - Deprecates providing a tombstone via __init__ since that   will restrict future enhancements we can make. - Builds the immediates and the to be scheduled lists in a   single static _prepare() function to aid in   understandability (and hopefully also reduces   complexity).  
__label__quality Refactor controller code to use RestController  - code becomes more readable - no longer need to manually check for http method type  
__label__objective Refactor controller code to use RestController  - code becomes more readable - no longer need to manually check for http method type  
__label__quality Trivial refactors to secret controller  Did some trivial refactors to secret controller to improve readability.  
__label__quality Refactor order validation  The 'meta' parameter for order validation was being handled manually instead of in the JSON schema; So this was fixed. On the other hand, there was a rudimentary validation for both the type and the meta parameters in the Order's PUT controller; this was removed, as it created unnecessary complexity.  
__label__objective Refactor order validation  The 'meta' parameter for order validation was being handled manually instead of in the JSON schema; So this was fixed. On the other hand, there was a rudimentary validation for both the type and the meta parameters in the Order's PUT controller; this was removed, as it created unnecessary complexity.  
__label__quality Refactoring benchmark/validation.py  ValidationResult() returns True as default. This patch removes mostly of the return ValidationResult() from the code and change ValidationResult to ValidationResult(True) so the code became more readable.  
__label__objective Refactoring benchmark/validation.py  ValidationResult() returns True as default. This patch removes mostly of the return ValidationResult() from the code and change ValidationResult to ValidationResult(True) so the code became more readable.  
__label__quality Refactoring structure of rally/verification  Removing the verifiers directory to make the code more readable and reduce unnecessary complexity  
__label__quality Refactor custom matchers  This reduces the complexity by grouping checks  
__label__quality Refactor describe methods to use Describer class  Except instances due their complexity  
__label__objective Refactor describe methods to use Describer class  Except instances due their complexity  
__label__quality Refactor process_router method in L3 agent  Refactors the process_router method of the L3NATAgent class to several methods that coherently group functionallity. The aim is to make the code more readable and maintainable. There is no functional change in this patch.  Partially-Implements: bp restructure-l3-agent  
__label__objective Refactor process_router method in L3 agent  Refactors the process_router method of the L3NATAgent class to several methods that coherently group functionallity. The aim is to make the code more readable and maintainable. There is no functional change in this patch.  Partially-Implements: bp restructure-l3-agent  
__label__quality Refactoring: cap complexity at 15 and coverage at 90  
__label__quality Refactor l2_pop code to pass mac/ip/device_owner info more readably  
__label__quality Cleanup and refactor methods in unit/test_security_groups_rpc  We had strings repeating all along the code which already were in constant form, those have been refactored. Also global configuration changes are now handled by functions to enhance code readability.  
__label__objective Cleanup and refactor methods in unit/test_security_groups_rpc  We had strings repeating all along the code which already were in constant form, those have been refactored. Also global configuration changes are now handled by functions to enhance code readability.  
__label__quality WIP Improve rally generic cleanup mechanism  Current cleanup mechanism is awful. It's hardcoed, without repeat on failures, contains a lot of mistakes, in some places it is too fast (in case of deletion of VMs) in other to slow (like deletion of users). As well there is mix of cleanup mechanism and resource cleanup mechanism.  To resolve these all issues this patch introcude a cleanup engine that resolves all issues above.  It's resource based, so to add new resouce you should just a make subclass of base.Resource and probably override some of methods like (list, delete, is_deleted) and that's all.  All complexity of managing: 0) waiting unit async deletion is finished 1) repeat on failure logic 2) greaceful failure handling 3) parallelization 4) plugin support Is hidden deep inside cleanup engine  + bonus we are able to specify now single resource (without clenaping whole service)  bp benchmark-context-cleanup-refactor  
__label__objective WIP Improve rally generic cleanup mechanism  Current cleanup mechanism is awful. It's hardcoed, without repeat on failures, contains a lot of mistakes, in some places it is too fast (in case of deletion of VMs) in other to slow (like deletion of users). As well there is mix of cleanup mechanism and resource cleanup mechanism.  To resolve these all issues this patch introcude a cleanup engine that resolves all issues above.  It's resource based, so to add new resouce you should just a make subclass of base.Resource and probably override some of methods like (list, delete, is_deleted) and that's all.  All complexity of managing: 0) waiting unit async deletion is finished 1) repeat on failure logic 2) greaceful failure handling 3) parallelization 4) plugin support Is hidden deep inside cleanup engine  + bonus we are able to specify now single resource (without clenaping whole service)  bp benchmark-context-cleanup-refactor  
__label__quality Refactor generic cleanup mechanism part 2  Current cleanup mechanism is awful. It's hardcoed, without repeat on failures, contains a lot of mistakes, in some places it is too fast (in case of deletion of VMs) in other to slow (like deletion of users). As well there is mix of cleanup mechanism and resource cleanup mechanism. To resolve these all issues this patch introcude a cleanup engine that resolves all issues above. It's resource based, so to add new resouce you should just a make subclass of base.Resource and probably override some of methods like (list, delete, is_deleted) and that's all. All complexity of managing: 0) waiting unit async deletion is finished 1) repeat on failure logic 2) greaceful failure handling 3) parallelization 4) plugin support Is hidden deep inside cleanup engine + bonus we are able to specify now single resource (without clenaping whole service)  PART 2: -------  * Write cleanup plugins for all tracked resources (on currnet moment) * Switch cleanap context to use cleanup engine isntead of ald cleanup.utils * Merge admin and user cleanup context (cause they are quite short now) * Change quotas scenairos cleanup context configuration * Fix resource names that are created by ceilometer scenarios  bp benchmark-context-cleanup-refactor  
__label__objective Refactor generic cleanup mechanism part 2  Current cleanup mechanism is awful. It's hardcoed, without repeat on failures, contains a lot of mistakes, in some places it is too fast (in case of deletion of VMs) in other to slow (like deletion of users). As well there is mix of cleanup mechanism and resource cleanup mechanism. To resolve these all issues this patch introcude a cleanup engine that resolves all issues above. It's resource based, so to add new resouce you should just a make subclass of base.Resource and probably override some of methods like (list, delete, is_deleted) and that's all. All complexity of managing: 0) waiting unit async deletion is finished 1) repeat on failure logic 2) greaceful failure handling 3) parallelization 4) plugin support Is hidden deep inside cleanup engine + bonus we are able to specify now single resource (without clenaping whole service)  PART 2: -------  * Write cleanup plugins for all tracked resources (on currnet moment) * Switch cleanap context to use cleanup engine isntead of ald cleanup.utils * Merge admin and user cleanup context (cause they are quite short now) * Change quotas scenairos cleanup context configuration * Fix resource names that are created by ceilometer scenarios  bp benchmark-context-cleanup-refactor  
__label__quality Refactor Heat dependencies for nova compute  Allows heat to have more control of the parallelism of the deploy and allow easy integration of the new heat dependencies required for nova compute integration as this at present is difficult understand and has unnecessary complex dependencies.  
__label__objective Refactor Heat dependencies for nova compute  Allows heat to have more control of the parallelism of the deploy and allow easy integration of the new heat dependencies required for nova compute integration as this at present is difficult understand and has unnecessary complex dependencies.  
__label__quality Refactor existing endpoint filter tests  Refactored the existing suite of endpoint filter tests including renaming method names to aid readability and added additional comments.  
__label__objective Refactor existing endpoint filter tests  Refactored the existing suite of endpoint filter tests including renaming method names to aid readability and added additional comments.  
__label__quality Refactor set domain-id and mapping code  Applied function separation refactorings to the _set_domain_id_and_mapping function in the identity/core module in an attempt to make it more readable.  
__label__objective Refactor set domain-id and mapping code  Applied function separation refactorings to the _set_domain_id_and_mapping function in the identity/core module in an attempt to make it more readable.  
__label__quality Refactor secret validation for redability  Mostly applied method extraction to the secret schema validation function in order to have it more readable.  
__label__objective Refactor secret validation for redability  Mostly applied method extraction to the secret schema validation function in order to have it more readable.  
__label__quality Refactor allow_all_content_types for readability  The current implementation of the decorator allow_all_content_types was slightly confusing, since while iterating through the mimetypes it would call setdefault each time for the same object. So I separated that call from the iteration that sets the default values to make it clear. Also, the iteration was turned into a generator for a more pythonic approach and performance.  
__label__objective Refactor allow_all_content_types for readability  The current implementation of the decorator allow_all_content_types was slightly confusing, since while iterating through the mimetypes it would call setdefault each time for the same object. So I separated that call from the iteration that sets the default values to make it clear. Also, the iteration was turned into a generator for a more pythonic approach and performance.  
__label__quality test: refactor run tasks to include file  This change move tasks to dedicated files to improve the readability of the run playbooks.  
__label__objective test: refactor run tasks to include file  This change move tasks to dedicated files to improve the readability of the run playbooks.  
__label__quality Refactor/cleanup jobs.py module  Since this is the main entry point for now, we should make it more obvious and clean it up. This includes getting rid of relative imports, cleaning up imported classes, and pulling some of the boiler plate code into more readable methods.  
__label__objective Refactor/cleanup jobs.py module  Since this is the main entry point for now, we should make it more obvious and clean it up. This includes getting rid of relative imports, cleaning up imported classes, and pulling some of the boiler plate code into more readable methods.  
__label__integration Refactor api.catalog.search() method to provide 'next_marker' value  That way it works like Glance (see http://tinyurl.com/jwqtj23) and allows for complex query pagination (to cycle through pages filtered by some criteria, muranoclient uses 'next_marker' pointer).  Implements: blueprint app-catalog-pagination 
__label__objective Refactor api.catalog.search() method to provide 'next_marker' value  That way it works like Glance (see http://tinyurl.com/jwqtj23) and allows for complex query pagination (to cycle through pages filtered by some criteria, muranoclient uses 'next_marker' pointer).  Implements: blueprint app-catalog-pagination 
__label__quality xenapi: refactor volumeops attach  Refactor the attach code, so its more readable.  At the same time, only check if the VM is running when a hotplug is requested.  
__label__objective xenapi: refactor volumeops attach  Refactor the attach code, so its more readable.  At the same time, only check if the VM is running when a hotplug is requested.  
__label__quality Refactor create_trust for readability  I refactored the create_trust function in the keystone.trust.controllers module in order to make it more readable. In addition, the function will now check for all the required attributes in the request and return an appropriate error message if any of them is missing or is empty.  
__label__objective Refactor create_trust for readability  I refactored the create_trust function in the keystone.trust.controllers module in order to make it more readable. In addition, the function will now check for all the required attributes in the request and return an appropriate error message if any of them is missing or is empty.  
__label__quality Refactor fuel-web's run_tests.sh  Purpose: get rid of unclear logic. It includes the following improvements:  * run tests from one place * increase code readability * function decomposition  
__label__objective Refactor fuel-web's run_tests.sh  Purpose: get rid of unclear logic. It includes the following improvements:  * run tests from one place * increase code readability * function decomposition  
__label__quality Refactor specs  Refactor the spec files to use the newer RSpec let, shared_context, and shared_example syntax to remove redundancy and improve readability.  
__label__objective Refactor specs  Refactor the spec files to use the newer RSpec let, shared_context, and shared_example syntax to remove redundancy and improve readability.  
__label__quality refactor graphite stanzas for readability  this refactors the graphite stanzas to something that's more readable, and makes it simpler to add new ones later without lots of copy / paste.  
__label__objective refactor graphite stanzas for readability  this refactors the graphite stanzas to something that's more readable, and makes it simpler to add new ones later without lots of copy / paste.  
__label__quality Coding standards and style refactor of runner  * Reordered imports * Replaced all instances of the use of % style string formatting   with python 2.6 compatible .format() string formatting. * Removed the use of  newline escapes on line breaks and stacked   paramaters where they did not increase readability. * Removed redundant try-excepts. * Refactored tag and attr checking methods to remove the use of   eval()  
__label__objective Coding standards and style refactor of runner  * Reordered imports * Replaced all instances of the use of % style string formatting   with python 2.6 compatible .format() string formatting. * Removed the use of  newline escapes on line breaks and stacked   paramaters where they did not increase readability. * Removed redundant try-excepts. * Refactored tag and attr checking methods to remove the use of   eval()  
__label__quality Refactor manage-projects for readability  This changes absolutely no functionality - it's merely extracting parts of the really long function into subfunctions. It should make further refactoring of sequencing and error conditions easier to reason about.  
__label__objective Refactor manage-projects for readability  This changes absolutely no functionality - it's merely extracting parts of the really long function into subfunctions. It should make further refactoring of sequencing and error conditions easier to reason about.  
__label__quality refactor tests to move common generators into base  the complexity of getting the generators setup after the first couple of sanity checks meant it really made sense to refactor into a common base class.  
__label__testing refactor tests to move common generators into base  the complexity of getting the generators setup after the first couple of sanity checks meant it really made sense to refactor into a common base class.  
__label__objective refactor tests to move common generators into base  the complexity of getting the generators setup after the first couple of sanity checks meant it really made sense to refactor into a common base class.  
__label__quality Refactoring for nicira plugin to support NVP DHCP/Metadata services  This initial patch is aimed at decoupling core plugin services from DHCP and metadata services. The abstraction being introduced is needed so that the code can support both models where dhcp and metadata services are provided by external RPC agents or solely by the server-side plugin.  Supports blueprint nvp-dhcp-metadata-services  
__label__objective Refactoring for nicira plugin to support NVP DHCP/Metadata services  This initial patch is aimed at decoupling core plugin services from DHCP and metadata services. The abstraction being introduced is needed so that the code can support both models where dhcp and metadata services are provided by external RPC agents or solely by the server-side plugin.  Supports blueprint nvp-dhcp-metadata-services  
__label__integration Refactoring for nicira plugin to support NVP DHCP/Metadata services  This initial patch is aimed at decoupling core plugin services from DHCP and metadata services. The abstraction being introduced is needed so that the code can support both models where dhcp and metadata services are provided by external RPC agents or solely by the server-side plugin.  Supports blueprint nvp-dhcp-metadata-services  
__label__quality Refactor AgentBase.heartbeat and process_next_step  These methods are reaching the complexity limits, split them. Also update messages to be more human-friendly.  The complexity limit is returned back to 18 as before hacking 3.0.  
__label__objective Refactor AgentBase.heartbeat and process_next_step  These methods are reaching the complexity limits, split them. Also update messages to be more human-friendly.  The complexity limit is returned back to 18 as before hacking 3.0.  
__label__quality Refactors to_bytes  The original logic was not much intuitive. Changed the code for better readability.  
__label__quality Refactor ClusterComplexName  This change includes various code cleanups which improve the way that a developer creates and interacts with ClusterComplexNames.  
__label__objective Refactor ClusterComplexName  This change includes various code cleanups which improve the way that a developer creates and interacts with ClusterComplexNames.  
__label__quality Ubuntu: refactor network.yml playbook  The network.yml playbook is reduced in complexity, now performing validation before including a role specific to the OS family of the host (network-redhat or network-debian). This will allow the network configuration to diverge between OS families without adding excessive conditionals.  Currently the content of the roles is identical.  Story: 2004960  
__label__objective Ubuntu: refactor network.yml playbook  The network.yml playbook is reduced in complexity, now performing validation before including a role specific to the OS family of the host (network-redhat or network-debian). This will allow the network configuration to diverge between OS families without adding excessive conditionals.  Currently the content of the roles is identical.  Story: 2004960  
__label__integration Ubuntu: refactor network.yml playbook  The network.yml playbook is reduced in complexity, now performing validation before including a role specific to the OS family of the host (network-redhat or network-debian). This will allow the network configuration to diverge between OS families without adding excessive conditionals.  Currently the content of the roles is identical.  Story: 2004960  
__label__quality Refactor set vf GUID to imporve readability  - Move set vf guid via sysfs logic to its own method   for both mlnx4 and mlnx5 - Change fallback logging to debug and minor rewording  
__label__objective Refactor set vf GUID to imporve readability  - Move set vf guid via sysfs logic to its own method   for both mlnx4 and mlnx5 - Change fallback logging to debug and minor rewording  
__label__quality Refactor static path code  The static path code is refactored to improve readability, and will be used in subsequent patches adding support for baremetal VNIC types.  
__label__objective Refactor static path code  The static path code is refactored to improve readability, and will be used in subsequent patches adding support for baremetal VNIC types.  
__label__quality Refactor static path code  The static path code is refactored to improve readability, and will be used in subsequent patches adding support for baremetal VNIC types.  
__label__objective Refactor static path code  The static path code is refactored to improve readability, and will be used in subsequent patches adding support for baremetal VNIC types.  
__label__quality Refactor static path code  The static path code is refactored to improve readability, and will be used in subsequent patches adding support for baremetal VNIC types.  
__label__objective Refactor static path code  The static path code is refactored to improve readability, and will be used in subsequent patches adding support for baremetal VNIC types.  
__label__quality Refactor static path code  The static path code is refactored to improve readability, and will be used in subsequent patches adding support for baremetal VNIC types.  
__label__objective Refactor static path code  The static path code is refactored to improve readability, and will be used in subsequent patches adding support for baremetal VNIC types.  
__label__quality Refactor static path code  The static path code is refactored to improve readability, and will be used in subsequent patches adding support for baremetal VNIC types.  
__label__objective Refactor static path code  The static path code is refactored to improve readability, and will be used in subsequent patches adding support for baremetal VNIC types.  
__label__quality Refactor action execution reporter  * Moved away from using Oslo periodic tasks in the action execution   reporter since in this case they don't make the code more readable.   Also, now it is symmetric with other similar components like action   execution checker. * Refactored action execution checker w/o using classes since having   many instances of it doesn't make sense. * Small style changes  
__label__objective Refactor action execution reporter  * Moved away from using Oslo periodic tasks in the action execution   reporter since in this case they don't make the code more readable.   Also, now it is symmetric with other similar components like action   execution checker. * Refactored action execution checker w/o using classes since having   many instances of it doesn't make sense. * Small style changes  
__label__quality Minor refactor cleanup of _make_proxy  Noticed we were doing a redundant lookup and conditional. Straight refactor for readability, no functional change.  
__label__objective Minor refactor cleanup of _make_proxy  Noticed we were doing a redundant lookup and conditional. Straight refactor for readability, no functional change.  
__label__objective Refactor upgrade_controlplane parts  * move network related methods from `upgrade_controlplane` to `env`   module * collect yaml files from nodes if bup info is not present * extract `delete_overlay_networks` action to separate function  
__label__objective Refactor upgrade_controlplane parts  * move network related methods from `upgrade_controlplane` to `env`   module * collect yaml files from nodes if bup info is not present * extract `delete_overlay_networks` action to separate function  
__label__testing Refactor upgrade_controlplane parts  * move network related methods from `upgrade_controlplane` to `env`   module * collect yaml files from nodes if bup info is not present * extract `delete_overlay_networks` action to separate function  
__label__quality Refactor upgrade_controlplane parts  * move network related methods from `upgrade_controlplane` to `env`   module * collect yaml files from nodes if bup info is not present * extract `delete_overlay_networks` action to separate function  
__label__objective Refactor upgrade_controlplane parts  * move network related methods from `upgrade_controlplane` to `env`   module * collect yaml files from nodes if bup info is not present * extract `delete_overlay_networks` action to separate function  
__label__objective Refactor upgrade_controlplane parts  * move network related methods from `upgrade_controlplane` to `env`   module * collect yaml files from nodes if bup info is not present * extract `delete_overlay_networks` action to separate function  
__label__testing Refactor upgrade_controlplane parts  * move network related methods from `upgrade_controlplane` to `env`   module * collect yaml files from nodes if bup info is not present * extract `delete_overlay_networks` action to separate function  
__label__quality Refactor upgrade_controlplane parts  * move network related methods from `upgrade_controlplane` to `env`   module * collect yaml files from nodes if bup info is not present * extract `delete_overlay_networks` action to separate function  
__label__quality Refactor Keystone wsgi/eventlet app  Due to passing functions as parameters startup code looks as it needs to be done as a class hierarchy.  
__label__objective Refactor token fetching  Refactor the code that handles fetching a token either from cache, decoded from PKI or from keystone. This will allow us to substitute a new method of fetching a token (like from the keystone database) in other scenarios.  Whilst the contextmanager pattern here seems a little odd in the auth_token middleware case (and possible server case) we need to additionally handle the token data after it has been validated and I consider this much cleaner that saying you must call an existing function.  
__label__testing Refactor token fetching  Refactor the code that handles fetching a token either from cache, decoded from PKI or from keystone. This will allow us to substitute a new method of fetching a token (like from the keystone database) in other scenarios.  Whilst the contextmanager pattern here seems a little odd in the auth_token middleware case (and possible server case) we need to additionally handle the token data after it has been validated and I consider this much cleaner that saying you must call an existing function.  
__label__quality Refactor of BaseTestCase  To run integratin tests, there needs to be set environment variable INTEGRATION_TESTS. In past, positive behaviour was enclosed in one big 'if' branch. I've moved negative behaviour to beginning and len rest of method as ordinary function body.  
__label__testing Refactor of BaseTestCase  To run integratin tests, there needs to be set environment variable INTEGRATION_TESTS. In past, positive behaviour was enclosed in one big 'if' branch. I've moved negative behaviour to beginning and len rest of method as ordinary function body.  
__label__objective Refactor Huawei Volume driver  This blueprint is an attempt to refactor the Huawei volume driver in liberty. We will add a base dirver to implement the basic functions that the Cinder driver required. The sub-class will inherit the base driver according to different storages. the following diragram shows the structure of the newest Huawei volume driver          +---------------+ +------------------+ +--------------------+         | ISCSIDriver | | HuaweiBaseDriver | | FibreChannelDriver |         +---------+-----+ +----+-------------+ +----+-----------+----+                   | | | |                   | | |__________ |                   | | | |               +---+--------------------+ +---+--------------------+               | Huawei18000ISCSIDriver | | Huawei18000FCDriver |               +-------------+----------+ +-------------+----------+  
__label__refactoring Refactor Huawei Volume driver  This blueprint is an attempt to refactor the Huawei volume driver in liberty. We will add a base dirver to implement the basic functions that the Cinder driver required. The sub-class will inherit the base driver according to different storages. the following diragram shows the structure of the newest Huawei volume driver          +---------------+ +------------------+ +--------------------+         | ISCSIDriver | | HuaweiBaseDriver | | FibreChannelDriver |         +---------+-----+ +----+-------------+ +----+-----------+----+                   | | | |                   | | |__________ |                   | | | |               +---+--------------------+ +---+--------------------+               | Huawei18000ISCSIDriver | | Huawei18000FCDriver |               +-------------+----------+ +-------------+----------+  
__label__objective Refactor Huawei Volume driver  This blueprint is an attempt to refactor the Huawei volume driver in liberty. We will add a base dirver to implement the basic functions that the Cinder driver required. The sub-class will inherit the base driver according to different storages. the following diragram shows the structure of the newest Huawei volume driver          +---------------+ +------------------+ +--------------------+         | ISCSIDriver | | HuaweiBaseDriver | | FibreChannelDriver |         +---------+-----+ +----+-------------+ +----+-----------+----+                   | | | |                   | | |__________ |                   | | | |               +---+--------------------+ +---+--------------------+               | Huawei18000ISCSIDriver | | Huawei18000FCDriver |               +-------------+----------+ +-------------+----------+  
__label__refactoring Refactor Huawei Volume driver  This blueprint is an attempt to refactor the Huawei volume driver in liberty. We will add a base dirver to implement the basic functions that the Cinder driver required. The sub-class will inherit the base driver according to different storages. the following diragram shows the structure of the newest Huawei volume driver          +---------------+ +------------------+ +--------------------+         | ISCSIDriver | | HuaweiBaseDriver | | FibreChannelDriver |         +---------+-----+ +----+-------------+ +----+-----------+----+                   | | | |                   | | |__________ |                   | | | |               +---+--------------------+ +---+--------------------+               | Huawei18000ISCSIDriver | | Huawei18000FCDriver |               +-------------+----------+ +-------------+----------+  
__label__refactoring Refactor Huawei Volume driver  This blueprint is an attempt to refactor the Huawei volume driver in liberty. We will add a base dirver to implement the basic functions that the Cinder driver required. The sub-class will inherit the base driver according to different storages. the following diragram shows the structure of the newest Huawei volume driver          +---------------+ +------------------+ +--------------------+         | ISCSIDriver | | HuaweiBaseDriver | | FibreChannelDriver |         +---------+-----+ +----+-------------+ +----+-----------+----+                   | | | |                   | | |__________ |                   | | | |               +---+--------------------+ +---+--------------------+               | Huawei18000ISCSIDriver | | Huawei18000FCDriver |               +-------------+----------+ +-------------+----------+  
__label__objective Refactor Huawei Volume driver  This blueprint is an attempt to refactor the Huawei volume driver in liberty. We will add a base dirver to implement the basic functions that the Cinder driver required. The sub-class will inherit the base driver according to different storages. the following diragram shows the structure of the newest Huawei volume driver          +---------------+ +------------------+ +--------------------+         | ISCSIDriver | | HuaweiBaseDriver | | FibreChannelDriver |         +---------+-----+ +----+-------------+ +----+-----------+----+                   | | | |                   | | |__________ |                   | | | |               +---+--------------------+ +---+--------------------+               | Huawei18000ISCSIDriver | | Huawei18000FCDriver |               +-------------+----------+ +-------------+----------+  
__label__quality Refactor Huawei Volume driver  This blueprint is an attempt to refactor the Huawei volume driver in liberty. We will add a base dirver to implement the basic functions that the Cinder driver required. The sub-class will inherit the base driver according to different storages. the following diragram shows the structure of the newest Huawei volume driver          +---------------+ +------------------+ +--------------------+         | ISCSIDriver | | HuaweiBaseDriver | | FibreChannelDriver |         +---------+-----+ +----+-------------+ +----+-----------+----+                   | | | |                   | | |__________ |                   | | | |               +---+--------------------+ +---+--------------------+               | Huawei18000ISCSIDriver | | Huawei18000FCDriver |               +-------------+----------+ +-------------+----------+  
__label__refactoring Refactor Huawei Volume driver  This blueprint is an attempt to refactor the Huawei volume driver in liberty. We will add a base dirver to implement the basic functions that the Cinder driver required. The sub-class will inherit the base driver according to different storages. the following diragram shows the structure of the newest Huawei volume driver          +---------------+ +------------------+ +--------------------+         | ISCSIDriver | | HuaweiBaseDriver | | FibreChannelDriver |         +---------+-----+ +----+-------------+ +----+-----------+----+                   | | | |                   | | |__________ |                   | | | |               +---+--------------------+ +---+--------------------+               | Huawei18000ISCSIDriver | | Huawei18000FCDriver |               +-------------+----------+ +-------------+----------+  
__label__refactoring Refactor and decompose db_base_plugin_v2.py  - Rebased to the master branch to get the latest fix on tox.ini   This resolves "ConfigError: substitution key 'envbindir' not found" error   when running functional testing. - Added infoblox and openstack license info in the comment section. - Changed variable names that use camel cases to use low cases with   underscores in BaseRequestFactory.  
__label__refactoring Refactor and decompose db_base_plugin_v2.py  - Rebased to the master branch to get the latest fix on tox.ini   This resolves "ConfigError: substitution key 'envbindir' not found" error   when running functional testing. - Added infoblox and openstack license info in the comment section. - Changed variable names that use camel cases to use low cases with   underscores in BaseRequestFactory.  
__label__objective wsgi/apache: refactore to use openstacklib  Refactorize some code to use openstacklib::wsgi::apache function to configure Keystone as a WSGI process with Apache2.  
__label__quality Cleanup/refactor neutron/agent/linux/iptables_firewall.py  - Split long functions into smaller ones. - Normalized ipset/normal security group rules generation. - Added log error on a not-to-happen condition.  
__label__refactoring Cleanup/refactor neutron/agent/linux/iptables_firewall.py  - Split long functions into smaller ones. - Normalized ipset/normal security group rules generation. - Added log error on a not-to-happen condition.  
__label__quality refactoring functional tests  This is a break up of the long tests.py file into smaller files. This is an attempt to improve maintainability of the functional tests, by breaking them up into functional areas.  This first commit pulled tests of slo, dlo and tempurl middleware and put them in their own files.  
__label__testing refactoring functional tests  This is a break up of the long tests.py file into smaller files. This is an attempt to improve maintainability of the functional tests, by breaking them up into functional areas.  This first commit pulled tests of slo, dlo and tempurl middleware and put them in their own files.  
__label__testing Refactor common code for test_server_cfn_init  In a subsequent patch we will introduce tests to work with os-collect-config that make use of these common functions.  
__label__quality Refactor common code for test_server_cfn_init  In a subsequent patch we will introduce tests to work with os-collect-config that make use of these common functions.  
__label__quality Refactor some common code in _get_schema  This patch does not make any functional change. It merely removes some code that could be shared between VDICT and LIST in _get_schema.  
__label__quality Refactor DB model access functions  The _get_collection and _get_collection_query functions are a bit messy, naming conventions and extensibility wise. This patch refactors these function in the purpose of reducing code-duplications and improving extensibility using a pre-filter function that allows custom filtering, which is currently not supported by the framework. Also, a missing unregister_model_query_hook is added.  1. Naming conventions: There is a mixup in the code as to what a                        collection is and what a query is. A query                        is a proper SQL query (model.query().select()),                        and a collection is the actual result of the                        given query (my_query.all()) 2. Custom filtering: When retrieving all resources of a model (for                      example, all ports), one can filter by a certain                      column (for example, by a specific port name).                      This is complicated when trying to filter using                      a relationship field (for example, foreign key).                      This patchset adds a pre-filter callback                      which allows custom filtering of fields. 3. Code duplication: The get_ports function is basically a duplication                      of '_get_collection', with a specific filtering                      inserted prior the normal filtering. The                      pre-filter callback feature eliminates the need                      for such code duplication, by using a                      straight-forward implementation.  
__label__refactoring Refactor DB model access functions  The _get_collection and _get_collection_query functions are a bit messy, naming conventions and extensibility wise. This patch refactors these function in the purpose of reducing code-duplications and improving extensibility using a pre-filter function that allows custom filtering, which is currently not supported by the framework. Also, a missing unregister_model_query_hook is added.  1. Naming conventions: There is a mixup in the code as to what a                        collection is and what a query is. A query                        is a proper SQL query (model.query().select()),                        and a collection is the actual result of the                        given query (my_query.all()) 2. Custom filtering: When retrieving all resources of a model (for                      example, all ports), one can filter by a certain                      column (for example, by a specific port name).                      This is complicated when trying to filter using                      a relationship field (for example, foreign key).                      This patchset adds a pre-filter callback                      which allows custom filtering of fields. 3. Code duplication: The get_ports function is basically a duplication                      of '_get_collection', with a specific filtering                      inserted prior the normal filtering. The                      pre-filter callback feature eliminates the need                      for such code duplication, by using a                      straight-forward implementation.  
__label__objective Refactor DB model access functions  The _get_collection and _get_collection_query functions are a bit messy, naming conventions and extensibility wise. This patch refactors these function in the purpose of reducing code-duplications and improving extensibility using a pre-filter function that allows custom filtering, which is currently not supported by the framework. Also, a missing unregister_model_query_hook is added.  1. Naming conventions: There is a mixup in the code as to what a                        collection is and what a query is. A query                        is a proper SQL query (model.query().select()),                        and a collection is the actual result of the                        given query (my_query.all()) 2. Custom filtering: When retrieving all resources of a model (for                      example, all ports), one can filter by a certain                      column (for example, by a specific port name).                      This is complicated when trying to filter using                      a relationship field (for example, foreign key).                      This patchset adds a pre-filter callback                      which allows custom filtering of fields. 3. Code duplication: The get_ports function is basically a duplication                      of '_get_collection', with a specific filtering                      inserted prior the normal filtering. The                      pre-filter callback feature eliminates the need                      for such code duplication, by using a                      straight-forward implementation.  
__label__quality Refactor DB model access functions  The _get_collection and _get_collection_query functions are a bit messy, naming conventions and extensibility wise. This patch refactors these function in the purpose of reducing code-duplications and improving extensibility.  
__label__refactoring Refactor DB model access functions  The _get_collection and _get_collection_query functions are a bit messy, naming conventions and extensibility wise. This patch refactors these function in the purpose of reducing code-duplications and improving extensibility.  
__label__integration Refactor DB model access functions  The _get_collection and _get_collection_query functions are a bit messy, naming conventions and extensibility wise. This patch refactors these function in the purpose of reducing code-duplications and improving extensibility.  
__label__quality Refactor clonemapper internal structure  The structure returned by the clonemapper was a simple dict of project -> destination.  Make the value a dict and insert the destination under the 'dest' key.  This will let us enhance the clonemapper to support more functionalities such as per project branch override.  An entry such as:   {'project': '/tmp/workspace/foo'}  Becomes:   {'project': {      'dest': '/tmp/workspace/foo'    }  }  
__label__objective Refactor ssh actions used for node erasing  Patch fixes few issues with erasing drives while stopping deployment during provisioning, e.g.:  * executing dd with non-existing under    debootstrap shell option 'flag';  * broken check of block device major code;  * incorrect order of arguments, which are passed    to erase_data function; Also it implements more robust mechanizm to detect provisining or provisined node.  
__label__quality Refactor ssh actions used for node erasing  Patch fixes few issues with erasing drives while stopping deployment during provisioning, e.g.:  * executing dd with non-existing under    debootstrap shell option 'flag';  * broken check of block device major code;  * incorrect order of arguments, which are passed    to erase_data function; Also it implements more robust mechanizm to detect provisining or provisined node.  
__label__quality This is part of the refactoring to fix the inheritance hierarchy of AutoScaleResourceGroup.  In this case, attempting to move some common functionality out of the inheritance hierarchy entirely (perhaps to the heat/scaling module).  Calculating the new capacity, taking min/max constraints into account, seems like some common functionality to any type of scaling.  Also, bounds checking was previously done in both handle_update and in adjust, and it seems like it could be done in just one place.  
__label__refactoring Refactor some code for backend abstraction  The function get_cfg_file, when using a db, will actually return a table. So rename it to something backend-agnostic  
__label__quality Refactor some code for backend abstraction  The function get_cfg_file, when using a db, will actually return a table. So rename it to something backend-agnostic  
__label__quality Refactor mysqla and redis apps  Reasons:  - each time mysql and redis manager and    backup/restore strategies instantiate    mysql/redis app object. This is not    correct since mysql app doesn't change    while guest is working.  Changes:  - app refactoring;  - tests refactoring;  
__label__testing Refactor mysqla and redis apps  Reasons:  - each time mysql and redis manager and    backup/restore strategies instantiate    mysql/redis app object. This is not    correct since mysql app doesn't change    while guest is working.  Changes:  - app refactoring;  - tests refactoring;  
__label__quality Refactor: move federation functions to federation utils  Some of the functions created in keystone.auth.plugins.saml2 can be re-used for other federation protocols that are supported in the future. Propose moving them to keystone.contrib.federation.utils.  
__label__objective Refactor: move federation functions to federation utils  Some of the functions created in keystone.auth.plugins.saml2 can be re-used for other federation protocols that are supported in the future. Propose moving them to keystone.contrib.federation.utils.  
__label__quality Refactor proxy/controllers obj & base http code  This is one of a set of patches implementing a container-forwarding feature. (see https://blueprints.launchpad.net/swift/+spec/cluster-federation)  Refactoring enables reuse of the http code in GETorHEAD_base and object PUT. Container_forwarding middleware needs to send requests to another proxy instead of the usual backend servers: refactored code enables to avoid code duplication and guarantees that middleware manages connections (closing down, etc.) as the proxy does.  Main changes: - server.py: shows how proxy-server calls back container_forwarding middleware, if present, to give it a handle on the newly created Controller object - base.py: refactoring of GETorHEAD_base without any mods - obj.py: PUT split into two extra methods and _connect_put_node modified to return a handle on connection object in all cases so that response with status > 400 can be returned to the client from the target proxy in newly created PUT_send - buffered_http: only add device/partition to the path if they are set. container_forwarding needs to forward the request to target proxy with the same path_info it received.  Additional code: - fake middleware: introduces method forward_request() that is used by the real container_forwarding middleware. This method uses a new locally defined ring with only one node (the target proxy) and no replication. It also illustrates how the middleware calls the refactored methods on the controller object using that ring. This middleware is for helping the review process only and will not be part of the final patch. Its basic functionality is to forward all requests to a configured target cluster. - functional test: simple tests for the fake middleware, testing basic operations such as create/delete containers/object.  
__label__objective Refactor proxy/controllers obj & base http code  This is one of a set of patches implementing a container-forwarding feature. (see https://blueprints.launchpad.net/swift/+spec/cluster-federation)  Refactoring enables reuse of the http code in GETorHEAD_base and object PUT. Container_forwarding middleware needs to send requests to another proxy instead of the usual backend servers: refactored code enables to avoid code duplication and guarantees that middleware manages connections (closing down, etc.) as the proxy does.  Main changes: - server.py: shows how proxy-server calls back container_forwarding middleware, if present, to give it a handle on the newly created Controller object - base.py: refactoring of GETorHEAD_base without any mods - obj.py: PUT split into two extra methods and _connect_put_node modified to return a handle on connection object in all cases so that response with status > 400 can be returned to the client from the target proxy in newly created PUT_send - buffered_http: only add device/partition to the path if they are set. container_forwarding needs to forward the request to target proxy with the same path_info it received.  Additional code: - fake middleware: introduces method forward_request() that is used by the real container_forwarding middleware. This method uses a new locally defined ring with only one node (the target proxy) and no replication. It also illustrates how the middleware calls the refactored methods on the controller object using that ring. This middleware is for helping the review process only and will not be part of the final patch. Its basic functionality is to forward all requests to a configured target cluster. - functional test: simple tests for the fake middleware, testing basic operations such as create/delete containers/object.  
__label__quality Refactor trusts format expires_at  Formatting a trusts expires_at was done in two distinct places, to achieve the same result. Give format_expires_at it's own function, and let other functions call it, as necessary.  
__label__refactoring Refactor trusts format expires_at  Formatting a trusts expires_at was done in two distinct places, to achieve the same result. Give format_expires_at it's own function, and let other functions call it, as necessary.  
__label__testing Tests refactoring for ci  Function setUpPackage() from tests/__init__.py was modified: ostf-server setup was added as child process via subprocess.Process() construction so that now both unit and functional tests can be run without any pre setup of fake ostf-server nor nailgunmimic because these actions are managed now by nose.  
__label__quality Refactoring of Quota system, Added guard objects functionality  Current quota implementation is quite complicated and error prone. We should try to make quota usage more transparent to make it simpler By using object guard we can simplify error handling in quota API.  This change is the first example of how guard objects can be used. Later same approach can be used to refactor most of the quota usages  
__label__quality Refactoring powervm blockdev for configdrive usage  Refactored blockdev module to reuse copy_image_file functionality regardless of implementation being Local Adapter now or something else in the future. Moving copy_image_file and its dependencies to base class.  Also renamed local md5sum functions to match name of remote md5sum function.  Implements bp powervm-configdrive  
__label__objective Refactoring powervm blockdev for configdrive usage  Refactored blockdev module to reuse copy_image_file functionality regardless of implementation being Local Adapter now or something else in the future. Moving copy_image_file and its dependencies to base class.  Also renamed local md5sum functions to match name of remote md5sum function.  Implements bp powervm-configdrive  
__label__refactoring Refactoring powervm blockdev for configdrive usage  Refactored blockdev module to reuse copy_image_file functionality regardless of implementation being Local Adapter now or something else in the future. Moving copy_image_file and its dependencies to base class.  Also renamed local md5sum functions to match name of remote md5sum function.  Implements bp powervm-configdrive  
__label__objective Refactor and extends the functionality of the TempestConfig  This patch refactor config.py to remove duplicate functionality. Also, it adds argument passing into the TempestConfig to allow future changes to the config using CLI arguments.  
__label__quality Refactor and extends the functionality of the TempestConfig  This patch refactor config.py to remove duplicate functionality. Also, it adds argument passing into the TempestConfig to allow future changes to the config using CLI arguments.  
__label__quality WIP Refactor ownership check during delete  This change refactors how the project_id and user_id are chosen during a delete operation.  The two checks are refactored into two new helper functions and duplicate code is replaced with said helpers.  Note: this has been future-proofed by using the openstack-common names 'tenant' and 'user' instead of the nova 'project_id' and 'user_id'. I'd like to hear what others think about this.  
__label__testing WIP Refactor ownership check during delete  This change refactors how the project_id and user_id are chosen during a delete operation.  The two checks are refactored into two new helper functions and duplicate code is replaced with said helpers.  Note: this has been future-proofed by using the openstack-common names 'tenant' and 'user' instead of the nova 'project_id' and 'user_id'. I'd like to hear what others think about this.  
__label__quality Refactor Huawei iscsi driver to better use SSHPool  In previous code, Huawei iscsi driver does a lot of tricks on code to support auto-switching controller when failed. For example, they changed the server_ip of a SSHPool during runtime; They use SSHPool.get() instead of SSHPool.item(), which is not suggest to use after Python 2.5  In this patch, I refactor the code in a cleaner way, including:     1. Allocating two seperate pools , one for each controller         During failure, we just need to switch the pool we use, no need         to lock the pool and changing the ip of a existing pool      2. Use SSHPool.item() instead of SSHPool.get()         Per suggested by Eventlet, refer to         https://github.com/eventlet/eventlet/blob/master/eventlet/pools.py#L64      3. Cleanup the SSHConn.create()         Since we don't need to manually close a client, it's OK for us to         use the infinite socket timeout, so just use the create() method         in SSHPool      4. Cleanup unused function in utils.py          SSHPool.remove() is created and used only by Huawei driver, it's         bugly(fixed in grizzly but not in master), since we don't need it,         just remove it.          utils.create_channel is also created and only used by this driver,         it could be replace by client.invoke_shell(width=XX, height=XX)  
__label__objective Refactor Huawei iscsi driver to better use SSHPool  In previous code, Huawei iscsi driver does a lot of tricks on code to support auto-switching controller when failed. For example, they changed the server_ip of a SSHPool during runtime; They use SSHPool.get() instead of SSHPool.item(), which is not suggest to use after Python 2.5  In this patch, I refactor the code in a cleaner way, including:     1. Allocating two seperate pools , one for each controller         During failure, we just need to switch the pool we use, no need         to lock the pool and changing the ip of a existing pool      2. Use SSHPool.item() instead of SSHPool.get()         Per suggested by Eventlet, refer to         https://github.com/eventlet/eventlet/blob/master/eventlet/pools.py#L64      3. Cleanup the SSHConn.create()         Since we don't need to manually close a client, it's OK for us to         use the infinite socket timeout, so just use the create() method         in SSHPool      4. Cleanup unused function in utils.py          SSHPool.remove() is created and used only by Huawei driver, it's         bugly(fixed in grizzly but not in master), since we don't need it,         just remove it.          utils.create_channel is also created and only used by this driver,         it could be replace by client.invoke_shell(width=XX, height=XX)  
__label__quality Refactoring database backend checks  Generalized and combined individual database checks for mysql and postgres into one _have_database function and passing backend.  
__label__refactoring Refactor chef's add run_list function  
__label__objective Refactor lvm image creation  When creating an lvm image we were checking to see if there was enough free space in the volume group in order to create an iamge. However we were not checking to see if volume group was large enough to contain an image as well.  Adds a new function called volume_group_size which checks the volume_group size.  Also raises an error if lvm image creation fails.  
__label__quality Refactor sql options avoid using CONF  Pass a conf instance to many of the sql functions so that CONF can be completely removed in subsequent commits.  Move the option definitions into a sql.opts module since both sql.core and sql.migration rely on the same options. In theory, this could make it easier for someone to copy and re-use either of those modules individually.  Also remove sql.min_pool_size, sql.max_pool_size and sql.pool_timeout since they are unused.  
__label__objective Refactor sql options avoid using CONF  Pass a conf instance to many of the sql functions so that CONF can be completely removed in subsequent commits.  Move the option definitions into a sql.opts module since both sql.core and sql.migration rely on the same options. In theory, this could make it easier for someone to copy and re-use either of those modules individually.  Also remove sql.min_pool_size, sql.max_pool_size and sql.pool_timeout since they are unused.  
__label__quality Refactor policy rules driver to avoid global CONF  Move the options related to this driver into the driver class and only use them within the class.  Add a new class to encapsulate the logic of the policy cache and use helper methods to interact with the global instance of that cache.  This refactoring has a nice side-effect of cleaning up the unit tests fairly significantly. No need for teardown methods to reset state and more easily disable loading the policy file by stubbing out the load_policy function.  
__label__refactoring Refactor policy rules driver to avoid global CONF  Move the options related to this driver into the driver class and only use them within the class.  Add a new class to encapsulate the logic of the policy cache and use helper methods to interact with the global instance of that cache.  This refactoring has a nice side-effect of cleaning up the unit tests fairly significantly. No need for teardown methods to reset state and more easily disable loading the policy file by stubbing out the load_policy function.  
__label__quality Refactor non-global config (in one giant patch)  Remove cfg wrappers from keystone.config      The idea with the cfg module is that we can have all projects using not     only the same code for config, but using similar idioms that will be     familiar to anyone working on OpenStack.      The register_*() wrappers don't add much in the way of convenience, but     if we really want them, we can add them to cfg itself.      Subsequent commits in this series remove the global CONF object and     move option definitions closer to where the option is used. The end     result is worth considering as well as this initial baby step.  Refactor password utils into separate module      The code is so self-contained, it seems a shame to have it lumped into     a generic utils module.      We make hash_password() use a supplied conf instance rather than CONF     to help us remove CONF completely in subsequent commits where the conf     instance will be an attribute of the identity drivers.      A default value for crypt_strength is also added to keystone.conf.  Refactor sql options avoid using CONF      Pass a conf instance to many of the sql functions so that CONF can     be completely removed in subsequent commits.      Move the option definitions into a sql.opts module since both sql.core     and sql.migration rely on the same options. In theory, this could make     it easier for someone to copy and re-use either of those modules     individually.      Also remove sql.min_pool_size, sql.max_pool_size and sql.pool_timeout     since they are unused.  memcache token backend refactoring      A trivial refactoring to isolate the memcache.servers option in the     memcache.Token class.      In a subsequent commit, the conf instance will be an attribute of     token.Driver and the lameness of using using config.CONF will be     removed.      Also add a default value for it in keystone.conf.  Refactor ldap identity backend options      Move the options definitions closer to where they are used, add default     values to the option definitions and rely on them, reconcile defaults     in the code with defaults in the config file.  Re-factor how service driver options are handled      Define the {catalog,ec2,identity,policy,token}.driver options in     the manager class which use them. The base manager class registers     them.      Also supply a conf instance to the constructor of each of these     manager classes so that the global CONF variable can be removed in     a subsequent commit.  Refactor admin_token handling      Move the admin_token option definition to the AdminTokenAuthMiddleware     class where it is used.      Also, explicitly set the admin_token value in the tests to make things     more clear.  Refactor port options      The admin_port and public_port options are only used in the tests and     in keystone-all. Move their definitions to the wsgi module and add     a helper method for registering them.      The compute port option is only used in the templated catalog backend,     so move its definition there.  Refactor policy rules driver to avoid global CONF      Move the options related to this driver into the driver class and only     use them within the class.      Add a new class to encapsulate the logic of the policy cache and use     helper methods to interact with the global instance of that cache.      This refactoring has a nice side-effect of cleaning up the unit tests     fairly significantly. No need for teardown methods to reset state and     more easily disable loading the policy file by stubbing out the     load_policy function.  Remove use of global CONF in service drivers      Make each of the service drivers take a conf instance paramater to its     constructor and use that instead of CONF.      The use of super(..., self).__init__() is avoided because of the mess     it causes with multiple inheritance in e.g. kvs.Identity where you     want identity.Driver to be supplied a conf instance from the preceeding     constructor in the MRO (i.e. kvs.Base).  Pass conf instance to sql.Base constructor      Removes use of CONF from common.sql completely.  Pass conf instance to WSGI app constructors      So that we can remove all CONF references from our WSGI apps, pass a     conf instance to their constructors. We need to make sure that e.g.     add_routes() is only called on a router app after its base class     constructor has been called and its conf attribute set.  Eliminate a bunch of CONF usage in cli and tests      This is a fairly random collection of changes, but it weanes the code     off CONF usage some more.  Add generic PasteDeploy factories from glance      PasteDeploy has no way of passing parameters to an app or filter     factory constructor except through options in the config file.      We want to pass a conf instance to these constructors, so we do a     lame trick where we stuff a conf instance into a global variable     before the factory is run and have the factory pass it on to the     constructor. Rather than duplicate the lame hack in a bunch of     places we have a single generic set of factories and do it there.      This code is copied straight from glance. It should eventually live     in openstack-common.  Remove last few uses of CONF      Only a few refernences to CONF exist at this point in the cli code     and tests.      Also, the need for ConfigMixin is pretty much eliminated at this     point since we can just pass the default config files list to the     ConfigOpts constructor.  
__label__testing Refactor non-global config (in one giant patch)  Remove cfg wrappers from keystone.config      The idea with the cfg module is that we can have all projects using not     only the same code for config, but using similar idioms that will be     familiar to anyone working on OpenStack.      The register_*() wrappers don't add much in the way of convenience, but     if we really want them, we can add them to cfg itself.      Subsequent commits in this series remove the global CONF object and     move option definitions closer to where the option is used. The end     result is worth considering as well as this initial baby step.  Refactor password utils into separate module      The code is so self-contained, it seems a shame to have it lumped into     a generic utils module.      We make hash_password() use a supplied conf instance rather than CONF     to help us remove CONF completely in subsequent commits where the conf     instance will be an attribute of the identity drivers.      A default value for crypt_strength is also added to keystone.conf.  Refactor sql options avoid using CONF      Pass a conf instance to many of the sql functions so that CONF can     be completely removed in subsequent commits.      Move the option definitions into a sql.opts module since both sql.core     and sql.migration rely on the same options. In theory, this could make     it easier for someone to copy and re-use either of those modules     individually.      Also remove sql.min_pool_size, sql.max_pool_size and sql.pool_timeout     since they are unused.  memcache token backend refactoring      A trivial refactoring to isolate the memcache.servers option in the     memcache.Token class.      In a subsequent commit, the conf instance will be an attribute of     token.Driver and the lameness of using using config.CONF will be     removed.      Also add a default value for it in keystone.conf.  Refactor ldap identity backend options      Move the options definitions closer to where they are used, add default     values to the option definitions and rely on them, reconcile defaults     in the code with defaults in the config file.  Re-factor how service driver options are handled      Define the {catalog,ec2,identity,policy,token}.driver options in     the manager class which use them. The base manager class registers     them.      Also supply a conf instance to the constructor of each of these     manager classes so that the global CONF variable can be removed in     a subsequent commit.  Refactor admin_token handling      Move the admin_token option definition to the AdminTokenAuthMiddleware     class where it is used.      Also, explicitly set the admin_token value in the tests to make things     more clear.  Refactor port options      The admin_port and public_port options are only used in the tests and     in keystone-all. Move their definitions to the wsgi module and add     a helper method for registering them.      The compute port option is only used in the templated catalog backend,     so move its definition there.  Refactor policy rules driver to avoid global CONF      Move the options related to this driver into the driver class and only     use them within the class.      Add a new class to encapsulate the logic of the policy cache and use     helper methods to interact with the global instance of that cache.      This refactoring has a nice side-effect of cleaning up the unit tests     fairly significantly. No need for teardown methods to reset state and     more easily disable loading the policy file by stubbing out the     load_policy function.  Remove use of global CONF in service drivers      Make each of the service drivers take a conf instance paramater to its     constructor and use that instead of CONF.      The use of super(..., self).__init__() is avoided because of the mess     it causes with multiple inheritance in e.g. kvs.Identity where you     want identity.Driver to be supplied a conf instance from the preceeding     constructor in the MRO (i.e. kvs.Base).  Pass conf instance to sql.Base constructor      Removes use of CONF from common.sql completely.  Pass conf instance to WSGI app constructors      So that we can remove all CONF references from our WSGI apps, pass a     conf instance to their constructors. We need to make sure that e.g.     add_routes() is only called on a router app after its base class     constructor has been called and its conf attribute set.  Eliminate a bunch of CONF usage in cli and tests      This is a fairly random collection of changes, but it weanes the code     off CONF usage some more.  Add generic PasteDeploy factories from glance      PasteDeploy has no way of passing parameters to an app or filter     factory constructor except through options in the config file.      We want to pass a conf instance to these constructors, so we do a     lame trick where we stuff a conf instance into a global variable     before the factory is run and have the factory pass it on to the     constructor. Rather than duplicate the lame hack in a bunch of     places we have a single generic set of factories and do it there.      This code is copied straight from glance. It should eventually live     in openstack-common.  Remove last few uses of CONF      Only a few refernences to CONF exist at this point in the cli code     and tests.      Also, the need for ConfigMixin is pretty much eliminated at this     point since we can just pass the default config files list to the     ConfigOpts constructor.  
__label__objective Refactor non-global config (in one giant patch)  Remove cfg wrappers from keystone.config      The idea with the cfg module is that we can have all projects using not     only the same code for config, but using similar idioms that will be     familiar to anyone working on OpenStack.      The register_*() wrappers don't add much in the way of convenience, but     if we really want them, we can add them to cfg itself.      Subsequent commits in this series remove the global CONF object and     move option definitions closer to where the option is used. The end     result is worth considering as well as this initial baby step.  Refactor password utils into separate module      The code is so self-contained, it seems a shame to have it lumped into     a generic utils module.      We make hash_password() use a supplied conf instance rather than CONF     to help us remove CONF completely in subsequent commits where the conf     instance will be an attribute of the identity drivers.      A default value for crypt_strength is also added to keystone.conf.  Refactor sql options avoid using CONF      Pass a conf instance to many of the sql functions so that CONF can     be completely removed in subsequent commits.      Move the option definitions into a sql.opts module since both sql.core     and sql.migration rely on the same options. In theory, this could make     it easier for someone to copy and re-use either of those modules     individually.      Also remove sql.min_pool_size, sql.max_pool_size and sql.pool_timeout     since they are unused.  memcache token backend refactoring      A trivial refactoring to isolate the memcache.servers option in the     memcache.Token class.      In a subsequent commit, the conf instance will be an attribute of     token.Driver and the lameness of using using config.CONF will be     removed.      Also add a default value for it in keystone.conf.  Refactor ldap identity backend options      Move the options definitions closer to where they are used, add default     values to the option definitions and rely on them, reconcile defaults     in the code with defaults in the config file.  Re-factor how service driver options are handled      Define the {catalog,ec2,identity,policy,token}.driver options in     the manager class which use them. The base manager class registers     them.      Also supply a conf instance to the constructor of each of these     manager classes so that the global CONF variable can be removed in     a subsequent commit.  Refactor admin_token handling      Move the admin_token option definition to the AdminTokenAuthMiddleware     class where it is used.      Also, explicitly set the admin_token value in the tests to make things     more clear.  Refactor port options      The admin_port and public_port options are only used in the tests and     in keystone-all. Move their definitions to the wsgi module and add     a helper method for registering them.      The compute port option is only used in the templated catalog backend,     so move its definition there.  Refactor policy rules driver to avoid global CONF      Move the options related to this driver into the driver class and only     use them within the class.      Add a new class to encapsulate the logic of the policy cache and use     helper methods to interact with the global instance of that cache.      This refactoring has a nice side-effect of cleaning up the unit tests     fairly significantly. No need for teardown methods to reset state and     more easily disable loading the policy file by stubbing out the     load_policy function.  Remove use of global CONF in service drivers      Make each of the service drivers take a conf instance paramater to its     constructor and use that instead of CONF.      The use of super(..., self).__init__() is avoided because of the mess     it causes with multiple inheritance in e.g. kvs.Identity where you     want identity.Driver to be supplied a conf instance from the preceeding     constructor in the MRO (i.e. kvs.Base).  Pass conf instance to sql.Base constructor      Removes use of CONF from common.sql completely.  Pass conf instance to WSGI app constructors      So that we can remove all CONF references from our WSGI apps, pass a     conf instance to their constructors. We need to make sure that e.g.     add_routes() is only called on a router app after its base class     constructor has been called and its conf attribute set.  Eliminate a bunch of CONF usage in cli and tests      This is a fairly random collection of changes, but it weanes the code     off CONF usage some more.  Add generic PasteDeploy factories from glance      PasteDeploy has no way of passing parameters to an app or filter     factory constructor except through options in the config file.      We want to pass a conf instance to these constructors, so we do a     lame trick where we stuff a conf instance into a global variable     before the factory is run and have the factory pass it on to the     constructor. Rather than duplicate the lame hack in a bunch of     places we have a single generic set of factories and do it there.      This code is copied straight from glance. It should eventually live     in openstack-common.  Remove last few uses of CONF      Only a few refernences to CONF exist at this point in the cli code     and tests.      Also, the need for ConfigMixin is pretty much eliminated at this     point since we can just pass the default config files list to the     ConfigOpts constructor.  
__label__refactoring Refactor non-global config (in one giant patch)  Remove cfg wrappers from keystone.config      The idea with the cfg module is that we can have all projects using not     only the same code for config, but using similar idioms that will be     familiar to anyone working on OpenStack.      The register_*() wrappers don't add much in the way of convenience, but     if we really want them, we can add them to cfg itself.      Subsequent commits in this series remove the global CONF object and     move option definitions closer to where the option is used. The end     result is worth considering as well as this initial baby step.  Refactor password utils into separate module      The code is so self-contained, it seems a shame to have it lumped into     a generic utils module.      We make hash_password() use a supplied conf instance rather than CONF     to help us remove CONF completely in subsequent commits where the conf     instance will be an attribute of the identity drivers.      A default value for crypt_strength is also added to keystone.conf.  Refactor sql options avoid using CONF      Pass a conf instance to many of the sql functions so that CONF can     be completely removed in subsequent commits.      Move the option definitions into a sql.opts module since both sql.core     and sql.migration rely on the same options. In theory, this could make     it easier for someone to copy and re-use either of those modules     individually.      Also remove sql.min_pool_size, sql.max_pool_size and sql.pool_timeout     since they are unused.  memcache token backend refactoring      A trivial refactoring to isolate the memcache.servers option in the     memcache.Token class.      In a subsequent commit, the conf instance will be an attribute of     token.Driver and the lameness of using using config.CONF will be     removed.      Also add a default value for it in keystone.conf.  Refactor ldap identity backend options      Move the options definitions closer to where they are used, add default     values to the option definitions and rely on them, reconcile defaults     in the code with defaults in the config file.  Re-factor how service driver options are handled      Define the {catalog,ec2,identity,policy,token}.driver options in     the manager class which use them. The base manager class registers     them.      Also supply a conf instance to the constructor of each of these     manager classes so that the global CONF variable can be removed in     a subsequent commit.  Refactor admin_token handling      Move the admin_token option definition to the AdminTokenAuthMiddleware     class where it is used.      Also, explicitly set the admin_token value in the tests to make things     more clear.  Refactor port options      The admin_port and public_port options are only used in the tests and     in keystone-all. Move their definitions to the wsgi module and add     a helper method for registering them.      The compute port option is only used in the templated catalog backend,     so move its definition there.  Refactor policy rules driver to avoid global CONF      Move the options related to this driver into the driver class and only     use them within the class.      Add a new class to encapsulate the logic of the policy cache and use     helper methods to interact with the global instance of that cache.      This refactoring has a nice side-effect of cleaning up the unit tests     fairly significantly. No need for teardown methods to reset state and     more easily disable loading the policy file by stubbing out the     load_policy function.  Remove use of global CONF in service drivers      Make each of the service drivers take a conf instance paramater to its     constructor and use that instead of CONF.      The use of super(..., self).__init__() is avoided because of the mess     it causes with multiple inheritance in e.g. kvs.Identity where you     want identity.Driver to be supplied a conf instance from the preceeding     constructor in the MRO (i.e. kvs.Base).  Pass conf instance to sql.Base constructor      Removes use of CONF from common.sql completely.  Pass conf instance to WSGI app constructors      So that we can remove all CONF references from our WSGI apps, pass a     conf instance to their constructors. We need to make sure that e.g.     add_routes() is only called on a router app after its base class     constructor has been called and its conf attribute set.  Eliminate a bunch of CONF usage in cli and tests      This is a fairly random collection of changes, but it weanes the code     off CONF usage some more.  Add generic PasteDeploy factories from glance      PasteDeploy has no way of passing parameters to an app or filter     factory constructor except through options in the config file.      We want to pass a conf instance to these constructors, so we do a     lame trick where we stuff a conf instance into a global variable     before the factory is run and have the factory pass it on to the     constructor. Rather than duplicate the lame hack in a bunch of     places we have a single generic set of factories and do it there.      This code is copied straight from glance. It should eventually live     in openstack-common.  Remove last few uses of CONF      Only a few refernences to CONF exist at this point in the cli code     and tests.      Also, the need for ConfigMixin is pretty much eliminated at this     point since we can just pass the default config files list to the     ConfigOpts constructor.  
__label__quality [WIP][RFC] Refactor the join list snippet  There seems to be desire to add variance to the list join function. Instead of creating new ones with minor variance, this patchset provides a generalize version. Existing methods should rely on this new generic function and marked deprecated. Existing functions are left to avoid breaking existing usage.  
__label__quality Fix/Refactor osh-infra-netpol gate  This change gets the osh-infra-network-policy gate working as well as refactors it to use the feature-gates functionality that is part of other existing openstack-helm jobs in zuul.  
__label__objective Fix/Refactor osh-infra-netpol gate  This change gets the osh-infra-network-policy gate working as well as refactors it to use the feature-gates functionality that is part of other existing openstack-helm jobs in zuul.  
__label__refactoring Refactor reboot_host function  
__label__objective Refactor hosts task  Add a function to filter out duplicate deleted hosts  
__label__quality Refactor hosts task  Add a function to filter out duplicate deleted hosts  
__label__objective Add chrony time sync, small refactor  Switch the time sync to preferring chrony if the client is installed. While we are here, refactor this slightly into the setup function (rather than the timer start function) as it seems more like a "setupy" thing to be doing.  See also I5e524588417c37691b9c1f6a2d3dccdb1f2340c8 for chrony install on system-config  
__label__refactoring Refactor to extract Placement helper functions for functional tests.  
__label__quality Refactoring for future work, moving storage code out of class  This is common code that will be used for subunit upload code also. Making it a function rather than a class method since it does not depend on the internal state of the handler class itself and can be abstracted out.  
__label__quality [WIP]Refactor docker cmd unit-tests  This patch propose to remove dependency around paunch in unit tests. Also refactor unit-tests and focus on function itself.  
__label__testing [WIP]Refactor docker cmd unit-tests  This patch propose to remove dependency around paunch in unit tests. Also refactor unit-tests and focus on function itself.  
__label__testing Refactor create_delete_server_with_instance_update  This patch refactor the create_delete_server_with_instance_update functional test.  
__label__objective Refactor meta patch for sudo package  remove 0002-spec-include-TiS-changes.patch change setting of ldap.conf to runtime via sudo.conf schema.OpenLDAP and sudoers2ldif move to sudo-config  Test: 1, Build pass and deploy multi-node, check sudo.schema and sudoers2ldif same as before 2, build-pkg --edit sudo, add stub in function sudoers_policy_deserialize_info in plugins/sudoers/policy.c to check variable path_ldap_conf, value is same as setting with configure option --with-ldap-conf-file="%{_sysconfdir}/openldap/ldap.conf"  Story: 2004212 Task: 27726  
__label__refactoring Refactor meta patch for sudo package  remove 0002-spec-include-TiS-changes.patch change setting of ldap.conf to runtime via sudo.conf schema.OpenLDAP and sudoers2ldif move to sudo-config  Test: 1, Build pass and deploy multi-node, check sudo.schema and sudoers2ldif same as before 2, build-pkg --edit sudo, add stub in function sudoers_policy_deserialize_info in plugins/sudoers/policy.c to check variable path_ldap_conf, value is same as setting with configure option --with-ldap-conf-file="%{_sysconfdir}/openldap/ldap.conf"  Story: 2004212 Task: 27726  
__label__testing WIP: Refactor functional tests  
__label__refactoring WIP: Refactor functional tests  
__label__quality Refactor "unit" to "remote_service" param  When handling ssh keys and known hosts for the relation(s) to the nova-compute units, the unit is passed to many of the utility functions. The purpose of the unit param is to derive a consistent remote_service string with which to create a pair of associated known_hosts and authorized_keys files.  However, it's not obvious that this is being done, when reading the code.  This patch refactors many of those functions so that a remote_service param is passed; this has the benefit of making it clear that it's the remote_service that is being made unique (for the known_hosts and authorized keys) as well as the optional user param, but also so that the deriving of the remote_service is reduced (where possible).  
__label__objective Refactor "unit" to "remote_service" param  When handling ssh keys and known hosts for the relation(s) to the nova-compute units, the unit is passed to many of the utility functions. The purpose of the unit param is to derive a consistent remote_service string with which to create a pair of associated known_hosts and authorized_keys files.  However, it's not obvious that this is being done, when reading the code.  This patch refactors many of those functions so that a remote_service param is passed; this has the benefit of making it clear that it's the remote_service that is being made unique (for the known_hosts and authorized keys) as well as the optional user param, but also so that the deriving of the remote_service is reduced (where possible).  
__label__objective Refactor "unit" to "remote_service" param  When handling ssh keys and known hosts for the relation(s) to the nova-compute units, the unit is passed to many of the utility functions. The purpose of the unit param is to derive a consistent remote_service string with which to create a pair of associated known_hosts and authorized_keys files.  However, it's not obvious that this is being done, when reading the code.  This patch refactors many of those functions so that a remote_service param is passed; this has the benefit of making it clear that it's the remote_service that is being made unique (for the known_hosts and authorized keys) as well as the optional user param, but also so that the deriving of the remote_service is reduced (where possible).  
__label__testing WiP refactor heat integration tests infra  devstack supports a 'test-conig' setup phase where it can setup tempest and its config appropriately.  Move the code from prepare_test_env.sh and prepare_test_network.sh directly into a heat's devstack plugin function that will be called in that phase. Couple of new devstack plugin settings are introduced as a side effect.  
__label__quality WiP refactor heat integration tests infra  devstack supports a 'test-conig' setup phase where it can setup tempest and its config appropriately.  Move the code from prepare_test_env.sh and prepare_test_network.sh directly into a heat's devstack plugin function that will be called in that phase. Couple of new devstack plugin settings are introduced as a side effect.  
__label__objective WiP refactor heat integration tests infra  devstack supports a 'test-conig' setup phase where it can setup tempest and its config appropriately.  Move the code from prepare_test_env.sh and prepare_test_network.sh directly into a heat's devstack plugin function that will be called in that phase. Couple of new devstack plugin settings are introduced as a side effect.  
__label__quality Refactor qga(Qemu guest agent) support mechanism for windows  * Add looping check to ensure virtio serial device ready before starting QGA * Block unnecessary interfaces functions of QGA, only `set-user-password` left  
__label__quality Refactor post-run  This simplifies post-run plays. Deployers wanting to gather logs can also do it on their machine by simply using the shell scripts in zuul.d/playbooks.  Because post-run was defined multiple times but were inheriting from the same job (osh-infra-functional), the post-run definition was moved to the base job.  Finally the gathering of the logs is only done once, avoiding ssh issues.  The previous log gathering cannot be removed until all the other jobs using the scripts are converted.  
__label__objective Refactor post-run  This simplifies post-run plays. Deployers wanting to gather logs can also do it on their machine by simply using the shell scripts in zuul.d/playbooks.  Because post-run was defined multiple times but were inheriting from the same job (osh-infra-functional), the post-run definition was moved to the base job.  Finally the gathering of the logs is only done once, avoiding ssh issues.  The previous log gathering cannot be removed until all the other jobs using the scripts are converted.  
__label__objective Refactor post-run  This simplifies post-run plays. Deployers wanting to gather logs can also do it on their machine by simply using the shell scripts in zuul.d/playbooks.  Because post-run was defined multiple times but were inheriting from the same job (osh-infra-functional), the post-run definition was moved to the base job.  Finally the gathering of the logs is only done once, avoiding ssh issues.  The previous log gathering cannot be removed until all the other jobs using the scripts are converted.  
__label__objective Refactor test_transfer_request.py and test_snapshot.py  Volume v1 tests test_transfer_request.py and test_snapshot.py are currently unable to properly skip-check due to their use of setUpClass and tearDownClass. This causes erroneous failures when volume v1 services are not present. This refactor allows the skip-check to work and aims to maintain functionality of code previously located within setUpClass and tearDownClass when and where necessary.  
__label__quality Refactor test_transfer_request.py and test_snapshot.py  Volume v1 tests test_transfer_request.py and test_snapshot.py are currently unable to properly skip-check due to their use of setUpClass and tearDownClass. This causes erroneous failures when volume v1 services are not present. This refactor allows the skip-check to work and aims to maintain functionality of code previously located within setUpClass and tearDownClass when and where necessary.  
__label__objective Refactor test_transfer_request.py and test_snapshot.py  Volume v1 tests test_transfer_request.py and test_snapshot.py are currently unable to properly skip-check due to their use of setUpClass and tearDownClass. This causes erroneous failures when volume v1 services are not present. This refactor allows the skip-check to work and aims to maintain functionality of code previously located within setUpClass and tearDownClass when and where necessary.  
__label__testing Refactor PortResourceRequestBasedSchedulingTestBase  Make it possible to create more than on SRIOV device RP in the functional test. This capability will be used in subsequent patches.  
__label__quality Refactor PortResourceRequestBasedSchedulingTestBase  Make it possible to create more than on SRIOV device RP in the functional test. This capability will be used in subsequent patches.  
__label__objective Refactor PortResourceRequestBasedSchedulingTestBase  Make it possible to create more than on SRIOV device RP in the functional test. This capability will be used in subsequent patches.  
__label__quality Refactoring hadoop2 folder for Hadoop 2.x and Hadoop 3.x  1. "hadoop2" floder is renamed as "common", the name of "hadoop2" floder could be confusing, because it needs to invoke function in the "hadoop2" floder when deploys Hadoop 3.x.  2. Less duplication can go on for the next upgrade. Reduce the amount of code under separate folders (sahara/plugins/vanilla/<version>)  
__label__objective Refactoring hadoop2 folder for Hadoop 2.x and Hadoop 3.x  1. "hadoop2" floder is renamed as "common", the name of "hadoop2" floder could be confusing, because it needs to invoke function in the "hadoop2" floder when deploys Hadoop 3.x.  2. Less duplication can go on for the next upgrade. Reduce the amount of code under separate folders (sahara/plugins/vanilla/<version>)  
__label__objective Refactoring hadoop2 folder for Hadoop 2.x and Hadoop 3.x  1. "hadoop2" floder is renamed as "common", the name of "hadoop2" floder could be confusing, because it needs to invoke function in the "hadoop2" floder when deploys Hadoop 3.x.  2. Less duplication can go on for the next upgrade. Reduce the amount of code under separate folders (sahara/plugins/vanilla/<version>)  
__label__quality refactor: Sanitized parameters replace req.params  This patch set changes sanitized_params function in deckhand.control.common to automatically replace `req.params` with the dict of sanitized params, such that an additional parameter need not be passed into controller methods and so that native falcon helper functions like:  https://falcon.readthedocs.io/en/stable/api/request_and_response.html#falcon.Request.get_param_as_bool  can be leveraged.  
__label__objective refactor: Sanitized parameters replace req.params  This patch set changes sanitized_params function in deckhand.control.common to automatically replace `req.params` with the dict of sanitized params, such that an additional parameter need not be passed into controller methods and so that native falcon helper functions like:  https://falcon.readthedocs.io/en/stable/api/request_and_response.html#falcon.Request.get_param_as_bool  can be leveraged.  
__label__quality refactor the check_state function in orchestrator  _check_state of Orchestrator and check_state of Worker are the same. this patch refactor this for deleting the _check_state of Orchestrator and changing some logical in the code.  
__label__quality Refactor fallocate and hole punching  Instead of having one function that either allocates space or deallocates it, and uses either the fallocate() or posix_fallocate() C functions for allocation, but only uses fallocate() for deallocation, and is a no-op sometimes for allocation but never for deallocation, let's try having two functions.  utils.fallocate(fd, size) allocates <size> bytes for the file referred to by <fd>. It allows for keeping a reserve of an additional N bytes or X% of the filesystem free. If neither fallocate() or posix_fallocate() C functions are avaialble, utils.fallocate() will log a warning (once only) and not actually allocate space.  utils.punch_hole(fd, offset, length) deallocates <length> bytes starting at <offset> from the file referred to by <fd>. It uses the C function fallocate(). If fallocate() is not available, calls to utils.punch_hole() will raise an exception.  This commit also gets rid of utils.FallocateWrapper() and just has two levels: utils.fallocate / utils.punch_hole have all the fancy logic in them, and utils._sys_fallocate / utils._sys_posix_fallocate are just thin wrappers around the libc functions.  Modernized the tests for utils.fallocate() and utils.punch_hole().  
__label__refactoring Refactor fallocate and hole punching  Instead of having one function that either allocates space or deallocates it, and uses either the fallocate() or posix_fallocate() C functions for allocation, but only uses fallocate() for deallocation, and is a no-op sometimes for allocation but never for deallocation, let's try having two functions.  utils.fallocate(fd, size) allocates <size> bytes for the file referred to by <fd>. It allows for keeping a reserve of an additional N bytes or X% of the filesystem free. If neither fallocate() or posix_fallocate() C functions are avaialble, utils.fallocate() will log a warning (once only) and not actually allocate space.  utils.punch_hole(fd, offset, length) deallocates <length> bytes starting at <offset> from the file referred to by <fd>. It uses the C function fallocate(). If fallocate() is not available, calls to utils.punch_hole() will raise an exception.  This commit also gets rid of utils.FallocateWrapper() and just has two levels: utils.fallocate / utils.punch_hole have all the fancy logic in them, and utils._sys_fallocate / utils._sys_posix_fallocate are just thin wrappers around the libc functions.  Modernized the tests for utils.fallocate() and utils.punch_hole().  
__label__testing Refactor fallocate and hole punching  Instead of having one function that either allocates space or deallocates it, and uses either the fallocate() or posix_fallocate() C functions for allocation, but only uses fallocate() for deallocation, and is a no-op sometimes for allocation but never for deallocation, let's try having two functions.  utils.fallocate(fd, size) allocates <size> bytes for the file referred to by <fd>. It allows for keeping a reserve of an additional N bytes or X% of the filesystem free. If neither fallocate() or posix_fallocate() C functions are avaialble, utils.fallocate() will log a warning (once only) and not actually allocate space.  utils.punch_hole(fd, offset, length) deallocates <length> bytes starting at <offset> from the file referred to by <fd>. It uses the C function fallocate(). If fallocate() is not available, calls to utils.punch_hole() will raise an exception.  This commit also gets rid of utils.FallocateWrapper() and just has two levels: utils.fallocate / utils.punch_hole have all the fancy logic in them, and utils._sys_fallocate / utils._sys_posix_fallocate are just thin wrappers around the libc functions.  Modernized the tests for utils.fallocate() and utils.punch_hole().  
__label__objective Refactors network topology into angular elements  IMPORTANT: This is still WIP, but the general outline is there. For review/debug/testing:  - settings.ANGULAR_TOPOLOGY = True enables the feature as   a new tab in the network topology panel - settings.ANGULAR_DEBUG_MODEL = True enables a model   debugging UI instead of using live server data  NOTE: A series of debug components exist for development and are not meant for the final version of this patch.  Visualisation is divided into separate compoments:  - Network-topology serves as the central component tying   all of the functionality together - Topology-graph wraps D3 displaying code. It should   be as general (and generic) as possible for potential   reuse in different contexts - Popup-balloon contains the logic related to the popups   displayed when clicking individual nodes in the graph - button-bar and checkbox-button are utility components   used in the UI  In addition to the visualisation elements, data handling has also been refactored and moved into angular elements:  - Topology-model.service contains code which handles the   reception of data from the server, it's mapping and   comparison with cached data for full diffing support   (data is modified, deleted and created on synch).    This service is meant as the central model store   (Single source of truth). This data store should   never be modified outside of the server synching   mechanism; any components that need to modify data   should create local working copies (data immutability).  - Topology-graph.factory is the factory function that   takes the stored model data and creates a graph-like   data structure of nodes and edges which are then   used for D3 display.    These elements are bound as D3 data when displayed.   Any purely visual operations   (Network Collapsing) should be carried out   at this level, NOT at the model level.  Intended as a continuation of the work done in https://review.openstack.org/#/c/199063/  
__label__quality Refactors network topology into angular elements  IMPORTANT: This is still WIP, but the general outline is there. For review/debug/testing:  - settings.ANGULAR_TOPOLOGY = True enables the feature as   a new tab in the network topology panel - settings.ANGULAR_DEBUG_MODEL = True enables a model   debugging UI instead of using live server data  NOTE: A series of debug components exist for development and are not meant for the final version of this patch.  Visualisation is divided into separate compoments:  - Network-topology serves as the central component tying   all of the functionality together - Topology-graph wraps D3 displaying code. It should   be as general (and generic) as possible for potential   reuse in different contexts - Popup-balloon contains the logic related to the popups   displayed when clicking individual nodes in the graph - button-bar and checkbox-button are utility components   used in the UI  In addition to the visualisation elements, data handling has also been refactored and moved into angular elements:  - Topology-model.service contains code which handles the   reception of data from the server, it's mapping and   comparison with cached data for full diffing support   (data is modified, deleted and created on synch).    This service is meant as the central model store   (Single source of truth). This data store should   never be modified outside of the server synching   mechanism; any components that need to modify data   should create local working copies (data immutability).  - Topology-graph.factory is the factory function that   takes the stored model data and creates a graph-like   data structure of nodes and edges which are then   used for D3 display.    These elements are bound as D3 data when displayed.   Any purely visual operations   (Network Collapsing) should be carried out   at this level, NOT at the model level.  Intended as a continuation of the work done in https://review.openstack.org/#/c/199063/  
__label__objective Refactors network topology into angular elements  IMPORTANT: This is still WIP, but the general outline is there. For review/debug/testing:  - settings.ANGULAR_TOPOLOGY = True enables the feature as   a new tab in the network topology panel - settings.ANGULAR_DEBUG_MODEL = True enables a model   debugging UI instead of using live server data  NOTE: A series of debug components exist for development and are not meant for the final version of this patch.  Visualisation is divided into separate compoments:  - Network-topology serves as the central component tying   all of the functionality together - Topology-graph wraps D3 displaying code. It should   be as general (and generic) as possible for potential   reuse in different contexts - Popup-balloon contains the logic related to the popups   displayed when clicking individual nodes in the graph - button-bar and checkbox-button are utility components   used in the UI  In addition to the visualisation elements, data handling has also been refactored and moved into angular elements:  - Topology-model.service contains code which handles the   reception of data from the server, it's mapping and   comparison with cached data for full diffing support   (data is modified, deleted and created on synch).    This service is meant as the central model store   (Single source of truth). This data store should   never be modified outside of the server synching   mechanism; any components that need to modify data   should create local working copies (data immutability).  - Topology-graph.factory is the factory function that   takes the stored model data and creates a graph-like   data structure of nodes and edges which are then   used for D3 display.    These elements are bound as D3 data when displayed.   Any purely visual operations   (Network Collapsing) should be carried out   at this level, NOT at the model level.  Intended as a continuation of the work done in https://review.openstack.org/#/c/199063/  
__label__testing Refactor functional tests to support both Python and CLI APIs  
__label__quality Refactor list_users and related functions  list_users has some excess looping that could be consolidated to gain some performance improvements. This change consolidates a few of these excess loops for list_users as well as the utility functions.  
__label__objective Refactor security group & rule take action methods  Add get_attributes internal functions to the security groups and security groups rules create & set, to allow other plugins to override only the attributes code and add extensions attributes without having to rewrite the entire take_action method.  For example see in https://review.openstack.org/#/c/393322/ where vmware-nsx adds some extensions to the security group.  
__label__quality Refactor security group & rule take action methods  Add get_attributes internal functions to the security groups and security groups rules create & set, to allow other plugins to override only the attributes code and add extensions attributes without having to rewrite the entire take_action method.  For example see in https://review.openstack.org/#/c/393322/ where vmware-nsx adds some extensions to the security group.  
__label__objective Refactoring main function  Moving code to a new TempestConfCmd that can be called outside the main function, configure, parse args, etc.  
__label__quality RequestHandler refactor  Split out RequestHandler.__init__ into multiple functions  
__label__quality [WIP] Refactor devstack log copying  This introduces a single function to collect devstack logs.  It either runs once for the devstack case, or twice (once for "old" and once for "new") in the grenade case.  I've rolled the duplicated parts of the code, including the testr artificat stuff, into this single function.  The layout is simplified into three distinct phases  1) copy devstack files 2) copy generic system logs/status 3) cleanup & compression  I feel this makes the whole process much easier to understand (even with greatly increased comments diffstat is ~equal), reduces duplication and reduces the chance that we make mistakes when trying to introduce various log processing enhancements.  
__label__objective [WIP] Refactor status functions, add web endpoints, allow params  This patch refactors status functions so that instead of having one function per output format, the output format is simply a parameter.  New status endpoints are added:  * image-list.json * request-list(.json)  The endpoint node-list(.json) accepts a node_id parameter for filtering.  
__label__objective [WIP] Refactor status functions, add more status endpoints  This patch refactors status functions so that instead of having one function per output format, the output format is simply a parameter. New status endpoints are added: * image-list.json * node-list(.json)  
__label__quality Refactor utils/replace_osd function, add tests  Monolithic replace_osd function will only work where mon and osds coexist on the same metal.  This change breaks that function into several logically distinct functions which can be used in hooks or actions independently of each other.  
__label__quality Refactor type_vlan for QinQ compatibility  While writing the QinQ driver, the logic for syncing vlan allocations was somewhat duplicated. This refactors the function to add conditional cases for it to be compatibile for both drivers.  The QinQ driver adds another layer of keys so instead of set operations we need to use dictionary operations and also another layer of nesting is needed for for loops to act on those values.  
__label__objective Refactor type_vlan for QinQ compatibility  While writing the QinQ driver, the logic for syncing vlan allocations was somewhat duplicated. This refactors the function to add conditional cases for it to be compatibile for both drivers.  The QinQ driver adds another layer of keys so instead of set operations we need to use dictionary operations and also another layer of nesting is needed for for loops to act on those values.  
__label__objective Refactor type_vlan for QinQ compatibility  While writing the QinQ driver, the logic for syncing vlan allocations was somewhat duplicated. This refactors the function to add conditional cases for it to be compatibile for both drivers.  The QinQ driver adds another layer of keys so instead of set operations we need to use dictionary operations and also another layer of nesting is needed for for loops to act on those values.  
__label__quality Small refactor of metadata bits  This patch performs a small refactor of the metadata port creation and the code which waits for metadata service to be provisioned in the network when a port transitions to 'up'.  Also, when metadata is disabled, an error was logged trying to retrieve fetch the metadata port. Instead of checking if metadata is enabled or not in many points of the code, that function will return None if service is disabled.  
__label__objective Small refactor of metadata bits  This patch performs a small refactor of the metadata port creation and the code which waits for metadata service to be provisioned in the network when a port transitions to 'up'.  Also, when metadata is disabled, an error was logged trying to retrieve fetch the metadata port. Instead of checking if metadata is enabled or not in many points of the code, that function will return None if service is disabled.  
__label__refactoring Refactor events functions into EvenSaver class  Required to add tests.  
__label__testing Refactor events functions into EvenSaver class  Required to add tests.  
__label__refactoring WIP: Refactor Basic Launch  This PS pulls all of the helm install logic out and into their own functions that Jenkins can call and put it's own timeout on per chart.  
__label__quality Refactor waiters in our tempest plugin  Deduplicates some of the code between common.waiters module and BaremetalScenarioTest functions.  
__label__testing Refactoring test_pod_cli.py  1. What is the problem? The methods are sharing common functionality which make difficult to avoid duplication.  2. What is the solution to the problem? Refactoring these common functionality.  3. What features need to be implemented to the Tricircle to realize the solution? None  
__label__quality Refactoring test_pod_cli.py  1. What is the problem? The methods are sharing common functionality which make difficult to avoid duplication.  2. What is the solution to the problem? Refactoring these common functionality.  3. What features need to be implemented to the Tricircle to realize the solution? None  
__label__quality Refactor VIFPortIDMixin to only handle VIF ops  Refactor the VIFPortIDMixin class to only handle VIF-related operations, and extract all neutron-specific functionality into a new subclass - NeutronVIFPortIDMixin. This allows network interfaces that do not support neutron to use the VIFPortIDMixin class, which provides VIF support methods.  
__label__objective Refactor VIFPortIDMixin to only handle VIF ops  Refactor the VIFPortIDMixin class to only handle VIF-related operations, and extract all neutron-specific functionality into a new subclass - NeutronVIFPortIDMixin. This allows network interfaces that do not support neutron to use the VIFPortIDMixin class, which provides VIF support methods.  
__label__quality Refactor placement fixtures  Some useful fixtures were created for the ironic inventory changes that would be handy to be able to access in other functional tests. This patch doesn't change any logic, but simply moves the fixtures into their own file.  Blueprint: custom-resource-classes-pike  
__label__testing Refactor placement fixtures  Some useful fixtures were created for the ironic inventory changes that would be handy to be able to access in other functional tests. This patch doesn't change any logic, but simply moves the fixtures into their own file.  Blueprint: custom-resource-classes-pike  
__label__objective Refactor placement fixtures  Some useful fixtures were created for the ironic inventory changes that would be handy to be able to access in other functional tests. This patch doesn't change any logic, but simply moves the fixtures into their own file.  Blueprint: custom-resource-classes-pike  
__label__quality Refactor: Generalize parameters passed to plugins  The funtion 'create_graph()' is a generic function and does not need to know which and how many parameters are passed on to the plugin constructor.  This patch generalizes the parameter passing.  This patch is needed for upcoming patches that eliminate the globals in block device handling.  
__label__objective Refactor: Generalize parameters passed to plugins  The funtion 'create_graph()' is a generic function and does not need to know which and how many parameters are passed on to the plugin constructor.  This patch generalizes the parameter passing.  This patch is needed for upcoming patches that eliminate the globals in block device handling.  
__label__objective Refactor hosts task  Add a function to filter out duplicate deleted hosts in case the duplicate records are present in the deleted_nodes file.  
__label__quality Refactor hosts task  Add a function to filter out duplicate deleted hosts in case the duplicate records are present in the deleted_nodes file.  
__label__objective Refactor hosts task  Add a function to filter out duplicate deleted hosts in case the duplicate records are present in the deleted_nodes file.  
__label__quality Refactor hosts task  Add a function to filter out duplicate deleted hosts in case the duplicate records are present in the deleted_nodes file.  
__label__quality WIP: Refactor enroll-node code  This change allows to enroll ironic nodes from INI files. INI files allow to have subsections which are described [0].  Each section specify ironic node-name. Each section may have any number of subsections. Subsection name specifies `ironic node-create` command option, where keys and values are key,values from appropriate subsection.      [node-name]     mac_address=<>     driver=<>     [node-name\properties]     ssh_virt_type=<>     ssh_address=<>     ...     [node-name\driver-info]     local_gb=<>     ...     [node-name\subsection]     option_1=value1  The described INI file will be translated to the following cmd: `ironic node-create --driver <> --properties ssh_virt_type=<> \ --properties ssh_address=<> --driver-info local_gb=<> \ --subsection option_1=value1`  The change gives full flexibility in enrolling nodes without changing devstack code.  Backward compatibility is done via convert_csv_to_ini function.  Reference: [0] https://en.wikipedia.org/wiki/INI_file#Hierarchy  
__label__objective WIP: Refactor enroll-node code  This change allows to enroll ironic nodes from INI files. INI files allow to have subsections which are described [0].  Each section specify ironic node-name. Each section may have any number of subsections. Subsection name specifies `ironic node-create` command option, where keys and values are key,values from appropriate subsection.      [node-name]     mac_address=<>     driver=<>     [node-name\properties]     ssh_virt_type=<>     ssh_address=<>     ...     [node-name\driver-info]     local_gb=<>     ...     [node-name\subsection]     option_1=value1  The described INI file will be translated to the following cmd: `ironic node-create --driver <> --properties ssh_virt_type=<> \ --properties ssh_address=<> --driver-info local_gb=<> \ --subsection option_1=value1`  The change gives full flexibility in enrolling nodes without changing devstack code.  Backward compatibility is done via convert_csv_to_ini function.  Reference: [0] https://en.wikipedia.org/wiki/INI_file#Hierarchy  
__label__quality Refactor abstract logic+models out of OVS driver  This patch refactors all logic and models that are abstract in SFC, and not specific to the OVS driver, moving them out of the OVS driver. It also updates the OVS driver so that it only manages OVS-specific resources and not the abstract plugin resources.  This allows Service Function Path IDs and identifiers to be managed and generated in the networking-sfc plugin itself, instead of inside the OVS driver, so that any driver can reuse these SFP allocations.  [WIP] This is a work-in-progress and is missing the following at this time: - Updated tests; - A working Update Port Chain - the plugin/driver interface is not   ideal to carry out the update of an existing port chain, due to the   split into abstract plugin resources and specific [OVS] resources.   As such, more discussion with the team should be held to decide the   best way to approach this, potentially by modifying the plugin/driver   interface. - Hands-on validation of instantiating more than 1 port-chain; - Other planned code changes.  Closes-Bug: #1588460  
__label__testing Refactor abstract logic+models out of OVS driver  This patch refactors all logic and models that are abstract in SFC, and not specific to the OVS driver, moving them out of the OVS driver. It also updates the OVS driver so that it only manages OVS-specific resources and not the abstract plugin resources.  This allows Service Function Path IDs and identifiers to be managed and generated in the networking-sfc plugin itself, instead of inside the OVS driver, so that any driver can reuse these SFP allocations.  [WIP] This is a work-in-progress and is missing the following at this time: - Updated tests; - A working Update Port Chain - the plugin/driver interface is not   ideal to carry out the update of an existing port chain, due to the   split into abstract plugin resources and specific [OVS] resources.   As such, more discussion with the team should be held to decide the   best way to approach this, potentially by modifying the plugin/driver   interface. - Hands-on validation of instantiating more than 1 port-chain; - Other planned code changes.  Closes-Bug: #1588460  
__label__objective Refactor abstract logic+models out of OVS driver  This patch refactors all logic and models that are abstract in SFC, and not specific to the OVS driver, moving them out of the OVS driver. It also updates the OVS driver so that it only manages OVS-specific resources and not the abstract plugin resources.  This allows Service Function Path IDs and identifiers to be managed and generated in the networking-sfc plugin itself, instead of inside the OVS driver, so that any driver can reuse these SFP allocations.  [WIP] This is a work-in-progress and is missing the following at this time: - Updated tests; - A working Update Port Chain - the plugin/driver interface is not   ideal to carry out the update of an existing port chain, due to the   split into abstract plugin resources and specific [OVS] resources.   As such, more discussion with the team should be held to decide the   best way to approach this, potentially by modifying the plugin/driver   interface. - Hands-on validation of instantiating more than 1 port-chain; - Other planned code changes.  Closes-Bug: #1588460  
__label__refactoring Refactoring authorization.  Merge logic into check_policy, made decorator functions identical  
__label__refactoring Refactoring Authorization.  Unified decorator functions.  
__label__objective Refactor: loopdev handling / introducing element results and cleanup  Sometimes it is needed to pass the result of an element back to the main script or to other elements. The element that creates a resource should also delete, destroy, umount or detach this resource afterwards.  When a result of an element is needed, it is possible to use eval_run_d to get mostly one result in an environment variable.  There was no way, that an element script for cleanup was called when a problem occurred.  This patch introduces a way of passing results back to the main script: the element can call the function 'element_result_add' to do so.  This patch also introduces the phases "umount" and "exit". The first is called when the image should be unmounted - the later one is called if a problem occurred during the image building.  Using the one liner of creating and deleting the loop device here is to show the concept.  (This is a extraction of one refactoring needed to implement the partitioning-parted and lvm2 elements.)  
__label__quality Refactor: loopdev handling / introducing element results and cleanup  Sometimes it is needed to pass the result of an element back to the main script or to other elements. The element that creates a resource should also delete, destroy, umount or detach this resource afterwards.  When a result of an element is needed, it is possible to use eval_run_d to get mostly one result in an environment variable.  There was no way, that an element script for cleanup was called when a problem occurred.  This patch introduces a way of passing results back to the main script: the element can call the function 'element_result_add' to do so.  This patch also introduces the phases "umount" and "exit". The first is called when the image should be unmounted - the later one is called if a problem occurred during the image building.  Using the one liner of creating and deleting the loop device here is to show the concept.  (This is a extraction of one refactoring needed to implement the partitioning-parted and lvm2 elements.)  
__label__objective Refactor: loopdev handling / introducing element results and cleanup  Sometimes it is needed to pass the result of an element back to the main script or to other elements. The element that creates a resource should also delete, destroy, umount or detach this resource afterwards.  When a result of an element is needed, it is possible to use eval_run_d to get mostly one result in an environment variable.  There was no way, that an element script for cleanup was called when a problem occurred.  This patch introduces a way of passing results back to the main script: the element can call the function 'element_result_add' to do so.  This patch also introduces the phases "umount" and "exit". The first is called when the image should be unmounted - the later one is called if a problem occurred during the image building.  Using the one liner of creating and deleting the loop device here is to show the concept.  (This is a extraction of one refactoring needed to implement the partitioning-parted and lvm2 elements.)  
__label__testing Puppet4 support: refactor vips  Cherry-pick of change https://review.openstack.org/#/c/326541/  The generate_vips function is refactored to work in pair with the create_resources functions. It's much better for testing and debugging. Input data of the vurual ip definition is split into many parameters and the generate vips function is tought to support the changed interfacs as well as to work with Puppet4's undef values.  
__label__objective Puppet4 support: refactor vips  Cherry-pick of change https://review.openstack.org/#/c/326541/  The generate_vips function is refactored to work in pair with the create_resources functions. It's much better for testing and debugging. Input data of the vurual ip definition is split into many parameters and the generate vips function is tought to support the changed interfacs as well as to work with Puppet4's undef values.  
__label__testing Refactoring writing deployment info  * function write_facts_to_dir was added * function get_dir_deployment_info was added * appropriate tests were added  
__label__objective Refactoring writing deployment info  * function write_facts_to_dir was added * function get_dir_deployment_info was added * appropriate tests were added  
__label__testing Refactor TestWalkMigrations  Currently TestWalkMigrations provides bad tests isolation and do not use appropriate classes from oslo.db. Refactor it to use oslo.db functionality.  Closes-bug: #1595918  
__label__quality Refactor TestWalkMigrations  Currently TestWalkMigrations provides bad tests isolation and do not use appropriate classes from oslo.db. Refactor it to use oslo.db functionality.  Closes-bug: #1595918  
__label__quality libvirt: virtlogd: refactoring 4 before functional change  The logic to create the char devices of a guest is now extracted into single pieces with single responsibilities. The refactoring is now good enough to use the "virtlogd" feature with a following change.  blueprint libvirt-virtlogd  
__label__objective libvirt: virtlogd: refactoring 4 before functional change  The logic to create the char devices of a guest is now extracted into single pieces with single responsibilities. The refactoring is now good enough to use the "virtlogd" feature with a following change.  blueprint libvirt-virtlogd  
__label__quality libvirt: virtlogd: refactoring 3 before functional change  The logic to create the char devices for a guest has a lot of conditionals which makes it hard to understand. This change inverts some of these to reduce the nested levels of IFs. The flow is then easier to understand and the functional changes for the "virtlogd" feature in a following change will be easier to review.  blueprint libvirt-virtlogd  
__label__objective libvirt: virtlogd: refactoring 3 before functional change  The logic to create the char devices for a guest has a lot of conditionals which makes it hard to understand. This change inverts some of these to reduce the nested levels of IFs. The flow is then easier to understand and the functional changes for the "virtlogd" feature in a following change will be easier to review.  blueprint libvirt-virtlogd  
__label__quality libvirt: virtlogd: refactoring 2 before functional change  The conditional logic to create the char devices is spread over 2 methods which makes it confusing to understand under which conditions which char devices get created for the guest. As the "virtlogd" feature will append a sub element "log" to the first(!) char device in a following change, a refactoring of these conditionals will make the future change easier to understand. This change: * inlines method "_create_serial_console_devices" * changes the unit tests accordingly  This refactoring step makes it later easier to understand which functional changes get introduced and under which conditions.  blueprint libvirt-virtlogd  
__label__objective libvirt: virtlogd: refactoring 2 before functional change  The conditional logic to create the char devices is spread over 2 methods which makes it confusing to understand under which conditions which char devices get created for the guest. As the "virtlogd" feature will append a sub element "log" to the first(!) char device in a following change, a refactoring of these conditionals will make the future change easier to understand. This change: * inlines method "_create_serial_console_devices" * changes the unit tests accordingly  This refactoring step makes it later easier to understand which functional changes get introduced and under which conditions.  blueprint libvirt-virtlogd  
__label__quality libvirt: virtlogd: refactoring 1 before functional change  The methods "_create_consoles" and "_create_serial_console_devices" have many conditional cases and return or append devices. It's confusing to read and understand them. This change: * moves all console related things to "_create_consoles" * renames "_create_consoles" * adds docstrings to understand which objects are used  This refactoring step makes it later easier to understand which functional changes get introduced and under which conditions.  blueprint libvirt-virtlogd  
__label__objective libvirt: virtlogd: refactoring 1 before functional change  The methods "_create_consoles" and "_create_serial_console_devices" have many conditional cases and return or append devices. It's confusing to read and understand them. This change: * moves all console related things to "_create_consoles" * renames "_create_consoles" * adds docstrings to understand which objects are used  This refactoring step makes it later easier to understand which functional changes get introduced and under which conditions.  blueprint libvirt-virtlogd  
__label__quality libvirt: Refactor _volume_snapshot_delete function  This patch refactors _volume_snapshot_delete function. It splits it up into different helper functions such that its easier to debug, read and maintain the volume snapshot delete flow.  
__label__quality Refactor get_filtered_hosts in filter host manager  * Linearized control flow * Removed nested functions * Removed nested loop in filter algorithm; O(kn) becomes O(k+n) * Dictionary no longer requires hashing a tuple  
__label__quality refactored the class by name logic, unifying several functions, modified ml_framework to create the classes at the begining, before binding anything  
__label__objective refactored the class by name logic, unifying several functions, modified ml_framework to create the classes at the begining, before binding anything  
__label__quality Refactor create_image in prep for import from url  Glance supports tasks for importing from a url. That's awesome. Add support for parameters to indicate that glance should import the image from a URL. This is a half-functional patch. It should not break any existing code, but it will not actually do the import. This is to keep the existing refactor small and make it easier to reason about reviewing.  
__label__objective Refactor create_image in prep for import from url  Glance supports tasks for importing from a url. That's awesome. Add support for parameters to indicate that glance should import the image from a URL. This is a half-functional patch. It should not break any existing code, but it will not actually do the import. This is to keep the existing refactor small and make it easier to reason about reviewing.  
__label__objective Refactor create_image in prep for import from url  Glance supports tasks for importing from a url. That's awesome. Add support for parameters to indicate that glance should import the image from a URL. This is a half-functional patch. It should not break any existing code, but it will not actually do the import. This is to keep the existing refactor small and make it easier to reason about reviewing.  
__label__testing Refactor ironic-lib to move to oslo.privsep  - Do not check for `run_as_root` and `root_helper` in our execute function in utils.py - Get rid of tests that require run_as_root=False - Simplify disk_partitioner (we don't need an _exec function) - Update tests to reflect that root is used.  
__label__quality Refactor ironic-lib to move to oslo.privsep  - Do not check for `run_as_root` and `root_helper` in our execute function in utils.py - Get rid of tests that require run_as_root=False - Simplify disk_partitioner (we don't need an _exec function) - Update tests to reflect that root is used.  
__label__objective Refactor ironic-lib to move to oslo.privsep  - Do not check for `run_as_root` and `root_helper` in our execute function in utils.py - Get rid of tests that require run_as_root=False - Simplify disk_partitioner (we don't need an _exec function) - Update tests to reflect that root is used.  
__label__quality Code refactor for v2-v3  Refactoring code to reuse as much functionality as possible.  
__label__quality Refactor separate ovsdb-server launches  To clean up the code, refactor the snippets that create log links and launch ovsdb-server processes into functions.  
__label__integration Code refactoring for couchdb  The code in the change_permissions function for couchdb in service.py was refactored. In addition, translation was added to several RuntimeError messages that were missing the underscore for translation. Replaced shell calls with the respective operating_system service commands - start/stop/ enable/disable/ change permissions and modified tests as necessary. Created operating_system service command change_user_group and associated tests.  
__label__objective Code refactoring for couchdb  The code in the change_permissions function for couchdb in service.py was refactored. In addition, translation was added to several RuntimeError messages that were missing the underscore for translation. Replaced shell calls with the respective operating_system service commands - start/stop/ enable/disable/ change permissions and modified tests as necessary. Created operating_system service command change_user_group and associated tests.  
__label__quality Code refactoring for couchdb  The code in the change_permissions function for couchdb in service.py was refactored. In addition, translation was added to several RuntimeError messages that were missing the underscore for translation. Replaced shell calls with the respective operating_system service commands - start/stop/ enable/disable/ change permissions and modified tests as necessary. Created operating_system service command change_user_group and associated tests.  
__label__quality Refactor `fetch_mapped_args` and `fetch_unsatisfied_args`  Both of these can share a function that is used to lookup which provider (or possible provider) produces or provides a needed value, so instead of duplicating that code share it across both methods and refactor both to use it so that less code is duplicated (and therefore less errors and issues due to that).  
__label__objective Refactor `fetch_mapped_args` and `fetch_unsatisfied_args`  Both of these can share a function that is used to lookup which provider (or possible provider) produces or provides a needed value, so instead of duplicating that code share it across both methods and refactor both to use it so that less code is duplicated (and therefore less errors and issues due to that).  
__label__objective Refactoring osbash networking code  In preparation for Liberty, which removes some networks and adds a new type of network interface configuration (manual), this patch refactors the osbash networking code.  - fewer hardcoded settings (e.g., removed hardcoded list of networks   from osbash.sh)  - eliminated code duplication for client-side network configuration and   split remaining code into separate libraries (functions.ubuntu.sh,   functions.fedora.sh)  - simplify code, e.g. by removing some magic that deduced network names   for KVM from variable names like MGMT_NET  - universal functions for reading network and network interface   configuration into arrays (get_host_network_config,   get_node_netif_config)  - the number of networks is no longer hardcoded in the template for   Windows hostnet creation  - renamed some variables, functions and files to (hopefully) be easier   to understand  
__label__quality Refactoring osbash networking code  In preparation for Liberty, which removes some networks and adds a new type of network interface configuration (manual), this patch refactors the osbash networking code.  - fewer hardcoded settings (e.g., removed hardcoded list of networks   from osbash.sh)  - eliminated code duplication for client-side network configuration and   split remaining code into separate libraries (functions.ubuntu.sh,   functions.fedora.sh)  - simplify code, e.g. by removing some magic that deduced network names   for KVM from variable names like MGMT_NET  - universal functions for reading network and network interface   configuration into arrays (get_host_network_config,   get_node_netif_config)  - the number of networks is no longer hardcoded in the template for   Windows hostnet creation  - renamed some variables, functions and files to (hopefully) be easier   to understand  
__label__objective Refactoring osbash networking code  In preparation for Liberty, which removes some networks and adds a new type of network interface configuration (manual), this patch refactors the osbash networking code.  - fewer hardcoded settings (e.g., removed hardcoded list of networks   from osbash.sh)  - eliminated code duplication for client-side network configuration and   split remaining code into separate libraries (functions.ubuntu.sh,   functions.fedora.sh)  - simplify code, e.g. by removing some magic that deduced network names   for KVM from variable names like MGMT_NET  - universal functions for reading network and network interface   configuration into arrays (get_host_network_config,   get_node_netif_config)  - the number of networks is no longer hardcoded in the template for   Windows hostnet creation  - renamed some variables, functions and files to (hopefully) be easier   to understand  
__label__quality Huawei: Refactor driver for the second time  After a few new features being added into drivers, we found it hard to maintain the code. For further working, we need to refactor our code. The work contains the following: 1. Define a new class, named HuaweiConf, to parse xml config file. We used an external xml file to store SAN info. But we do config parsing anywhere in our code, even two different functions do the same parsing. 2. Adjust some function structures. 3. Rename some functions & variables.  DocImpact Implements: blueprint refactor-huawei-driver  
__label__objective Huawei: Refactor driver for the second time  After a few new features being added into drivers, we found it hard to maintain the code. For further working, we need to refactor our code. The work contains the following: 1. Define a new class, named HuaweiConf, to parse xml config file. We used an external xml file to store SAN info. But we do config parsing anywhere in our code, even two different functions do the same parsing. 2. Adjust some function structures. 3. Rename some functions & variables.  DocImpact Implements: blueprint refactor-huawei-driver  
__label__quality Huawei: Refactor driver for the second time  After a few new features being added into drivers, we found it hard to maintain the code. For further working, we need to refactor our code. The work contains the following: 1. Define a new class, named HuaweiConf, to parse xml config file. We used an external xml file to store SAN info. But we do config parsing anywhere in our code, even two different functions do the same parsing. 2. Adjust some function structures. 3. Rename some functions & variables.  DocImpact Implements: blueprint refactor-huawei-driver  
__label__objective Huawei: Refactor driver for the second time  After a few new features being added into drivers, we found it hard to maintain the code. For further working, we need to refactor our code. The work contains the following: 1. Define a new class, named HuaweiConf, to parse xml config file. We used an external xml file to store SAN info. But we do config parsing anywhere in our code, even two different functions do the same parsing. 2. Adjust some function structures. 3. Rename some functions & variables.  DocImpact Implements: blueprint refactor-huawei-driver  
__label__quality Huawei: Refactor driver for the second time  After a few new features being added into drivers, we found it hard to maintain the code. For further working, we need to refactor our code. The work contains the following: 1. Define a new class, named HuaweiConf, to parse xml config file. We used an external xml file to store SAN info. But we do config parsing anywhere in our code, even two different functions do the same parsing. 2. Adjust some function structures. 3. Rename some functions & variables.  DocImpact Implements: blueprint refactor-huawei-driver  
__label__objective Huawei: Refactor driver for the second time  After a few new features being added into drivers, we found it hard to maintain the code. For further working, we need to refactor our code. The work contains the following: 1. Define a new class, named HuaweiConf, to parse xml config file. We used an external xml file to store SAN info. But we do config parsing anywhere in our code, even two different functions do the same parsing. 2. Adjust some function structures. 3. Rename some functions & variables.  DocImpact Implements: blueprint refactor-huawei-driver  
__label__quality WIP! DO NOT MERGE: refactor DVR local and edge router classes  Rename DVR router classes to distributed and centralized to reflect their functionality. Refactor code between distributed router and DvrRouterBase classes to allow the centralized router class to inherit from DvrRouterBase rather than from the distributed router class.  
__label__objective WIP! DO NOT MERGE: refactor DVR local and edge router classes  Rename DVR router classes to distributed and centralized to reflect their functionality. Refactor code between distributed router and DvrRouterBase classes to allow the centralized router class to inherit from DvrRouterBase rather than from the distributed router class.  
__label__objective WIP! DO NOT MERGE: refactor DVR local and edge router classes  Rename DVR router classes to distributed and centralized to reflect their functionality. Refactor code between distributed router and DvrRouterBase classes to allow the centralized router class to inherit from DvrRouterBase rather than from the distributed router class.  
__label__quality Refactor SRB Unittest LVM command handlers.  For the LVM command act() handlers, call them with any env variable settings stripped off the head of the cmd list passed in; this makes it easier to maintain patches that add or remove env variable values as the cmd list indexes in the act() handler will not change, and the check() handler already validates that the env settings are present. The stripping is performed by the newly added _strip_env_settings() helper.  Created _lvm_size_to_bytes() helper function to replace a repeated pattern of code identified in the LVM command act() handlers.  
__label__objective Refactor SRB Unittest LVM command handlers.  For the LVM command act() handlers, call them with any env variable settings stripped off the head of the cmd list passed in; this makes it easier to maintain patches that add or remove env variable values as the cmd list indexes in the act() handler will not change, and the check() handler already validates that the env settings are present. The stripping is performed by the newly added _strip_env_settings() helper.  Created _lvm_size_to_bytes() helper function to replace a repeated pattern of code identified in the LVM command act() handlers.  
__label__objective Refactor SRB Unittest LVM command handlers.  For the LVM command act() handlers, call them with any env variable settings stripped off the head of the cmd list passed in; this makes it easier to maintain patches that add or remove env variable values as the cmd list indexes in the act() handler will not change, and the check() handler already validates that the env settings are present. The stripping is performed by the newly added _strip_env_settings() helper.  Created _lvm_size_to_bytes() helper function to replace a repeated pattern of code identified in the LVM command act() handlers.  
__label__objective Refactor Angular features enablement  To support stand settings service lookups, this creates a common features area under local_settings.py and creates common utility functions to access it.  
__label__objective Refactor Angular features enablement  To support stand settings service lookups, this creates a common features area under local_settings.py and creates common utility functions to access it.  
__label__objective Refactor compute hostname resolving functionality  The main driver here is to separate the concerns of resolving host names and adding them to service/user related files.  This is to enable the (eventual) resolution of the feature to allow migrations across relation ids (i.e. between nova-compute applications) and to enable caching of hostname look ups.  
__label__objective Refactor compute hostname resolving functionality  The main driver here is to separate the concerns of resolving host names and adding them to service/user related files.  This is to enable the (eventual) resolution of the feature to allow migrations across relation ids (i.e. between nova-compute applications) and to enable caching of hostname look ups.  
__label__quality Refactor qos_plugin._extend_port_resource_request  In order to speed up the port collection, some DB calls have been deleted in the extended function "QoSPlugin._extend_port_resource_request".  With the parent commit, the port DB/OVO object now has the network QoS policy ID, making the network retrieval unneeded.  In this refactor the QoS policy is collected from the DB only if a valid QoS policy ID exists, bound to the port or to the network. This reduces the number of QoS objects collection to one or zero.  
__label__integration Refactor qos_plugin._extend_port_resource_request  In order to speed up the port collection, some DB calls have been deleted in the extended function "QoSPlugin._extend_port_resource_request".  With the parent commit, the port DB/OVO object now has the network QoS policy ID, making the network retrieval unneeded.  In this refactor the QoS policy is collected from the DB only if a valid QoS policy ID exists, bound to the port or to the network. This reduces the number of QoS objects collection to one or zero.  
__label__objective Refactor qos_plugin._extend_port_resource_request  In order to speed up the port collection, some DB calls have been deleted in the extended function "QoSPlugin._extend_port_resource_request".  With the parent commit, the port DB/OVO object now has the network QoS policy ID, making the network retrieval unneeded.  In this refactor the QoS policy is collected from the DB only if a valid QoS policy ID exists, bound to the port or to the network. This reduces the number of QoS objects collection to one or zero.  
__label__refactoring Refactor bandwidth related functional tests  The common code that checked the allocation on the compute RP is move to a separate function.  The PCI addresses used by the fake virt driver are moved to a constant.  
__label__testing Refactor bandwidth related functional tests  The common code that checked the allocation on the compute RP is move to a separate function.  The PCI addresses used by the fake virt driver are moved to a constant.  
__label__quality Refactor region notification code to not need unit  The (already) refactored region notification code checked for the 'region' value in the remote unit, despite the nova-compute charm not setting the value.  This has been removed.  Now that the function only needs to be set for the relation, it is no longer included in 'unit' loops.  The utility function is also renamed to set_region_on_relation_from_config to better reflect it's actual function.  
__label__objective Refactor region notification code to not need unit  The (already) refactored region notification code checked for the 'region' value in the remote unit, despite the nova-compute charm not setting the value.  This has been removed.  Now that the function only needs to be set for the relation, it is no longer included in 'unit' loops.  The utility function is also renamed to set_region_on_relation_from_config to better reflect it's actual function.  
__label__quality Refactor ssh_known_hosts_lines() and ssh_authorized_keys_lines()  Refactor ssh_known_hosts_lines() and ssh_authorized_keys_lines to be easier to maintain and only call rstrip() once (per function).  
__label__objective Refactor ssh_known_hosts_lines() and ssh_authorized_keys_lines()  Refactor ssh_known_hosts_lines() and ssh_authorized_keys_lines to be easier to maintain and only call rstrip() once (per function).  
__label__quality Refactor compute_changed() hook handler  The compute_changed() function (which handled the cloud-compute relation changed hook event) was also used in the config-changed and update-charm hooks.  This meant that it did a lot of work that wasn't necessary for those hooks.  This patch splits the function up into separate functions that deal with one thing, and then introduces a new function to call those.  This means that the other usages compute_changed() now use the actual features that they need.  
__label__objective Refactor compute_changed() hook handler  The compute_changed() function (which handled the cloud-compute relation changed hook event) was also used in the config-changed and update-charm hooks.  This meant that it did a lot of work that wasn't necessary for those hooks.  This patch splits the function up into separate functions that deal with one thing, and then introduces a new function to call those.  This means that the other usages compute_changed() now use the actual features that they need.  
__label__objective Refactor compute_changed() hook handler  The compute_changed() function (which handled the cloud-compute relation changed hook event) was also used in the config-changed and update-charm hooks.  This meant that it did a lot of work that wasn't necessary for those hooks.  This patch splits the function up into separate functions that deal with one thing, and then introduces a new function to call those.  This means that the other usages compute_changed() now use the actual features that they need.  
__label__quality Refactor import_authorized_keys() function for performance  The main change is to fetch all of the relation_data() at once, and then iterate through the python dictionary.  This speeds up processing of potentially hundreds of hosts and authorized_keys.  
__label__objective Refactor import_authorized_keys() function for performance  The main change is to fetch all of the relation_data() at once, and then iterate through the python dictionary.  This speeds up processing of potentially hundreds of hosts and authorized_keys.  
__label__objective refactor nova-manage archive_deleted_rows  In Change I408c22d8eada0518ec5d685213f250e8e3dae76e we want to be able to archive records before a certain date. Without this patch,it will require a few modifications to records in instance_actions, instance_actions_events and migrations tables as they are handled separately from other tables.  However, refactoring the archiving workflow to archive all dependent tables in same function '_archive_if_instance_deleted()' allows archiving without updating rows in those table. This is much cleaner.  
__label__quality refactor nova-manage archive_deleted_rows  In Change I408c22d8eada0518ec5d685213f250e8e3dae76e we want to be able to archive records before a certain date. Without this patch,it will require a few modifications to records in instance_actions, instance_actions_events and migrations tables as they are handled separately from other tables.  However, refactoring the archiving workflow to archive all dependent tables in same function '_archive_if_instance_deleted()' allows archiving without updating rows in those table. This is much cleaner.  
__label__quality Split code for reuse and refactor for code style  To make it easier to reuse GitTree elsewhere move outside of the gitfixture and reference.  Instead of treating the functions in utils as private to indicate they shouldn't be relied upon outside of the package, switch utils to indicate that it should not relied upon to clear up some IDE warnings on use of private functions.  Finally avoid use of potentially mutable default params.  
__label__objective Split code for reuse and refactor for code style  To make it easier to reuse GitTree elsewhere move outside of the gitfixture and reference.  Instead of treating the functions in utils as private to indicate they shouldn't be relied upon outside of the package, switch utils to indicate that it should not relied upon to clear up some IDE warnings on use of private functions.  Finally avoid use of potentially mutable default params.  
__label__quality Refactor stack output fetching  We are duplicating the code to fetch a specific value from the stack outputs. This adds a get_stack_output_item that can be used to fetch any named stack output and refactors the other functions that did this same type of action.  
__label__objective Refactor stack output fetching  We are duplicating the code to fetch a specific value from the stack outputs. This adds a get_stack_output_item that can be used to fetch any named stack output and refactors the other functions that did this same type of action.  
__label__objective Continue refactoring of the image  Next refactoring monster with: - switch bunch of cloud._image methods to using image.proxy methods - Add new image.Image attribute - Fix image properties by adding global support for keeping "unknown"  attributes under properties attr - turn back function lost in openstackcloud split (sadly not found by  unittests) - add ability to create image without data required by OSC to switch to  SDK  
__label__objective Continue refactoring of the image  Next refactoring monster with: - switch bunch of cloud._image methods to using image.proxy methods - Add new image.Image attribute - Fix image properties by adding global support for keeping "unknown"  attributes under properties attr - turn back function lost in openstackcloud split (sadly not found by  unittests) - add ability to create image without data required by OSC to switch to  SDK  
__label__testing Refactor tox.ini to match OpenStack Project Testing Interface  OpenStack Project Testing Interface[1] extabilish a set of rules to make sure project testing interface looks similarly between OpenStack projects. This is intended to be the first change in such direction.  Major improvements are: - Separate new cover environment from other testing environments - Reorganize tox.ini to better separate type of envs in sections - Create an [openstack] section to unify settings for environments   that would require connecting to OpenStack (functional, scenarion,   ...) - Create scenario env to exectute all scenarion tests including   Neutron ones. - Point to the new URL for upstream upper hand global requirements file.  Know missing things are: - Create docs environment. - Create functional env.  [1] https://governance.openstack.org/tc/reference/project-testing-interface.html  
__label__quality Refactor tox.ini to match OpenStack Project Testing Interface  OpenStack Project Testing Interface[1] extabilish a set of rules to make sure project testing interface looks similarly between OpenStack projects. This is intended to be the first change in such direction.  Major improvements are: - Separate new cover environment from other testing environments - Reorganize tox.ini to better separate type of envs in sections - Create an [openstack] section to unify settings for environments   that would require connecting to OpenStack (functional, scenarion,   ...) - Create scenario env to exectute all scenarion tests including   Neutron ones. - Point to the new URL for upstream upper hand global requirements file.  Know missing things are: - Create docs environment. - Create functional env.  [1] https://governance.openstack.org/tc/reference/project-testing-interface.html  
__label__objective Refactor tox.ini to match OpenStack Project Testing Interface  OpenStack Project Testing Interface[1] extabilish a set of rules to make sure project testing interface looks similarly between OpenStack projects. This is intended to be the first change in such direction.  Major improvements are: - Separate new cover environment from other testing environments - Reorganize tox.ini to better separate type of envs in sections - Create an [openstack] section to unify settings for environments   that would require connecting to OpenStack (functional, scenarion,   ...) - Create scenario env to exectute all scenarion tests including   Neutron ones. - Point to the new URL for upstream upper hand global requirements file.  Know missing things are: - Create docs environment. - Create functional env.  [1] https://governance.openstack.org/tc/reference/project-testing-interface.html  
__label__objective Refactor tox.ini to match OpenStack Project Testing Interface  OpenStack Project Testing Interface[1] extabilish a set of rules to make sure project testing interface looks similarly between OpenStack projects. This is intended to be the first change in such direction.  Major improvements are: - Separate new cover environment from other testing environments - Reorganize tox.ini to better separate type of envs in sections - Create an [openstack] section to unify settings for environments   that would require connecting to OpenStack (functional, scenarion,   ...) - Create scenario env to exectute all scenarion tests including   Neutron ones. - Point to the new URL for upstream upper hand global requirements file.  Know missing things are: - Create docs environment. - Create functional env.  [1] https://governance.openstack.org/tc/reference/project-testing-interface.html  
__label__quality relinker: refactor to share common code  Refactor the relinker to reduce the amount of code that is duplicated in the relink and cleanup functions.  
__label__refactoring Light refactoring  This is a small change to fix some spelling issues, logging mistakes, and simplifying small functions.  
__label__quality Refactor Container Driver  The container driver code needs a refactor to facilitate the development of new functionality. This patch improves:  - Error handling: don't swallow every exception. - Method modularization: move common code to private methods. - Move methods to more appropriate classes: methods should live   in classes that encapsulate their responsibility. E.g: the   protocol helper should not access the container to obtain its   IP address, it should invoke a method from the container helper. - Don't use share_id everywhere: even though the code   currently does not use the instance_id, deriving the   share name from the export location makes it easier to   support instance_id or manage/unmanage future implementations.  
__label__objective Refactor Container Driver  The container driver code needs a refactor to facilitate the development of new functionality. This patch improves:  - Error handling: don't swallow every exception. - Method modularization: move common code to private methods. - Move methods to more appropriate classes: methods should live   in classes that encapsulate their responsibility. E.g: the   protocol helper should not access the container to obtain its   IP address, it should invoke a method from the container helper. - Don't use share_id everywhere: even though the code   currently does not use the instance_id, deriving the   share name from the export location makes it easier to   support instance_id or manage/unmanage future implementations.  
__label__quality Refactor directory creation into a common place  There is a useful method in the fernet_utils.py module for creating directories. We can reuse this for the jwt provider implementation.  This commit generalizes the logic and moves it into a common place for fernet_utils to use. A subsequent patch introducing JWT functionality will use the same utils.  bp json-web-tokens  
__label__objective Refactor directory creation into a common place  There is a useful method in the fernet_utils.py module for creating directories. We can reuse this for the jwt provider implementation.  This commit generalizes the logic and moves it into a common place for fernet_utils to use. A subsequent patch introducing JWT functionality will use the same utils.  bp json-web-tokens  
__label__objective Refactor _build_device_metadata  This patch splits out interface and disk metadata generation into its own function each, in preparation for handling hostdev metadata generation in a subsequent patch. It also adds some debug logging.  NOTE(artom): Queens -> Pike backport is clean, conflicts in nova/virt/libvirt/driver.py in Queens due to trusted VFs not being present.  Related-bug: 1743458 
__label__objective Refactor _build_device_metadata  This patch splits out interface and disk metadata generation into its own function each, in preparation for handling hostdev metadata generation in a subsequent patch. It also adds some debug logging.  NOTE(artom): Queens -> Pike backport is clean, conflicts in nova/virt/libvirt/driver.py in Queens due to trusted VFs not being present.  Related-bug: 1743458 
__label__quality refactor: Allow site_by_params to take in list of fields  This patch set simplifies some code related to site_by_params by allowing it to take an iterable argument called *fields which specifies exactly which parameters to include from the site-definition.yaml. This means that no hard-coding is required to manually filter the params into the exact parameters required by follow-up function calls. This is done for better code maintenance.  
__label__objective refactor: Allow site_by_params to take in list of fields  This patch set simplifies some code related to site_by_params by allowing it to take an iterable argument called *fields which specifies exactly which parameters to include from the site-definition.yaml. This means that no hard-coding is required to manually filter the params into the exact parameters required by follow-up function calls. This is done for better code maintenance.  
__label__quality refactor: Exchange NotADirectoryError for better exception  This patch set replaces raising NotADirectoryError after trying to parse a repository for its root path (normalize_repo_path in pegleg.engine.util.git) with a better exception (exceptions.GitInvalidRepoException). It is better because a folder can still not be a repo, so raising the first exception isn't apropos.  Next, this patch set changes where the exception is raised -- which is in normalize_repo_path itself, which is more appropriate as the function is used in many places and so there should be intrinsic error handling so as to avoid having to wrap it every time.  
__label__objective refactor: Exchange NotADirectoryError for better exception  This patch set replaces raising NotADirectoryError after trying to parse a repository for its root path (normalize_repo_path in pegleg.engine.util.git) with a better exception (exceptions.GitInvalidRepoException). It is better because a folder can still not be a repo, so raising the first exception isn't apropos.  Next, this patch set changes where the exception is raised -- which is in normalize_repo_path itself, which is more appropriate as the function is used in many places and so there should be intrinsic error handling so as to avoid having to wrap it every time.  
__label__objective refactor: Exchange NotADirectoryError for better exception  This patch set replaces raising NotADirectoryError after trying to parse a repository for its root path (normalize_repo_path in pegleg.engine.util.git) with a better exception (exceptions.GitInvalidRepoException). It is better because a folder can still not be a repo, so raising the first exception isn't apropos.  Next, this patch set changes where the exception is raised -- which is in normalize_repo_path itself, which is more appropriate as the function is used in many places and so there should be intrinsic error handling so as to avoid having to wrap it every time.  
__label__refactoring Refactoring of the cli app module  Logging strings use format function.  Signed-off-by: Jiri Podivin <jpodivin@redhat.com> 
__label__quality Refactor on dl_rpms.sh  A refactor was made in the dl_rpms.sh script to simplify the maintenance and development. A new file utils.sh was created to store all the common functions that could be used by another scripts.  Also, some unit testing was added to the util.sh file.  Story: 2002736 Task: 26194  
__label__testing Refactor on dl_rpms.sh  A refactor was made in the dl_rpms.sh script to simplify the maintenance and development. A new file utils.sh was created to store all the common functions that could be used by another scripts.  Also, some unit testing was added to the util.sh file.  Story: 2002736 Task: 26194  
__label__objective Refactor DriverBase.get_instance()  scope param is added to allow getting multiple independent instances of a driver. This is particularly useful for using same VIFPoolDriver implementation for multiple PodVIFDrivers (eg. NoopVIFPool may be used for multiple PodVIFDriver types)  Also renames driver_alias to specific_driver to better indicate its function.  
__label__objective Refactor DriverBase.get_instance()  scope param is added to allow getting multiple independent instances of a driver. This is particularly useful for using same VIFPoolDriver implementation for multiple PodVIFDrivers (eg. NoopVIFPool may be used for multiple PodVIFDriver types)  Also renames driver_alias to specific_driver to better indicate its function.  
__label__quality Refactor service client getters  This change removes duplication of service clients instantiations throughout the code (especially the lookup plugins). It also consolidates service client getter functions by placing them all in the utils module.  
__label__objective Refactor service client getters  This change removes duplication of service clients instantiations throughout the code (especially the lookup plugins). It also consolidates service client getter functions by placing them all in the utils module.  
__label__refactoring Refactor non-docker upload functions into base class  This is in preparation for a SkopeoImageUploader which won't need to create a docker client for any operations.  
__label__objective Refactor list function in docker driver  Function list in docker driver is called by update_containers_states in docker.driver and init_containers in compute.manager. When restart compute service, the init_containers function is called, then the list is called. The function list will heal non-existent containers, which is not necessary to do this when restart compute service.    It is better to heal non-existent containers only in update_containers_states.  
__label__objective Refactor list function in docker driver  Function list in docker driver is called by update_containers_states in docker.driver and init_containers in compute.manager. When restart compute service, the init_containers function is called, then the list is called. The function list will heal non-existent containers, which is not necessary to do this when restart compute service.    It is better to heal non-existent containers only in update_containers_states.  
__label__objective Refactor _build_device_metadata  This patch splits out interface and disk metadata generation into its own function each, in preparation for handling hostdev metadata generation in a subsequent patch. It also adds some debug logging.  NOTE(artom): Conflicts in nova/virt/libvirt/driver.py due to trusted VFs not being present in Queens.  Related-bug: 1743458 
__label__quality Refactor _build_device_metadata  This patch splits out interface and disk metadata generation into its own function each, in preparation for handling hostdev metadata generation in a subsequent patch. It also adds some debug logging.  NOTE(artom): Conflicts in nova/virt/libvirt/driver.py due to trusted VFs not being present in Queens.  Related-bug: 1743458 
__label__quality Refactor parameters.py  Converted all relevant functions to use helpers.<insert function> instead of a specific import.  Added commas to last entries of mapping tuples.  
__label__quality Refactor _set_domain_id_and_mapping functions  This change refactors both functions listed for single refs and a list of refs for _set_domain_id_and_mapping to do separate checks for conditions such as _is_domain_aware and _is_mapping_needed. This is due to how it is currently handled, it uses the same logic between both functions, which provides more overhead for a list than a single ref.  
__label__objective Refactor _set_domain_id_and_mapping functions  This change refactors both functions listed for single refs and a list of refs for _set_domain_id_and_mapping to do separate checks for conditions such as _is_domain_aware and _is_mapping_needed. This is due to how it is currently handled, it uses the same logic between both functions, which provides more overhead for a list than a single ref.  
__label__quality Refactor clone_workspace function in publishers.py to utilize convert_mapping_to_xml  Refactor the code in the function to utilize convert_mapping_to_xml's way of detecting valid types.  
__label__objective Refactor clone_workspace function in publishers.py to utilize convert_mapping_to_xml  Refactor the code in the function to utilize convert_mapping_to_xml's way of detecting valid types.  
__label__quality Refactor notifications.py  Converted all relevant functions to use helpers.<insert function> instead of a specific import.  Added commas to last entries of mapping tuples.  
__label__objective Refactor notifications.py  Converted all relevant functions to use helpers.<insert function> instead of a specific import.  Added commas to last entries of mapping tuples.  
__label__quality Refactor hipchat_notif.py  Converted all relevant functions to use helpers.<insert function> instead of a specific import.  
__label__objective Refactor hipchat_notif.py  Converted all relevant functions to use helpers.<insert function> instead of a specific import.  
__label__quality Refactor ivy function in triggers.py to utilize convert_mapping_to_xml  Refactor the code in the function to utilize convert_mapping_to_xml.  
__label__objective Refactor ivy function in triggers.py to utilize convert_mapping_to_xml  Refactor the code in the function to utilize convert_mapping_to_xml.  
__label__quality Refactor builders.py  The refactoring process includes the following 1. Converted all relevant functions to use helpers.<insert function> instead of a specific import. 2. Standardized indentation for mapping tuple 3. Add commas to last entries of mapping tuples  
__label__objective Refactor builders.py  The refactoring process includes the following 1. Converted all relevant functions to use helpers.<insert function> instead of a specific import. 2. Standardized indentation for mapping tuple 3. Add commas to last entries of mapping tuples  
__label__quality Refactor _build_device_metadata  This patch splits out interface and disk metadata generation into its own function each, in preparation for handling hostdev metadata generation in a subsequent patch. It also adds some debug logging.  
__label__objective Refactor _build_device_metadata  This patch splits out interface and disk metadata generation into its own function each, in preparation for handling hostdev metadata generation in a subsequent patch. It also adds some debug logging.  
__label__refactoring Refactor libvirt get_memory_used_mb()  Split _sum_domain_memory_mb and _get_avail_memory_kb to separate functions. Simplifies xen codepath in get_memory_used_mb, and eases integration for file-backed-memory  
__label__quality Refactor object updater's async-pending finder  Pulled the FS walking out into its own function so that finding async_pendings is in one place and processing them is in another. This should make it easier to add greenthread-based concurrency later.  Also refactored rate limiting to use utils.RateLimitedIterator instead of calling ratelimit_sleep ourselves. The functionality's the same, but the interface is easier.  
__label__objective refactor(keystone): clean up code  This patch set cleans up a few items in the keystone code in the airship-armada code base:  * Change the provided util function to load the session from   [keystone_authtoken] section of the cfg.CONF rather than picking at   the fields to use v3.Password. * (trivial) the import order is now alphabetical * (trivial) keystoneauth1 exception no longer imports to the actual module  
__label__quality refactor(keystone): clean up code  This patch set cleans up a few items in the keystone code in the airship-armada code base:  * Change the provided util function to load the session from   [keystone_authtoken] section of the cfg.CONF rather than picking at   the fields to use v3.Password. * (trivial) the import order is now alphabetical * (trivial) keystoneauth1 exception no longer imports to the actual module  
__label__quality Refactor finding sharding and shrinking candidates  Refactor to provide module level functions for the finding of sharding and shrinking candidates, so that these can be used by other callers.  Add unit tests.  
__label__testing Refactor finding sharding and shrinking candidates  Refactor to provide module level functions for the finding of sharding and shrinking candidates, so that these can be used by other callers.  Add unit tests.  
__label__quality FC: refactor fczm utils decorators to functions  This patch changes the Fibre Channel Zone Manager utility decorators to functions.   Those functions now have to be called manually.   The intention of this is to unify how the FC drivers are to be declared and used vs. the iSCSI.  No more magic decorators for FC drivers only.  
__label__objective FC: refactor fczm utils decorators to functions  This patch changes the Fibre Channel Zone Manager utility decorators to functions.   Those functions now have to be called manually.   The intention of this is to unify how the FC drivers are to be declared and used vs. the iSCSI.  No more magic decorators for FC drivers only.  
__label__refactoring Refactor setting default CA  This merely breaks the code that sets the default CA in the deployment workflow to more functions. Preparing for setting the certificate for the overcloud in a subsequent commit.  
__label__testing Refactor tempurl functional test's try-finally  This is a following patch of [1]. In [1] comment, tim suggested implementation for same behavior with less code. This change implemented the suggestion. See [1] for more details.  [1]: https://review.openstack.org/#/c/547306/  
__label__quality Refactor tempurl functional test's try-finally  This is a following patch of [1]. In [1] comment, tim suggested implementation for same behavior with less code. This change implemented the suggestion. See [1] for more details.  [1]: https://review.openstack.org/#/c/547306/  
__label__objective Refactor some common code between overcloud_upgrade and update  Adds a new run_update_ansible_action function in utils to be used by the upgrade and update to avoid repetition. The package_update action is passed into the utils function to avoid circular dependency.  
__label__quality Refactor some common code between overcloud_upgrade and update  Moves the invocation of update_ansible action into a common utils function to avoid repetition.  
__label__objective Refactor status functions, add web endpoints, allow params This patch refactors status functions so that instead of having one function per output format, the output format is simply a parameter.  New status endpoints are added:  * image-list.json * request-list(.json)  The endpoint node-list(.json) accepts a node_id parameter for filtering.  
__label__objective Refactor status functions, add web endpoints, allow params This patch refactors status functions so that instead of having one function per output format, the output format is simply a parameter.  New status endpoints are added:  * image-list.json * request-list(.json)  The endpoint node-list(.json) accepts a node_id parameter for filtering.  
__label__quality Refactor playbooks/nodepool-zuul-functional/pre.yaml  Instead of using tasks and roles together, create a new role and use it. This makes ordering easier to understand.  This is followup for https://review.openstack.org/#/c/545158/14/playbooks/nodepool-zuul-functional/pre.yaml  
__label__objective Refactor expirer's task shuffling implementation  Object-expirer shuffles order of expiration tasks to avoid deleting objects in a certain container continuously.  To make review for expirer's task queue update patch [1] easy, this patch refactors the implementation of the shuffling. In this patch, the shuffling is divided as a function.  The patch [1] will be rebased after this patch merged.  [1]: https://review.openstack.org/#/c/517389  
__label__objective Refactor expirer's task shuffling implementation  Object-expirer shuffles order of expiration tasks to avoid deleting objects in a certain container continuously.  To make review for expirer's task queue update patch [1] easy, this patch refactors the implementation of the shuffling. In this patch, the shuffling is divided as a function.  The patch [1] will be rebased after this patch merged.  [1]: https://review.openstack.org/#/c/517389  
__label__quality Refactor set_bios_settings  This patch factors the code in set_bios_settings out into a utility method that can be used by other code that uses the same functionality.  Depends-On: I70e52868f10bfafb30bbb38b85888bc4ec8e65ae 
__label__refactoring refactor_functional_utils  
__label__refactoring Refactor method node_list in status.py  Extract same logics into one internal function, and call it when get one node's values or iterate some nodes' value.  
__label__refactoring [WIP] Refactored make_client  There were two code paths that did the same thing, and while the code paths did the same thing, one of them supported region_name and the other one did not.  Moving all this functionality into a single function to prevent this from happening in the future.  - Re-factored make_client and create_connection. - Remove now unused sdk.py.  
__label__quality [WIP] Refactored make_client  There were two code paths that did the same thing, and while the code paths did the same thing, one of them supported region_name and the other one did not.  Moving all this functionality into a single function to prevent this from happening in the future.  - Re-factored make_client and create_connection. - Remove now unused sdk.py.  
__label__refactoring Fix accumulated nits in refactor series  Addresses the following minor review comments:  https://review.openstack.org/#/c/516778/10/nova/tests/functional/db/test_allocation_candidates.py@261 https://review.openstack.org/#/c/516779/9/nova/objects/resource_provider.py@2732 https://review.openstack.org/#/c/516780/10/nova/objects/resource_provider.py@2583  
__label__quality Refactory for get_xenapi_facts  This commit contains the following changes: 1. remove it from cmd; as there is no need to expose this as a    separate command. Making this as an util which will be invoked    by xenapi_bootstrap. 2. rename the general function of get_hostname to be get_remote_hostname    and move it to common_functions. 3. change the keywords for the facts items to make it more clear.  
__label__objective Refactory for get_xenapi_facts  This commit contains the following changes: 1. remove it from cmd; as there is no need to expose this as a    separate command. Making this as an util which will be invoked    by xenapi_bootstrap. 2. rename the general function of get_hostname to be get_remote_hostname    and move it to common_functions. 3. change the keywords for the facts items to make it more clear.  
__label__refactoring Refactor generic container executor  Refactor executor functions in go lang style  
__label__quality Refactor placement version check  raise_http_status_code_if_not_version are duplicate we don't need keep this function, instead, use the decorater to check version.  
__label__refactoring Refactor proxy-server conf loading to a utils function  There were two middlewares using a common pattern to load the proxy-server app config section. This patch moves the common code to a utils helper function and adds some unit tests.  
__label__testing Refactor proxy-server conf loading to a utils function  There were two middlewares using a common pattern to load the proxy-server app config section. This patch moves the common code to a utils helper function and adds some unit tests.  
__label__objective Refactor Register nodes dialog to use redux-form  * RegisterNodesDialog now connects to registerNodesForm and uses selectors   action creators to access form state * RegisterNodesForm uses redux-form and lists node forms as fieldArray * Adds Horizontal field components to use with redux-form * Uploading nodes from file is extracted into separate component * Uses redux-form-validators to provide validations for fields * Updates DriverFields components to be used with redux-form * Adds Fieldset component * Changes nodes registration logic:   * Function for handling form submit replaces thunk action to simplify     work with redux-form as it can return Promise which redux-form expects   * validateNodes Mistral action is called explicitly to act as a standalone     server side validation   * When register nodes workflow successfully starts, form is reset and app     redirects to nodes page where registration continues   * Logic is prepared to work on individual nodes which will be introduced in     subsequent patch  Implements: blueprint ui-redux-form-migration 
__label__quality Refactor Register nodes dialog to use redux-form  * RegisterNodesDialog now connects to registerNodesForm and uses selectors   action creators to access form state * RegisterNodesForm uses redux-form and lists node forms as fieldArray * Adds Horizontal field components to use with redux-form * Uploading nodes from file is extracted into separate component * Uses redux-form-validators to provide validations for fields * Updates DriverFields components to be used with redux-form * Adds Fieldset component * Changes nodes registration logic:   * Function for handling form submit replaces thunk action to simplify     work with redux-form as it can return Promise which redux-form expects   * validateNodes Mistral action is called explicitly to act as a standalone     server side validation   * When register nodes workflow successfully starts, form is reset and app     redirects to nodes page where registration continues   * Logic is prepared to work on individual nodes which will be introduced in     subsequent patch  Implements: blueprint ui-redux-form-migration 
__label__refactoring Refactor ZaqarWebSocketService functions into thunks  
__label__testing Refactor ServerMovingTests for non-move tests  This came up as a review comment in change c19ebcbd58bc673e336bc5fa3b815c7b0a20d628.  The tests being moved aren't related to move operations, so they shouldn't be in the ServerMovingTests class.  This moves them to separate classes and uses distinct fake virt drivers to avoid monkey patching the compute manager code in a functional test.  Conflicts:       nova/tests/functional/test_servers.py  NOTE(mriedem): The conflict is due to not having change cc833359870d3962326c35094adea2f525ec8141 in Pike.  
__label__quality Refactor ServerMovingTests for non-move tests  This came up as a review comment in change c19ebcbd58bc673e336bc5fa3b815c7b0a20d628.  The tests being moved aren't related to move operations, so they shouldn't be in the ServerMovingTests class.  This moves them to separate classes and uses distinct fake virt drivers to avoid monkey patching the compute manager code in a functional test.  Conflicts:       nova/tests/functional/test_servers.py  NOTE(mriedem): The conflict is due to not having change cc833359870d3962326c35094adea2f525ec8141 in Pike.  
__label__objective Refactor ServerMovingTests for non-move tests  This came up as a review comment in change c19ebcbd58bc673e336bc5fa3b815c7b0a20d628.  The tests being moved aren't related to move operations, so they shouldn't be in the ServerMovingTests class.  This moves them to separate classes and uses distinct fake virt drivers to avoid monkey patching the compute manager code in a functional test.  Conflicts:       nova/tests/functional/test_servers.py  NOTE(mriedem): The conflict is due to not having change cc833359870d3962326c35094adea2f525ec8141 in Pike.  
__label__objective Refactor out claim_resources_on_destination into a utility  We need this method for a similar fix in evacuate, so this change pulls the method out of the LiveMigrationTask and moves it into scheduler utils along with unit tests.  The only functional difference is that instead of raising MigrationPreCheckError, it now raises NoValidHost, which for live migration ends up being the same result when it's handled in ComputeTaskManager.  
__label__objective Refactor out claim_resources_on_destination into a utility  We need this method for a similar fix in evacuate, so this change pulls the method out of the LiveMigrationTask and moves it into scheduler utils along with unit tests.  The only functional difference is that instead of raising MigrationPreCheckError, it now raises NoValidHost, which for live migration ends up being the same result when it's handled in ComputeTaskManager.  
__label__testing Refactor ServerMovingTests for non-move tests  This came up as a review comment in change c19ebcbd58bc673e336bc5fa3b815c7b0a20d628.  The tests being moved aren't related to move operations, so they shouldn't be in the ServerMovingTests class.  This moves them to separate classes and uses distinct fake virt drivers to avoid monkey patching the compute manager code in a functional test.  
__label__quality Refactor ServerMovingTests for non-move tests  This came up as a review comment in change c19ebcbd58bc673e336bc5fa3b815c7b0a20d628.  The tests being moved aren't related to move operations, so they shouldn't be in the ServerMovingTests class.  This moves them to separate classes and uses distinct fake virt drivers to avoid monkey patching the compute manager code in a functional test.  
__label__objective Refactor ServerMovingTests for non-move tests  This came up as a review comment in change c19ebcbd58bc673e336bc5fa3b815c7b0a20d628.  The tests being moved aren't related to move operations, so they shouldn't be in the ServerMovingTests class.  This moves them to separate classes and uses distinct fake virt drivers to avoid monkey patching the compute manager code in a functional test.  
__label__quality Refactor spec helper  The spec helper file has been cargocult-copied from puppetlabs and puppet-openstack modules, adjusted slightly for Infra's particular needs. It is hard to read which makes adjusting it hard to do and hard to review. This refactor moves code into named functions and condenses the main setup code so that there is only one loop over the host list.  
__label__objective Refactor spec helper  The spec helper file has been cargocult-copied from puppetlabs and puppet-openstack modules, adjusted slightly for Infra's particular needs. It is hard to read which makes adjusting it hard to do and hard to review. This refactor moves code into named functions and condenses the main setup code so that there is only one loop over the host list.  
__label__objective Refactor out claim_resources_on_destination into a utility  We need this method for a similar fix in evacuate, so this change pulls the method out of the LiveMigrationTask and moves it into scheduler utils along with unit tests.  The only functional difference is that instead of raising MigrationPreCheckError, it now raises NoValidHost, which for live migration ends up being the same result when it's handled in ComputeTaskManager.  
__label__objective Refactor out claim_resources_on_destination into a utility  We need this method for a similar fix in evacuate, so this change pulls the method out of the LiveMigrationTask and moves it into scheduler utils along with unit tests.  The only functional difference is that instead of raising MigrationPreCheckError, it now raises NoValidHost, which for live migration ends up being the same result when it's handled in ComputeTaskManager.  
__label__quality Small refactor of metadata bits  This patch performs a small refactor of the metadata port creation and the code which waits for metadata service to be provisioned in the network when a port transitions to 'up'.  Also, when metadata is disabled, an error was logged trying to retrieve fetch the metadata port. Instead of checking if metadata is enabled or not in many points of the code, that function will return None if service is disabled.  
__label__objective Small refactor of metadata bits  This patch performs a small refactor of the metadata port creation and the code which waits for metadata service to be provisioned in the network when a port transitions to 'up'.  Also, when metadata is disabled, an error was logged trying to retrieve fetch the metadata port. Instead of checking if metadata is enabled or not in many points of the code, that function will return None if service is disabled.  
__label__refactoring Refactor record processor  Move user-related and Launchpad-related functions from record processor to corresponding modules.  
__label__objective Refactor get_physnets_by_portgroup_id  There is a lot of common code between the functions ironic.conductor.utils.validate_port_physnets() and ironic.drivers.modules.network.common._get_physnets_by_portgroup().  This change refactors the code, adding a new utility method, get_physnets_by_portgroup_id, which returns the physical networks associated with a portgroup. There should be at most one such physical network, and the presence of multiple will cause PortgroupPhysnetInconsistent to be raised.  
__label__quality Refactor get_physnets_by_portgroup_id  There is a lot of common code between the functions ironic.conductor.utils.validate_port_physnets() and ironic.drivers.modules.network.common._get_physnets_by_portgroup().  This change refactors the code, adding a new utility method, get_physnets_by_portgroup_id, which returns the physical networks associated with a portgroup. There should be at most one such physical network, and the presence of multiple will cause PortgroupPhysnetInconsistent to be raised.  
__label__objective Refactor get_physnets_by_portgroup_id  There is a lot of common code between the functions ironic.conductor.utils.validate_port_physnets() and ironic.drivers.modules.network.common._get_physnets_by_portgroup().  This change refactors the code, adding a new utility method, get_physnets_by_portgroup_id, which returns the physical networks associated with a portgroup. There should be at most one such physical network, and the presence of multiple will cause PortgroupPhysnetInconsistent to be raised.  
__label__quality Refactoring test_pod_cli.py  1. What is the problem? The methods are sharing common functionality which make difficult to avoid duplication.  2. What is the solution to the problem? Refactoring these common functionality.  3. What features need to be implemented to the Tricircle to realize the solution? None  
__label__refactoring Refactor network restore function  
__label__quality Refactor and expose logic to acquire a flock with retries  When locking the file descriptor skip_udev_partition_probe was not handling errors thrown by fcntl.flock which was leading controller-0 to degraded state after unlock. This change aims to strengthen that logic by handling the error properly, retrying the lock operation and improving logs.  Re-implementation of commit cbb9121a289603ec003dec098b8fa5918ca98300. The original commit inadvertently replaced a shared lock with a exclusive lock on the decorator skip_udev_partition_probe which caused fd locking issues.  This commit exposes utility functions to acquire shared or exclusive non-blocking locks of file descriptors.  Tested on Standard (2 + 4) configuration.  Closes-Bug: 1922256 Signed-off-by: Pedro Henrique Linhares <PedroHenriqueLinhares.Silva@windriver.com> 
__label__objective Refactor and expose logic to acquire a flock with retries  When locking the file descriptor skip_udev_partition_probe was not handling errors thrown by fcntl.flock which was leading controller-0 to degraded state after unlock. This change aims to strengthen that logic by handling the error properly, retrying the lock operation and improving logs.  Re-implementation of commit cbb9121a289603ec003dec098b8fa5918ca98300. The original commit inadvertently replaced a shared lock with a exclusive lock on the decorator skip_udev_partition_probe which caused fd locking issues.  This commit exposes utility functions to acquire shared or exclusive non-blocking locks of file descriptors.  Tested on Standard (2 + 4) configuration.  Closes-Bug: 1922256 Signed-off-by: Pedro Henrique Linhares <PedroHenriqueLinhares.Silva@windriver.com> 
__label__quality Refactor the install_solumclient function  Only install python-solumcline from source when configed LIBS_FROM_GIT, otherwise pip install from gloal requirements.  
__label__refactoring Refactor server restore function  
__label__quality Refactor common keystone methods  - Split loading session and auth from config to separate functions,   allow to override options loaded from config.   This will lay ground to more efficiently load clients that allow   passing in both session and auth plugin objects separately.  - When resoving a service endpoint, either fetch the requested interface,   or first try 'internal' and then 'public'.   This is done due to our config lacking any options to set the default   interface for service endpoints to use, and we've used 'internal' by   default, although DevStack has no such endpoints for most services   any more [0].   This will be changed again when gradually introducing usage of   keystoneauth Adapters to ironic.  - Remove get_admin_token method, it was used only in glance-related code   once, and was simply moved there.  [0] https://review.openstack.org/#/c/433272  
__label__objective Refactor common keystone methods  - Split loading session and auth from config to separate functions,   allow to override options loaded from config.   This will lay ground to more efficiently load clients that allow   passing in both session and auth plugin objects separately.  - When resoving a service endpoint, either fetch the requested interface,   or first try 'internal' and then 'public'.   This is done due to our config lacking any options to set the default   interface for service endpoints to use, and we've used 'internal' by   default, although DevStack has no such endpoints for most services   any more [0].   This will be changed again when gradually introducing usage of   keystoneauth Adapters to ironic.  - Remove get_admin_token method, it was used only in glance-related code   once, and was simply moved there.  [0] https://review.openstack.org/#/c/433272  
__label__testing Monasca role refactoring[+docs]  This patch refactors the whole monasca role by bringing consistency with the other openstack-ansible roles. Main changes include:   - Install services on its specific cointainer;   - monasca-thresh, monasca-notification and monasca-persister was     not being installed/configured, now it is;   - Tempest tests are ran for the whole monasca-api;   - The service should be fully functional;   - Added documentation.  The extras directory contains the changes necessary to openstack- ansible to setup monasca.  
__label__objective Monasca role refactoring[+docs]  This patch refactors the whole monasca role by bringing consistency with the other openstack-ansible roles. Main changes include:   - Install services on its specific cointainer;   - monasca-thresh, monasca-notification and monasca-persister was     not being installed/configured, now it is;   - Tempest tests are ran for the whole monasca-api;   - The service should be fully functional;   - Added documentation.  The extras directory contains the changes necessary to openstack- ansible to setup monasca.  
__label__quality Monasca role refactoring[+docs]  This patch refactors the whole monasca role by bringing consistency with the other openstack-ansible roles. Main changes include:   - Install services on its specific cointainer;   - monasca-thresh, monasca-notification and monasca-persister was     not being installed/configured, now it is;   - Tempest tests are ran for the whole monasca-api;   - The service should be fully functional;   - Added documentation.  The extras directory contains the changes necessary to openstack- ansible to setup monasca.  
__label__objective Monasca role refactoring[+docs]  This patch refactors the whole monasca role by bringing consistency with the other openstack-ansible roles. Main changes include:   - Install services on its specific cointainer;   - monasca-thresh, monasca-notification and monasca-persister was     not being installed/configured, now it is;   - Tempest tests are ran for the whole monasca-api;   - The service should be fully functional;   - Added documentation.  The extras directory contains the changes necessary to openstack- ansible to setup monasca.  
__label__refactoring Minor changes, non-functional refactoring.  
__label__refactoring [refactoring] simplify signature of _finish function  This is a follow-up to commit e05257035ca9dfa53c59ec5b7aa451dc061b452d.  
__label__quality Refactor resource.py/Resource  Create a class of 'Recource' to replace the original definition. It will bring several advantages.  1. The new class will be used as tuple which can't be modified, accessed by name or index.  2. The instance of new class can be hashable whatever the type of members of instace. So, it can be used in method of 'build_graph'.  3. Add some other functions to it, such as transform it to dict.  4. It is easy to chose members of it to be serialized by modifing the definition of property of 'Resource'.  
__label__objective Refactor resource.py/Resource  Create a class of 'Recource' to replace the original definition. It will bring several advantages.  1. The new class will be used as tuple which can't be modified, accessed by name or index.  2. The instance of new class can be hashable whatever the type of members of instace. So, it can be used in method of 'build_graph'.  3. Add some other functions to it, such as transform it to dict.  4. It is easy to chose members of it to be serialized by modifing the definition of property of 'Resource'.  
__label__objective Refactor resource.py/Resource  Create a class of 'Recource' to replace the original definition. It will bring several advantages.  1. The new class will be used as tuple which can't be modified, accessed by name or index.  2. The instance of new class can be hashable whatever the type of members of instace. So, it can be used in method of 'build_graph'.  3. Add some other functions to it, such as transform it to dict.  4. It is easy to chose members of it to be serialized by modifing the definition of property of 'Resource'.  
__label__refactoring Refactor volume restore function  
__label__quality WIP: refactor rest_utils  * Method rest_utils.get_all() was not composed efficiently enough.   It applied 'resource_function' to potentially load additional   fields even if only specific fields were requested by a user.   This patch fixes this by splitting the whole logic of the method   into cases when specific fields are requested and when they are   not.  
__label__objective WIP: refactor rest_utils  * Method rest_utils.get_all() was not composed efficiently enough.   It applied 'resource_function' to potentially load additional   fields even if only specific fields were requested by a user.   This patch fixes this by splitting the whole logic of the method   into cases when specific fields are requested and when they are   not.  
__label__quality Refactor template rendering, use entry point templates  Refactor the template rending code into a static function.  Ensure that templates for the entry point are rendered during execute, not the global templates.  
__label__objective Refactor template rendering, use entry point templates  Refactor the template rending code into a static function.  Ensure that templates for the entry point are rendered during execute, not the global templates.  
__label__quality Refactor Authorziation:  Merged the decorator logic into a single function that calls check_policy  Moved authorization logic in authorize.py  Prep for oslo-context fixes  
__label__refactoring Refactor block-device base functions.  As part of the final steps, refactor the bits belonging to block device and functions. This is a partial refactor from I3600c6a3d663c697b59d91bd3fbb5e408af345e4  
__label__quality Refactor block_device: passing command line parameters The original approach was to pass each and every command line parameter to the block device. While the block device functionality gets extended, this is not any longer practical. Instead of passing in all the parameters separately this patch collects these in a YAML file that is passed in to the block device layer. 
__label__objective Refactor block_device: passing command line parameters The original approach was to pass each and every command line parameter to the block device. While the block device functionality gets extended, this is not any longer practical. Instead of passing in all the parameters separately this patch collects these in a YAML file that is passed in to the block device layer. 
__label__quality Refactor the Hyper-V Layer 2 Agent  Refactor the layer 2 related modules in order to ease the adding of a new layer 2 agent with similar structure.  This patch add a couple of contract classes that contains the base functionalities of an agent.  
__label__objective Refactor the Hyper-V Layer 2 Agent  Refactor the layer 2 related modules in order to ease the adding of a new layer 2 agent with similar structure.  This patch add a couple of contract classes that contains the base functionalities of an agent.  
__label__refactoring Refactor config component  These changes are cosmetic, and aim to make it easier for users to navigate, read, and edit each config subsection. No underlying functionality has been changed.  
__label__quality Refactor config component  These changes are cosmetic, and aim to make it easier for users to navigate, read, and edit each config subsection. No underlying functionality has been changed.  
__label__quality VMware: Refactor vmdk unit tests  * Refactor unit tests for _create_backing and ImageDiskType so that each case is tested by a separate method.  * Use utility function to reduce code duplication.  
__label__testing VMware: Refactor vmdk unit tests  * Refactor unit tests for _create_backing and ImageDiskType so that each case is tested by a separate method.  * Use utility function to reduce code duplication.  
__label__quality Refactor waiters in our tempest plugin  Deduplicates some of the code between common.waiters module and BaremetalScenarioTest functions.  
__label__quality Refactor zun.service.js  There are many duplicated lines in zun.service.js. So this patch refactors this.  convertMemorySize function is unnecessary, due to the memory size unit was fixed as MiB. Also, this patch removes it.  
__label__objective Refactor: block-device partitioning cleanup  Now that the main partitioning refactor patch is merged, there is a small relict of handling partitions still in the disk-image-create main.  This patch moves the functionality from disk-image-create to the block-device/partitioning module: it is mostly a rewrite of the original bash code in python.  
__label__refactoring placement: refactor instance translate function  Makes the _allocations() object method of the SchedulerReportingClient into a simple module-level function called _instance_to_allocations_dict(). This makes the function name match what the returned result is and indicates what the function actually does.  
__label__refactoring placement: refactor translate from node to dict  This patch refactors the previous object method on the scheduler report client _compute_node_inventory() to being a module-level function called _compute_node_to_inventory_dict(). The spurious top-level 'inventories' key is removed from the returned dict and the payload for PUT /r-p/{uuid}/inventories is constructed explicitly now.  Refactors the unit tests for the report client that handle inventory to remove unnecessary mocking and correct some improper stub values that were being masked by the mocks.  
__label__testing placement: refactor translate from node to dict  This patch refactors the previous object method on the scheduler report client _compute_node_inventory() to being a module-level function called _compute_node_to_inventory_dict(). The spurious top-level 'inventories' key is removed from the returned dict and the payload for PUT /r-p/{uuid}/inventories is constructed explicitly now.  Refactors the unit tests for the report client that handle inventory to remove unnecessary mocking and correct some improper stub values that were being masked by the mocks.  
__label__objective Refactor check_example to be clearer on error  Currently the check_example in test_functional computes sums and on error tells the developer the difference in sums, which is confusing and error prone.  It also leads to false positives where sums may be correct, but the exact number of MEDIUM, HIGH, etc is different. This was the case for two tests: test_xml and test_secret_config_option.  
__label__quality Refactor check_example to be clearer on error  Currently the check_example in test_functional computes sums and on error tells the developer the difference in sums, which is confusing and error prone.  It also leads to false positives where sums may be correct, but the exact number of MEDIUM, HIGH, etc is different. This was the case for two tests: test_xml and test_secret_config_option.  
__label__quality Refactor rpc backend vhost creation  The creation of the cellsv1 rpc vhost was buried in the restart function, which makes it hard to extend. This breaks it out into a helper method and moves the conditional logic into the nova module itself.  
__label__quality DB code refactor, simplify and clean-up  * Centralized the common function is_image_visible * Removed unused copy/paste version of is_image_mutable  
__label__quality Refactor docker cmd arg building  This change refactors the arg building so that the logic is contained in dedicated functions for 'docker run' and 'docker exec', instead of being split between the main loop and docker_arg_map.  Minor changes in behaviour which don't affect the tests include: - No longer force ascii encoding of arg values - Extra check to ensure the command is a list before extending cmd - Remove the unicode/empty-string list value check  
__label__testing Refactor extensions to align with upstream  Upstream moved ExtensionDescriptor into neutron-lib as well as some functionality revolved around retrieving the plugin from NeutronManager. This refactor moves libraries around in order to align quark with upstream neutron's expectations.  JIRA:NCP2115 
__label__quality Refactor NetworkDeviceById to use format_variables  To remove duplicate code, this commit refactors the NetworkDeviceById get method to make use of the format_variables function in resources.utils.  
__label__quality Refactoring of proxy.py, stage one  This reduces the usage of member variables in favor of a dictionary containing details. Now almost all the details are set in a new function get_details.  Though this is a first good step, more work needs to be done in follow-up patches.  
__label__quality Refactor kustomization of env vars  This tweaks the generation of the env-vars catalogue to be done in the airshipctl-catalogues function itself, resulting in a vanilla catalogue that can be imported as a resource across the phases that need it.  
__label__quality Refactor Phase and Document components  Moves all phase related functionality to the Phase component, and document functionality (currently just doc pull) to the Document component. Also refactors backend code to ensure phase and document messages are handled by separate handlers.  
__label__objective Refactor Phase and Document components  Moves all phase related functionality to the Phase component, and document functionality (currently just doc pull) to the Document component. Also refactors backend code to ensure phase and document messages are handled by separate handlers.  
__label__refactoring Refactor Phase and Document components  Moves all phase related functionality to the Phase component, and document functionality (currently just doc pull) to the Document component. Also refactors backend code to ensure phase and document messages are handled by separate handlers.  
__label__quality refactoring of change validation functions  
__label__objective Code refactoring - EntityGraph class functionality moved to a processor utils  
__label__refactoring Code refactoring - EntityGraph class functionality moved to a processor utils  
__label__testing Code refactoring - EntityGraph class functionality moved to a processor utils  
__label__objective Refactor recon to use single md5_hash_for_file function  There were several implementations of hashing the content of a file in cli/recon.py and common/middleware/recon.py. This patch relocates one implementation (_hash_for_ringfile, introduced in the Related Change) to common/utils.py and refactors recon cli and middleware to use that function.  Also improves use of mocking in the unit tests to eliminate passing custom file opener functions to the ReconMiddleware get_ring_md5 and get_swift_conf_md5 methods.  Related-Change: I23b5e0a8082b30ca257aeb1fab03ab74e6f0b2d4  
__label__testing Refactor recon to use single md5_hash_for_file function  There were several implementations of hashing the content of a file in cli/recon.py and common/middleware/recon.py. This patch relocates one implementation (_hash_for_ringfile, introduced in the Related Change) to common/utils.py and refactors recon cli and middleware to use that function.  Also improves use of mocking in the unit tests to eliminate passing custom file opener functions to the ReconMiddleware get_ring_md5 and get_swift_conf_md5 methods.  Related-Change: I23b5e0a8082b30ca257aeb1fab03ab74e6f0b2d4  
__label__objective Refactor project and domain scoping  Moves the project and domain logic into their own functions inside the plugin object.  
__label__testing Models refactoring  - Add unit tests for models - Avoid default method arguments with mutable values - Simplify object serialization/unserialization - Model objects are self-contained and do not use global functions - Do not hardcode specific image metadata in the code - Rename "os" key to the standard name "image_meta" - Both keys "os" and "image_meta" are stored in the db for backward compatibility  
__label__refactoring Models refactoring  - Add unit tests for models - Avoid default method arguments with mutable values - Simplify object serialization/unserialization - Model objects are self-contained and do not use global functions - Do not hardcode specific image metadata in the code - Rename "os" key to the standard name "image_meta" - Both keys "os" and "image_meta" are stored in the db for backward compatibility  
__label__quality Models refactoring  - Add unit tests for models - Avoid default method arguments with mutable values - Simplify object serialization/unserialization - Model objects are self-contained and do not use global functions - Do not hardcode specific image metadata in the code - Rename "os" key to the standard name "image_meta" - Both keys "os" and "image_meta" are stored in the db for backward compatibility  
__label__objective NFP - Refactor to support extensions such as network device cluster  Refactor orchestrator to support network function device cluster framework and more granular events.  
__label__refactoring Trivial refactor of session var in reset_stack_status  Non-functional change.  
__label__objective Refactor the source code of infra_driver/openstack  In order to support Senlin driver for vnf auto-scaling management, need to add auto-scaling backend switch function. But the openstack infra_driver's source codes are using too many inner methods, that is difficult to read, not feasible to change, and also difficult to test. This patch refactors the source code for the first step.  
__label__objective NFP - Refactor to support extensions such as network device cluster  Refactor orchestrator to support network function device cluster framework and more granular events.  
__label__objective Refactor, add encrypt/decrypt data dict functions to crypt  Just a refactor, no change in functionality.  The functions added to crypt are used to encrypt / decrypt resource properties data dicts. Note that they should not be used for encrypting / decrypting other things such as params or user creds (which are just strings).  An intermediate json conversion of each value in a dict takes place before it is encrypted/decrypted.  
__label__quality Refactor tox to reduce duplication  - Updated envlist, so just running `tox` from the CLI will now run all voting gate tests - Reduce duplicated definitions and commands - Remove any reliance on run_tests within tox - Add the LOCALE_PATHS setting to settings.py, so that `tox -e manage makemessages` functions correctly. This is already documented in the Django settings docs, so I haven't duplicated anything in our own docs  
__label__testing Refactor tox to reduce duplication  - Updated envlist, so just running `tox` from the CLI will now run all voting gate tests - Reduce duplicated definitions and commands - Remove any reliance on run_tests within tox - Add the LOCALE_PATHS setting to settings.py, so that `tox -e manage makemessages` functions correctly. This is already documented in the Django settings docs, so I haven't duplicated anything in our own docs  
__label__objective Inventory filesystem refactor load funcs moved  The last uses of the builtin os module are removed from generate as the load_environment and load_user_configuration functions are moved, along with the _extra_config method they rely upon. This also moves the last use of the yaml module.  These functions are not refactored to make use of the other funcs available in the filesystem package, and as a result there is still an undesirable use of the dir_find func in the generate script. These will all be cleaned up in a following patch to keep this easier to review.  An unused left-over function is removed now that there are no merge conflicts introduced by it.  A debug logging message is formatted consistent to other messages; the only impact in this case is applying consistency in log message formatting since the formatting was only occuring when the log level is activated already.  
__label__quality Inventory filesystem refactor load funcs moved  The last uses of the builtin os module are removed from generate as the load_environment and load_user_configuration functions are moved, along with the _extra_config method they rely upon. This also moves the last use of the yaml module.  These functions are not refactored to make use of the other funcs available in the filesystem package, and as a result there is still an undesirable use of the dir_find func in the generate script. These will all be cleaned up in a following patch to keep this easier to review.  An unused left-over function is removed now that there are no merge conflicts introduced by it.  A debug logging message is formatted consistent to other messages; the only impact in this case is applying consistency in log message formatting since the formatting was only occuring when the log level is activated already.  
__label__refactoring Inventory filesystem refactor load funcs moved  The last uses of the builtin os module are removed from generate as the load_environment and load_user_configuration functions are moved, along with the _extra_config method they rely upon. This also moves the last use of the yaml module.  These functions are not refactored to make use of the other funcs available in the filesystem package, and as a result there is still an undesirable use of the dir_find func in the generate script. These will all be cleaned up in a following patch to keep this easier to review.  An unused left-over function is removed now that there are no merge conflicts introduced by it.  A debug logging message is formatted consistent to other messages; the only impact in this case is applying consistency in log message formatting since the formatting was only occuring when the log level is activated already.  
__label__quality start refactoring validation code  We need to expand the validation code to include branches. Rather than continuing to grow the logic in one very large function, start splitting it up.  
__label__testing Refactor skip-if tests to use irrelevant-files  Skip-if has been removed in favor of irrelevant-files and the branch matchers. This refactors the tests that used to be used for skip-if to cover irrelevant-files.  There may still be need to cover the other types of matchers.  The 'test_parse_skip_if' has just been removed as it wasn't really covering anything not also covered by the functional tests.  
__label__quality Refactoring: Make code decomposition  * Move code responsible for endpoint creation and update   to reusable functions `_create_endpoint`, `_update_endpoint`  
__label__quality Refactor get_manager_for_store in an OO manner  get_manager_for_store is a weird function that switches based on the class type of the first parameter. This is an odd throw back to pre object orientated days where the object defines what it wants. Refactor it to put the class on the object.  
__label__quality Refactor of _convert_fwaas_to_iptables_rule and dependencies  In iptables_fwaas*.py, the function _convert_fwaas_to_iptables_rule prepare and array of all potential '-arg value' adding an extra-space for each unused argument. The refactor code deal with each element between spaces separately , for example, '-arg' 'value', etc... in the array (like done in the security groups part of neutron). The main advantage is much better performance when applied to a router (during difflib.ndiff) as we have exactly same syntax between what expected and iptables-save result.  
__label__quality Refactor charm to work with declarative-changes  This is a refactor of the charm (no new functionality) to work with the declarative helpers in charms.openstack.  This means that much of the boiler plate has disappeared from the charm and into charms.openstack including the tests.  
__label__testing Refactor charm to work with declarative-changes  This is a refactor of the charm (no new functionality) to work with the declarative helpers in charms.openstack.  This means that much of the boiler plate has disappeared from the charm and into charms.openstack including the tests.  
__label__quality placement: refactor instance translate function  Makes the _allocations() object method of the SchedulerReportingClient into a simple module-level function called _instance_to_allocations_dict(). This makes the function name match what the returned result is and indicates what the function actually does.  
__label__testing placement: refactor instance translate function  Makes the _allocations() object method of the SchedulerReportingClient into a simple module-level function called _instance_to_allocations_dict(). This makes the function name match what the returned result is and indicates what the function actually does.  
__label__quality placement: refactor translate from node to dict  This patch refactors the previous object method on the scheduler report client _compute_node_inventory() to being a module-level function called _compute_node_to_inventory_dict(). The spurious top-level 'inventories' key is removed from the returned dict and the payload for PUT /r-p/{uuid}/inventories is constructed explicitly now.  Refactors the unit tests for the report client that handle inventory to remove unnecessary mocking and correct some improper stub values that were being masked by the mocks.  
__label__testing placement: refactor translate from node to dict  This patch refactors the previous object method on the scheduler report client _compute_node_inventory() to being a module-level function called _compute_node_to_inventory_dict(). The spurious top-level 'inventories' key is removed from the returned dict and the payload for PUT /r-p/{uuid}/inventories is constructed explicitly now.  Refactors the unit tests for the report client that handle inventory to remove unnecessary mocking and correct some improper stub values that were being masked by the mocks.  
__label__testing Refactor functional tests  1. Move all schema tests to separate file 2. Group all functional tests by their meaning 3. Move testing router to functional/__init__.py file 4. Get rid of lifecycle test, because it duplicate the functionality of other existing tests.  
__label__quality Translations: Refactor cleanup  All functions use now the same three cleanup routines, use a separate routine for them.  
__label__quality [Trivial] Refactor libvirt inspector connection & uri  libvirt inpsector has an attribute called `uri`, which only used when connecting to libvirtd. There is no such need to do so, a local variable can do it as well.  Meanwhile, we initialize connection by calling a method `_get_connection`, and there is an attribute ``connection`` holds the returned value. This method can be replaced with a property `connection`, to shorten typing and avoid function calling style.  
__label__objective Refactor resource definition parsing in HOT/cfn  Parse each field in a resource definition individually instead of all in one go. This allows the HOT and cfn formats to apply different parsing to different fields - specifically in the future we want to parse the condition field like a condition, using only the valid condition functions.  
__label__quality Refactor boolean condition functions  
__label__refactoring Refactor boolean condition functions  
__label__quality Refactor affinity policy  This patch moves the unility functions related to nova calls up to the base class.  
__label__quality Refactor process starting functions  This patch refactors functions related to process launching (spawn_subprocess, wait_for_daemon_to_initialize and process_start_daemon), so that they can be just utility functions to manage storlet daemon.  
__label__quality Refactor process_kill and process_kill_all  This patch refactors two functions in daemon_factory, process_kill and process_kill_all, to make them as just utility functions to manage storlet daemon.  
__label__quality WIP: Refactor status functions  
__label__objective Refactor shutdown functions  This patch refactors two functions in daemon_factory, shutdown_process and shutdown_all_processes, to make them as just utility functions to manage storlet daemon.  
__label__objective Refactor shutdown functions  This patch refactors two functions in daemon_factory, shutdown_process and shutdown_all_processes, to make them as just utility functions to manage storlet daemon.  
__label__testing Refactor processing of node list settings  Methods related to node list sorting, filtering functionality and role management are moved to a separate component.  Closes-Bug: #1615558  
__label__testing Fix functional tests broken by the latest refactoring  Depends-On: I39ca8220940d0aca76131f85bbec1fc94a5411d6 
__label__testing Refactor merge_dicts helper function tests  merge_dicts function wasn't covered with all the needed tests and had some issues in code. So it's refactored.  Additionaly used here function merge_lists was refactored.  
__label__testing Refactors nova.cmd utils  Some of functions used in the nova.cmd modules are duplicated or they can be reused in future modules.  Adds docstrings to the refactored functions.  Adds unit tests to the refactored functions.  
__label__objective Refactor "get_instance_info" gathering  This change re-factors the "get_instance_info" function so that its logging everything to a file instead of stdout. This will help folks with debugging the gate. The function was logging most of important data to stdout which is only trapped by the main playbook run and caused someone to load the entire run output to get useful information about the environment.  In addition to logging everything to a file the custom fact gathering commands we were running have been removed in-favor of simply running the ansible setup module which will provide a lot more data in a format that is far easier to consume.  
__label__quality Refactoring networks.js library  Changes: Class structure implementation Css selectors splitting and reworking Functions rework due to new class and selectors structure Code cleanup Mistakes fixing  
__label__refactoring Refactoring networks.js library  Changes: Class structure implementation Css selectors splitting and reworking Functions rework due to new class and selectors structure Code cleanup Mistakes fixing  
__label__quality Refactor some process launching functions in daemon factory  
__label__quality Refactor sqlalchemy service methods  This patch refactors the sqlalchemy DB methods related to the service to consolidate the methods into the minimum number that is actually needed, to reduce the number of DB calls per operation, and to reduce the data retrieved from the DB server.  For method consolidation the patch removes `service_get_by_host_and_topic`, `service_get_by_args`, `service_get_all_by_topic`, and `service_get_all_by_binary`, and includes the functionality provided by those methods in `service_get` and `service_get_all` methods.  To reduce the number of DB calls we won't retrieve the service from the DB when deleting or updating a service.  And to reduce the data retrieved from the DB we filter UP nodes in the DB instead of locally.  This patch is related to the efforts to support HA A/A in c-vol nodes. Job distribution patches are dependent on this one.  Specs: https://review.openstack.org/232595/  Implements: blueprint cinder-volume-active-active-support 
__label__quality Refactor functions which read astute yaml directly  * Fuctions should not be reading astute yaml directly   because it will break a lot of things * Functions should use data provided through their arguments  Rally-ID: US717768 
__label__quality Refactor function which read astute yaml directly  * Fuctions should not be reading astute yaml directly   because it will break a lot of things * Functions should use data provided through their arguments  Rally-ID: US717768 
__label__quality Refactored service_definition.py into service_resources.yaml  - Refactor only, not a blue-print nor bug-fix. - Refactored service_definition.py which was a python code file acting   as a configuration file, into server_resources.yaml.  This allows us   to modify configuration, instead of code.  It also allows to add   configuration properties at any level... service, pod, or container if   necessary in the future. - Added caching to Pathfinder._find_dir so that we hit disk a lot less.  - Added objects for Service, Pod, and Container to service_resources.py.   This paves the way in the future to add actions on each of these.  For   example, we today have a functional _bootstrap_service('mariadb').  In   the future, we can do 's = Service('mariadb'); s.bootstrap();   s.verify(); s.kill()'.  We can also add methods to query status   directly from Kubernetes API.  This code reorg allows us to structure   this nicely for future additions.  
__label__quality Refactor airshipctl root command  As part of config refactoring process, we have to prepare root level command to future changes, optimize function signatures and its logic.  
__label__refactoring Refactor airshipctl root command  As part of config refactoring process, we have to prepare root level command to future changes, optimize function signatures and its logic.  
__label__refactoring Refactor common code for tripleo-ci  This commit refactors out some reusable pieces of tripleo-ci into common_functions.sh and common_vars.bash. This is in preparation for adding ovb and multinode support.  
__label__quality Refactor common code for tripleo-ci  This commit refactors out some reusable pieces of tripleo-ci into common_functions.sh and common_vars.bash. This is in preparation for adding ovb and multinode support.  
__label__quality Refactor ceilometer transformer  Transitioned to new transformer class to have cleaner and smaller code. Refactored tests to easily handle multiple transformers tests. Modified BaseTransformer to ensure all data is passed to custom functions.  
__label__testing Refactor ceilometer transformer  Transitioned to new transformer class to have cleaner and smaller code. Refactored tests to easily handle multiple transformers tests. Modified BaseTransformer to ensure all data is passed to custom functions.  
__label__objective Refactor ceilometer transformer  Transitioned to new transformer class to have cleaner and smaller code. Refactored tests to easily handle multiple transformers tests. Modified BaseTransformer to ensure all data is passed to custom functions.  
__label__refactoring Add support to update segment host binding with no agent topology  Trival refactor to make topology without l2 agent(networking ovn) can use the functions to update segment host binding.  
__label__objective Refactors service url retrieval  This patch introduces functionality to set service URLs in the app.conf file, either to:  - add service urls which aren't part of the serviceCatalog yet - override service urls exposed through the serviceCatalog  Closes-Bug: 1586364  
__label__objective Refactors service url retrieval  This patch introduces functionality to set service URLs in the app.conf file, either to:  - add service urls which aren't part of the serviceCatalog yet - override service urls exposed through the serviceCatalog  Closes-Bug: 1586364  
__label__objective Refactor check_valid_auth_options function  The function check_valid_auth_options() function was relying on the name for checking the set of required options, but this could cause errors with external auth plugins. If somebody defines an auth plugin plugin named "footoken" the check function would check for a "token" option, even if the plugin has not defined that option. This change tries to improve this situation, cheking for some options only if they have been defined in the plugin.  
__label__objective Refactor check_valid_auth_options function  The function check_valid_auth_options() function was relying on the name for checking the set of required options, but this could cause errors with external auth plugins. If somebody defines an auth plugin plugin named "footoken" the check function would check for a "token" option, even if the plugin has not defined that option. This change tries to improve this situation, cheking for some options only if they have been defined in the plugin.  
__label__refactoring Refactor local_action SCP task into function  This allows use to reused the logic, for the following patchset.  
__label__quality Refactor local_action SCP task into function  This allows use to reused the logic, for the following patchset.  
__label__objective Puppet4 support: refactor vips  The generate_vips function is refactored to work in pair with the create_resources functions. It's much better for testing and debugging. Input data of the vurual ip definition is split into many parameters and the generate vips function is tought to support the changed interfacs as well as to work with Puppet4's undef values.  
__label__testing Puppet4 support: refactor vips  The generate_vips function is refactored to work in pair with the create_resources functions. It's much better for testing and debugging. Input data of the vurual ip definition is split into many parameters and the generate vips function is tought to support the changed interfacs as well as to work with Puppet4's undef values.  
__label__objective Puppet4 support: refactor vips  The generate_vips function is refactored to work in pair with the create_resources functions. It's much better for testing and debugging. Input data of the vurual ip definition is split into many parameters and the generate vips function is tought to support the changed interfacs as well as to work with Puppet4's undef values.  
__label__quality Refactor: remove unused functions  There were a couple of functions which were unused: ensure_nbd, map_nbd, unmount_qcow_image, mount_qcow_image, ensure_sudo Because some of them use 'trap ... EXIT' this hinders introducing a separate exit phase - therefore they are removed.  (It would also be impossible to use them in the current setup, because they overwrite the 'trap ... EXIT' of the disk-image-creates 'main'.)  
__label__objective Refactor: remove unused functions  There were a couple of functions which were unused: ensure_nbd, map_nbd, unmount_qcow_image, mount_qcow_image, ensure_sudo Because some of them use 'trap ... EXIT' this hinders introducing a separate exit phase - therefore they are removed.  (It would also be impossible to use them in the current setup, because they overwrite the 'trap ... EXIT' of the disk-image-creates 'main'.)  
__label__quality Refactor test_ipam functional testing module  Use existing testing ifrastructure to better integrate with the rest of Neutron tests. This change allows test_ipam module to work with future db engine facade changes.  
__label__testing Refactor test_ipam functional testing module  Use existing testing ifrastructure to better integrate with the rest of Neutron tests. This change allows test_ipam module to work with future db engine facade changes.  
__label__objective Refactor test_ipam functional testing module  Use existing testing ifrastructure to better integrate with the rest of Neutron tests. This change allows test_ipam module to work with future db engine facade changes.  
__label__refactoring Tempest Refactoring (Part 1)  There were UTs for APIs under directory "tests/functional", have moved it under "tests/unit" directory. Modified the code accordingly.  In future(next commit), the tempest testcases will also be under kingbird/tests.  
__label__refactoring Refactor collect_usage function  
__label__testing Test and refactor argument parsing  This patch does not change functionality of the argument parsing function, but does make it easier to test. While argparse has its own tests within the standard library and the `args` function could theoretically be excluded, including these simple tests provide the coverage we need without introducing the possibility of skipping over code that might be added later.  
__label__objective Test and refactor argument parsing  This patch does not change functionality of the argument parsing function, but does make it easier to test. While argparse has its own tests within the standard library and the `args` function could theoretically be excluded, including these simple tests provide the coverage we need without introducing the possibility of skipping over code that might be added later.  
__label__testing Refactor server side copy as middleware  This is the first draft and far from complete. Failing unit tests need some major changes. Posted to get some early comments. Currently, this change is dependant on Thiago's versioned writes middleware change.  Rewrite server side copy and 'object post as copy' feature as middleware to simplify the PUT method in the object controller code. COPY is no longer a verb implemented as public method in Proxy application.  With this change, there should be no change in funcionality or existing behavior. This is asserted with (almost) no changes required to existing functional tests.  Some notes (for operators): * Middleware required to be auto-inserted after versioned_writes, slo and dlo. * Turning off server side copy is not configurable. * object_post_as_copy is no longer a configurable option of proxy server   but of this middleware.  TODO: * Fix/Write unit tests * Documentation * Figure out why testCopyAccount404s functest fails  
__label__quality Refactor server side copy as middleware  This is the first draft and far from complete. Failing unit tests need some major changes. Posted to get some early comments. Currently, this change is dependant on Thiago's versioned writes middleware change.  Rewrite server side copy and 'object post as copy' feature as middleware to simplify the PUT method in the object controller code. COPY is no longer a verb implemented as public method in Proxy application.  With this change, there should be no change in funcionality or existing behavior. This is asserted with (almost) no changes required to existing functional tests.  Some notes (for operators): * Middleware required to be auto-inserted after versioned_writes, slo and dlo. * Turning off server side copy is not configurable. * object_post_as_copy is no longer a configurable option of proxy server   but of this middleware.  TODO: * Fix/Write unit tests * Documentation * Figure out why testCopyAccount404s functest fails  
__label__objective Refactor server side copy as middleware  This is the first draft and far from complete. Failing unit tests need some major changes. Posted to get some early comments. Currently, this change is dependant on Thiago's versioned writes middleware change.  Rewrite server side copy and 'object post as copy' feature as middleware to simplify the PUT method in the object controller code. COPY is no longer a verb implemented as public method in Proxy application.  With this change, there should be no change in funcionality or existing behavior. This is asserted with (almost) no changes required to existing functional tests.  Some notes (for operators): * Middleware required to be auto-inserted after versioned_writes, slo and dlo. * Turning off server side copy is not configurable. * object_post_as_copy is no longer a configurable option of proxy server   but of this middleware.  TODO: * Fix/Write unit tests * Documentation * Figure out why testCopyAccount404s functest fails  
__label__quality Refactor server side copy as middleware  This is the first draft and far from complete. Failing unit tests need some major changes. Posted to get some early comments. Currently, this change is dependant on Thiago's versioned writes middleware change.  Rewrite server side copy and 'object post as copy' feature as middleware to simplify the PUT method in the object controller code. COPY is no longer a verb implemented as public method in Proxy application.  With this change, there should be no change in funcionality or existing behavior. This is asserted with (almost) no changes required to existing functional tests.  Some notes (for operators): * Middleware required to be auto-inserted after versioned_writes, slo and dlo. * Turning off server side copy is not configurable. * object_post_as_copy is no longer a configurable option of proxy server   but of this middleware.  TODO: * Fix/Write unit tests * Documentation * Figure out why testCopyAccount404s functest fails  
__label__refactoring Refactoring tests/setup_functional_tests.sh  Moving all storlets installation to install/storlet/install_storlets.sh  
__label__refactoring Refactor extract code to function in auth.py  Code for applying filters to the urls in the KeystoneV*AuthProvider classes was copy-pasted. Extracting the copied code to a function so that fixes can be made in one place.  
__label__objective Refactor extract code to function in auth.py  Code for applying filters to the urls in the KeystoneV*AuthProvider classes was copy-pasted. Extracting the copied code to a function so that fixes can be made in one place.  
__label__refactoring Refactor DataTable filtering functions into mixin  Move DataTable filtering related functions into a mixin class so that other classes can use filtering in their tables. Namely, in this patch, the TabbedTableView class.  
__label__objective Refactor DataTable filtering functions into mixin  Move DataTable filtering related functions into a mixin class so that other classes can use filtering in their tables. Namely, in this patch, the TabbedTableView class.  
__label__objective Refactor of BaseTestCase  To run integratin tests, there needs to be set environment variable INTEGRATION_TESTS. In past, positive behaviour was enclosed in one big 'if' branch. I've moved negative behaviour to beginning and len rest of method as ordinary function body.  Closes-Bug: 1463729 
__label__testing Refactor of BaseTestCase  To run integratin tests, there needs to be set environment variable INTEGRATION_TESTS. In past, positive behaviour was enclosed in one big 'if' branch. I've moved negative behaviour to beginning and len rest of method as ordinary function body.  Closes-Bug: 1463729 
__label__objective Refactor of BaseTestCase  To run integratin tests, there needs to be set environment variable INTEGRATION_TESTS. In past, positive behaviour was enclosed in one big 'if' branch. I've moved negative behaviour to beginning and len rest of method as ordinary function body.  Closes-Bug: 1463729 
__label__refactoring [Reports] Refactor processing.plot.plot  Move part of code into separate function because it will be re-used in upcoming function processing.plot.trends (will be introduced in further patches)  
__label__quality [Reports] Refactor processing.plot.plot  Move part of code into separate function because it will be re-used in upcoming function processing.plot.trends (will be introduced in further patches)  
__label__integration Refactor plugin to depend on controller galera and rabbitmq  Now with advanced task deployment features, we can deploy detached-keystone during the middle of controller deployment and no longer require separated database plugin.  As a consequence this fixes ceilometer deployment as well, which requires RabbitMQ to be functioning.  
__label__objective Refactor plugin to depend on controller galera and rabbitmq  Now with advanced task deployment features, we can deploy detached-keystone during the middle of controller deployment and no longer require separated database plugin.  As a consequence this fixes ceilometer deployment as well, which requires RabbitMQ to be functioning.  
__label__quality Refactor is_pkg_installed function  * Should return false instead of errors * Correct package status processing  
__label__refactoring Refactor is_pkg_installed function  * Should return false instead of errors * Correct package status processing  
__label__refactoring Refactoring functions in checkers.py(part 3)  Following functions were changed:   * external_ntp_check   * check_available_mode   * check_auto_mode   * is_ntpd_active   * wait_phrase_in_log   * get_package_versions_from_node  Folowing functions were moved to utils.py:   * wait_phrase_in_log   * get_package_versions_from_node  Related tests are also modified. Implements: blueprint sshmanager-integration  
__label__objective Refactoring functions in checkers.py(part 3)  Following functions were changed:   * external_ntp_check   * check_available_mode   * check_auto_mode   * is_ntpd_active   * wait_phrase_in_log   * get_package_versions_from_node  Folowing functions were moved to utils.py:   * wait_phrase_in_log   * get_package_versions_from_node  Related tests are also modified. Implements: blueprint sshmanager-integration  
__label__refactoring Refactoring functions in chekers.py(part 2)  Following functions was changed:   * get_ceph_partitions   * get_mongo_partitions  Folowing functions was moved to utils.py:   * get_mongo_partitions   * get_ceph_partitions Related tests are also modified. Implements: blueprint sshmanager-integration  
__label__objective Refactoring functions in chekers.py(part 2)  Following functions was changed:   * get_ceph_partitions   * get_mongo_partitions  Folowing functions was moved to utils.py:   * get_mongo_partitions   * get_ceph_partitions Related tests are also modified. Implements: blueprint sshmanager-integration  
__label__quality CDH plugin config helper refactoring  This commit encapulate CDH plugin config_helper into class for a better extensibility. Changes in config_helper: * Create sahara/plugins/cdh/config_helper.py and move general parts to   ConfigHelper. * Provide an instance of ConfigHelper to minimize changes outside. * Remove function _prepare_value and use lambda instead. * Add method _load_and_init_configs to load files and convert dict to   Config object * Move some long string into file  Changes outside config_helper: * change mudules depending on config helper to import config_helper.config  
__label__objective CDH plugin config helper refactoring  This commit encapulate CDH plugin config_helper into class for a better extensibility. Changes in config_helper: * Create sahara/plugins/cdh/config_helper.py and move general parts to   ConfigHelper. * Provide an instance of ConfigHelper to minimize changes outside. * Remove function _prepare_value and use lambda instead. * Add method _load_and_init_configs to load files and convert dict to   Config object * Move some long string into file  Changes outside config_helper: * change mudules depending on config helper to import config_helper.config  
__label__objective CDH plugin config helper refactoring  This commit encapulate CDH plugin config_helper into class for a better extensibility. Changes in config_helper: * Create sahara/plugins/cdh/config_helper.py and move general parts to   ConfigHelper. * Provide an instance of ConfigHelper to minimize changes outside. * Remove function _prepare_value and use lambda instead. * Add method _load_and_init_configs to load files and convert dict to   Config object * Move some long string into file  Changes outside config_helper: * change mudules depending on config helper to import config_helper.config  
__label__objective Refactoring of smart-types defined in DSL  * MuranoType and MuranoObjectParameterType smart types   were merged into a single smart type because their functionality   overlap to a large degree. New smart type is called MuranoObjectParameter * Other smart types were renamed to have the same name pattern:    ThisParameterType -> ThisParameter, InterfacesParameterType -> InterfacesParameter * For MuranoObjectInterface instead of saying obj.data().propertyName the syntax now is    obj.properties.propertyName  
__label__objective Refactoring of smart-types defined in DSL  * MuranoType and MuranoObjectParameterType smart types   were merged into a single smart type because their functionality   overlap to a large degree. New smart type is called MuranoObjectParameter * Other smart types were renamed to have the same name pattern:    ThisParameterType -> ThisParameter, InterfacesParameterType -> InterfacesParameter * For MuranoObjectInterface instead of saying obj.data().propertyName the syntax now is    obj.properties.propertyName  
__label__refactoring Refactoring functions in chekers.py(part 1)  Folowing functions was chenged:   * check_update_network_data_over_cli   * check_get_network_data_over_cli   * check_offload   * check_client_smoke   * check_hiera_hosts   * check_log_lines_order   * check_file_exists  Related tests are also modified. Some typos are fixed. Implements: blueprint sshmanager-integration  
__label__testing Refactoring functions in chekers.py(part 1)  Folowing functions was chenged:   * check_update_network_data_over_cli   * check_get_network_data_over_cli   * check_offload   * check_client_smoke   * check_hiera_hosts   * check_log_lines_order   * check_file_exists  Related tests are also modified. Some typos are fixed. Implements: blueprint sshmanager-integration  
__label__objective Timeout module refactoring  After a series of changes run_with_timeout became very strange. In case of timeout it doesn't raise TimeoutError, defined in this module, but instead returns default argument. Also it's impossible to distinguish if timeout reached or user pressed ctrl-C, because thread.interrupt_main raises KeyboardInterrupt in the main thread.  So let's rewrite this run_with_timeout function, so it will raise either TimeoutError or KeyboardInterrupt. In this case default argument is not needed. Since it will always raise an exception in case of error.  Also fix usage of this function and add unit tests mostly from I5176b9adee1538c2a7d476a95e551027c8ccb444 change.  
__label__testing Timeout module refactoring  After a series of changes run_with_timeout became very strange. In case of timeout it doesn't raise TimeoutError, defined in this module, but instead returns default argument. Also it's impossible to distinguish if timeout reached or user pressed ctrl-C, because thread.interrupt_main raises KeyboardInterrupt in the main thread.  So let's rewrite this run_with_timeout function, so it will raise either TimeoutError or KeyboardInterrupt. In this case default argument is not needed. Since it will always raise an exception in case of error.  Also fix usage of this function and add unit tests mostly from I5176b9adee1538c2a7d476a95e551027c8ccb444 change.  
__label__objective Timeout module refactoring  After a series of changes run_with_timeout became very strange. In case of timeout it doesn't raise TimeoutError, defined in this module, but instead returns default argument. Also it's impossible to distinguish if timeout reached or user pressed ctrl-C, because thread.interrupt_main raises KeyboardInterrupt in the main thread.  So let's rewrite this run_with_timeout function, so it will raise either TimeoutError or KeyboardInterrupt. In this case default argument is not needed. Since it will always raise an exception in case of error.  Also fix usage of this function and add unit tests mostly from I5176b9adee1538c2a7d476a95e551027c8ccb444 change.  
__label__objective Refactor scaling policy implementation  This patch reworks the scaling policy v1.0 to use common utility functions for parameter validation. Another change made is about whether we count ERROR nodes when doing scaling. Previously, we exclude them when calculating current size. However, that might be wrong. We should always do things consistently.  
__label__objective Refactor scaling policy implementation  This patch reworks the scaling policy v1.0 to use common utility functions for parameter validation. Another change made is about whether we count ERROR nodes when doing scaling. Previously, we exclude them when calculating current size. However, that might be wrong. We should always do things consistently.  
__label__quality Refactor the signing backends  Prepare for new signing backend implementations which reuse the existing functionality. This abstracts most of the current signing function, so that the signature generation itself can be replaced.  
__label__objective Refactor the signing backends  Prepare for new signing backend implementations which reuse the existing functionality. This abstracts most of the current signing function, so that the signature generation itself can be replaced.  
__label__objective Refactor the signing backends  Prepare for new signing backend implementations which reuse the existing functionality. This abstracts most of the current signing function, so that the signature generation itself can be replaced.  
__label__refactoring Refactor security group functional tests  Moved the functional tests for "os security group" and "os security group rule" from the compute to the network directory to align with the refactoring to the commands.  
__label__objective Refactor security group functional tests  Moved the functional tests for "os security group" and "os security group rule" from the compute to the network directory to align with the refactoring to the commands.  
__label__objective refactor generator._list_opts for further enhancement  The _list_opts() function combines the behavior for loading the options and the behavior for cleaning and filtering them. This patch breaks it up a bit and updates the relevant tests, to prepare for the next patch which will add some new behavior to _list_opts().  
__label__testing refactor generator._list_opts for further enhancement  The _list_opts() function combines the behavior for loading the options and the behavior for cleaning and filtering them. This patch breaks it up a bit and updates the relevant tests, to prepare for the next patch which will add some new behavior to _list_opts().  
__label__objective refactor generator._list_opts for further enhancement  The _list_opts() function combines the behavior for loading the options and the behavior for cleaning and filtering them. This patch breaks it up a bit and updates the relevant tests, to prepare for the next patch which will add some new behavior to _list_opts().  
__label__refactoring Pecan: controller refactor and extended functional tests  This patch refactors the pecan controllers by streamlining the code and splitting them in separate python modules. It als improves functional testing for most of these controllers.  Please note that functional tests for Pecan hooks are not part of these patch.  
__label__testing Pecan: controller refactor and extended functional tests  This patch refactors the pecan controllers by streamlining the code and splitting them in separate python modules. It als improves functional testing for most of these controllers.  Please note that functional tests for Pecan hooks are not part of these patch.  
__label__quality [WIP] iSCSI initiator refactoring using iscsidsc.dll  This patch adds a new iscsi initiator utils class, leveraging iscsidsc.dll functions.  The advantages are:     - same error output as iscsicli, without the proccess       spawn overhead     - improved overall performance, having finer control over       the iSCSI initiator and avoiding unnecessary operations     - fixed bugs related to LUN discovery and persistent targets  
__label__objective [WIP] iSCSI initiator refactoring using iscsidsc.dll  This patch adds a new iscsi initiator utils class, leveraging iscsidsc.dll functions.  The advantages are:     - same error output as iscsicli, without the proccess       spawn overhead     - improved overall performance, having finer control over       the iSCSI initiator and avoiding unnecessary operations     - fixed bugs related to LUN discovery and persistent targets  
__label__objective [WIP] iSCSI initiator refactoring using iscsidsc.dll  This patch adds a new iscsi initiator utils class, leveraging iscsidsc.dll functions.  The advantages are:     - same error output as iscsicli, without the proccess       spawn overhead     - improved overall performance, having finer control over       the iSCSI initiator and avoiding unnecessary operations     - fixed bugs related to LUN discovery and persistent targets  
__label__objective Refactor resource specific replace logic  Currently we override _needs_update for some resources, where replacement is required either based on tmpl_diff or prop_diff. This patch refactors and adds specific functions (needs_replace, needs_replace_with_prop_diff, needs_replace_with_tmpl_diff). These can now be overidden as required.  
__label__objective Refactor resource specific replace logic  Currently we override _needs_update for some resources, where replacement is required either based on tmpl_diff or prop_diff. This patch refactors and adds specific functions (needs_replace, needs_replace_with_prop_diff, needs_replace_with_tmpl_diff). These can now be overidden as required.  
__label__objective Refactor code of LB backends waiting pieces  This commit introduces a couple of classes and a function to allow a user to specify for which load balancing checkers to wait.  Related-bug: #1533279  Conflicts:         deployment/puppet/osnailyfacter/modular/ceph/radosgw.pp         deployment/puppet/osnailyfacter/modular/openstack-controller/openstack-controller.pp         deployment/puppet/osnailyfacter/modular/sahara/sahara.pp         tests/noop/spec/hosts/ceph/radosgw_spec.rb  
__label__objective Refactor code of managing waiting of LB backends  This commit introduces a couple of classes and a function to allow a user to specify for which load balancing checkers to wait.  
__label__refactoring More refactoring of the image module  Introducing new function _umount_all_partitions to reduce the size of _install_grub2  
__label__objective More refactoring of the image module  Introducing new function _umount_all_partitions to reduce the size of _install_grub2  
__label__quality Huawei: Refactor driver for the second time  After a few new features being added into drivers, we found it hard to maintain the code. For further working, we need to refactor our code. The work contains the following: 1. Define a new class, named HuaweiConf, to parse xml config file. We used an external xml file to store SAN info. But we do config parsing anywhere in our code, even two different functions do the same parsing. 2. Adjust some function structures. 3. Rename some functions & variables.  DocImpact Implements: blueprint refactor-huawei-driver  
__label__objective Huawei: Refactor driver for the second time  After a few new features being added into drivers, we found it hard to maintain the code. For further working, we need to refactor our code. The work contains the following: 1. Define a new class, named HuaweiConf, to parse xml config file. We used an external xml file to store SAN info. But we do config parsing anywhere in our code, even two different functions do the same parsing. 2. Adjust some function structures. 3. Rename some functions & variables.  DocImpact Implements: blueprint refactor-huawei-driver  
__label__objective Huawei: Refactor driver for the second time  After a few new features being added into drivers, we found it hard to maintain the code. For further working, we need to refactor our code. The work contains the following: 1. Define a new class, named HuaweiConf, to parse xml config file. We used an external xml file to store SAN info. But we do config parsing anywhere in our code, even two different functions do the same parsing. 2. Adjust some function structures. 3. Rename some functions & variables.  DocImpact Implements: blueprint refactor-huawei-driver  
__label__quality gluster*: refactor gluster_call  So far, GlusterManager.gluster_call was directly calling into the given execution function, of which the expected error type is ProcessExecutionError; while practically in all use cases we wanted to raise upwards a GlusterfsException, so all use cases were individually coercing the ProcessExecutionError into a GlusterfsException. This produced a huge amount of excess boilerplate code.  Here we include the coercion in the definiton of gluster_call and clean out the excess code.  Partially implements bp gluster-code-cleanup  
__label__objective gluster*: refactor gluster_call  So far, GlusterManager.gluster_call was directly calling into the given execution function, of which the expected error type is ProcessExecutionError; while practically in all use cases we wanted to raise upwards a GlusterfsException, so all use cases were individually coercing the ProcessExecutionError into a GlusterfsException. This produced a huge amount of excess boilerplate code.  Here we include the coercion in the definiton of gluster_call and clean out the excess code.  Partially implements bp gluster-code-cleanup  
__label__objective gluster*: refactor gluster_call  So far, GlusterManager.gluster_call was directly calling into the given execution function, of which the expected error type is ProcessExecutionError; while practically in all use cases we wanted to raise upwards a GlusterfsException, so all use cases were individually coercing the ProcessExecutionError into a GlusterfsException. This produced a huge amount of excess boilerplate code.  Here we include the coercion in the definiton of gluster_call and clean out the excess code.  Partially implements bp gluster-code-cleanup  
__label__quality Group common PKI validation code - Refactor  The PKI token validation for PKI and PKIZ tokens both individually do the cms validation and the revocation checking. There's no reason that this needs to be in both the functions. We can split the decode process and standardize the validation process to make the code flow easier to understand.  As per the previous patch the tests all operate on _validate_offline already so this is a straight refactoring.  
__label__refactoring Group common PKI validation code - Refactor  The PKI token validation for PKI and PKIZ tokens both individually do the cms validation and the revocation checking. There's no reason that this needs to be in both the functions. We can split the decode process and standardize the validation process to make the code flow easier to understand.  As per the previous patch the tests all operate on _validate_offline already so this is a straight refactoring.  
__label__objective Group common PKI validation code - Refactor  The PKI token validation for PKI and PKIZ tokens both individually do the cms validation and the revocation checking. There's no reason that this needs to be in both the functions. We can split the decode process and standardize the validation process to make the code flow easier to understand.  As per the previous patch the tests all operate on _validate_offline already so this is a straight refactoring.  
__label__quality Refactor "os availability zone list"  Refactor the "os availability zone list" command to make it a common command instead of a compute-only command. Since availability zones are common to compute, volume and network (new), this refactoring allows availability zone support to be added for volume and network.  In addition to the refactor, unit and functional tests were added.  
__label__testing Refactor "os availability zone list"  Refactor the "os availability zone list" command to make it a common command instead of a compute-only command. Since availability zones are common to compute, volume and network (new), this refactoring allows availability zone support to be added for volume and network.  In addition to the refactor, unit and functional tests were added.  
__label__objective Refactor "os availability zone list"  Refactor the "os availability zone list" command to make it a common command instead of a compute-only command. Since availability zones are common to compute, volume and network (new), this refactoring allows availability zone support to be added for volume and network.  In addition to the refactor, unit and functional tests were added.  
__label__refactoring Image Import Refactor  This spec is intended to serve as the basis for the discussion on refactoring the Glance image import functionality at the Mitka summit.  ApiImpact DocImpact SecurityImpact  
__label__objective Code refactoring for couchdb  The code in the change_permissions function for couchdb in service.py was refactored. In addition, translation was added to several RuntimeError messages that were missing the underscore for translation.  
__label__integration Code refactoring for couchdb  The code in the change_permissions function for couchdb in service.py was refactored. In addition, translation was added to several RuntimeError messages that were missing the underscore for translation.  
__label__objective Code refactoring for couchdb  The code in the change_permissions function for couchdb in service.py was refactored. In addition, translation was added to several RuntimeError messages that were missing the underscore for translation.  
__label__quality Refactoring osbash networking code  In preparation for Liberty, which removes some networks and adds a new type of network interface configuration (manual), this patch refactors the osbash networking code.  - fewer hardcoded settings (e.g., removed hardcoded list of networks   from osbash.sh)  - eliminated code duplication for client-side network configuration and   split remaining code into separate libraries (functions.ubuntu.sh,   functions.fedora.sh)  - simplify code, e.g. by removing some magic that deduced network names   for KVM from variable names like MGMT_NET  - universal functions for reading network and network interface   configuration into arrays (get_host_network_config,   get_node_netif_config)  - the number of networks is no longer hardcoded in the template for   Windows hostnet creation  - renamed some variables, functions and files to (hopefully) be easier   to understand  
__label__objective Refactoring osbash networking code  In preparation for Liberty, which removes some networks and adds a new type of network interface configuration (manual), this patch refactors the osbash networking code.  - fewer hardcoded settings (e.g., removed hardcoded list of networks   from osbash.sh)  - eliminated code duplication for client-side network configuration and   split remaining code into separate libraries (functions.ubuntu.sh,   functions.fedora.sh)  - simplify code, e.g. by removing some magic that deduced network names   for KVM from variable names like MGMT_NET  - universal functions for reading network and network interface   configuration into arrays (get_host_network_config,   get_node_netif_config)  - the number of networks is no longer hardcoded in the template for   Windows hostnet creation  - renamed some variables, functions and files to (hopefully) be easier   to understand  
__label__objective Refactoring osbash networking code  In preparation for Liberty, which removes some networks and adds a new type of network interface configuration (manual), this patch refactors the osbash networking code.  - fewer hardcoded settings (e.g., removed hardcoded list of networks   from osbash.sh)  - eliminated code duplication for client-side network configuration and   split remaining code into separate libraries (functions.ubuntu.sh,   functions.fedora.sh)  - simplify code, e.g. by removing some magic that deduced network names   for KVM from variable names like MGMT_NET  - universal functions for reading network and network interface   configuration into arrays (get_host_network_config,   get_node_netif_config)  - the number of networks is no longer hardcoded in the template for   Windows hostnet creation  - renamed some variables, functions and files to (hopefully) be easier   to understand  
__label__quality Refactoring osbash networking code  In preparation for Liberty, which removes some networks and adds a new type of network interface configuration (manual), this patch refactors the osbash networking code.  - fewer hardcoded settings (e.g., removed hardcoded list of networks   from osbash.sh)  - eliminated code duplication for client-side network configuration and   split remaining code into separate libraries (functions.ubuntu.sh,   functions.fedora.sh)  - simplify code, e.g. by removing some magic that deduced network names   for KVM from variable names like MGMT_NET  - universal functions for reading network and network interface   configuration into arrays (get_host_network_config,   get_node_netif_config)  - the number of networks is no longer hardcoded in the template for   Windows hostnet creation  - renamed some variables, functions and files to (hopefully) be easier   to understand  
__label__objective Refactoring osbash networking code  In preparation for Liberty, which removes some networks and adds a new type of network interface configuration (manual), this patch refactors the osbash networking code.  - fewer hardcoded settings (e.g., removed hardcoded list of networks   from osbash.sh)  - eliminated code duplication for client-side network configuration and   split remaining code into separate libraries (functions.ubuntu.sh,   functions.fedora.sh)  - simplify code, e.g. by removing some magic that deduced network names   for KVM from variable names like MGMT_NET  - universal functions for reading network and network interface   configuration into arrays (get_host_network_config,   get_node_netif_config)  - the number of networks is no longer hardcoded in the template for   Windows hostnet creation  - renamed some variables, functions and files to (hopefully) be easier   to understand  
__label__objective Refactoring osbash networking code  In preparation for Liberty, which removes some networks and adds a new type of network interface configuration (manual), this patch refactors the osbash networking code.  - fewer hardcoded settings (e.g., removed hardcoded list of networks   from osbash.sh)  - eliminated code duplication for client-side network configuration and   split remaining code into separate libraries (functions.ubuntu.sh,   functions.fedora.sh)  - simplify code, e.g. by removing some magic that deduced network names   for KVM from variable names like MGMT_NET  - universal functions for reading network and network interface   configuration into arrays (get_host_network_config,   get_node_netif_config)  - the number of networks is no longer hardcoded in the template for   Windows hostnet creation  - renamed some variables, functions and files to (hopefully) be easier   to understand  
__label__testing NetApp: Refactor E-Series tests  Refactor the unittests for the NetApp E-Series drivers, removing any functional tests and relocating tests underneath the the path where the rest of the tests live.  Improve the coverage against the Fibre Channel E-Series driver by refactoring the iSCSI tests to work generically where possible.  
__label__refactoring NetApp: Refactor E-Series tests  Refactor the unittests for the NetApp E-Series drivers, removing any functional tests and relocating tests underneath the the path where the rest of the tests live.  Improve the coverage against the Fibre Channel E-Series driver by refactoring the iSCSI tests to work generically where possible.  
__label__quality Refactor 'detach vopt' to use detach_storage  pypowervm.tasks.scsi_mapper.detach_storage provides the function to detach the storage element from VSCSI mappings.  This logic was previously inlined in nova_powervm.virt.powervm.media.add_dlt_vopt_tasks - this change set replaces the inline code with the pypowervm call.  
__label__objective Refactor 'detach vopt' to use detach_storage  pypowervm.tasks.scsi_mapper.detach_storage provides the function to detach the storage element from VSCSI mappings.  This logic was previously inlined in nova_powervm.virt.powervm.media.add_dlt_vopt_tasks - this change set replaces the inline code with the pypowervm call.  
__label__quality [WIP] Improve OVS-agent init-method  Currently there is a method which creates specific configurations dictionary according to cfg.CONF and call the OVS-agent with that structure. Removing this method and pass oslo_config directly to init-method of OVS-agent is avoids a confusion and makes it easy to track. Also refactored unit and functional tests of OVS-agent in accordance with the changes in init-method. Removed CreateAgentConfigMap.  
__label__testing [WIP] Improve OVS-agent init-method  Currently there is a method which creates specific configurations dictionary according to cfg.CONF and call the OVS-agent with that structure. Removing this method and pass oslo_config directly to init-method of OVS-agent is avoids a confusion and makes it easy to track. Also refactored unit and functional tests of OVS-agent in accordance with the changes in init-method. Removed CreateAgentConfigMap.  
__label__objective [WIP] Improve OVS-agent init-method  Currently there is a method which creates specific configurations dictionary according to cfg.CONF and call the OVS-agent with that structure. Removing this method and pass oslo_config directly to init-method of OVS-agent is avoids a confusion and makes it easy to track. Also refactored unit and functional tests of OVS-agent in accordance with the changes in init-method. Removed CreateAgentConfigMap.  
__label__quality Refactor os-client-config usage in from_config  This change allows the from_config factory function to better support two angles from which it will most commonly be used.  1. When SDK is being used from within OSC, OSC will have obtained configuration data from OCC and is better served by passing it directly into SDK rather than SDK additionally accessing that data.  2. Direct users of the SDK, such as customer applications, are less likely to have dealt directly with OCC and are better served by just passing in the name of the configuration they want to run with.  Closes-Bug:1513920  
__label__objective Refactor os-client-config usage in from_config  This change allows the from_config factory function to better support two angles from which it will most commonly be used.  1. When SDK is being used from within OSC, OSC will have obtained configuration data from OCC and is better served by passing it directly into SDK rather than SDK additionally accessing that data.  2. Direct users of the SDK, such as customer applications, are less likely to have dealt directly with OCC and are better served by just passing in the name of the configuration they want to run with.  Closes-Bug:1513920  
__label__objective Refactor os-client-config usage in from_config  This change allows the from_config factory function to better support two angles from which it will most commonly be used.  1. When SDK is being used from within OSC, OSC will have obtained configuration data from OCC and is better served by passing it directly into SDK rather than SDK additionally accessing that data.  2. Direct users of the SDK, such as customer applications, are less likely to have dealt directly with OCC and are better served by just passing in the name of the configuration they want to run with.  Closes-Bug:1513920  
__label__refactoring Refactor Port number validation  Leverage the recently added _is_int_in_range() function to simpify valid range check  
__label__testing Refactor test_server functional tests  * Launching services with 0 workers makes no sense and would soon   be prohibited in oslo.service. Passing workers=1 means that a   service will be run in a current process. * Extract the dummy _check_active method to the base class.  
__label__quality Refactor test_server functional tests  * Launching services with 0 workers makes no sense and would soon   be prohibited in oslo.service. Passing workers=1 means that a   service will be run in a current process. * Extract the dummy _check_active method to the base class.  
__label__objective Refactor test_server functional tests  * Launching services with 0 workers makes no sense and would soon   be prohibited in oslo.service. Passing workers=1 means that a   service will be run in a current process. * Extract the dummy _check_active method to the base class.  
__label__quality Refactor part of image module  Shuffle some functions around and reduce size of _is_bootloader_loaded moving logic out to a new function.  
__label__refactoring Refactor part of image module  Shuffle some functions around and reduce size of _is_bootloader_loaded moving logic out to a new function.  
__label__quality Refactor the datastore manager classes  There is a large amount of boiler-plate code in each datastore manager. As more managers are added, the time involved in maintaining all this code wil continue to grow. To alleviate this, a base manager class has been added where all common code can reside.  The initial refactoring just moved some of the obvious code (such as rpc_ping and update_status) into the base class, along with defining properties that can be used to further abstract functionality going forward.  The issue of having instances move in-and-out of ACTIVE state has also been fixed by adding a flag file that is written by the base class once prepare has finished successfully.  Closes-Bug: #1482795 Closes-Bug: #1487233 Partially Implements: blueprint datastore-manager-refactor 
__label__objective Refactor the datastore manager classes  There is a large amount of boiler-plate code in each datastore manager. As more managers are added, the time involved in maintaining all this code wil continue to grow. To alleviate this, a base manager class has been added where all common code can reside.  The initial refactoring just moved some of the obvious code (such as rpc_ping and update_status) into the base class, along with defining properties that can be used to further abstract functionality going forward.  The issue of having instances move in-and-out of ACTIVE state has also been fixed by adding a flag file that is written by the base class once prepare has finished successfully.  Closes-Bug: #1482795 Closes-Bug: #1487233 Partially Implements: blueprint datastore-manager-refactor 
__label__quality Pagination limit code refactor  The logic to find the pagination limit is repeated several times and is not in one function. This patch creates a function that is called in various locations replacing repetitive code.  
__label__refactoring Pagination limit code refactor  The logic to find the pagination limit is repeated several times and is not in one function. This patch creates a function that is called in various locations replacing repetitive code.  
__label__refactoring Refactor upgrade_controlplane parts  * move network related methods from `upgrade_controlplane` to `env`   module * collect yaml files from nodes if bup info is not present * extract `delete_overlay_networks` action to separate function  
__label__quality Refactor use of basedisk name/path  The basedisk name (and hence get_base_disk_name) have the filename extension .vdi removed to allow for backends that have different file extensions.  The VirtualBox-specific function get_base_disk_path is moved from functions-host.sh to virtualbox-functions.sh.  
__label__refactoring Refactor use of basedisk name/path  The basedisk name (and hence get_base_disk_name) have the filename extension .vdi removed to allow for backends that have different file extensions.  The VirtualBox-specific function get_base_disk_path is moved from functions-host.sh to virtualbox-functions.sh.  
__label__quality Some minor refactoring and comment/note addition  In the internal '_run' instead of having a loop that has various cases with quite a bit of code per case instead have the loop call into smaller helper functions that handle the different types of processing the loop does.  Also adds a note to the 'reset' method that explains why the metrics keys are overwritten vs being copied/replaced with a new copy.  
__label__objective Some minor refactoring and comment/note addition  In the internal '_run' instead of having a loop that has various cases with quite a bit of code per case instead have the loop call into smaller helper functions that handle the different types of processing the loop does.  Also adds a note to the 'reset' method that explains why the metrics keys are overwritten vs being copied/replaced with a new copy.  
__label__refactoring Refactor services maintenance functions  Move functions that start services using corosync and upstart from module commands/upgrade_controlplane.py to module util/maintenance.py.  
__label__quality Refactor common parts of 'get_maybe_ready_for' methods  These share quite a bit of common-like code, so refactor both of them to share the same function and differentiate certain provided arguments as needed.  
__label__objective Refactor common parts of 'get_maybe_ready_for' methods  These share quite a bit of common-like code, so refactor both of them to share the same function and differentiate certain provided arguments as needed.  
__label__objective nsx v3 lport refactor  this patch refactors the nsx v3 logical switch port functions into the rest client/resource model and updates all refs to these functions to use an nsx v3 client. the patch also adds support for passing switch profile ids to the lport create. this functionality will be leveraged in subsequent port security change sets.  
__label__objective nsx v3 lport refactor  this patch refactors the nsx v3 logical switch port functions into the rest client/resource model and updates all refs to these functions to use an nsx v3 client. the patch also adds support for passing switch profile ids to the lport create. this functionality will be leveraged in subsequent port security change sets.  
__label__objective Refactor verification for ZanataRestService  Rather than pass verify to each function that requires it, refactor it down the stack into __init__. Now that we have moved to using translate.o.o which has a trusted certificate, switch the default to True.  Add a command-line argument --no-verify to create-zanata-xml to ease testing against translate-dev.  
__label__testing Refactor verification for ZanataRestService  Rather than pass verify to each function that requires it, refactor it down the stack into __init__. Now that we have moved to using translate.o.o which has a trusted certificate, switch the default to True.  Add a command-line argument --no-verify to create-zanata-xml to ease testing against translate-dev.  
__label__objective Refactor verification for ZanataRestService  Rather than pass verify to each function that requires it, refactor it down the stack into __init__. Now that we have moved to using translate.o.o which has a trusted certificate, switch the default to True.  Add a command-line argument --no-verify to create-zanata-xml to ease testing against translate-dev.  
__label__objective Refactor get_task_spec using mechanism of polymorphic DSL entities  * Use instantiate_spec function for task spec initializaion, no matter the   task belongs to direct or reverse workflow.  * Replace the code logic of prohibition of co-existance between action and   workflow in task spec with jsonschema restriction.  
__label__objective Refactor get_task_spec using mechanism of polymorphic DSL entities  * Use instantiate_spec function for task spec initializaion, no matter the   task belongs to direct or reverse workflow.  * Replace the code logic of prohibition of co-existance between action and   workflow in task spec with jsonschema restriction.  
__label__refactoring Refactoring of conventions code  * Simplifies convention classes, moves all special names processing code into specs.  * Now it is possible to have special functions with suffixes  that conventions will apply to. For example  #prefix_name_do_something will remain intact but  #prefix_name#do_something will be converted to  #prefix_name#doSomething. This will be later used to implement properties  
__label__objective Refactoring of conventions code  * Simplifies convention classes, moves all special names processing code into specs.  * Now it is possible to have special functions with suffixes  that conventions will apply to. For example  #prefix_name_do_something will remain intact but  #prefix_name#do_something will be converted to  #prefix_name#doSomething. This will be later used to implement properties  
__label__refactoring [Intern] Network tab tests refactoring  Related to blueprint ui-functional-tests-with-intern 
__label__testing [Intern] Network tab tests refactoring  Related to blueprint ui-functional-tests-with-intern 
__label__refactoring [Intern] Network tab tests refactoring  Related to blueprint ui-functional-tests-with-intern 
__label__testing [Intern] Network tab tests refactoring  Related to blueprint ui-functional-tests-with-intern 
__label__quality Refactor root ssh config, add admin_network to list of host nets  SSH config for root user should use key auth regardless of hostname. This enables deployment to hosts that have IP addresses outside of RFC 1918 ranges.  Host network should include admin network expressed by wildcard.  Added new function ipcalc_network_wildcard  
__label__objective Refactor root ssh config, add admin_network to list of host nets  SSH config for root user should use key auth regardless of hostname. This enables deployment to hosts that have IP addresses outside of RFC 1918 ranges.  Host network should include admin network expressed by wildcard.  Added new function ipcalc_network_wildcard  
__label__testing Minor refactoring of integration tests  Simplify 2 CheckBoxRegion-s by moving their common functionality into mixin.  
__label__refactoring Minor refactoring of integration tests  Simplify 2 CheckBoxRegion-s by moving their common functionality into mixin.  
__label__refactoring Refactor list_block_devices to its own function  This function is useful in any HardwareManager that interacts with disks. Subclassing GenericHardwareManager is not ideal for any hardware manager that interacts with only specific devices.  
__label__objective Refactor list_block_devices to its own function  This function is useful in any HardwareManager that interacts with disks. Subclassing GenericHardwareManager is not ideal for any hardware manager that interacts with only specific devices.  
__label__refactoring Refactor InstanceGroup batch sizing logic  Calculate the batch sizes in a separate function that is independent of the resource itself, and therefore suitable for moving into a library.  
__label__objective Refactor InstanceGroup batch sizing logic  Calculate the batch sizes in a separate function that is independent of the resource itself, and therefore suitable for moving into a library.  
__label__quality Refactor to remove duplicate code  This change reuses the get_volume_type_encryption function for the implementation of the is_encrypted function.  
__label__quality libvirt: refactor _create_domain_setup_lxc to use Image.get_model  Instead of trying to figure out what the proper ImageModel is for the instance's image, just use the get_model function. The resulting ImageModel will actually represent the proper ImageModel for the instance, and downstream mounting functions will be able to make intelligent decisions on how to mount the instance's disks.  It is not possible to use get_model for an instance booted from volume, but we can still use LocalBlockImage in it's case because it is simply exposed as a block device.  
__label__objective libvirt: refactor _create_domain_setup_lxc to use Image.get_model  Instead of trying to figure out what the proper ImageModel is for the instance's image, just use the get_model function. The resulting ImageModel will actually represent the proper ImageModel for the instance, and downstream mounting functions will be able to make intelligent decisions on how to mount the instance's disks.  It is not possible to use get_model for an instance booted from volume, but we can still use LocalBlockImage in it's case because it is simply exposed as a block device.  
__label__objective refactoring castellan configuration  This change adds a module for listing configuration options and setting their defaults. It also changes the key manager base class to incorporate a configuration during creation. By default, the key manager will continue to use the global CONF object from the oslo.config package.  For the most part, this change will be backwards compatible. The one exception is the creation of sample configuration files. Previously, importing castellan was sufficient to add these options to the global configuration object. Now, these options will need to be applied by using the castellan.options.list_opts function, or adding them through other means, to create sample configuration files. Similar applies for setting configuration before instantiating a key manager.  changes * adding castellan.options with list_opts and set_defaults functions * changing KeyManager abc to include a configuration option to __init__ * changing babrican and not_implemented key managers to accept   configuration parameters * adding tests for set_defaults function * fixing barbican tests to accomodate new configuration parameter * adding documentation about configuration usage  
__label__quality refactoring castellan configuration  This change adds a module for listing configuration options and setting their defaults. It also changes the key manager base class to incorporate a configuration during creation. By default, the key manager will continue to use the global CONF object from the oslo.config package.  For the most part, this change will be backwards compatible. The one exception is the creation of sample configuration files. Previously, importing castellan was sufficient to add these options to the global configuration object. Now, these options will need to be applied by using the castellan.options.list_opts function, or adding them through other means, to create sample configuration files. Similar applies for setting configuration before instantiating a key manager.  changes * adding castellan.options with list_opts and set_defaults functions * changing KeyManager abc to include a configuration option to __init__ * changing babrican and not_implemented key managers to accept   configuration parameters * adding tests for set_defaults function * fixing barbican tests to accomodate new configuration parameter * adding documentation about configuration usage  
__label__testing refactoring castellan configuration  This change adds a module for listing configuration options and setting their defaults. It also changes the key manager base class to incorporate a configuration during creation. By default, the key manager will continue to use the global CONF object from the oslo.config package.  For the most part, this change will be backwards compatible. The one exception is the creation of sample configuration files. Previously, importing castellan was sufficient to add these options to the global configuration object. Now, these options will need to be applied by using the castellan.options.list_opts function, or adding them through other means, to create sample configuration files. Similar applies for setting configuration before instantiating a key manager.  changes * adding castellan.options with list_opts and set_defaults functions * changing KeyManager abc to include a configuration option to __init__ * changing babrican and not_implemented key managers to accept   configuration parameters * adding tests for set_defaults function * fixing barbican tests to accomodate new configuration parameter * adding documentation about configuration usage  
__label__objective refactoring castellan configuration  This change adds a module for listing configuration options and setting their defaults. It also changes the key manager base class to incorporate a configuration during creation. By default, the key manager will continue to use the global CONF object from the oslo.config package.  For the most part, this change will be backwards compatible. The one exception is the creation of sample configuration files. Previously, importing castellan was sufficient to add these options to the global configuration object. Now, these options will need to be applied by using the castellan.options.list_opts function, or adding them through other means, to create sample configuration files. Similar applies for setting configuration before instantiating a key manager.  changes * adding castellan.options with list_opts and set_defaults functions * changing KeyManager abc to include a configuration option to __init__ * changing babrican and not_implemented key managers to accept   configuration parameters * adding tests for set_defaults function * fixing barbican tests to accomodate new configuration parameter * adding documentation about configuration usage  
__label__testing refactor compute controller index  start with the refactoring of the compute controller methods, as long as adding better unit tests so that we can actually do unit testing rather than functional testing.  
__label__objective refactor compute controller index  start with the refactoring of the compute controller methods, as long as adding better unit tests so that we can actually do unit testing rather than functional testing.  
__label__objective Refactor the utility module  This change set provides a refactoring of the utility module to make it simple functions instead of the heavier weight class.  The agent itself now has the adapter, which is in line with the PowerVM code in other OpenStack projects.  This change set also changes single quotes to double quotes to keep method comments consisten within the project.  
__label__objective Refactor the utility module  This change set provides a refactoring of the utility module to make it simple functions instead of the heavier weight class.  The agent itself now has the adapter, which is in line with the PowerVM code in other OpenStack projects.  This change set also changes single quotes to double quotes to keep method comments consisten within the project.  
__label__refactoring Refactor virtual_ips task  * Use function instead of hardcoded values  
__label__quality Refactor virtual_ips task  * Use function instead of hardcoded values  
__label__quality refactor Huawei Volume driver  This blueprint is an attempt to refactor the Huawei volume driver in liberty. We will add a base dirver to implement the basic functions that the Cinder driver required. The sub-class will inherit the base driver according to different storages.  
__label__objective refactor Huawei Volume driver  This blueprint is an attempt to refactor the Huawei volume driver in liberty. We will add a base dirver to implement the basic functions that the Cinder driver required. The sub-class will inherit the base driver according to different storages.  
__label__refactoring Introduce refactored tests  - Move all functions excluding specific to common/utils.py - Add requests to test-requirements.txt - Modify config.py to give more flexibility to tests  
__label__testing Introduce refactored tests  - Move all functions excluding specific to common/utils.py - Add requests to test-requirements.txt - Modify config.py to give more flexibility to tests  
__label__quality devstack-plugin-glusterfs: Refactoring plugin code  This patch modifies the plugin code into more reusable manner. Also adds a new file "devstack/gluster-functions.sh", which contains gluster specific functions.  
__label__objective devstack-plugin-glusterfs: Refactoring plugin code  This patch modifies the plugin code into more reusable manner. Also adds a new file "devstack/gluster-functions.sh", which contains gluster specific functions.  
__label__objective Fixes for a couple of upstream refactors  IPAM got rid of _delete_port function and RBAC required a context for make_subnet_dict function.  
__label__refactoring Refactor pulling translations into a common func  In preperation for switching projects one at a time to pulling translations from Zanata, refactor the two calls to tx pull into a common function.  
__label__objective Refactor pulling translations into a common func  In preperation for switching projects one at a time to pulling translations from Zanata, refactor the two calls to tx pull into a common function.  
__label__quality Refactor certificate fetch functions  The certificate fetch function code was complicated because you passed in a string to pick the certificate type. This was a holdover from before keystoneclient was used because it was building the paths to the certificates. Now auth_token is just calling client methods rather then building the path so the strings don't mean anything anymore.  
__label__objective Refactor certificate fetch functions  The certificate fetch function code was complicated because you passed in a string to pick the certificate type. This was a holdover from before keystoneclient was used because it was building the paths to the certificates. Now auth_token is just calling client methods rather then building the path so the strings don't mean anything anymore.  
__label__quality Refactor Trilio charms base classes  Move into separate module to avoid explosion in size of adapters classes module.  Refactor principle and subordinate classes to have the correct super classes.  Provide install and configure source helpers as functions so they can be used in both class types.  Split ghost share action out into a mixin as its not used everywhere.  Add TrilioVault charm classes to main module __all__.  
__label__objective Refactor Trilio charms base classes  Move into separate module to avoid explosion in size of adapters classes module.  Refactor principle and subordinate classes to have the correct super classes.  Provide install and configure source helpers as functions so they can be used in both class types.  Split ghost share action out into a mixin as its not used everywhere.  Add TrilioVault charm classes to main module __all__.  
__label__objective Refactor Trilio charms base classes  Move into separate module to avoid explosion in size of adapters classes module.  Refactor principle and subordinate classes to have the correct super classes.  Provide install and configure source helpers as functions so they can be used in both class types.  Split ghost share action out into a mixin as its not used everywhere.  Add TrilioVault charm classes to main module __all__.  
__label__quality Refactor extract function load_auth_method  A load_auth_method function is extracted from load_auth_methods so that it's easier to modify and unit test.  bp stevedore  
__label__refactoring Refactor extract function load_auth_method  A load_auth_method function is extracted from load_auth_methods so that it's easier to modify and unit test.  bp stevedore  
__label__refactoring Refactor the alternative name iteration code  Put the altname iteration in a separate function. This will be useful for the future validators. Also provides a better exception messages.  
__label__objective Refactor the alternative name iteration code  Put the altname iteration in a separate function. This will be useful for the future validators. Also provides a better exception messages.  
__label__quality Refactor machine builder + runner into single unit  There is really no need to seperate off the runner into a unit that builds a state-machine and then provides a tiny utility function, both of these can just be in the same class and code so that it is easier to understand/read.  
__label__objective Refactor machine builder + runner into single unit  There is really no need to seperate off the runner into a unit that builds a state-machine and then provides a tiny utility function, both of these can just be in the same class and code so that it is easier to understand/read.  
__label__objective Refactor PureISCSIDriver into base and iSCSI classes.  This adds in a new class called PureBaseVolumeDriver that contains all of the generic shared methods that utilize the management REST API.  The PureISCSIDriver now inherits from the base driver and implements the functionality required for iSCSI hosts/initiators.  As part of this we���ve cleaned up some of the logging where it would previously have hard coded the drivers class name in it, and moved some static non-class helper methods into the base class.  These changes will ease future work to add additional drivers or split them into separate files.  Implements: blueprint pure-base-driver 
__label__quality Refactor PureISCSIDriver into base and iSCSI classes.  This adds in a new class called PureBaseVolumeDriver that contains all of the generic shared methods that utilize the management REST API.  The PureISCSIDriver now inherits from the base driver and implements the functionality required for iSCSI hosts/initiators.  As part of this we���ve cleaned up some of the logging where it would previously have hard coded the drivers class name in it, and moved some static non-class helper methods into the base class.  These changes will ease future work to add additional drivers or split them into separate files.  Implements: blueprint pure-base-driver 
__label__objective Refactor PureISCSIDriver into base and iSCSI classes.  This adds in a new class called PureBaseVolumeDriver that contains all of the generic shared methods that utilize the management REST API.  The PureISCSIDriver now inherits from the base driver and implements the functionality required for iSCSI hosts/initiators.  As part of this we���ve cleaned up some of the logging where it would previously have hard coded the drivers class name in it, and moved some static non-class helper methods into the base class.  These changes will ease future work to add additional drivers or split them into separate files.  Implements: blueprint pure-base-driver 
__label__quality Huawei manila driver code refactoring  The Huawei manila driver code should be restructured. Instead of using a lose interface definition of share drivers use the ABC python library to build abstract classes that enforces the driver to implement the needed functionality.  The huawei_helper.py is to long, the code structure should be adjustmented.  Partially implements: blueprint huawei-manila-driver-refactor  
__label__objective Huawei manila driver code refactoring  The Huawei manila driver code should be restructured. Instead of using a lose interface definition of share drivers use the ABC python library to build abstract classes that enforces the driver to implement the needed functionality.  The huawei_helper.py is to long, the code structure should be adjustmented.  Partially implements: blueprint huawei-manila-driver-refactor  
__label__refactoring Small refactoring of 'merge_uri' utility function  
__label__refactoring Refactor common event code into event_utils module  The recently added event-mangling code for event-list --nested-depth will also be needed for hook-poll functionality, so refactor to move the code and tests into seperate files.  
__label__objective Refactor common event code into event_utils module  The recently added event-mangling code for event-list --nested-depth will also be needed for hook-poll functionality, so refactor to move the code and tests into seperate files.  
__label__quality Refactor _create_attribute_statement IdP method  Create an inner function to build the attributes so we avoid to repeat the same commands for each attribute.  
__label__objective Refactor _create_attribute_statement IdP method  Create an inner function to build the attributes so we avoid to repeat the same commands for each attribute.  
__label__refactoring Refactor common function for loading drivers  A common function is provided for loading drivers so that the method of loading drivers can be easily changed.  
__label__quality Refactor RSA Functional Smoke Tests  General clean up and removal of duplicate code by using class variables and adding helper functions.  
__label__testing Refactor RSA Functional Smoke Tests  General clean up and removal of duplicate code by using class variables and adding helper functions.  
__label__quality Refactor sql filter code for clarity  The sql filter code was not clear.   - The "hint" parameter was passed into functions that don't use it,    so stop passing this parameter.  - The parameter docstrings should specify the type normally  - It should be clear that the cumulative_filter_dict parameter is    mutated, so don't return it.  
__label__objective Refactor sql filter code for clarity  The sql filter code was not clear.   - The "hint" parameter was passed into functions that don't use it,    so stop passing this parameter.  - The parameter docstrings should specify the type normally  - It should be clear that the cumulative_filter_dict parameter is    mutated, so don't return it.  
__label__quality refactor how provider starts child process  in very rare cases processes created by puppet return before waiting for the child process to finish. this leads to the issue when pacemaker provider starts working with shadow xml copies before they are even created.  this fix refactors how provider starts child process using system function instead of fork&exec pair  testing showed that the issue goes away after this leaving all the other functions untouched  
__label__objective refactor how provider starts child process  in very rare cases processes created by puppet return before waiting for the child process to finish. this leads to the issue when pacemaker provider starts working with shadow xml copies before they are even created.  this fix refactors how provider starts child process using system function instead of fork&exec pair  testing showed that the issue goes away after this leaving all the other functions untouched  
__label__objective Refactor tests.  - Adding 'functional' directory to store all functional tests - Adding 'unit' directory to store unit tests - Moving fixtures to the functional directory  
__label__testing Refactor tests.  - Adding 'functional' directory to store all functional tests - Adding 'unit' directory to store unit tests - Moving fixtures to the functional directory  
__label__quality Refactor caching to allow per-method invalidate  Previously dogpile caching was hidden in private functions, but this is not how dogpile intends for the methods to be called.  
__label__quality refactor to remove functions-common  This refactor's the grenade code to remove the copy/pasted functions-common from devstack and instead use the functions from TARGET_DEVSTACK. In order to accomplish this we need to refactor when the devstack trees are pulled, so that we always pull both the base and target devstack trees *extremely* early.  We also need to include a small number of functions (mostly related to git) in grenade to be able to bootstrap these trees. This is done in the inc/bootstrap tree.  There are some slightly unrelated function moves into inc/upgrade to consolidate all the upgrade functions which were scattered through the codebase for clarity. inc/* will be the contract library interfaces out of grenade (mirroring devstack).  To do this grenaderc has to be split between variables which can be set without devstack functions, and variables we compute later. These later variables will be moved into project specific directories based on the plugin plan.  
__label__objective refactor to remove functions-common  This refactor's the grenade code to remove the copy/pasted functions-common from devstack and instead use the functions from TARGET_DEVSTACK. In order to accomplish this we need to refactor when the devstack trees are pulled, so that we always pull both the base and target devstack trees *extremely* early.  We also need to include a small number of functions (mostly related to git) in grenade to be able to bootstrap these trees. This is done in the inc/bootstrap tree.  There are some slightly unrelated function moves into inc/upgrade to consolidate all the upgrade functions which were scattered through the codebase for clarity. inc/* will be the contract library interfaces out of grenade (mirroring devstack).  To do this grenaderc has to be split between variables which can be set without devstack functions, and variables we compute later. These later variables will be moved into project specific directories based on the plugin plan.  
__label__quality Refactor nailgun.statistics package  Two subpackages (for statistic collecting of fuel infrastructure using and collecting of oswl info) created in order to separate code dedicated to logically different functions. Utility (universal utility functions and custom errors description) infrastructure left on statistics package level with possibility of reusing in subpackages' code. Tests refactored considering current separation.  
__label__testing Refactor nailgun.statistics package  Two subpackages (for statistic collecting of fuel infrastructure using and collecting of oswl info) created in order to separate code dedicated to logically different functions. Utility (universal utility functions and custom errors description) infrastructure left on statistics package level with possibility of reusing in subpackages' code. Tests refactored considering current separation.  
__label__objective Refactor nailgun.statistics package  Two subpackages (for statistic collecting of fuel infrastructure using and collecting of oswl info) created in order to separate code dedicated to logically different functions. Utility (universal utility functions and custom errors description) infrastructure left on statistics package level with possibility of reusing in subpackages' code. Tests refactored considering current separation.  
__label__quality Refactor direct_networks to not call Hiera directly  This function simply forms a list of networks according to our network_scheme. We can pass $network_scheme['endpoints'] hash as a parameter to this function instead of calling Hiera directly from it.  
__label__objective Refactor direct_networks to not call Hiera directly  This function simply forms a list of networks according to our network_scheme. We can pass $network_scheme['endpoints'] hash as a parameter to this function instead of calling Hiera directly from it.  
__label__quality Global refactoring of CI scripts  Global refactoring is include: * drop Icehouse support; * improvements nodepool's slave installing script; * remove deprecated jobs; * create config template for old integration tests; * create config files for PYPI; * improve and refactor function.sh, execution tests scripts;  
__label__testing Global refactoring of CI scripts  Global refactoring is include: * drop Icehouse support; * improvements nodepool's slave installing script; * remove deprecated jobs; * create config template for old integration tests; * create config files for PYPI; * improve and refactor function.sh, execution tests scripts;  
__label__quality Refactor _remove_unused_security_group_info  _remove_unused_security_group_info is refactored into smaller functions, to make this block easier to understand.  Partially implements blueprint refactor-iptables-firewall-driver  
__label__objective Refactor _remove_unused_security_group_info  _remove_unused_security_group_info is refactored into smaller functions, to make this block easier to understand.  Partially implements blueprint refactor-iptables-firewall-driver  
__label__quality Refactor Swift backup driver and introduce chunking driver.  Abstract out a "chunked" backup driver class between the top abstract backup driver class and the Swift backup driver class which implements common functionality for backup drivers that store volume data in multiple "chunks" in a backup repository when the size of the backed up cinder volume exceeds the size of a backup repository "chunk."  The Swift driver itself is reworked to extend the chunked backup driver and implement abstract methods defined in the chunked backup driver.  It is expected that posix filesystem and NFS backup drivers will also extend the chunked backup driver.  
__label__objective Refactor Swift backup driver and introduce chunking driver.  Abstract out a "chunked" backup driver class between the top abstract backup driver class and the Swift backup driver class which implements common functionality for backup drivers that store volume data in multiple "chunks" in a backup repository when the size of the backed up cinder volume exceeds the size of a backup repository "chunk."  The Swift driver itself is reworked to extend the chunked backup driver and implement abstract methods defined in the chunked backup driver.  It is expected that posix filesystem and NFS backup drivers will also extend the chunked backup driver.  
__label__objective Refactor Swift backup driver and introduce chunking driver.  Abstract out a "chunked" backup driver class between the top abstract backup driver class and the Swift backup driver class which implements common functionality for backup drivers that store volume data in multiple "chunks" in a backup repository when the size of the backed up cinder volume exceeds the size of a backup repository "chunk."  The Swift driver itself is reworked to extend the chunked backup driver and implement abstract methods defined in the chunked backup driver.  It is expected that posix filesystem and NFS backup drivers will also extend the chunked backup driver.  
__label__quality Main loop refactor  The code relative to the various actions is moved into their respective job objects. A factory function creates the correct type of job object according to the action requested. This replaces the long "if" chain in the main loop  The main loop calls the Job object's execute() method.  
__label__objective Main loop refactor  The code relative to the various actions is moved into their respective job objects. A factory function creates the correct type of job object according to the action requested. This replaces the long "if" chain in the main loop  The main loop calls the Job object's execute() method.  
__label__quality Refactor Secrets resource to use repository factories  Instead of passing around the repositories in the constructor of the controller classes, now a factory function is called.  The Repository class was left as is, as the objects that use it will be refactored in subsequent commits.  
__label__objective Refactor Secrets resource to use repository factories  Instead of passing around the repositories in the constructor of the controller classes, now a factory function is called.  The Repository class was left as is, as the objects that use it will be refactored in subsequent commits.  
__label__quality Refactor Orders resource to use repository factories  Instead of passing around the repositories in the constructor of the controller classes, now a factory function is called.  
__label__objective Refactor Orders resource to use repository factories  Instead of passing around the repositories in the constructor of the controller classes, now a factory function is called.  
__label__quality Refactoring for consistency  This change set provides some refactorings that make the code easier to read and maintain.  The key changes are:  - Support fixtures in a similar way that nova_powervm does.  This    reduces the amount of mock up code required for testing.  - Rename the powervm_sea_agent to sea_agent.  The PowerVM is already    part of the namespace (due to the folder it is in).  This was    creating too long of a name for use.  - Change the connection utility to be PVMUtils.  Simpler name more in    line with how the function has evolved.  
__label__objective Refactoring for consistency  This change set provides some refactorings that make the code easier to read and maintain.  The key changes are:  - Support fixtures in a similar way that nova_powervm does.  This    reduces the amount of mock up code required for testing.  - Rename the powervm_sea_agent to sea_agent.  The PowerVM is already    part of the namespace (due to the folder it is in).  This was    creating too long of a name for use.  - Change the connection utility to be PVMUtils.  Simpler name more in    line with how the function has evolved.  
__label__refactoring Cleanup and refactor csr_validate function from certificate_ops  
__label__quality Refactor _lookup for secrets  The way the _lookup function in the controllers is documented (in the pecan documentation), the actual lookup of the entity is actually done in that function. So this CR changes that for the "secrets" entity. Which actually reduces code repetition throughout that controller.  
__label__objective Refactor _lookup for secrets  The way the _lookup function in the controllers is documented (in the pecan documentation), the actual lookup of the entity is actually done in that function. So this CR changes that for the "secrets" entity. Which actually reduces code repetition throughout that controller.  
__label__testing refactor probe tests  * refactor probe tests to use probe.common.ProbeTest * move reset_environment functionality to ProbeTest.setUp() * choose rings and policies that meet the criteria - raise SkipTest if nothing matches  
__label__quality refactor probe tests  * refactor probe tests to use probe.common.ProbeTest * move reset_environment functionality to ProbeTest.setUp() * choose rings and policies that meet the criteria - raise SkipTest if nothing matches  
__label__objective refactor probe tests  * refactor probe tests to use probe.common.ProbeTest * move reset_environment functionality to ProbeTest.setUp() * choose rings and policies that meet the criteria - raise SkipTest if nothing matches  
__label__objective Update baseline to resolve refactoring items  Over the past couple of weeks, changes from neutron and pypowervm have affected neutron_powervm such that it was no longer sending messages to the agent (and when fixed, crashed the agent).  This change set fixes the following:  - Sends the messages properly to the agent  - Changes the cadence of checks (slightly slower)  - Works off of MTMS for the host name  - Updates the MTMS format for new pypowervm functions  
__label__objective Update baseline to resolve refactoring items  Over the past couple of weeks, changes from neutron and pypowervm have affected neutron_powervm such that it was no longer sending messages to the agent (and when fixed, crashed the agent).  This change set fixes the following:  - Sends the messages properly to the agent  - Changes the cadence of checks (slightly slower)  - Works off of MTMS for the host name  - Updates the MTMS format for new pypowervm functions  
__label__objective Update baseline to resolve refactoring items  Over the past couple of weeks, changes from neutron and pypowervm have affected neutron_powervm such that it was no longer sending messages to the agent (and when fixed, crashed the agent).  This change set fixes the following:  - Sends the messages properly to the agent  - Changes the cadence of checks (slightly slower)  - Works off of MTMS for the host name  - Updates the MTMS format for new pypowervm functions  
__label__testing Refactor cloudconfig plugin, in order to simplify enhancements  The patch includes the following changes:     * move the code related to cloudconfig functionalities in a      visitor class. The meaning of this class is plain and simple      and it doesn't clutter the base plugin.    * add a from_yaml classmethod to the newly added visitor plugin.     In this way, we could add support for other formats as well,     the only thing required being adding a new factory method for     these formats.    * make some public methods private and simplify the check for     the correctness of the content.    * the tests aren't relying too much on mock, they are written     with feature-testing in mind.  
__label__quality Refactor cloudconfig plugin, in order to simplify enhancements  The patch includes the following changes:     * move the code related to cloudconfig functionalities in a      visitor class. The meaning of this class is plain and simple      and it doesn't clutter the base plugin.    * add a from_yaml classmethod to the newly added visitor plugin.     In this way, we could add support for other formats as well,     the only thing required being adding a new factory method for     these formats.    * make some public methods private and simplify the check for     the correctness of the content.    * the tests aren't relying too much on mock, they are written     with feature-testing in mind.  
__label__objective Refactor cloudconfig plugin, in order to simplify enhancements  The patch includes the following changes:     * move the code related to cloudconfig functionalities in a      visitor class. The meaning of this class is plain and simple      and it doesn't clutter the base plugin.    * add a from_yaml classmethod to the newly added visitor plugin.     In this way, we could add support for other formats as well,     the only thing required being adding a new factory method for     these formats.    * make some public methods private and simplify the check for     the correctness of the content.    * the tests aren't relying too much on mock, they are written     with feature-testing in mind.  
__label__quality Refactor processing of testr artifacts for reuse  Previously, only testr artifacts for tempest were being processed on cleanup.  Functional jobs for neutron and neutron-vnpaas have adding their own artifact processing into hook scripts to work around this limitation, but this duplication of effort is costly.  This change refactors the existing artifact processing so it can be configurably targeted at any project's testr artifacts.  The DEVSTACK_GATE_TESTR_ARTIFACT_TARGET environment variable can be set to the repo path name (e.g. 'neutron') to ensure that artifacts are correctly processed for that project.  
__label__objective Refactor processing of testr artifacts for reuse  Previously, only testr artifacts for tempest were being processed on cleanup.  Functional jobs for neutron and neutron-vnpaas have adding their own artifact processing into hook scripts to work around this limitation, but this duplication of effort is costly.  This change refactors the existing artifact processing so it can be configurably targeted at any project's testr artifacts.  The DEVSTACK_GATE_TESTR_ARTIFACT_TARGET environment variable can be set to the repo path name (e.g. 'neutron') to ensure that artifacts are correctly processed for that project.  
__label__refactoring Refactor ilo.deploy.get_single_nic_with_vif_port_id()  Move ilo.deploy._get_single_nic_with_vif_port_id() to deploy_utils.get_single_nic_with_vif_port_id() in order to share between iLO driver and iRMC driver as a common function.  
__label__quality Refactor keystone-all  There was a lot of code in keystone-all. Functions in keystone-all can't be called from the tests.  This change moves most of the code from keystone-all into a new keystone.eventlet_server module.  
__label__testing Refactor keystone-all  There was a lot of code in keystone-all. Functions in keystone-all can't be called from the tests.  This change moves most of the code from keystone-all into a new keystone.eventlet_server module.  
__label__objective Refactor keystone-all  There was a lot of code in keystone-all. Functions in keystone-all can't be called from the tests.  This change moves most of the code from keystone-all into a new keystone.eventlet_server module.  
__label__quality Refactor metering utility and view functions  Some of these function were copied from Horizon and then modified. After pushing those modifications back to Horizon, we should be able to call the Horizon functions and delete the copied code from Tuskar-UI.  
__label__objective Refactor metering utility and view functions  Some of these function were copied from Horizon and then modified. After pushing those modifications back to Horizon, we should be able to call the Horizon functions and delete the copied code from Tuskar-UI.  
__label__quality Refactor _convert_sgr_to_iptables_rules in iptables_firewall  The function is refactored to build ipset and non ipset iptables rules on separate functions.  Partially implements blueprint refactor-iptables-firewall-driver  
__label__objective Refactor _convert_sgr_to_iptables_rules in iptables_firewall  The function is refactored to build ipset and non ipset iptables rules on separate functions.  Partially implements blueprint refactor-iptables-firewall-driver  
__label__quality Refactor iptables rule expansion for the non ipset case  IptablesFirewallDriver / _select_sg_rules_for_port was handling the rule expansion for the non ipset case all inside the same function.  This patch refactors the expansion out, so it will be more clear, and easier to cut out non-ipset code later in time.  Partially implements blueprint refactor-iptables-firewall-driver  
__label__objective Refactor iptables rule expansion for the non ipset case  IptablesFirewallDriver / _select_sg_rules_for_port was handling the rule expansion for the non ipset case all inside the same function.  This patch refactors the expansion out, so it will be more clear, and easier to cut out non-ipset code later in time.  Partially implements blueprint refactor-iptables-firewall-driver  
__label__quality Refactor the hook logic into a reusable function  Hook logic exists twice. Let's refactor it into a function so that it can be reused for more hooks.  
__label__quality Refactor metering utility and view functions  Many of these functions have been copied to Tuskar-UI and then have diverged in both places. This is an attempt to consolidate these functions and eliminate any code duplication. These modifications to horizon utility and view metering functions should make it possible to delete the duplicated code from Tuskar-UI.  
__label__objective Refactor metering utility and view functions  Many of these functions have been copied to Tuskar-UI and then have diverged in both places. This is an attempt to consolidate these functions and eliminate any code duplication. These modifications to horizon utility and view metering functions should make it possible to delete the duplicated code from Tuskar-UI.  
__label__refactoring Assignment sql backend create_grant refactoring  Moved calculate_type function to be a class method of AssignmentType.  
__label__refactoring Refactor meetings.py  Make better use of Meetings objects by refactoring functions applying to them as object methods.  Clean up superfluous argument value copy in cli.py as well.  
__label__objective Added comments, and refactored _add_rule_by_security_group  Added some comments, and extracted fixed egress rules addition to a separate function.  Partially implements blueprint refactor-iptables-firewall-driver  
__label__quality Refactor assignment manager/driver methods  This is the part of the more comprehensive split of assignments, which rationalizes both the backend and controllers. In order to make this change easier for reviewers, it is divided into a number of smaller patches.  Previous patches have:  - Moved role management into its own manager and drivers - Fixed incorrect doc strings for grant driver methods - Updated controllers to call the new role manager - Updated unit tests to call the new role manager  This patch refactors the assignment manager and driver methods to logically separate the project/domain functionality from that of the actual assignments in preparation for the move of projects/domains to their own backend. This patch should not cause any functional change.  Future patches will:  - Split projects and domains into their own manager/backend - Update the assignment controller to call the new manager - Update the tests to call the new manager - Split the assignment controller, giving projects/domains   their own controller  Partially implements: bp pluggable-assignments  
__label__testing Refactor assignment manager/driver methods  This is the part of the more comprehensive split of assignments, which rationalizes both the backend and controllers. In order to make this change easier for reviewers, it is divided into a number of smaller patches.  Previous patches have:  - Moved role management into its own manager and drivers - Fixed incorrect doc strings for grant driver methods - Updated controllers to call the new role manager - Updated unit tests to call the new role manager  This patch refactors the assignment manager and driver methods to logically separate the project/domain functionality from that of the actual assignments in preparation for the move of projects/domains to their own backend. This patch should not cause any functional change.  Future patches will:  - Split projects and domains into their own manager/backend - Update the assignment controller to call the new manager - Update the tests to call the new manager - Split the assignment controller, giving projects/domains   their own controller  Partially implements: bp pluggable-assignments  
__label__objective Refactor assignment manager/driver methods  This is the part of the more comprehensive split of assignments, which rationalizes both the backend and controllers. In order to make this change easier for reviewers, it is divided into a number of smaller patches.  Previous patches have:  - Moved role management into its own manager and drivers - Fixed incorrect doc strings for grant driver methods - Updated controllers to call the new role manager - Updated unit tests to call the new role manager  This patch refactors the assignment manager and driver methods to logically separate the project/domain functionality from that of the actual assignments in preparation for the move of projects/domains to their own backend. This patch should not cause any functional change.  Future patches will:  - Split projects and domains into their own manager/backend - Update the assignment controller to call the new manager - Update the tests to call the new manager - Split the assignment controller, giving projects/domains   their own controller  Partially implements: bp pluggable-assignments  
__label__integration Refactor db api:  1. Increasing flexibility of function parameters. 2. Passing session as a parameter.  
__label__objective Refactor db api:  1. Increasing flexibility of function parameters. 2. Passing session as a parameter.  
__label__quality VMware: refactor utility functions related to VMDK  Replace get_vmdk_path and get_vmdk_path_and_adapter_type with a new function called get_vmdk_info which returns a named tuple with all properties needed for VMDK operations.  
__label__objective VMware: refactor utility functions related to VMDK  Replace get_vmdk_path and get_vmdk_path_and_adapter_type with a new function called get_vmdk_info which returns a named tuple with all properties needed for VMDK operations.  
__label__quality Refactor sql2subunit to use get_tests_run_dicts_from_run_id  This commit takes the sql2subunit method in write_subunit and rewrites it to use the get_tests_run_dicts_from_run_id() function. This significantly improves the performance of sql2subunit by using a single joined query to collect information, rather than running multiple queries serially in a loop.  
__label__objective Refactor sql2subunit to use get_tests_run_dicts_from_run_id  This commit takes the sql2subunit method in write_subunit and rewrites it to use the get_tests_run_dicts_from_run_id() function. This significantly improves the performance of sql2subunit by using a single joined query to collect information, rather than running multiple queries serially in a loop.  
__label__quality mall refactor in run function  This patch properly print in the debug the exception that might ocurr when rally calls the cmd.cliutils.run command  
__label__quality Refactored help string generation  Refactored code to generate configuration help strings into its own private function. The motivation is to use the same function to generate help strings for both configuration parameters (existing functionality) and parameter groups (to be added).  Partial-Bug 1395819  
__label__objective Refactored help string generation  Refactored code to generate configuration help strings into its own private function. The motivation is to use the same function to generate help strings for both configuration parameters (existing functionality) and parameter groups (to be added).  Partial-Bug 1395819  
__label__refactoring Refactoring "checks_functions" to check function definitions  - old checks_functions functionality preserved as "checks_calls"  
__label__refactoring Refactor Zone import functionality  
__label__refactoring Minor refactor of _setup_instance_group()  This patch is a minor refactoring of the _setup_instance_group() method in the filter scheduler.  The majority of the method was inside of a conditional.  This primarily reverses that and reduces the nesting depth used.  There should be no functional changes at all in this patch.  
__label__quality Minor refactor of _setup_instance_group()  This patch is a minor refactoring of the _setup_instance_group() method in the filter scheduler.  The majority of the method was inside of a conditional.  This primarily reverses that and reduces the nesting depth used.  There should be no functional changes at all in this patch.  
__label__refactoring Small refactoring of get_by_id methods  * Only single invocation of this function left in utils.general * Removed unused _find_by_id in direct.py  
__label__testing Fuel-agent functional tests refactoring  Removed fuel-agent dependecy from functional tests.  
__label__quality Fuel-agent functional tests refactoring  Removed fuel-agent dependecy from functional tests.  
__label__testing Refactor secret functional tests using models and behaviors  Updated the functional tests to use models and behavoirs for secrets.  
__label__quality Refactor secret functional tests using models and behaviors  Updated the functional tests to use models and behavoirs for secrets.  
__label__objective Refactor ramdisk element to allow alternate implementations  In preparation for enabling Dracut-based ramdisks, this change factors out functionality that is common to both busybox and Dracut ramdisks.  Said functionality is moved to a ramdisk-base element which is added as a dependency of the ramdisk element.  ramdisk now only contains the functionality specific to building busybox-based ramdisks.  bp tripleo-juno-dracut-ramdisks 
__label__quality Refactor ramdisk element to allow alternate implementations  In preparation for enabling Dracut-based ramdisks, this change factors out functionality that is common to both busybox and Dracut ramdisks.  Said functionality is moved to a ramdisk-base element which is added as a dependency of the ramdisk element.  ramdisk now only contains the functionality specific to building busybox-based ramdisks.  bp tripleo-juno-dracut-ramdisks 
__label__refactoring Refactor l3_agent.process_router_floating_ip_addresses  Split it out to several functions.  
__label__refactoring Refactor functions in eip.py  Refactor functions in eip.py for some similar codes.  Implements blueprint implement-ec2eip-updatable  
__label__quality Simple refactor to stop passing around an unused parameter  There is no functional change in this patch.  However, this refactor allows another patch [1] to make a simpler change to the code base.  [1] https://review.openstack.org/#/c/109776  
__label__objective Simple refactor to stop passing around an unused parameter  There is no functional change in this patch.  However, this refactor allows another patch [1] to make a simpler change to the code base.  [1] https://review.openstack.org/#/c/109776  
__label__objective Adds Support for Recent Puppet Module Refactor  The puppet-openshift_origin module recently went through a refactor in preperation for the v4 OSO release.  This patch changes the necessary puppet parameters for the template to continue functioning.  
__label__objective Adds Support for Recent Puppet Module Refactor  The puppet-openshift_origin module recently went through a refactor in preperation for the v4 OSO release.  This patch changes the necessary puppet parameters for the template to continue functioning.  
__label__refactoring Refactor AWS::EC2::Instance delete handling  Refactor instance to use the nova_utils delete function.  Closes-Bug: #1329453 
__label__objective Refactor functional tests  * Reduce amout of time waiting for element that should not be exist * Impove some xpaths * Fix screenshot taking only on fail * Add config file to git ignore  In plans remove all constants with xpaths into a separate python file  
__label__testing Refactor functional tests  * Reduce amout of time waiting for element that should not be exist * Impove some xpaths * Fix screenshot taking only on fail * Add config file to git ignore  In plans remove all constants with xpaths into a separate python file  
__label__objective Refactor functional tests  * Reduce amout of time waiting for element that should not be exist * Impove some xpaths * Fix screenshot taking only on fail * Add config file to git ignore  In plans remove all constants with xpaths into a separate python file  
__label__quality Refactor selecting values from an attribute  Move the code to select particular keys/indices from an attribute value out of the get_attr intrinsic functions and into the attributes module as a separate function.  
__label__objective Refactor selecting values from an attribute  Move the code to select particular keys/indices from an attribute value out of the get_attr intrinsic functions and into the attributes module as a separate function.  
__label__refactoring Refactored datastores to use common chown function  Refactored mongdb and couchbase managers to use the common change_owner function defined in trove/guestagent/common/operating_system.py instead of rolling their own.  
__label__quality Refactor ssh actions used for node erasing  Patch fixes few issues with erasing drives while stopping deployment during provisioning, e.g.:  * executing dd with non-existing under    debootstrap shell option 'flag';  * broken check of block device major code;  * incorrect order of arguments, which are passed    to erase_data function; Also it implements more robust mechanizm to detect provisining or provisined node.  
__label__objective Refactor ssh actions used for node erasing  Patch fixes few issues with erasing drives while stopping deployment during provisioning, e.g.:  * executing dd with non-existing under    debootstrap shell option 'flag';  * broken check of block device major code;  * incorrect order of arguments, which are passed    to erase_data function; Also it implements more robust mechanizm to detect provisining or provisined node.  
__label__objective Refactor ssh actions used for node erasing  Patch fixes few issues with erasing drives while stopping deployment during provisioning, e.g.:  * executing dd with non-existing under    debootstrap shell option 'flag';  * broken check of block device major code;  * incorrect order of arguments, which are passed    to erase_data function; Also it implements more robust mechanizm to detect provisining or provisined node.  
__label__quality Refactors VIF configuration logic  There are too many if/else checks when we choose the right function to conduct vif operations. We can do better by setting an alias of each vif type and getattr on the nessesary function obj.  Please enter the commit message for your changes. Lines starting  
__label__objective Refactors VIF configuration logic  There are too many if/else checks when we choose the right function to conduct vif operations. We can do better by setting an alias of each vif type and getattr on the nessesary function obj.  Please enter the commit message for your changes. Lines starting  
__label__quality Refactor the PBM support  Having a Pbm class that inherits from Vim is a design mistake that we need to fix before start using Pbm features in other projects like Nova.  This patch introduces a new base class 'Service' which provides common functionality for invoking vSphere APIs and both Vim and Pbm inherit from it. That will allow to further evolve our APIs and add features which are specific to only Vim or Pbm.  Existing clients which use the Vim object through VMwareAPISession are not impacted by this change. The interface of VMwareAPISession is unchanged.  
__label__objective Refactor the PBM support  Having a Pbm class that inherits from Vim is a design mistake that we need to fix before start using Pbm features in other projects like Nova.  This patch introduces a new base class 'Service' which provides common functionality for invoking vSphere APIs and both Vim and Pbm inherit from it. That will allow to further evolve our APIs and add features which are specific to only Vim or Pbm.  Existing clients which use the Vim object through VMwareAPISession are not impacted by this change. The interface of VMwareAPISession is unchanged.  
__label__objective Refactor the PBM support  Having a Pbm class that inherits from Vim is a design mistake that we need to fix before start using Pbm features in other projects like Nova.  This patch introduces a new base class 'Service' which provides common functionality for invoking vSphere APIs and both Vim and Pbm inherit from it. That will allow to further evolve our APIs and add features which are specific to only Vim or Pbm.  Existing clients which use the Vim object through VMwareAPISession are not impacted by this change. The interface of VMwareAPISession is unchanged.  
__label__quality Libvirt driver class refactoring  The libvirt driver.py class is growing ever larger and more complicated. There are circular dependencies between this class and other libvirt classes. This work aims to split some of the functionality out into new classes  
__label__objective Libvirt driver class refactoring  The libvirt driver.py class is growing ever larger and more complicated. There are circular dependencies between this class and other libvirt classes. This work aims to split some of the functionality out into new classes  
__label__objective Refactor json validator  * Changed the rest of the exception raising to use the _assert_validity   function. * Introduced minimum set of required  names secret refs in containers.   (for both rsa and certificates). * Added tests regarding these required names.  
__label__testing Refactor json validator  * Changed the rest of the exception raising to use the _assert_validity   function. * Introduced minimum set of required  names secret refs in containers.   (for both rsa and certificates). * Added tests regarding these required names.  
__label__objective Refactor json validator  * Changed the rest of the exception raising to use the _assert_validity   function. * Introduced minimum set of required  names secret refs in containers.   (for both rsa and certificates). * Added tests regarding these required names.  
__label__quality vmware: Refactor: fold volume_util.py into volumeops.py  volume_util.py seems to have originally been intended to be a general repository of operations on volumes. In fact, it was an arbitrary collection of iscsi functions which were exclusively called by VMwareVolumeOps with VMwareVolumeOps private data as arguments.  This change moves all functions from volume_util.py into VMwareVolumeOps in volumeops.py. This makes it simpler to read and understand the code, as there is now only a single place to look for iscsi functions. It also moves StorageError into volumeops.py, as that is the only place it is used. Arguments have been updated to use private data directly rather than having them passed in. In addition, function names have been updated to accurately reflect their actual purpose.  There are no functional changes. All code change is purely mechanical.  
__label__objective vmware: Refactor: fold volume_util.py into volumeops.py  volume_util.py seems to have originally been intended to be a general repository of operations on volumes. In fact, it was an arbitrary collection of iscsi functions which were exclusively called by VMwareVolumeOps with VMwareVolumeOps private data as arguments.  This change moves all functions from volume_util.py into VMwareVolumeOps in volumeops.py. This makes it simpler to read and understand the code, as there is now only a single place to look for iscsi functions. It also moves StorageError into volumeops.py, as that is the only place it is used. Arguments have been updated to use private data directly rather than having them passed in. In addition, function names have been updated to accurately reflect their actual purpose.  There are no functional changes. All code change is purely mechanical.  
__label__objective Task helpers partial refactoring added  What is done: - most methods from TaskHelper class moved to objects.Task; - rpc receiver code changed, explicit controll of sqlalchemy session for   Task object methods added.  What is missed: - TaskHelper class is still in use as far as it holds several common use   helper function (in future will be moved to utils module); - tests are not updated; - partial refactoring - system in not in a working state.  
__label__objective Task helpers partial refactoring added  What is done: - most methods from TaskHelper class moved to objects.Task; - rpc receiver code changed, explicit controll of sqlalchemy session for   Task object methods added.  What is missed: - TaskHelper class is still in use as far as it holds several common use   helper function (in future will be moved to utils module); - tests are not updated; - partial refactoring - system in not in a working state.  
__label__refactoring Refactored RabbitMQ.py  * suppressed html output from rabbitmq management * add functions  
__label__quality Refactor tempest config generator  Use `requests` library instead of `urllib2` & `httplib` Main profit from `requests` library: - `requests` is HTTP for Humans; - `requests` is well documented[1]; - `requests` can save downloaded files by parts, so usage of memory is less(useful when downloading big data, for example - some images) - `requests` has same name as in Python 2x and Python 3x  Use `inspect.getmembers`[2][3] for discovery of each function for section generator. Profit : decrease lines of code  Add checks for existence of subnet in 'network' section.  Move function `_write_config`[4] from class `Tempest`[5] to `TempestConf`. Reason: this function not related to verifier for Tempest.  Fix message for exception when user doesn't have admin role.  Move name of section into kwargs to each section function. Profit: less string objects with section names  [1] - http://docs.python-requests.org/en/latest/ [2] - https://docs.python.org/2/library/inspect.html#types-and-members [3] - https://docs.python.org/3.3/library/inspect.html#types-and-members [4] - http://git.io/E1zPOQ [5] - http://git.io/8Ru-Yw  
__label__objective Refactor tempest config generator  Use `requests` library instead of `urllib2` & `httplib` Main profit from `requests` library: - `requests` is HTTP for Humans; - `requests` is well documented[1]; - `requests` can save downloaded files by parts, so usage of memory is less(useful when downloading big data, for example - some images) - `requests` has same name as in Python 2x and Python 3x  Use `inspect.getmembers`[2][3] for discovery of each function for section generator. Profit : decrease lines of code  Add checks for existence of subnet in 'network' section.  Move function `_write_config`[4] from class `Tempest`[5] to `TempestConf`. Reason: this function not related to verifier for Tempest.  Fix message for exception when user doesn't have admin role.  Move name of section into kwargs to each section function. Profit: less string objects with section names  [1] - http://docs.python-requests.org/en/latest/ [2] - https://docs.python.org/2/library/inspect.html#types-and-members [3] - https://docs.python.org/3.3/library/inspect.html#types-and-members [4] - http://git.io/E1zPOQ [5] - http://git.io/8Ru-Yw  
__label__objective Refactor tempest config generator  Use `requests` library instead of `urllib2` & `httplib` Main profit from `requests` library: - `requests` is HTTP for Humans; - `requests` is well documented[1]; - `requests` can save downloaded files by parts, so usage of memory is less(useful when downloading big data, for example - some images) - `requests` has same name as in Python 2x and Python 3x  Use `inspect.getmembers`[2][3] for discovery of each function for section generator. Profit : decrease lines of code  Add checks for existence of subnet in 'network' section.  Move function `_write_config`[4] from class `Tempest`[5] to `TempestConf`. Reason: this function not related to verifier for Tempest.  Fix message for exception when user doesn't have admin role.  Move name of section into kwargs to each section function. Profit: less string objects with section names  [1] - http://docs.python-requests.org/en/latest/ [2] - https://docs.python.org/2/library/inspect.html#types-and-members [3] - https://docs.python.org/3.3/library/inspect.html#types-and-members [4] - http://git.io/E1zPOQ [5] - http://git.io/8Ru-Yw  
__label__quality Groups portal infra code refactor  This patch removes the drush make site building function from groups-dev instance, and now directly fetch release tarballs from http://tarballs.openstack.org/groups repository. With an advanced multi-slot deployment architecture it prevents the typical Drupal WSOD issues that randomly caused site malfunction when a request arrived during installation. It also simplifies the deployment steps using the standard drush aliases and drush-dsd extension and supports local configuration variables in local_settings.php file.  
__label__objective Groups portal infra code refactor  This patch removes the drush make site building function from groups-dev instance, and now directly fetch release tarballs from http://tarballs.openstack.org/groups repository. With an advanced multi-slot deployment architecture it prevents the typical Drupal WSOD issues that randomly caused site malfunction when a request arrived during installation. It also simplifies the deployment steps using the standard drush aliases and drush-dsd extension and supports local configuration variables in local_settings.php file.  
__label__quality Refactor deployment and statefulset functions  This change refactors the mkDeployment and mkStatefulset function to enable spliting the component to their own file. The main difference is that the method needs an extra input for the application name.  
__label__objective Refactor deployment and statefulset functions  This change refactors the mkDeployment and mkStatefulset function to enable spliting the component to their own file. The main difference is that the method needs an extra input for the application name.  
__label__quality Refactor kubernetes resources constructor to the function file  This change refactors the mkService function for easier maintainance and usage outside of the resource function.  
__label__quality Refactor file creation to function files  This change splits the mkConf into dedicated functions file for easier maintainance.  
__label__quality Refactor auxiliary methods for MongoDB unit tests  This patchset DRYes the implementation of auxiliary functions in MongoDB unit tests.  
__label__testing Refactor auxiliary methods for MongoDB unit tests  This patchset DRYes the implementation of auxiliary functions in MongoDB unit tests.  
__label__quality Refactor code to select boot kernel  The script to find best kernel from image (used by vm and baremetal element) is duplicated and is not in sync with each other. Moving the code to img-functions as a function will reduce duplicated code and make it reusable in future.  
__label__objective Refactor code to select boot kernel  The script to find best kernel from image (used by vm and baremetal element) is duplicated and is not in sync with each other. Moving the code to img-functions as a function will reduce duplicated code and make it reusable in future.  
__label__refactoring Refactor some router-related methods  This is done in preparation for the distributed router functionality.  Partially-implements: blueprint neutron-ovs-dvr  
__label__quality Refactors ClientInterface and Guzzle adapter.  This patch achieves three interrelated changes  1. an update to the ClientInterface, making it more efficient and consistent with other HTTP libraries. PSR-FIG messages have also been added as separate classes, rather than lumped as one. Guzzle functionality has also been moved to its own namespace;  2. the refactoring of `GuzzleClient` to `GuzzleAdapter`, including relevant changes needed for the interface change (1). We now have ADAPTERS that bridge our interfaces with Guzzle's - making that difference much clearer, extensible, less tightly coupled and less brittle;  3. moving "bad request" error handling into its own dedicated space, based on how the new Adapter functionality (2). Previously the client tried to do all the exception logic - but this is not strictly its responsibility. This logic has been shipped out to a base RequestException which instantiates one of its children exception based on the HTTP status code.  Although I have attempted to keep the scope of this patch to a minimum, as granular as possible, because the interface is a core internal API, various other files need to be modified to reflect the change. In terms of the other two changes, these are inextricably linked to the interface change, so cannot be teased out into their own patches.  
__label__integration Refactors ClientInterface and Guzzle adapter.  This patch achieves three interrelated changes  1. an update to the ClientInterface, making it more efficient and consistent with other HTTP libraries. PSR-FIG messages have also been added as separate classes, rather than lumped as one. Guzzle functionality has also been moved to its own namespace;  2. the refactoring of `GuzzleClient` to `GuzzleAdapter`, including relevant changes needed for the interface change (1). We now have ADAPTERS that bridge our interfaces with Guzzle's - making that difference much clearer, extensible, less tightly coupled and less brittle;  3. moving "bad request" error handling into its own dedicated space, based on how the new Adapter functionality (2). Previously the client tried to do all the exception logic - but this is not strictly its responsibility. This logic has been shipped out to a base RequestException which instantiates one of its children exception based on the HTTP status code.  Although I have attempted to keep the scope of this patch to a minimum, as granular as possible, because the interface is a core internal API, various other files need to be modified to reflect the change. In terms of the other two changes, these are inextricably linked to the interface change, so cannot be teased out into their own patches.  
__label__objective Refactors ClientInterface and Guzzle adapter.  This patch achieves three interrelated changes  1. an update to the ClientInterface, making it more efficient and consistent with other HTTP libraries. PSR-FIG messages have also been added as separate classes, rather than lumped as one. Guzzle functionality has also been moved to its own namespace;  2. the refactoring of `GuzzleClient` to `GuzzleAdapter`, including relevant changes needed for the interface change (1). We now have ADAPTERS that bridge our interfaces with Guzzle's - making that difference much clearer, extensible, less tightly coupled and less brittle;  3. moving "bad request" error handling into its own dedicated space, based on how the new Adapter functionality (2). Previously the client tried to do all the exception logic - but this is not strictly its responsibility. This logic has been shipped out to a base RequestException which instantiates one of its children exception based on the HTTP status code.  Although I have attempted to keep the scope of this patch to a minimum, as granular as possible, because the interface is a core internal API, various other files need to be modified to reflect the change. In terms of the other two changes, these are inextricably linked to the interface change, so cannot be teased out into their own patches.  
__label__quality Refactor next_weekday into Meeting class  Previously, the next_weekday method was the only module level function in the meeting module, and that was the only place it was used. This change incorporates it into the Meeting class since it makes sense to have it there since that's the only thing that uses it.  This also touches up the doc strings of next_weekday.  
__label__objective Refactor next_weekday into Meeting class  Previously, the next_weekday method was the only module level function in the meeting module, and that was the only place it was used. This change incorporates it into the Meeting class since it makes sense to have it there since that's the only thing that uses it.  This also touches up the doc strings of next_weekday.  
__label__quality Refactor tests regarding required attributes  Some tests regarding the _required_attribute(s) functions in the wsgi module seemed to be somewhat confusing, so I refactored them trying to increase redability  
__label__testing Refactor tests regarding required attributes  Some tests regarding the _required_attribute(s) functions in the wsgi module seemed to be somewhat confusing, so I refactored them trying to increase redability  
__label__objective Refactor tests regarding required attributes  Some tests regarding the _required_attribute(s) functions in the wsgi module seemed to be somewhat confusing, so I refactored them trying to increase redability  
__label__refactoring Refactored code  * Main steps split into functions * Add error handling  
__label__objective Refactored code  * Main steps split into functions * Add error handling  
__label__quality Refactor preference provider  Preference provider should not use $_prefixed functions not collide with inbuilt angular functions  $get -> get $set -> set  
__label__objective Refactored scripts code  * Add common functions library * Refactored configure_api.sh  
__label__quality Refactor the `matches` function  - Clearer parameter names and doc string - Use fnmatch.fnmatch instead of re.match and fnmatch.translate - Use `any` to make code more succint.  
__label__objective Refactor the `matches` function  - Clearer parameter names and doc string - Use fnmatch.fnmatch instead of re.match and fnmatch.translate - Use `any` to make code more succint.  
__label__objective Refactor dynamic UI field parsing a bit  Now it is possible to use deeply-nested dictionary keys 'name' and 'type' - because top-level 'name' and 'type' keys' processing is moved out from the recursive `parse_spec` function.  
__label__objective Refactor dynamic UI field parsing a bit  Now it is possible to use deeply-nested dictionary keys 'name' and 'type' - because top-level 'name' and 'type' keys' processing is moved out from the recursive `parse_spec` function.  
__label__quality VMware: spawn refactor - execute_create_vm  Moves the inner function "execute_create_vm" from the spawn method to a private method of VMwareVMOps. There is currently no rational reason for the function to be nested within the spawn method.  partial blueprint vmware-spawn-refactor  
__label__objective VMware: spawn refactor - execute_create_vm  Moves the inner function "execute_create_vm" from the spawn method to a private method of VMwareVMOps. There is currently no rational reason for the function to be nested within the spawn method.  partial blueprint vmware-spawn-refactor  
__label__testing Refactor WebUI tests  - Adapted tests for IceHouse horizon - Deleted tests for deprecated functionalities - Prepared basis for new tests  
__label__objective Refactor WebUI tests  - Adapted tests for IceHouse horizon - Deleted tests for deprecated functionalities - Prepared basis for new tests  
__label__refactoring Minor refactor of storage policy helper functions  Pulled from a larger pending review where it became clear that we didn't need to keep adding get_data_dir(index) type routines so this patch makes a generic function in the policy module that constructs strings given a base and a policy index then others can use it directly or as a partial (as is done with get_data_dir() for example)  
__label__objective Minor refactor of storage policy helper functions  Pulled from a larger pending review where it became clear that we didn't need to keep adding get_data_dir(index) type routines so this patch makes a generic function in the policy module that constructs strings given a base and a policy index then others can use it directly or as a partial (as is done with get_data_dir() for example)  
__label__refactoring Refactor: move federation functions to federation utils  Some of the functions created in keystone.auth.plugins.saml2 can be re-used for other federation protocols that are supported in the future. Propose moving them to keystone.contrib.federation.utils.  
__label__quality Refactor: move federation functions to federation utils  Some of the functions created in keystone.auth.plugins.saml2 can be re-used for other federation protocols that are supported in the future. Propose moving them to keystone.contrib.federation.utils.  
__label__objective Refactor: move federation functions to federation utils  Some of the functions created in keystone.auth.plugins.saml2 can be re-used for other federation protocols that are supported in the future. Propose moving them to keystone.contrib.federation.utils.  
__label__refactoring Refactor: moved flatten function to utils  Previously, the keystone.common.authorization module contained the function "flatten", which would transform a dictionary (possibly nested) into a single level dictionary. Given that the "flattening" of a dictionary is a more general concept, not related to authorization, I thought it would be more intuitive to have it in the keystone.common.utils module.  
__label__objective Refactor: moved flatten function to utils  Previously, the keystone.common.authorization module contained the function "flatten", which would transform a dictionary (possibly nested) into a single level dictionary. Given that the "flattening" of a dictionary is a more general concept, not related to authorization, I thought it would be more intuitive to have it in the keystone.common.utils module.  
__label__refactoring Unfinished fuelclient refactoring   * package structure  * some implementation ideas  * a lot of working functions  
__label__quality Refactor nova.virt.ironic.driver get_host_stats  Refactor the get_host_stats() method to be cleaner and easier to maintain.  This patch does not change any APIs or functionality.  
__label__objective Refactor nova.virt.ironic.driver get_host_stats  Refactor the get_host_stats() method to be cleaner and easier to maintain.  This patch does not change any APIs or functionality.  
__label__refactoring Refactor murano functional tests  
__label__testing Refactor murano functional tests  
__label__quality Refactor Template.parse()  Split out Template.parse() as a separate function. This saves an expensive method call to self.functions() for every potential intrinsic function in the template, plus makes a template parsing routine available to other parts of the code that may want to use it, without being tied to a Template's ideas of what the intrinsic functions available are.  
__label__objective Refactor Template.parse()  Split out Template.parse() as a separate function. This saves an expensive method call to self.functions() for every potential intrinsic function in the template, plus makes a template parsing routine available to other parts of the code that may want to use it, without being tied to a Template's ideas of what the intrinsic functions available are.  
__label__quality Refactor CurrentContextEntryPoint function  Currently it takes ClusterType as first parameter, however this parameter can be retrieved via appropriate function CurrentContextClusterType in the same module.  
__label__objective Refactor CurrentContextEntryPoint function  Currently it takes ClusterType as first parameter, however this parameter can be retrieved via appropriate function CurrentContextClusterType in the same module.  
__label__testing Updates the Compute-Volumes integration tests for Volume refactors  * Changed instances of storage_client/storage_behavior to   blockstorage_client/blockstorage_behavior * Removed parameters from function calls that are now set   as defaults  
__label__quality Updates the Compute-Volumes integration tests for Volume refactors  * Changed instances of storage_client/storage_behavior to   blockstorage_client/blockstorage_behavior * Removed parameters from function calls that are now set   as defaults  
__label__objective Updates the Compute-Volumes integration tests for Volume refactors  * Changed instances of storage_client/storage_behavior to   blockstorage_client/blockstorage_behavior * Removed parameters from function calls that are now set   as defaults  
__label__quality Complete session hadling refactoring  All parts of system have been refactored. Session creation has been simplified. Now session is created only when it is desperately needed and its using is maximized instead of uncontrollable producing for each and every block of code which is supposed to communicate with db.  This refactoring simplifies db data transfer management and makes it more explicit for further developing.  Unit and functional tests have been updated.  
__label__objective Complete session hadling refactoring  All parts of system have been refactored. Session creation has been simplified. Now session is created only when it is desperately needed and its using is maximized instead of uncontrollable producing for each and every block of code which is supposed to communicate with db.  This refactoring simplifies db data transfer management and makes it more explicit for further developing.  Unit and functional tests have been updated.  
__label__integration Complete session hadling refactoring  All parts of system have been refactored. Session creation has been simplified. Now session is created only when it is desperately needed and its using is maximized instead of uncontrollable producing for each and every block of code which is supposed to communicate with db.  This refactoring simplifies db data transfer management and makes it more explicit for further developing.  Unit and functional tests have been updated.  
__label__testing Complete session hadling refactoring  All parts of system have been refactored. Session creation has been simplified. Now session is created only when it is desperately needed and its using is maximized instead of uncontrollable producing for each and every block of code which is supposed to communicate with db.  This refactoring simplifies db data transfer management and makes it more explicit for further developing.  Unit and functional tests have been updated.  
__label__quality Refactor stack watching into a separate class  In later oslo.messaging patches, the Stack watch functionality must be called from two separate places (the endpoint class and the service class).  In order to do that and not result in needless code duplication, break it into a separate class and so the object can be passed around.  
__label__objective Refactor stack watching into a separate class  In later oslo.messaging patches, the Stack watch functionality must be called from two separate places (the endpoint class and the service class).  In order to do that and not result in needless code duplication, break it into a separate class and so the object can be passed around.  
__label__quality Refactor the overcloud views tests  Move the repeated parts of tests to a separate function.  
__label__testing Refactor the overcloud views tests  Move the repeated parts of tests to a separate function.  
__label__objective Refactor use deployment command  * Renamed 'deployment' filename in 'use_command' in order to use this file with other use subcommands such as 'task' * Refactored by moving code into new generic functions that   * check if the 'use_command' file exists:   _check_rally_configuration_dir_exists(self)   * update env var in the 'use_comand' file:   _update_attribute_in_use_file(self, attribute, value)  
__label__objective Refactor use deployment command  * Renamed 'deployment' filename in 'use_command' in order to use this file with other use subcommands such as 'task' * Refactored by moving code into new generic functions that   * check if the 'use_command' file exists:   _check_rally_configuration_dir_exists(self)   * update env var in the 'use_comand' file:   _update_attribute_in_use_file(self, attribute, value)  
__label__refactoring Refactor a quorum-size calculation  No behavior change, just use the utility function instead of rolling our own.  
__label__testing unit tests: Refactor to accomodate lazy evaluation  Do a complete resolution of all functions on each snippet, rather than specifying individual function resolution methods to call.  
__label__quality Refactor large method into 4 methods  In trying to reuse some of the code in views, I realized that the get method for SampleView is quite long. This change breaks this method into 3 functions. The get method now is responsible for parsing HTTP arguments and formatting AJAX response. The other functionality has been pulled out. One of these functions (query_data) can be used by other views in the future.  
__label__objective Refactor large method into 4 methods  In trying to reuse some of the code in views, I realized that the get method for SampleView is quite long. This change breaks this method into 3 functions. The get method now is responsible for parsing HTTP arguments and formatting AJAX response. The other functionality has been pulled out. One of these functions (query_data) can be used by other views in the future.  
__label__objective Start refactoring scneario runner  We should remove spaghetti from code and make it safer.  Current code have a few issues: 1) If something went wrong (and it can) we won't cleanup fully cloud 2) There is a lot of spaghetti around catching exception and preparing cloud 3) There will be even more spaghetti when we try to extend current functionallity with (stress exectution/non admin users/another loads and cloud pre configuration) 4) We have a lot of IFs that switch what kind of exectuion we will use. This should be done via classes and inheritance IMO.  This patch fix a part of issues: 1) Add Context class that allows us to create/delete tmp users and tenants 2) Add Context class that makes all cleanups. For users if they are present and for admins if they are present. 3) Changed algorithm of deleting resources (try-catch) e.g. if 1 user wasn't deleted => we should try to continue and delete others. 4) Add some todos 5) Replace ScenarioRunner.run() method to use these context classes  
__label__objective Start refactoring scneario runner  We should remove spaghetti from code and make it safer.  Current code have a few issues: 1) If something went wrong (and it can) we won't cleanup fully cloud 2) There is a lot of spaghetti around catching exception and preparing cloud 3) There will be even more spaghetti when we try to extend current functionallity with (stress exectution/non admin users/another loads and cloud pre configuration) 4) We have a lot of IFs that switch what kind of exectuion we will use. This should be done via classes and inheritance IMO.  This patch fix a part of issues: 1) Add Context class that allows us to create/delete tmp users and tenants 2) Add Context class that makes all cleanups. For users if they are present and for admins if they are present. 3) Changed algorithm of deleting resources (try-catch) e.g. if 1 user wasn't deleted => we should try to continue and delete others. 4) Add some todos 5) Replace ScenarioRunner.run() method to use these context classes  
__label__objective Refactor task/flow flattening  - Instead of having to pass context data between the   recursive function calls, create an object to hold   this context data, which also contains the flattening   functionality itself. - Allow the flattening functions to be more easily   extended by having a selection function that matches   item type to flattening function. - Add pre/post flattening functions (which can be   extended/inherited to do different activites as   needed).  
__label__objective Refactor task/flow flattening  - Instead of having to pass context data between the   recursive function calls, create an object to hold   this context data, which also contains the flattening   functionality itself. - Allow the flattening functions to be more easily   extended by having a selection function that matches   item type to flattening function. - Add pre/post flattening functions (which can be   extended/inherited to do different activites as   needed).  
__label__objective Refactor Parameters Schema based on common Schema  This patch is last in a series of patches to unify the code for property and parameter validation based on a common Schema class.  The current patch refactors the implementation of the Parameters Schema to be a sub-class of the common Schema class in constraints.py so that most of the schema validation code can be shared for property and parameter validation and no two different code paths for mostly indentical functionality exist.  
__label__objective Refactor Parameters Schema based on common Schema  This patch is last in a series of patches to unify the code for property and parameter validation based on a common Schema class.  The current patch refactors the implementation of the Parameters Schema to be a sub-class of the common Schema class in constraints.py so that most of the schema validation code can be shared for property and parameter validation and no two different code paths for mostly indentical functionality exist.  
__label__testing Refactor environment functions in preparation for get_file  These functions have been reorganised to break out functions that deal with only file or URL handling to allow for better unit testing and to prepare for get_file which will also use some of these functions.  
__label__objective Refactor environment functions in preparation for get_file  These functions have been reorganised to break out functions that deal with only file or URL handling to allow for better unit testing and to prepare for get_file which will also use some of these functions.  
__label__quality shell: refactor boot to use _print_server  In the shell command when we use the command boot, at the end we use code to print some server information. We should use the already defined function _print_server.  
__label__objective shell: refactor boot to use _print_server  In the shell command when we use the command boot, at the end we use code to print some server information. We should use the already defined function _print_server.  
__label__refactoring Minor refactoring of dynamic_ui.  Move more functions to dynamic_ui.helpers.  
__label__objective Refactor task handler binding  Instead of using a dictionary of handler mappings use a dict[event] -> list of handler mappings, this allows the same function/handler to be bound more than once (which can be useful to do, depending on handler specifications) and to allow for removal of these handlers find the first match and remove it using the reflection callback comparison routine.  
__label__objective Refactor task handler binding  Instead of using a dictionary of handler mappings use a dict[event] -> list of handler mappings, this allows the same function/handler to be bound more than once (which can be useful to do, depending on handler specifications) and to allow for removal of these handlers find the first match and remove it using the reflection callback comparison routine.  
__label__objective Refactoring the loadbalancing view classes  In several view classes, there's overloaded functions that do nothing but calling the overloaded function and returning the results. Removed theses functions.  
__label__objective Refactoring the loadbalancing view classes  In several view classes, there's overloaded functions that do nothing but calling the overloaded function and returning the results. Removed theses functions.  
__label__refactoring Minor refactoring of dynamic_ui package.  Remove one inner import in dynamic_ui.services and rewrite a bit iterate_over_services() function.  
__label__refactoring First stage of Auth Provider refactor  * Surfaced rax and keystone authentication functions   so that they can be used without config files   when necessary  
__label__objective First stage of Auth Provider refactor  * Surfaced rax and keystone authentication functions   so that they can be used without config files   when necessary  
__label__objective Refactor setup_logging  This change just cleans up the setup_logging function. It was defined in keystone.common.config and then also exported from keystone.config. Also, it had extra parameters that were unused.  This takes care of a NOTE (which probably should have been a TODO) in the code.  
__label__objective Refactor setup_logging  This change just cleans up the setup_logging function. It was defined in keystone.common.config and then also exported from keystone.config. Also, it had extra parameters that were unused.  This takes care of a NOTE (which probably should have been a TODO) in the code.  
__label__testing Tests refactoring for ci  Function setUpPackage() from tests/__init__.py was modified: ostf-server setup was added as child process via subprocess.Process() construction so that now both unit and functional tests can be run without any pre setup of fake ostf-server nor nailgunmimic because these actions are managed now by nose.  
__label__objective Tests refactoring for ci  Function setUpPackage() from tests/__init__.py was modified: ostf-server setup was added as child process via subprocess.Process() construction so that now both unit and functional tests can be run without any pre setup of fake ostf-server nor nailgunmimic because these actions are managed now by nose.  
__label__objective Tests refactoring for ci  Function setUpPackage() from tests/__init__.py was modified: ostf-server setup was added as child process via subprocess.Process() construction so that now both unit and functional tests can be run without any pre setup of fake ostf-server nor nailgunmimic because these actions are managed now by nose.  
__label__refactoring Refactor Glance Images v2.0 Behaviors  Behaviors refactoring:  - used Glange default functionality for image creation  - values of tag, protected and visibility are by default set by Glance.  
__label__objective Refactor Glance Images v2.0 Behaviors  Behaviors refactoring:  - used Glange default functionality for image creation  - values of tag, protected and visibility are by default set by Glance.  
__label__refactoring Non major core refactoring  Some utilities were grouped in new file mixins.py. This was done with purpose of code spreading minimazing. Because of that two files are not neede any more so they were deleted (utils/utils.py and wsgi_utils.py). Unit and functional tests were updated.  
__label__testing Non major core refactoring  Some utilities were grouped in new file mixins.py. This was done with purpose of code spreading minimazing. Because of that two files are not neede any more so they were deleted (utils/utils.py and wsgi_utils.py). Unit and functional tests were updated.  
__label__objective Refactoring for generic benchmark cleanup  Initial refactoring which will be used in the generic benchmark cleanup implementation. Specifically the utility functions which existed in the NovaScenarios class are now exposed in benchmark.test_utils. Moreover a few of these functions have been enahanced to be more generic/flexible in nature.  Subsequent patch will provide the actual generic cleanup.  Implements partial: blueprint benchmark-cloud-cleanup  
__label__objective Refactoring for generic benchmark cleanup  Initial refactoring which will be used in the generic benchmark cleanup implementation. Specifically the utility functions which existed in the NovaScenarios class are now exposed in benchmark.test_utils. Moreover a few of these functions have been enahanced to be more generic/flexible in nature.  Subsequent patch will provide the actual generic cleanup.  Implements partial: blueprint benchmark-cloud-cleanup  
__label__objective Unittests refactoring for ci  Logic that supports automated execution of unit tests for ci purpose were added via setUp/tearDownPackage functions in testing/tests/__init__.py file. Now when tests started via nose in package setUp function nailgunmimic server is setting up in separate process and terminating in tearDown. This functionality provides unified way to execute unit tests.  
__label__testing Unittests refactoring for ci  Logic that supports automated execution of unit tests for ci purpose were added via setUp/tearDownPackage functions in testing/tests/__init__.py file. Now when tests started via nose in package setUp function nailgunmimic server is setting up in separate process and terminating in tearDown. This functionality provides unified way to execute unit tests.  
__label__objective Unittests refactoring for ci  Logic that supports automated execution of unit tests for ci purpose were added via setUp/tearDownPackage functions in testing/tests/__init__.py file. Now when tests started via nose in package setUp function nailgunmimic server is setting up in separate process and terminating in tearDown. This functionality provides unified way to execute unit tests.  
__label__refactoring Refactor convert() function to serialize().  Take advantage of PyYAML in python3.  
__label__objective Python code refactorings.  This commit refactors the python code in diskimage_builder slightly.  This is in preparation for a larger review that adds more functionality to the python code, namely the ability to apply elements to the current system as opposed to a chroot.  Further, the refactorings can stand on their own for better clarity. They include:  - renaming elements.py to element_dependencies.py.  Adds clarity about the    purpose of this module.  - updating other code for this rename.  - move tests into a tests submodule.  
__label__quality Python code refactorings.  This commit refactors the python code in diskimage_builder slightly.  This is in preparation for a larger review that adds more functionality to the python code, namely the ability to apply elements to the current system as opposed to a chroot.  Further, the refactorings can stand on their own for better clarity. They include:  - renaming elements.py to element_dependencies.py.  Adds clarity about the    purpose of this module.  - updating other code for this rename.  - move tests into a tests submodule.  
__label__refactoring DELETE v2.0/images/{image_id}/tags/{tag} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__testing DELETE v2.0/images/{image_id}/tags/{tag} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__refactoring PATCH v2.0/images/{image_id} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__testing PATCH v2.0/images/{image_id} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__refactoring DELETE v2.0/images/{image_id} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__testing DELETE v2.0/images/{image_id} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__refactoring POST v2.0/images/{image_id}/tags/{tag} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__testing POST v2.0/images/{image_id}/tags/{tag} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__refactoring GET v2.0/images/{image_id} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__testing GET v2.0/images/{image_id} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__refactoring GET v2.0/images/{image_id}/file - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__testing GET v2.0/images/{image_id}/file - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__refactoring POST v2.0/images/{image_id}/members - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__testing POST v2.0/images/{image_id}/members - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__refactoring PUT v2.0/images/{image_id}/members/{member_id} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__testing PUT v2.0/images/{image_id}/members/{member_id} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__refactoring DELETE v2.0/images/{image_id}/members/{member_id} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__testing DELETE v2.0/images/{image_id}/members/{member_id} - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__refactoring GET v2.0/images/{image_id}/members - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__testing GET v2.0/images/{image_id}/members - Refactoring  Refactors all tests to use images_behavior functionality.  
__label__objective Refactor yum packages collection mechanism  * Get desired rpms from dependencies and from instances   functions joined and unified. * Requirement objects are used instead of package names.  
__label__quality Refactor yum packages collection mechanism  * Get desired rpms from dependencies and from instances   functions joined and unified. * Requirement objects are used instead of package names.  
__label__objective Refactor of SSH client  * Override Paramiko's SSH client to return status code * Created strongly typed response for exec_command * Created new base SSH client which handles the bare essentials * Created base SSH behaviors to encapsulate functionality from the client  
__label__quality Refactor of SSH client  * Override Paramiko's SSH client to return status code * Created strongly typed response for exec_command * Created new base SSH client which handles the bare essentials * Created base SSH behaviors to encapsulate functionality from the client  
__label__objective Refactor of Remote Instance client  * Moved instance client into Compute namespace * Moved ping client into Compute namespace * Added instance client base class * Simplified functionality provided by instance client  
__label__refactoring Refactor of Remote Instance client  * Moved instance client into Compute namespace * Moved ping client into Compute namespace * Added instance client base class * Simplified functionality provided by instance client  
__label__objective Verify-license refactoring  Added variable number of arguments capability and cleaned up unused code. Allowing variable number of arguments would help different vendors implement their own version of licensing that might need additional information to be passed to the verify_license function, e.g. software version.  Story: 2007403 Task: 39407  
__label__quality Verify-license refactoring  Added variable number of arguments capability and cleaned up unused code. Allowing variable number of arguments would help different vendors implement their own version of licensing that might need additional information to be passed to the verify_license function, e.g. software version.  Story: 2007403 Task: 39407  
__label__objective Verify-license refactoring  Added variable number of arguments capability and cleaned up unused code. Allowing variable number of arguments would help different vendors implement their own version of licensing that might need additional information to be passed to the verify_license function, e.g. software version.  Story: 2007403 Task: 39407  
__label__refactoring Refactor read_uri function  
__label__refactoring Refactor path splitting and validation.  The account, container, and object servers all do the same thing at the top of GET/PUT/etc.: they split the path, validate that the first two components are a good (device, partition) pair, and return a 400 if they're not. The object server already had a module-local helper function for this, but the account and container servers just had duplicate boilerplate code. Now it's all in one common helper.  
__label__quality Refactor path splitting and validation.  The account, container, and object servers all do the same thing at the top of GET/PUT/etc.: they split the path, validate that the first two components are a good (device, partition) pair, and return a 400 if they're not. The object server already had a module-local helper function for this, but the account and container servers just had duplicate boilerplate code. Now it's all in one common helper.  
__label__objective Refactor path splitting and validation.  The account, container, and object servers all do the same thing at the top of GET/PUT/etc.: they split the path, validate that the first two components are a good (device, partition) pair, and return a 400 if they're not. The object server already had a module-local helper function for this, but the account and container servers just had duplicate boilerplate code. Now it's all in one common helper.  
__label__objective Refactor how we pick listings' content type.  There were a few different places where we had some repeated code to figure out what format an account or container listing response should be in (text, JSON, or XML). Now that's been pulled into a single function.  As part of this, you can now raise HTTPException subclasses in proxy controllers instead of laboriously plumbing error responses all the way back up to swift.proxy.server.Application.handle_request(). This lets us avoid certain ugly patterns, like the one where a method returns a tuple of (x, y, z, error) and the caller has to see if it got (value, value, value, None) or (None, None, None, errorvalue). Now we can just raise the error.  
__label__quality Refactor how we pick listings' content type.  There were a few different places where we had some repeated code to figure out what format an account or container listing response should be in (text, JSON, or XML). Now that's been pulled into a single function.  As part of this, you can now raise HTTPException subclasses in proxy controllers instead of laboriously plumbing error responses all the way back up to swift.proxy.server.Application.handle_request(). This lets us avoid certain ugly patterns, like the one where a method returns a tuple of (x, y, z, error) and the caller has to see if it got (value, value, value, None) or (None, None, None, errorvalue). Now we can just raise the error.  
__label__objective Refactor how we pick listings' content type.  There were a few different places where we had some repeated code to figure out what format an account or container listing response should be in (text, JSON, or XML). Now that's been pulled into a single function.  As part of this, you can now raise HTTPException subclasses in proxy controllers instead of laboriously plumbing error responses all the way back up to swift.proxy.server.Application.handle_request(). This lets us avoid certain ugly patterns, like the one where a method returns a tuple of (x, y, z, error) and the caller has to see if it got (value, value, value, None) or (None, None, None, errorvalue). Now we can just raise the error.  
__label__objective Refactor decorators  There must be difference between task class and task instance: at the very least, they have different uuids. Task decorator should produce task classes, not instances.  This commit attempts to simplify things by adding attribute to function instead of wrapping it.  
__label__quality Refactor decorators  There must be difference between task class and task instance: at the very least, they have different uuids. Task decorator should produce task classes, not instances.  This commit attempts to simplify things by adding attribute to function instead of wrapping it.  
__label__objective Refactor decorators  There must be difference between task class and task instance: at the very least, they have different uuids. Task decorator should produce task classes, not instances.  This commit attempts to simplify things by adding attribute to function instead of wrapping it.  
__label__objective xenapi: refactor - extract get_virtual_size  This change extracts a function get_virtual_size. This is needed, because we would like to support tar.gz files, in which case the image's virtual size will be determined by looking at the tar.gz stream. The first tarinfo will tell us the size.  related to blueprint xenapi-supported-image-import-export  
__label__integration xenapi: refactor - extract get_virtual_size  This change extracts a function get_virtual_size. This is needed, because we would like to support tar.gz files, in which case the image's virtual size will be determined by looking at the tar.gz stream. The first tarinfo will tell us the size.  related to blueprint xenapi-supported-image-import-export  
__label__objective xenapi: refactor - extract get_virtual_size  This change extracts a function get_virtual_size. This is needed, because we would like to support tar.gz files, in which case the image's virtual size will be determined by looking at the tar.gz stream. The first tarinfo will tell us the size.  related to blueprint xenapi-supported-image-import-export  
__label__objective xenapi: refactor - extract get_stream_funct_for  This change extracts the get_stream_funct_for function. As we would like to support tar.gz compressed raw images, the stream function for them should be different from the plain ones.  related to blueprint xenapi-supported-image-import-export  
__label__integration xenapi: refactor - extract get_stream_funct_for  This change extracts the get_stream_funct_for function. As we would like to support tar.gz compressed raw images, the stream function for them should be different from the plain ones.  related to blueprint xenapi-supported-image-import-export  
__label__objective xenapi: refactor - extract get_stream_funct_for  This change extracts the get_stream_funct_for function. As we would like to support tar.gz compressed raw images, the stream function for them should be different from the plain ones.  related to blueprint xenapi-supported-image-import-export  
__label__quality Refactor of Servers requests  * Replaced usage of banned _auto_to_* function calls    with proper serialization * Renamed un-pythonic properties to proper names * Refactored rebuild to no longer inherit from create   server. There could be some code sharing between the   two, but the previous implementation was hackish  
__label__objective Refactor of Servers requests  * Replaced usage of banned _auto_to_* function calls    with proper serialization * Renamed un-pythonic properties to proper names * Refactored rebuild to no longer inherit from create   server. There could be some code sharing between the   two, but the previous implementation was hackish  
__label__objective Refactor into a main() function  Add a main() function.  Also only process one project's changes at a time to help reduce how much has to be held in memory at once.  
__label__refactoring Refactor into a main() function  Add a main() function.  Also only process one project's changes at a time to help reduce how much has to be held in memory at once.  
__label__objective Refactor into a main() function  Add a main() function.  Also only process one project's changes at a time to help reduce how much has to be held in memory at once.  
__label__quality Refactor useful nova functions for re-use.  Refactor handy nova functions out of Instance and into a helper module. This allows alternate compute implementations to use this functionality without having to subclass.  
__label__objective Refactor useful nova functions for re-use.  Refactor handy nova functions out of Instance and into a helper module. This allows alternate compute implementations to use this functionality without having to subclass.  
__label__objective CLI colors refactored  Colors are now stored in their own module. Output coloring was factored out into a separate utility function.  State => color mapping is now implemented as a dictionary instead of multiple conditionals.  Signed-off-by: Jiri Podivin <jpodivin@redhat.com> 
__label__refactoring CLI colors refactored  Colors are now stored in their own module. Output coloring was factored out into a separate utility function.  State => color mapping is now implemented as a dictionary instead of multiple conditionals.  Signed-off-by: Jiri Podivin <jpodivin@redhat.com> 
__label__objective Refactoring and adding to functional orders tests  
__label__testing Refactoring and adding to functional orders tests  
__label__refactoring [MGM] Refactor pool manager ready for new functions such as delete  
__label__refactoring [MGM] Refactor pool manager ready for new functions such as delete  
__label__objective Refactor DiskFile instantiation in object server.  DiskFile() takes a lot of arguments whose value is the same on every instantiation, so I pulled that stuff out into a utility method. No functionality change is intended.  
__label__refactoring Refactor DiskFile instantiation in object server.  DiskFile() takes a lot of arguments whose value is the same on every instantiation, so I pulled that stuff out into a utility method. No functionality change is intended.  
__label__objective Refactor the backup method of SwiftBackupService  Export functionalities of backup to 3 new methods: prepare_backup backup_chunk and finalize_backup. The original backup function calls those functions. This allows other drivers to combine them in a different logic. e.g for the RBDDriver  
__label__quality Refactor the backup method of SwiftBackupService  Export functionalities of backup to 3 new methods: prepare_backup backup_chunk and finalize_backup. The original backup function calls those functions. This allows other drivers to combine them in a different logic. e.g for the RBDDriver  
__label__objective Refactor the backup method of SwiftBackupService  Export functionalities of backup to 3 new methods: prepare_backup backup_chunk and finalize_backup. The original backup function calls those functions. This allows other drivers to combine them in a different logic. e.g for the RBDDriver  
__label__objective Refactor code  _add_recipe and _add_run_list are combined, _run_chef_client are modified, and multi-thread code are put in a single function.  
__label__objective Refactor code  _add_recipe and _add_run_list are combined, _run_chef_client are modified, and multi-thread code are put in a single function.  
__label__objective Refactor the first boot routine.  Setting up a routine to run at first time the system boot may vary from distribution to distribution. This patch will remove the logic from the diskimage-builder code and put it into the elements.  The base element will now deploy a dib-first-boot script and each OS element will ensure that this script runs at rc.local time. By doing that we will put the OS specific stuff in the OS elements and remove the embedded code out of the img-function file.  
__label__objective Refactor the first boot routine.  Setting up a routine to run at first time the system boot may vary from distribution to distribution. This patch will remove the logic from the diskimage-builder code and put it into the elements.  The base element will now deploy a dib-first-boot script and each OS element will ensure that this script runs at rc.local time. By doing that we will put the OS specific stuff in the OS elements and remove the embedded code out of the img-function file.  
__label__testing Refactored tests for key_pair_*() functions.  
__label__refactoring Refactored tests for key_pair_*() functions.  
__label__objective Refactored image behaviors  * Modified polling methods to match standard CC style * Added create_active_image function  
__label__objective Refactored image behaviors  * Modified polling methods to match standard CC style * Added create_active_image function  
__label__objective Refactoring format_device function  * Algorithm format_device was changed for simplicity extension new   ip addresses parameters. * Some prints outputs was replacement by function format_device.  
__label__objective Refactoring format_device function  * Algorithm format_device was changed for simplicity extension new   ip addresses parameters. * Some prints outputs was replacement by function format_device.  
__label__objective refactor the install/configure split  configure remains just to generate configs, install now gets the setup_develop in addition to the git clone. This lets use remove configure_glanceclient as a function  
__label__objective refactor the install/configure split  configure remains just to generate configs, install now gets the setup_develop in addition to the git clone. This lets use remove configure_glanceclient as a function  
__label__objective Refactor error logging  It is hard to grep errors in current log. so in this patch, I'm adding log_error function which also writes log for screen_log_dir/error.log. In future, we may categolize negative fault by using this error.log.  
__label__objective Refactor error logging  It is hard to grep errors in current log. so in this patch, I'm adding log_error function which also writes log for screen_log_dir/error.log. In future, we may categolize negative fault by using this error.log.  
__label__integration Refactor compute_utils to avoid db lookup  This simple change passes bdms into the following compute_utils function to avoid it doing a database lookup:    get_device_name_for_instance()  Related to bp/no-db-compute  
__label__objective Refactor compute_utils to avoid db lookup  This simple change passes bdms into the following compute_utils function to avoid it doing a database lookup:    get_device_name_for_instance()  Related to bp/no-db-compute  
__label__quality Refactor quantum installation  * Move quantum installation to lib/quantum * Refactor quantum configuration * Move Quantum service account creation from keystone_data.sh to lib/quantum * Define generic functions to install third party programs  * Minor cleanups related to Quantum   * Kill dnsmasq which watches an interface 'ns-XXXXXX' in unstack.sh   * Set default_floating_pool in nova.conf to make default flaoting pool     work when PUBLIC_NETWORK_NAME is other than 'nova'   * Make tempest work even when PRIVATE_NETWORK_NAME is other than 'private'  
__label__objective Refactor quantum installation  * Move quantum installation to lib/quantum * Refactor quantum configuration * Move Quantum service account creation from keystone_data.sh to lib/quantum * Define generic functions to install third party programs  * Minor cleanups related to Quantum   * Kill dnsmasq which watches an interface 'ns-XXXXXX' in unstack.sh   * Set default_floating_pool in nova.conf to make default flaoting pool     work when PUBLIC_NETWORK_NAME is other than 'nova'   * Make tempest work even when PRIVATE_NETWORK_NAME is other than 'private'  
__label__quality module refactoring  Distributes the functionality of service.py into the modules. Moves ComposableRouters into their own package keystone/routers. Moved the token controller from service.py into trusts/controllers split out extensions move version controller into catalog/controllers removed apis from common controller and pushed  down to module controllers  
__label__objective module refactoring  Distributes the functionality of service.py into the modules. Moves ComposableRouters into their own package keystone/routers. Moved the token controller from service.py into trusts/controllers split out extensions move version controller into catalog/controllers removed apis from common controller and pushed  down to module controllers  
__label__integration Refactor db_replicator's roundrobin_datadirs  roundrobin_datadirs was returning any .db file at any depth in the accounts/containers structure. Since xfs corruption can cause such files to appear in odd places at times (only happened on one drive of ours so far, but still...), I've refactored this function to only return .db files at the proper depth.  
__label__quality Refactor db_replicator's roundrobin_datadirs  roundrobin_datadirs was returning any .db file at any depth in the accounts/containers structure. Since xfs corruption can cause such files to appear in odd places at times (only happened on one drive of ours so far, but still...), I've refactored this function to only return .db files at the proper depth.  
__label__objective Refactor db_replicator's roundrobin_datadirs  roundrobin_datadirs was returning any .db file at any depth in the accounts/containers structure. Since xfs corruption can cause such files to appear in odd places at times (only happened on one drive of ours so far, but still...), I've refactored this function to only return .db files at the proper depth.  
__label__quality Refactor: config drive related functions  Related to blueprint xenapi-config-drive  Move the configdrive related functions to the nova.virt.configdrive module, so that it could be used by other drivers as well. Also move the configdrive related configuration options to the same module.  
__label__integration Refactor: config drive related functions  Related to blueprint xenapi-config-drive  Move the configdrive related functions to the nova.virt.configdrive module, so that it could be used by other drivers as well. Also move the configdrive related configuration options to the same module.  
__label__objective Refactor: config drive related functions  Related to blueprint xenapi-config-drive  Move the configdrive related functions to the nova.virt.configdrive module, so that it could be used by other drivers as well. Also move the configdrive related configuration options to the same module.  
__label__objective refactor all uses of the `qemu-img info` command  * nova/virt/images.py: Define a single function that calls `qemu-img info` in a robust manner, by avoiding locale issues etc. * nova/virt/libvirt/utils.py: Define secondary functions to parse items returned from images.qemu_img_info(). * nova/virt/libvirt/driver.py: Use the libvirt.utils functions. * nova/virt/disk/api.py: Likewise. * nova/tests/test_libvirt.py: Remove no longer needed stub for utils.execute('qemu-img info'). Adjust to a more restrictive `qemu-img info` format, and more robust calling signature.  
__label__objective refactor all uses of the `qemu-img info` command  * nova/virt/images.py: Define a single function that calls `qemu-img info` in a robust manner, by avoiding locale issues etc. * nova/virt/libvirt/utils.py: Define secondary functions to parse items returned from images.qemu_img_info(). * nova/virt/libvirt/driver.py: Use the libvirt.utils functions. * nova/virt/disk/api.py: Likewise. * nova/tests/test_libvirt.py: Remove no longer needed stub for utils.execute('qemu-img info'). Adjust to a more restrictive `qemu-img info` format, and more robust calling signature.  
__label__objective Auth refactor.  Switch to using the self-contained django_openstack_auth package which is a proper django.contrib.auth pluggable backend.  Notable functional improvements include:    * Better overall security via use of standard Django     auth code (well-vetted by security experts).   * Token expiration checking.   * User "enabled" attribute checking.   * Support for full range of Django auth attributes     such as is_anonymous, is_active, is_superuser, etc.   * Improved hooks for RBAC/permission-based acess control.  Regarding the RBAC/permission-based access control, this patch moves all "role" and "service"-oriented checks to permission checks. This will make transitioning to policy-driven checking much easier once that fully lands in OpenStack.  Implements blueprint move-keystone-support-to-django-auth-backend  
__label__objective Auth refactor.  Switch to using the self-contained django_openstack_auth package which is a proper django.contrib.auth pluggable backend.  Notable functional improvements include:    * Better overall security via use of standard Django     auth code (well-vetted by security experts).   * Token expiration checking.   * User "enabled" attribute checking.   * Support for full range of Django auth attributes     such as is_anonymous, is_active, is_superuser, etc.   * Improved hooks for RBAC/permission-based acess control.  Regarding the RBAC/permission-based access control, this patch moves all "role" and "service"-oriented checks to permission checks. This will make transitioning to policy-driven checking much easier once that fully lands in OpenStack.  Implements blueprint move-keystone-support-to-django-auth-backend  
__label__quality Refactor away the flags.DEFINE_* helpers  The next obvious step in porting to cfg is to define all options using cfg schemas directly rather than using the flags.DEFINE_* helpers.  This is a large change, but it is almost entirely pure refactoring and does not result in any functional changes.  The only change to note is that the default values for glance_host, glance_api_servers and default_publisher_id options are now using opt value interpolation i.e.   -glance_host=_get_my_ip()  +glance_host='$my_ip'   -glance_api_servers=['%s:%d' % (FLAGS.glance_host, FLAGS.glance_port)]  +glance_api_servers=['$glance_host:$glance_port']   -default_publisher_id=FLAGS.host  +default_publisher_id='$host'  Also note that the lower_bound check on the {report,periodic}_interval options are no more, but this has been true since cfg was first added.  
__label__objective Refactor away the flags.DEFINE_* helpers  The next obvious step in porting to cfg is to define all options using cfg schemas directly rather than using the flags.DEFINE_* helpers.  This is a large change, but it is almost entirely pure refactoring and does not result in any functional changes.  The only change to note is that the default values for glance_host, glance_api_servers and default_publisher_id options are now using opt value interpolation i.e.   -glance_host=_get_my_ip()  +glance_host='$my_ip'   -glance_api_servers=['%s:%d' % (FLAGS.glance_host, FLAGS.glance_port)]  +glance_api_servers=['$glance_host:$glance_port']   -default_publisher_id=FLAGS.host  +default_publisher_id='$host'  Also note that the lower_bound check on the {report,periodic}_interval options are no more, but this has been true since cfg was first added.  
__label__quality Refactor virtualbmc-domain tasks into a module  Virtualbmc domain creation can be unreliable, in particular when domains already exist. This is in part due to the vbmc stop command not functioning properly [1]. By moving the domain management into a Python module we can better control the process of creation, and improve performance.  [1] https://storyboard.openstack.org/#!/story/2003534  
__label__objective Refactor virtualbmc-domain tasks into a module  Virtualbmc domain creation can be unreliable, in particular when domains already exist. This is in part due to the vbmc stop command not functioning properly [1]. By moving the domain management into a Python module we can better control the process of creation, and improve performance.  [1] https://storyboard.openstack.org/#!/story/2003534  
__label__objective Refactor virtualbmc-domain tasks into a module  Virtualbmc domain creation can be unreliable, in particular when domains already exist. This is in part due to the vbmc stop command not functioning properly [1]. By moving the domain management into a Python module we can better control the process of creation, and improve performance.  [1] https://storyboard.openstack.org/#!/story/2003534  
__label__quality Refactoring logging _log function.  We should not be overriding private functions of core python modules. Fixes bug: 915597  
__label__objective Refactoring logging _log function.  We should not be overriding private functions of core python modules. Fixes bug: 915597  
__label__objective Refactoring logging _log function.  We should not be overriding private functions of core python modules. Fixes bug: 915597  
__label__testing Refactored manage.py to be both testable and useful for testing  - Added keystone.test.functional.test_core_api, with example - Also revised imports in functional tests  
__label__objective Refactored manage.py to be both testable and useful for testing  - Added keystone.test.functional.test_core_api, with example - Also revised imports in functional tests  
__label__objective Generalize and refactor Octavia waiters module  So far tobiko/tobiko/tests/scenario/octavia/waiters.py could only wait for provisioning_status and for operating_status, and only for "ACTIVE" status.  This patch generalizes the waiters module so it could wait for any Octavia object, for any status key (field) and for any specific status. It also refactors the waiters module to have one function which is well documented and uses constants.  
__label__objective Generalize and refactor Octavia waiters module  So far tobiko/tobiko/tests/scenario/octavia/waiters.py could only wait for provisioning_status and for operating_status, and only for "ACTIVE" status.  This patch generalizes the waiters module so it could wait for any Octavia object, for any status key (field) and for any specific status. It also refactors the waiters module to have one function which is well documented and uses constants.  
__label__objective Refactor registry request actions  In order to handle re-authentication at request time rather than letting tenancity trigger it, this change creates a session helper class that wraps the various get/patch/push/put actions that we use in the image uploader to perform a single re-autentication action when we get a 401 from a registry.  Previously we would let the reauthentication occur when tenancity would retry various functions.  There are several functions which perform muiltple requests that could exceed the TTL for authentication tokens. This leads to failures that could have been prevented if we re-auth at the time of the request rather than retrying the entire action.  
__label__objective Refactor registry request actions  In order to handle re-authentication at request time rather than letting tenancity trigger it, this change creates a session helper class that wraps the various get/patch/push/put actions that we use in the image uploader to perform a single re-autentication action when we get a 401 from a registry.  Previously we would let the reauthentication occur when tenancity would retry various functions.  There are several functions which perform muiltple requests that could exceed the TTL for authentication tokens. This leads to failures that could have been prevented if we re-auth at the time of the request rather than retrying the entire action.  
__label__objective Refactor registry request actions  In order to handle re-authentication at request time rather than letting tenancity trigger it, this change creates a session helper class that wraps the various get/patch/push/put actions that we use in the image uploader to perform a single re-autentication action when we get a 401 from a registry.  Previously we would let the reauthentication occur when tenancity would retry various functions.  There are several functions which perform muiltple requests that could exceed the TTL for authentication tokens. This leads to failures that could have been prevented if we re-auth at the time of the request rather than retrying the entire action.  
__label__objective Refactor registry request actions  In order to handle re-authentication at request time rather than letting tenancity trigger it, this change creates a session helper class that wraps the various get/patch/push/put actions that we use in the image uploader to perform a single re-autentication action when we get a 401 from a registry.  Previously we would let the reauthentication occur when tenancity would retry various functions.  There are several functions which perform muiltple requests that could exceed the TTL for authentication tokens. This leads to failures that could have been prevented if we re-auth at the time of the request rather than retrying the entire action.  
__label__objective Refactor registry request actions  In order to handle re-authentication at request time rather than letting tenancity trigger it, this change creates a session helper class that wraps the various get/patch/push/put actions that we use in the image uploader to perform a single re-autentication action when we get a 401 from a registry.  Previously we would let the reauthentication occur when tenancity would retry various functions.  There are several functions which perform muiltple requests that could exceed the TTL for authentication tokens. This leads to failures that could have been prevented if we re-auth at the time of the request rather than retrying the entire action.  
__label__objective Refactor registry request actions  In order to handle re-authentication at request time rather than letting tenancity trigger it, this change creates a session helper class that wraps the various get/patch/push/put actions that we use in the image uploader to perform a single re-autentication action when we get a 401 from a registry.  Previously we would let the reauthentication occur when tenancity would retry various functions.  There are several functions which perform muiltple requests that could exceed the TTL for authentication tokens. This leads to failures that could have been prevented if we re-auth at the time of the request rather than retrying the entire action.  
__label__quality Refactoring: move iSCSI deploy code to iscsi_deploy.py  The deploy_utils module is for code that is shared between all deploy methods, but these functions are specific to iSCSI deploy.  
__label__objective Refactoring: move iSCSI deploy code to iscsi_deploy.py  The deploy_utils module is for code that is shared between all deploy methods, but these functions are specific to iSCSI deploy.  
__label__quality Refactoring: move generic agent clean step functions to agent_base  * Clean steps methods from deploy_utils * Identical implementations from agent.py and iscsi_deploy.py  
__label__objective Refactoring: move generic agent clean step functions to agent_base  * Clean steps methods from deploy_utils * Identical implementations from agent.py and iscsi_deploy.py  
__label__objective Refactor validate_ports function  Since 1.28 is ancient and all the stable branches have support for `get_node_vifs` let's remove the unnecessary check.  
__label__objective Refactor validate_ports function  Since 1.28 is ancient and all the stable branches have support for `get_node_vifs` let's remove the unnecessary check.  
__label__quality WIP: Refactor expressions  * This patch moves code related to YAQL and Jinja into their   specific modules so that there isn't any module that works with   both. It makes it easier to understand how code related to one   of these technologies works. * Custome built-in functions for YAQL and Jinja are now in a   separate module. It's easier now to see what's related with   the expression framework now and what's with integration part,   i.e. functions themselves. * Renamed the base module of expressions similar to other packages. * Other style changes.  
__label__objective WIP: Refactor expressions  * This patch moves code related to YAQL and Jinja into their   specific modules so that there isn't any module that works with   both. It makes it easier to understand how code related to one   of these technologies works. * Custome built-in functions for YAQL and Jinja are now in a   separate module. It's easier now to see what's related with   the expression framework now and what's with integration part,   i.e. functions themselves. * Renamed the base module of expressions similar to other packages. * Other style changes.  
__label__objective Refactoring: finish splitting do_node_deploy  This change splits ConductorManager.do_node_deploy into two new functions: validate_node and start_deploy. The only small behavior change is validating that an FSM action is possible before making any changes (previously we did it in the very end, potentiall after modifying a node).  
__label__objective Refactoring: finish splitting do_node_deploy  This change splits ConductorManager.do_node_deploy into two new functions: validate_node and start_deploy. The only small behavior change is validating that an FSM action is possible before making any changes (previously we did it in the very end, potentiall after modifying a node).  
__label__objective generic: Refactor network functions to l3_init  There's a few functions which are used inside service_instance which do networking that can live inside the linux interface driver code.  This patch refactors them into there as this helps allow for the noop driver.  
__label__objective generic: Refactor network functions to l3_init  There's a few functions which are used inside service_instance which do networking that can live inside the linux interface driver code.  This patch refactors them into there as this helps allow for the noop driver.  
__label__objective generic: Refactor network functions to l3_init  There's a few functions which are used inside service_instance which do networking that can live inside the linux interface driver code.  This patch refactors them into there as this helps allow for the noop driver.  
__label__objective generic: Refactor network functions to l3_init  There's a few functions which are used inside service_instance which do networking that can live inside the linux interface driver code.  This patch refactors them into there as this helps allow for the noop driver.  
__label__quality [WIP] Refactors pegleg CLI to use single commands  Debugging pegleg can currently be difficult and the Click CLI does not easily allow debuggers like pdb or PyCharm to use breakpoints. By moving all CLI command calls into singular functions, we can easily create an "if __name__ == '__main__'" entry point to call these functions and investigate any bugs that may arise.  
__label__objective [WIP] Refactors pegleg CLI to use single commands  Debugging pegleg can currently be difficult and the Click CLI does not easily allow debuggers like pdb or PyCharm to use breakpoints. By moving all CLI command calls into singular functions, we can easily create an "if __name__ == '__main__'" entry point to call these functions and investigate any bugs that may arise.  
__label__objective Refactoring the codes about getting used and free resources  We have provided functions to get used and free resources in class ModelRoot. So strategies can invoke the functions to get used and free resources.  
__label__objective Refactoring the codes about getting used and free resources  We have provided functions to get used and free resources in class ModelRoot. So strategies can invoke the functions to get used and free resources.  
__label__testing Refactor AggregateTests  While investigating the referenced story/bug I noticed that wait_for_status in openstackclient.tests.functional.compute.v2.test_aggregate.AggregateTests was doing a lot more than it should ever need to (it probably got copied in from somewhere). The two places calling it only need to a) check the output of `openstack aggregate show`, and b) try once -- since they just got done creating the aggregate synchronously, there should never be a need to delay/retry. So this commit removes the helper method and just inlines the check.  At the same time, the addCleanup(aggregate delete) directives are moved above their respective creates. This is a defensive best practice which makes sure cleanup happens even if something fails very soon after the actual back-end create (as was in fact the case with the referenced bug/story).  It is unknown whether this will impact the referenced bug.  
__label__quality Refactor AggregateTests  While investigating the referenced story/bug I noticed that wait_for_status in openstackclient.tests.functional.compute.v2.test_aggregate.AggregateTests was doing a lot more than it should ever need to (it probably got copied in from somewhere). The two places calling it only need to a) check the output of `openstack aggregate show`, and b) try once -- since they just got done creating the aggregate synchronously, there should never be a need to delay/retry. So this commit removes the helper method and just inlines the check.  At the same time, the addCleanup(aggregate delete) directives are moved above their respective creates. This is a defensive best practice which makes sure cleanup happens even if something fails very soon after the actual back-end create (as was in fact the case with the referenced bug/story).  It is unknown whether this will impact the referenced bug.  
__label__objective Refactor AggregateTests  While investigating the referenced story/bug I noticed that wait_for_status in openstackclient.tests.functional.compute.v2.test_aggregate.AggregateTests was doing a lot more than it should ever need to (it probably got copied in from somewhere). The two places calling it only need to a) check the output of `openstack aggregate show`, and b) try once -- since they just got done creating the aggregate synchronously, there should never be a need to delay/retry. So this commit removes the helper method and just inlines the check.  At the same time, the addCleanup(aggregate delete) directives are moved above their respective creates. This is a defensive best practice which makes sure cleanup happens even if something fails very soon after the actual back-end create (as was in fact the case with the referenced bug/story).  It is unknown whether this will impact the referenced bug.  
__label__objective More refactoring of the image module  Introducing new function _umount_all_partitions to reduce the size of _install_grub2  
__label__quality More refactoring of the image module  Introducing new function _umount_all_partitions to reduce the size of _install_grub2  
__label__objective More refactoring of the image module  Introducing new function _umount_all_partitions to reduce the size of _install_grub2  
__label__objective Refactor TSM code to common with redfish  This gives common access to TSM OEM function to redfish and IPMI (which really is using https here).  Should any function come up which absolutely suggests IPMI use in the TSM module, it will be conoditionally enabled by ipmi side and ignored redfish side.  
__label__quality Refactor TSM code to common with redfish  This gives common access to TSM OEM function to redfish and IPMI (which really is using https here).  Should any function come up which absolutely suggests IPMI use in the TSM module, it will be conoditionally enabled by ipmi side and ignored redfish side.  
__label__objective Refactor TSM code to common with redfish  This gives common access to TSM OEM function to redfish and IPMI (which really is using https here).  Should any function come up which absolutely suggests IPMI use in the TSM module, it will be conoditionally enabled by ipmi side and ignored redfish side.  
__label__refactoring Some refactoring regarding merge aim statuses  Put those common codes into a function.  
__label__refactoring Some refactoring regarding merge aim statuses  Put those common codes into a function.  
__label__refactoring Some refactoring regarding merge aim statuses  Put those common codes into a function.  
__label__refactoring Some refactoring regarding merge aim statuses  Put those common codes into a function.  
__label__refactoring Some refactoring regarding merge aim statuses  Put those common codes into a function.  
__label__quality Refactor MigrationTask._execute  This patch pulls out two functions from MigrationTask._execute. One for the initial schedule case and the other for the re-schedule case. This way unit testing some of the intricate parts of re-schedule becomes easier.  
__label__testing Refactor MigrationTask._execute  This patch pulls out two functions from MigrationTask._execute. One for the initial schedule case and the other for the re-schedule case. This way unit testing some of the intricate parts of re-schedule becomes easier.  
__label__objective Refactor MigrationTask._execute  This patch pulls out two functions from MigrationTask._execute. One for the initial schedule case and the other for the re-schedule case. This way unit testing some of the intricate parts of re-schedule becomes easier.  
__label__quality Refactor part of image module  Shuffle some functions around and reduce size of _is_bootloader_loaded moving logic out to a new function.  
__label__quality More refactoring of the image module  Introducing new function _umount_all_partitions to reduce the size of _install_grub2  
__label__quality Refactor part of image module  Shuffle some functions around and reduce size of _is_bootloader_loaded moving logic out to a new function.  
__label__quality k8s: refactor functions into KubernetesDriver  We currently have a lot of duplicate functions across our drivers which use Kubernetes.  This takes them and brings them into a common class called KubernetesDriver and cleans up the subclasses.  
__label__integration k8s: refactor functions into KubernetesDriver  We currently have a lot of duplicate functions across our drivers which use Kubernetes.  This takes them and brings them into a common class called KubernetesDriver and cleans up the subclasses.  
__label__objective k8s: refactor functions into KubernetesDriver  We currently have a lot of duplicate functions across our drivers which use Kubernetes.  This takes them and brings them into a common class called KubernetesDriver and cleans up the subclasses.  
__label__objective Refactor the test_qos.QoSTestMixin._check_bw function  Improved the robustness of this function: - The remote process ("nc"), will be stopped both at the beginning and   the end of this function, just to ensure the process is not left   running at the beginning of the next check. - The socket connection is closed when the file is received (or in case   of exception). This will close the client socket and will end the "nc"   process in the remote VM. - Set a socket timeout. This timeout, specifically defined for each   iteration, depending on the expected bandwidth, will force a quick   timeout while receiving from the remote VM. The check will fail and it   will be tested again, if the "FILE_DOWNLOAD_TIMEOUT" didn't happen yet.  
__label__testing Refactor the test_qos.QoSTestMixin._check_bw function  Improved the robustness of this function: - The remote process ("nc"), will be stopped both at the beginning and   the end of this function, just to ensure the process is not left   running at the beginning of the next check. - The socket connection is closed when the file is received (or in case   of exception). This will close the client socket and will end the "nc"   process in the remote VM. - Set a socket timeout. This timeout, specifically defined for each   iteration, depending on the expected bandwidth, will force a quick   timeout while receiving from the remote VM. The check will fail and it   will be tested again, if the "FILE_DOWNLOAD_TIMEOUT" didn't happen yet.  
__label__objective Refactor the test_qos.QoSTestMixin._check_bw function  Improved the robustness of this function: - The remote process ("nc"), will be stopped both at the beginning and   the end of this function, just to ensure the process is not left   running at the beginning of the next check. - The socket connection is closed when the file is received (or in case   of exception). This will close the client socket and will end the "nc"   process in the remote VM. - Set a socket timeout. This timeout, specifically defined for each   iteration, depending on the expected bandwidth, will force a quick   timeout while receiving from the remote VM. The check will fail and it   will be tested again, if the "FILE_DOWNLOAD_TIMEOUT" didn't happen yet.  



